"use strict";(self["webpackChunkmy_vue_project"]=self["webpackChunkmy_vue_project"]||[]).push([[504],{24:function(t,e,i){var s=i(5471);e.A=s.Ay.extend({name:"v-list-item-icon",functional:!0,render(t,{data:e,children:i}){return e.staticClass=`v-list-item__icon ${e.staticClass||""}`.trim(),t("div",e,i)}})},34:function(t,e,i){var s=i(4901);t.exports=function(t){return"object"==typeof t?null!==t:s(t)}},81:function(t,e,i){var s=i(9565),n=i(9306),o=i(8551),r=i(6823),a=i(851),h=TypeError;t.exports=function(t,e){var i=arguments.length<2?a(t):e;if(n(i))return o(s(i,t));throw new h(r(t)+" is not iterable")}},116:function(t,e,i){var s=i(6518),n=i(2652),o=i(9306),r=i(8551),a=i(1767);s({target:"Iterator",proto:!0,real:!0},{find:function(t){r(this),o(t);var e=a(this),i=0;return n(e,(function(e,s){if(t(e,i++))return s(e)}),{IS_RECORD:!0,INTERRUPTED:!0}).result}})},125:function(){},158:function(){},283:function(t,e,i){var s=i(9504),n=i(9039),o=i(4901),r=i(9297),a=i(3724),h=i(350).CONFIGURABLE,l=i(3706),u=i(1181),c=u.enforce,d=u.get,f=String,g=Object.defineProperty,p=s("".slice),m=s("".replace),y=s([].join),v=a&&!n((function(){return 8!==g((function(){}),"length",{value:8}).length})),x=String(String).split("String"),b=t.exports=function(t,e,i){"Symbol("===p(f(e),0,7)&&(e="["+m(f(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),i&&i.getter&&(e="get "+e),i&&i.setter&&(e="set "+e),(!r(t,"name")||h&&t.name!==e)&&(a?g(t,"name",{value:e,configurable:!0}):t.name=e),v&&i&&r(i,"arity")&&t.length!==i.arity&&g(t,"length",{value:i.arity});try{i&&r(i,"constructor")&&i.constructor?a&&g(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(n){}var s=c(t);return r(s,"source")||(s.source=y(x,"string"==typeof e?e:"")),t};Function.prototype.toString=b((function(){return o(this)&&d(this).source||l(this)}),"toString")},350:function(t,e,i){var s=i(3724),n=i(9297),o=Function.prototype,r=s&&Object.getOwnPropertyDescriptor,a=n(o,"name"),h=a&&"something"===function(){}.name,l=a&&(!s||s&&r(o,"name").configurable);t.exports={EXISTS:a,PROPER:h,CONFIGURABLE:l}},397:function(t,e,i){var s=i(7751);t.exports=s("document","documentElement")},421:function(t){t.exports={}},616:function(t,e,i){var s=i(9039);t.exports=!s((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},679:function(t,e,i){var s=i(1625),n=TypeError;t.exports=function(t,e){if(s(e,t))return t;throw new n("Incorrect invocation")}},713:function(t,e,i){var s=i(9565),n=i(9306),o=i(8551),r=i(1767),a=i(9462),h=i(6319),l=a((function(){var t=this.iterator,e=o(s(this.next,t)),i=this.done=!!e.done;if(!i)return h(t,this.mapper,[e.value,this.counter++],!0)}));t.exports=function(t){return o(this),n(t),new l(r(this),{mapper:t})}},741:function(t){var e=Math.ceil,i=Math.floor;t.exports=Math.trunc||function(t){var s=+t;return(s>0?i:e)(s)}},757:function(t,e,i){var s=i(7751),n=i(4901),o=i(1625),r=i(7040),a=Object;t.exports=r?function(t){return"symbol"==typeof t}:function(t){var e=s("Symbol");return n(e)&&o(e.prototype,a(t))}},851:function(t,e,i){var s=i(6955),n=i(5966),o=i(4117),r=i(6269),a=i(8227),h=a("iterator");t.exports=function(t){if(!o(t))return n(t,h)||n(t,"@@iterator")||r[s(t)]}},980:function(t,e,i){i.d(e,{A:function(){return f}});i(4114);var s=i(6965),n=i(1325),o=i(3507),r=i(6960),a=(0,o.A)(n.A).extend({name:"v-responsive",props:{aspectRatio:[String,Number],contentClass:String},computed:{computedAspectRatio(){return Number(this.aspectRatio)},aspectStyle(){return this.computedAspectRatio?{paddingBottom:1/this.computedAspectRatio*100+"%"}:void 0},__cachedSizer(){return this.aspectStyle?this.$createElement("div",{style:this.aspectStyle,staticClass:"v-responsive__sizer"}):[]}},methods:{genContent(){return this.$createElement("div",{staticClass:"v-responsive__content",class:this.contentClass},(0,r.$c)(this))}},render(t){return t("div",{staticClass:"v-responsive",style:this.measurableStyles,on:this.$listeners},[this.__cachedSizer,this.genContent()])}}),h=a,l=i(3661),u=i(4961),c=i(5604);const d="undefined"!==typeof window&&"IntersectionObserver"in window;var f=(0,o.A)(h,l.A).extend({name:"v-img",directives:{intersect:s.A},props:{alt:String,contain:Boolean,eager:Boolean,gradient:String,lazySrc:String,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},position:{type:String,default:"center center"},sizes:String,src:{type:[String,Object],default:""},srcset:String,transition:{type:[Boolean,String],default:"fade-transition"}},data(){return{currentSrc:"",image:null,isLoading:!0,calculatedAspectRatio:void 0,naturalWidth:void 0,hasError:!1}},computed:{computedAspectRatio(){return Number(this.normalisedSrc.aspect||this.calculatedAspectRatio)},normalisedSrc(){return this.src&&"object"===typeof this.src?{src:this.src.src,srcset:this.srcset||this.src.srcset,lazySrc:this.lazySrc||this.src.lazySrc,aspect:Number(this.aspectRatio||this.src.aspect)}:{src:this.src,srcset:this.srcset,lazySrc:this.lazySrc,aspect:Number(this.aspectRatio||0)}},__cachedImage(){if(!(this.normalisedSrc.src||this.normalisedSrc.lazySrc||this.gradient))return[];const t=[],e=this.isLoading?this.normalisedSrc.lazySrc:this.currentSrc;this.gradient&&t.push(`linear-gradient(${this.gradient})`),e&&t.push(`url("${e}")`);const i=this.$createElement("div",{staticClass:"v-image__image",class:{"v-image__image--preload":this.isLoading,"v-image__image--contain":this.contain,"v-image__image--cover":!this.contain},style:{backgroundImage:t.join(", "),backgroundPosition:this.position},key:+this.isLoading});return this.transition?this.$createElement("transition",{attrs:{name:this.transition,mode:"in-out"}},[i]):i}},watch:{src(){this.isLoading?this.loadImage():this.init(void 0,void 0,!0)},"$vuetify.breakpoint.width":"getSrc"},mounted(){this.init()},methods:{init(t,e,i){if(!d||i||this.eager){if(this.normalisedSrc.lazySrc){const t=new Image;t.src=this.normalisedSrc.lazySrc,this.pollForSize(t,null)}this.normalisedSrc.src&&this.loadImage()}},onLoad(){this.getSrc(),this.isLoading=!1,this.$emit("load",this.src),this.image&&(this.normalisedSrc.src.endsWith(".svg")||this.normalisedSrc.src.startsWith("data:image/svg+xml"))&&(this.image.naturalHeight&&this.image.naturalWidth?(this.naturalWidth=this.image.naturalWidth,this.calculatedAspectRatio=this.image.naturalWidth/this.image.naturalHeight):this.calculatedAspectRatio=1)},onError(){this.hasError=!0,this.$emit("error",this.src)},getSrc(){this.image&&(this.currentSrc=this.image.currentSrc||this.image.src)},loadImage(){const t=new Image;this.image=t,t.onload=()=>{t.decode?t.decode().catch((t=>{(0,c.OP)(`Failed to decode image, trying to render anyway\n\nsrc: ${this.normalisedSrc.src}`+(t.message?`\nOriginal error: ${t.message}`:""),this)})).then(this.onLoad):this.onLoad()},t.onerror=this.onError,this.hasError=!1,this.sizes&&(t.sizes=this.sizes),this.normalisedSrc.srcset&&(t.srcset=this.normalisedSrc.srcset),t.src=this.normalisedSrc.src,this.$emit("loadstart",this.normalisedSrc.src),this.aspectRatio||this.pollForSize(t),this.getSrc()},pollForSize(t,e=100){const i=()=>{const{naturalHeight:s,naturalWidth:n}=t;s||n?(this.naturalWidth=n,this.calculatedAspectRatio=n/s):t.complete||!this.isLoading||this.hasError||null==e||setTimeout(i,e)};i()},genContent(){const t=h.options.methods.genContent.call(this);return this.naturalWidth&&this._b(t.data,"div",{style:{width:`${this.naturalWidth}px`}}),t},__genPlaceholder(){const t=(0,r.$c)(this,"placeholder");if(t){const e=this.isLoading?[this.$createElement("div",{staticClass:"v-image__placeholder"},t)]:[];return this.transition?this.$createElement("transition",{props:{appear:!0,name:this.transition}},e):e[0]}}},render(t){const e=h.options.render.call(this,t),i=(0,u.Ay)(e.data,{staticClass:"v-image",attrs:{"aria-label":this.alt,role:this.alt?"img":void 0},class:this.themeClasses,directives:d?[{name:"intersect",modifiers:{once:!0},value:{handler:this.init,options:this.options}}]:void 0});return e.children=[this.__cachedSizer,this.__cachedImage,this.__genPlaceholder(),this.genContent()],t(e.tag,i,e.children)}})},1072:function(t,e,i){var s=i(1828),n=i(8727);t.exports=Object.keys||function(t){return s(t,n)}},1075:function(t,e,i){i.d(e,{A:function(){return f}});var s=i(8767),n=i(8010),o=i(4387),r=i(3661),a=i(9748),h=i(1723),l=i(6960),u=i(5604),c=i(3507);const d=(0,c.A)(s.A,n.A,r.A,(0,o.P)("listItemGroup"),(0,a.P)("inputValue"));var f=d.extend().extend({name:"v-list-item",directives:{Ripple:h.A},inject:{isInGroup:{default:!1},isInList:{default:!1},isInMenu:{default:!1},isInNav:{default:!1}},inheritAttrs:!1,props:{activeClass:{type:String,default(){return this.listItemGroup?this.listItemGroup.activeClass:""}},dense:Boolean,inactive:Boolean,link:Boolean,selectable:{type:Boolean},tag:{type:String,default:"div"},threeLine:Boolean,twoLine:Boolean,value:null},data:()=>({proxyClass:"v-list-item--active"}),computed:{classes(){return{"v-list-item":!0,...n.A.options.computed.classes.call(this),"v-list-item--dense":this.dense,"v-list-item--disabled":this.disabled,"v-list-item--link":this.isClickable&&!this.inactive,"v-list-item--selectable":this.selectable,"v-list-item--three-line":this.threeLine,"v-list-item--two-line":this.twoLine,...this.themeClasses}},isClickable(){return Boolean(n.A.options.computed.isClickable.call(this)||this.listItemGroup)}},created(){this.$attrs.hasOwnProperty("avatar")&&(0,u.rq)("avatar",this)},methods:{click(t){t.detail&&this.$el.blur(),this.$emit("click",t),this.to||this.toggle()},genAttrs(){const t={"aria-disabled":!!this.disabled||void 0,tabindex:this.isClickable&&!this.disabled?0:-1,...this.$attrs};return this.$attrs.hasOwnProperty("role")||this.isInNav||(this.isInGroup?(t.role="option",t["aria-selected"]=String(this.isActive)):this.isInMenu?(t.role=this.isClickable?"menuitem":void 0,t.id=t.id||`list-item-${this._uid}`):this.isInList&&(t.role="listitem")),t},toggle(){this.to&&void 0===this.inputValue&&(this.isActive=!this.isActive),this.$emit("change")}},render(t){let{tag:e,data:i}=this.generateRouteLink();i.attrs={...i.attrs,...this.genAttrs()},i[this.to?"nativeOn":"on"]={...i[this.to?"nativeOn":"on"],keydown:t=>{this.disabled||(t.keyCode===l.uP.enter&&this.click(t),this.$emit("keydown",t))}},this.inactive&&(e="div"),this.inactive&&this.to&&(i.on=i.nativeOn,delete i.nativeOn);const s=this.$scopedSlots.default?this.$scopedSlots.default({active:this.isActive,toggle:this.toggle}):this.$slots.default;return t(e,this.isActive?this.setTextColor(this.color,i):i,s)}})},1148:function(t,e,i){var s=i(6518),n=i(2652),o=i(9306),r=i(8551),a=i(1767);s({target:"Iterator",proto:!0,real:!0},{every:function(t){r(this),o(t);var e=a(this),i=0;return!n(e,(function(e,s){if(!t(e,i++))return s()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},1181:function(t,e,i){var s,n,o,r=i(8622),a=i(4576),h=i(34),l=i(6699),u=i(9297),c=i(7629),d=i(6119),f=i(421),g="Object already initialized",p=a.TypeError,m=a.WeakMap,y=function(t){return o(t)?n(t):s(t,{})},v=function(t){return function(e){var i;if(!h(e)||(i=n(e)).type!==t)throw new p("Incompatible receiver, "+t+" required");return i}};if(r||c.state){var x=c.state||(c.state=new m);x.get=x.get,x.has=x.has,x.set=x.set,s=function(t,e){if(x.has(t))throw new p(g);return e.facade=t,x.set(t,e),e},n=function(t){return x.get(t)||{}},o=function(t){return x.has(t)}}else{var b=d("state");f[b]=!0,s=function(t,e){if(u(t,b))throw new p(g);return e.facade=t,l(t,b,e),e},n=function(t){return u(t,b)?t[b]:{}},o=function(t){return u(t,b)}}t.exports={set:s,get:n,has:o,enforce:y,getterFor:v}},1291:function(t,e,i){var s=i(741);t.exports=function(t){var e=+t;return e!==e||0===e?0:s(e)}},1325:function(t,e,i){var s=i(6960),n=i(5471);e.A=n.Ay.extend({name:"measurable",props:{height:[Number,String],maxHeight:[Number,String],maxWidth:[Number,String],minHeight:[Number,String],minWidth:[Number,String],width:[Number,String]},computed:{measurableStyles(){const t={},e=(0,s.Dg)(this.height),i=(0,s.Dg)(this.minHeight),n=(0,s.Dg)(this.minWidth),o=(0,s.Dg)(this.maxHeight),r=(0,s.Dg)(this.maxWidth),a=(0,s.Dg)(this.width);return e&&(t.height=e),i&&(t.minHeight=i),n&&(t.minWidth=n),o&&(t.maxHeight=o),r&&(t.maxWidth=r),a&&(t.width=a),t}}})},1418:function(t,e,i){i.d(e,{A:function(){return u}});i(4114),i(8111),i(3579);function s(t){if("function"!==typeof t.getRootNode){while(t.parentNode)t=t.parentNode;return t!==document?null:document}const e=t.getRootNode();return e!==document&&e.getRootNode({composed:!0})!==document?null:e}function n(){return!0}function o(t,e,i){if(!t||!1===r(t,i))return!1;const n=s(e);if("undefined"!==typeof ShadowRoot&&n instanceof ShadowRoot&&n.host===t.target)return!1;const o=("object"===typeof i.value&&i.value.include||(()=>[]))();return o.push(e),!o.some((e=>e.contains(t.target)))}function r(t,e){const i="object"===typeof e.value&&e.value.closeConditional||n;return i(t)}function a(t,e,i){const s="function"===typeof i.value?i.value:i.value.handler;e._clickOutside.lastMousedownWasOutside&&o(t,e,i)&&setTimeout((()=>{r(t,i)&&s&&s(t)}),0)}function h(t,e){const i=s(t);e(document),"undefined"!==typeof ShadowRoot&&i instanceof ShadowRoot&&e(i)}const l={inserted(t,e,i){const s=i=>a(i,t,e),n=i=>{t._clickOutside.lastMousedownWasOutside=o(i,t,e)};h(t,(t=>{t.addEventListener("click",s,!0),t.addEventListener("mousedown",n,!0)})),t._clickOutside||(t._clickOutside={lastMousedownWasOutside:!0}),t._clickOutside[i.context._uid]={onClick:s,onMousedown:n}},unbind(t,e,i){t._clickOutside&&(h(t,(e=>{var s;if(!e||!(null===(s=t._clickOutside)||void 0===s?void 0:s[i.context._uid]))return;const{onClick:n,onMousedown:o}=t._clickOutside[i.context._uid];e.removeEventListener("click",n,!0),e.removeEventListener("mousedown",o,!0)})),delete t._clickOutside[i.context._uid])}};var u=l},1526:function(t,e,i){i(4114),i(8111),i(7588),i(3579),i(125);var s=i(5471),n=i(4961),o=i(6960);const r=["sm","md","lg","xl"],a=(()=>r.reduce(((t,e)=>(t[e]={type:[Boolean,String,Number],default:!1},t)),{}))(),h=(()=>r.reduce(((t,e)=>(t["offset"+(0,o.Zb)(e)]={type:[String,Number],default:null},t)),{}))(),l=(()=>r.reduce(((t,e)=>(t["order"+(0,o.Zb)(e)]={type:[String,Number],default:null},t)),{}))(),u={col:Object.keys(a),offset:Object.keys(h),order:Object.keys(l)};function c(t,e,i){let s=t;if(null!=i&&!1!==i){if(e){const i=e.replace(t,"");s+=`-${i}`}return"col"!==t||""!==i&&!0!==i?(s+=`-${i}`,s.toLowerCase()):s.toLowerCase()}}const d=new Map;e.A=s.Ay.extend({name:"v-col",functional:!0,props:{cols:{type:[Boolean,String,Number],default:!1},...a,offset:{type:[String,Number],default:null},...h,order:{type:[String,Number],default:null},...l,alignSelf:{type:String,default:null,validator:t=>["auto","start","end","center","baseline","stretch"].includes(t)},tag:{type:String,default:"div"}},render(t,{props:e,data:i,children:s,parent:o}){let r="";for(const n in e)r+=String(e[n]);let a=d.get(r);if(!a){let t;for(t in a=[],u)u[t].forEach((i=>{const s=e[i],n=c(t,i,s);n&&a.push(n)}));const i=a.some((t=>t.startsWith("col-")));a.push({col:!i||!e.cols,[`col-${e.cols}`]:e.cols,[`offset-${e.offset}`]:e.offset,[`order-${e.order}`]:e.order,[`align-self-${e.alignSelf}`]:e.alignSelf}),d.set(r,a)}return t(e.tag,(0,n.Ay)(i,{class:a}),s)}})},1609:function(t,e,i){i.d(e,{k:function(){return s}});class s{constructor(){this.framework={}}init(t,e){}}},1625:function(t,e,i){var s=i(9504);t.exports=s({}.isPrototypeOf)},1656:function(t,e,i){function s(t,e,i,s,n,o,r,a){var h,l="function"===typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=i,l._compiled=!0),s&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),r?(h=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},l._ssrRegister=h):n&&(h=a?function(){n.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:n),h)if(l.functional){l._injectStyles=h;var u=l.render;l.render=function(t,e){return h.call(e),u(t,e)}}else{var c=l.beforeCreate;l.beforeCreate=c?[].concat(c,h):[h]}return{exports:t,options:l}}i.d(e,{A:function(){return s}})},1701:function(t,e,i){var s=i(6518),n=i(713),o=i(6395);s({target:"Iterator",proto:!0,real:!0,forced:o},{map:n})},1713:function(t,e,i){var s=i(5471);e.A=s.Ay.extend({name:"sizeable",props:{large:Boolean,small:Boolean,xLarge:Boolean,xSmall:Boolean},computed:{medium(){return Boolean(!this.xSmall&&!this.small&&!this.large&&!this.xLarge)},sizeableClasses(){return{"v-size--x-small":this.xSmall,"v-size--small":this.small,"v-size--default":this.medium,"v-size--large":this.large,"v-size--x-large":this.xLarge}}}})},1723:function(t,e,i){i.d(e,{A:function(){return P}});var s=i(6960);const n=80;function o(t,e){t.style.transform=e,t.style.webkitTransform=e}function r(t){return"TouchEvent"===t.constructor.name}function a(t){return"KeyboardEvent"===t.constructor.name}const h=(t,e,i={})=>{let s=0,n=0;if(!a(t)){const i=e.getBoundingClientRect(),o=r(t)?t.touches[t.touches.length-1]:t;s=o.clientX-i.left,n=o.clientY-i.top}let o=0,h=.3;e._ripple&&e._ripple.circle?(h=.15,o=e.clientWidth/2,o=i.center?o:o+Math.sqrt((s-o)**2+(n-o)**2)/4):o=Math.sqrt(e.clientWidth**2+e.clientHeight**2)/2;const l=(e.clientWidth-2*o)/2+"px",u=(e.clientHeight-2*o)/2+"px",c=i.center?l:s-o+"px",d=i.center?u:n-o+"px";return{radius:o,scale:h,x:c,y:d,centerX:l,centerY:u}},l={show(t,e,i={}){if(!e._ripple||!e._ripple.enabled)return;const s=document.createElement("span"),n=document.createElement("span");s.appendChild(n),s.className="v-ripple__container",i.class&&(s.className+=` ${i.class}`);const{radius:r,scale:a,x:l,y:u,centerX:c,centerY:d}=h(t,e,i),f=2*r+"px";n.className="v-ripple__animation",n.style.width=f,n.style.height=f,e.appendChild(s);const g=window.getComputedStyle(e);g&&"static"===g.position&&(e.style.position="relative",e.dataset.previousPosition="static"),n.classList.add("v-ripple__animation--enter"),n.classList.add("v-ripple__animation--visible"),o(n,`translate(${l}, ${u}) scale3d(${a},${a},${a})`),n.dataset.activated=String(performance.now()),setTimeout((()=>{n.classList.remove("v-ripple__animation--enter"),n.classList.add("v-ripple__animation--in"),o(n,`translate(${c}, ${d}) scale3d(1,1,1)`)}),0)},hide(t){if(!t||!t._ripple||!t._ripple.enabled)return;const e=t.getElementsByClassName("v-ripple__animation");if(0===e.length)return;const i=e[e.length-1];if(i.dataset.isHiding)return;i.dataset.isHiding="true";const s=performance.now()-Number(i.dataset.activated),n=Math.max(250-s,0);setTimeout((()=>{i.classList.remove("v-ripple__animation--in"),i.classList.add("v-ripple__animation--out"),setTimeout((()=>{var e;const s=t.getElementsByClassName("v-ripple__animation");1===s.length&&t.dataset.previousPosition&&(t.style.position=t.dataset.previousPosition,delete t.dataset.previousPosition),(null===(e=i.parentNode)||void 0===e?void 0:e.parentNode)===t&&t.removeChild(i.parentNode)}),300)}),n)}};function u(t){return"undefined"===typeof t||!!t}function c(t){const e={},i=t.currentTarget;if(i&&i._ripple&&!i._ripple.touched&&!t.rippleStop){if(t.rippleStop=!0,r(t))i._ripple.touched=!0,i._ripple.isTouch=!0;else if(i._ripple.isTouch)return;if(e.center=i._ripple.centered||a(t),i._ripple.class&&(e.class=i._ripple.class),r(t)){if(i._ripple.showTimerCommit)return;i._ripple.showTimerCommit=()=>{l.show(t,i,e)},i._ripple.showTimer=window.setTimeout((()=>{i&&i._ripple&&i._ripple.showTimerCommit&&(i._ripple.showTimerCommit(),i._ripple.showTimerCommit=null)}),n)}else l.show(t,i,e)}}function d(t){const e=t.currentTarget;if(e&&e._ripple){if(window.clearTimeout(e._ripple.showTimer),"touchend"===t.type&&e._ripple.showTimerCommit)return e._ripple.showTimerCommit(),e._ripple.showTimerCommit=null,void(e._ripple.showTimer=setTimeout((()=>{d(t)})));window.setTimeout((()=>{e._ripple&&(e._ripple.touched=!1)})),l.hide(e)}}function f(t){const e=t.currentTarget;e&&e._ripple&&(e._ripple.showTimerCommit&&(e._ripple.showTimerCommit=null),window.clearTimeout(e._ripple.showTimer))}let g=!1;function p(t){g||t.keyCode!==s.uP.enter&&t.keyCode!==s.uP.space||(g=!0,c(t))}function m(t){g=!1,d(t)}function y(t){!0===g&&(g=!1,d(t))}function v(t,e,i){const s=u(e.value);s||l.hide(t),t._ripple=t._ripple||{},t._ripple.enabled=s;const n=e.value||{};n.center&&(t._ripple.centered=!0),n.class&&(t._ripple.class=e.value.class),n.circle&&(t._ripple.circle=n.circle),s&&!i?(t.addEventListener("touchstart",c,{passive:!0}),t.addEventListener("touchend",d,{passive:!0}),t.addEventListener("touchmove",f,{passive:!0}),t.addEventListener("touchcancel",d),t.addEventListener("mousedown",c),t.addEventListener("mouseup",d),t.addEventListener("mouseleave",d),t.addEventListener("keydown",p),t.addEventListener("keyup",m),t.addEventListener("blur",y),t.addEventListener("dragstart",d,{passive:!0})):!s&&i&&x(t)}function x(t){t.removeEventListener("mousedown",c),t.removeEventListener("touchstart",c),t.removeEventListener("touchend",d),t.removeEventListener("touchmove",f),t.removeEventListener("touchcancel",d),t.removeEventListener("mouseup",d),t.removeEventListener("mouseleave",d),t.removeEventListener("keydown",p),t.removeEventListener("keyup",m),t.removeEventListener("dragstart",d),t.removeEventListener("blur",y)}function b(t,e,i){v(t,e,!1)}function w(t){delete t._ripple,x(t)}function k(t,e){if(e.value===e.oldValue)return;const i=u(e.oldValue);v(t,e,i)}const S={bind:b,unbind:w,update:k};var P=S},1735:function(t,e,i){i.d(e,{sw:function(){return o}});var s=i(7043),n=i(6960);const o=(0,n.Gn)("v-toolbar__title"),r=(0,n.Gn)("v-toolbar__items");s.A},1767:function(t){t.exports=function(t){return{iterator:t,next:t.next,done:!1}}},1828:function(t,e,i){var s=i(9504),n=i(9297),o=i(5397),r=i(9617).indexOf,a=i(421),h=s([].push);t.exports=function(t,e){var i,s=o(t),l=0,u=[];for(i in s)!n(a,i)&&n(s,i)&&h(u,i);while(e.length>l)n(s,i=e[l++])&&(~r(u,i)||h(u,i));return u}},1906:function(t,e,i){i.d(e,{Qo:function(){return c},SM:function(){return d},mM:function(){return l},vt:function(){return u}});var s=i(4961);function n(t=[],...e){return Array().concat(t,...e)}function o(t,e="top center 0",i){return{name:t,functional:!0,props:{group:{type:Boolean,default:!1},hideOnLeave:{type:Boolean,default:!1},leaveAbsolute:{type:Boolean,default:!1},mode:{type:String,default:i},origin:{type:String,default:e}},render(e,i){const o="transition"+(i.props.group?"-group":""),r={props:{name:t,mode:i.props.mode},on:{beforeEnter(t){t.style.transformOrigin=i.props.origin,t.style.webkitTransformOrigin=i.props.origin}}};return i.props.leaveAbsolute&&(r.on.leave=n(r.on.leave,(t=>{const{offsetTop:e,offsetLeft:i,offsetWidth:s,offsetHeight:n}=t;t._transitionInitialStyles={position:t.style.position,top:t.style.top,left:t.style.left,width:t.style.width,height:t.style.height},t.style.position="absolute",t.style.top=e+"px",t.style.left=i+"px",t.style.width=s+"px",t.style.height=n+"px"})),r.on.afterLeave=n(r.on.afterLeave,(t=>{if(t&&t._transitionInitialStyles){const{position:e,top:i,left:s,width:n,height:o}=t._transitionInitialStyles;delete t._transitionInitialStyles,t.style.position=e||"",t.style.top=i||"",t.style.left=s||"",t.style.width=n||"",t.style.height=o||""}}))),i.props.hideOnLeave&&(r.on.leave=n(r.on.leave,(t=>{t.style.setProperty("display","none","important")}))),e(o,(0,s.Ay)(i.data,r),i.children)}}}function r(t,e,i="in-out"){return{name:t,functional:!0,props:{mode:{type:String,default:i}},render(i,n){return i("transition",(0,s.Ay)(n.data,{props:{name:t},on:e}),n.children)}}}var a=i(6960);function h(t="",e=!1){const i=e?"width":"height",s=`offset${(0,a.Zb)(i)}`;return{beforeEnter(t){t._parent=t.parentNode,t._initialStyle={transition:t.style.transition,overflow:t.style.overflow,[i]:t.style[i]}},enter(e){const n=e._initialStyle;e.style.setProperty("transition","none","important"),e.style.overflow="hidden";const o=`${e[s]}px`;e.style[i]="0",e.offsetHeight,e.style.transition=n.transition,t&&e._parent&&e._parent.classList.add(t),requestAnimationFrame((()=>{e.style[i]=o}))},afterEnter:o,enterCancelled:o,leave(t){t._initialStyle={transition:"",overflow:t.style.overflow,[i]:t.style[i]},t.style.overflow="hidden",t.style[i]=`${t[s]}px`,t.offsetHeight,requestAnimationFrame((()=>t.style[i]="0"))},afterLeave:n,leaveCancelled:n};function n(e){t&&e._parent&&e._parent.classList.remove(t),o(e)}function o(t){const e=t._initialStyle[i];t.style.overflow=t._initialStyle.overflow,null!=e&&(t.style[i]=e),delete t._initialStyle}}o("carousel-transition"),o("carousel-reverse-transition"),o("tab-transition"),o("tab-reverse-transition"),o("menu-transition"),o("fab-transition","center center","out-in"),o("dialog-transition"),o("dialog-bottom-transition"),o("dialog-top-transition");const l=o("fade-transition"),u=(o("scale-transition"),o("scroll-x-transition"),o("scroll-x-reverse-transition"),o("scroll-y-transition"),o("scroll-y-reverse-transition"),o("slide-x-transition")),c=(o("slide-x-reverse-transition"),o("slide-y-transition"),o("slide-y-reverse-transition"),r("expand-transition",h())),d=r("expand-x-transition",h("",!0))},2e3:function(t,e,i){var s=i(5604),n=i(5471);e.A=n.Ay.extend().extend({name:"bootable",props:{eager:Boolean},data:()=>({isBooted:!1}),computed:{hasContent(){return this.isBooted||this.eager||this.isActive}},watch:{isActive(){this.isBooted=!0}},created(){"lazy"in this.$attrs&&(0,s.rq)("lazy",this)},methods:{showLazyContent(t){return this.hasContent&&t?t():[this.$createElement()]}}})},2106:function(t,e,i){var s=i(283),n=i(4913);t.exports=function(t,e,i){return i.get&&s(i.get,e,{getter:!0}),i.set&&s(i.set,e,{setter:!0}),n.f(t,e,i)}},2136:function(t,e,i){function s(t,e,i){const s=e.value,n=e.options||{passive:!0};window.addEventListener("resize",s,n),t._onResize=Object(t._onResize),t._onResize[i.context._uid]={callback:s,options:n},e.modifiers&&e.modifiers.quiet||s()}function n(t,e,i){var s;if(!(null===(s=t._onResize)||void 0===s?void 0:s[i.context._uid]))return;const{callback:n,options:o}=t._onResize[i.context._uid];window.removeEventListener("resize",n,o),delete t._onResize[i.context._uid]}const o={inserted:s,unbind:n};e.A=o},2140:function(t,e,i){var s=i(8227),n=s("toStringTag"),o={};o[n]="z",t.exports="[object z]"===String(o)},2195:function(t,e,i){var s=i(9504),n=s({}.toString),o=s("".slice);t.exports=function(t){return o(n(t),8,-1)}},2211:function(t,e,i){var s=i(9039);t.exports=!s((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},2360:function(t,e,i){var s,n=i(8551),o=i(6801),r=i(8727),a=i(421),h=i(397),l=i(4055),u=i(6119),c=">",d="<",f="prototype",g="script",p=u("IE_PROTO"),m=function(){},y=function(t){return d+g+c+t+d+"/"+g+c},v=function(t){t.write(y("")),t.close();var e=t.parentWindow.Object;return t=null,e},x=function(){var t,e=l("iframe"),i="java"+g+":";return e.style.display="none",h.appendChild(e),e.src=String(i),t=e.contentWindow.document,t.open(),t.write(y("document.F=Object")),t.close(),t.F},b=function(){try{s=new ActiveXObject("htmlfile")}catch(e){}b="undefined"!=typeof document?document.domain&&s?v(s):x():v(s);var t=r.length;while(t--)delete b[f][r[t]];return b()};a[p]=!0,t.exports=Object.create||function(t,e){var i;return null!==t?(m[f]=n(t),i=new m,m[f]=null,i[p]=t):i=b(),void 0===e?i:o.f(i,e)}},2489:function(t,e,i){var s=i(6518),n=i(9565),o=i(9306),r=i(8551),a=i(1767),h=i(9462),l=i(6319),u=i(6395),c=h((function(){var t,e,i,s=this.iterator,o=this.predicate,a=this.next;while(1){if(t=r(n(a,s)),e=this.done=!!t.done,e)return;if(i=t.value,l(s,o,[i,this.counter++],!0))return i}}));s({target:"Iterator",proto:!0,real:!0,forced:u},{filter:function(t){return r(this),o(t),new c(a(this),{predicate:t})}})},2529:function(t){t.exports=function(t,e){return{value:t,done:e}}},2652:function(t,e,i){var s=i(6080),n=i(9565),o=i(8551),r=i(6823),a=i(4209),h=i(6198),l=i(1625),u=i(81),c=i(851),d=i(9539),f=TypeError,g=function(t,e){this.stopped=t,this.result=e},p=g.prototype;t.exports=function(t,e,i){var m,y,v,x,b,w,k,S=i&&i.that,P=!(!i||!i.AS_ENTRIES),M=!(!i||!i.IS_RECORD),C=!(!i||!i.IS_ITERATOR),A=!(!i||!i.INTERRUPTED),N=s(e,S),L=function(t){return m&&d(m,"normal",t),new g(!0,t)},T=function(t){return P?(o(t),A?N(t[0],t[1],L):N(t[0],t[1])):A?N(t,L):N(t)};if(M)m=t.iterator;else if(C)m=t;else{if(y=c(t),!y)throw new f(r(t)+" is not iterable");if(a(y)){for(v=0,x=h(t);x>v;v++)if(b=T(t[v]),b&&l(p,b))return b;return new g(!1)}m=u(t,y)}w=M?t.next:m.next;while(!(k=n(w,m)).done){try{b=T(k.value)}catch(D){d(m,"throw",D)}if("object"==typeof b&&b&&l(p,b))return b}return new g(!1)}},2777:function(t,e,i){var s=i(9565),n=i(34),o=i(757),r=i(5966),a=i(4270),h=i(8227),l=TypeError,u=h("toPrimitive");t.exports=function(t,e){if(!n(t)||o(t))return t;var i,h=r(t,u);if(h){if(void 0===e&&(e="default"),i=s(h,t,e),!n(i)||o(i))return i;throw new l("Can't convert object to primitive value")}return void 0===e&&(e="number"),a(t,e)}},2787:function(t,e,i){var s=i(9297),n=i(4901),o=i(8981),r=i(6119),a=i(2211),h=r("IE_PROTO"),l=Object,u=l.prototype;t.exports=a?l.getPrototypeOf:function(t){var e=o(t);if(s(e,h))return e[h];var i=e.constructor;return n(i)&&e instanceof i?i.prototype:e instanceof l?u:null}},2796:function(t,e,i){var s=i(9039),n=i(4901),o=/#|\.prototype\./,r=function(t,e){var i=h[a(t)];return i===u||i!==l&&(n(e)?s(e):!!e)},a=r.normalize=function(t){return String(t).replace(o,".").toLowerCase()},h=r.data={},l=r.NATIVE="N",u=r.POLYFILL="P";t.exports=r},2839:function(t,e,i){var s=i(4576),n=s.navigator,o=n&&n.userAgent;t.exports=o?String(o):""},2987:function(t,e,i){i.d(e,{A:function(){return n}});i(4114);var s=i(3858),n=s.A.extend().extend({name:"v-list",provide(){return{isInList:!0,list:this}},inject:{isInMenu:{default:!1},isInNav:{default:!1}},props:{dense:Boolean,disabled:Boolean,expand:Boolean,flat:Boolean,nav:Boolean,rounded:Boolean,subheader:Boolean,threeLine:Boolean,twoLine:Boolean},data:()=>({groups:[]}),computed:{classes(){return{...s.A.options.computed.classes.call(this),"v-list--dense":this.dense,"v-list--disabled":this.disabled,"v-list--flat":this.flat,"v-list--nav":this.nav,"v-list--rounded":this.rounded,"v-list--subheader":this.subheader,"v-list--two-line":this.twoLine,"v-list--three-line":this.threeLine}}},methods:{register(t){this.groups.push(t)},unregister(t){const e=this.groups.findIndex((e=>e._uid===t._uid));e>-1&&this.groups.splice(e,1)},listClick(t){if(!this.expand)for(const e of this.groups)e.toggle(t)}},render(t){const e={staticClass:"v-list",class:this.classes,style:this.styles,attrs:{role:this.isInNav||this.isInMenu?void 0:"list",...this.attrs$}};return t(this.tag,this.setBackgroundColor(this.color,e),[this.$slots.default])}})},3392:function(t,e,i){var s=i(9504),n=0,o=Math.random(),r=s(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+r(++n+o,36)}},3507:function(t,e,i){i.d(e,{A:function(){return n}});var s=i(5471);function n(...t){return s.Ay.extend({mixins:t})}},3579:function(t,e,i){var s=i(6518),n=i(2652),o=i(9306),r=i(8551),a=i(1767);s({target:"Iterator",proto:!0,real:!0},{some:function(t){r(this),o(t);var e=a(this),i=0;return n(e,(function(e,s){if(t(e,i++))return s()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},3661:function(t,e,i){var s=i(5471);const n=s.Ay.extend().extend({name:"themeable",provide(){return{theme:this.themeableProvide}},inject:{theme:{default:{isDark:!1}}},props:{dark:{type:Boolean,default:null},light:{type:Boolean,default:null}},data(){return{themeableProvide:{isDark:!1}}},computed:{appIsDark(){return this.$vuetify.theme.dark||!1},isDark(){return!0===this.dark||!0!==this.light&&this.theme.isDark},themeClasses(){return{"theme--dark":this.isDark,"theme--light":!this.isDark}},rootIsDark(){return!0===this.dark||!0!==this.light&&this.appIsDark},rootThemeClasses(){return{"theme--dark":this.rootIsDark,"theme--light":!this.rootIsDark}}},watch:{isDark:{handler(t,e){t!==e&&(this.themeableProvide.isDark=this.isDark)},immediate:!0}}});e.A=n},3706:function(t,e,i){var s=i(9504),n=i(4901),o=i(7629),r=s(Function.toString);n(o.inspectSource)||(o.inspectSource=function(t){return r(t)}),t.exports=o.inspectSource},3717:function(t,e){e.f=Object.getOwnPropertySymbols},3724:function(t,e,i){var s=i(9039);t.exports=!s((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},3805:function(t,e,i){i.d(e,{E8:function(){return o},VP:function(){return n},si:function(){return a},y6:function(){return r}});i(8111),i(1701);var s=i(5604);function n(t){return!!t&&!!t.match(/^(#|var\(--|(rgb|hsl)a?\()/)}function o(t){let e;if("number"===typeof t)e=t;else{if("string"!==typeof t)throw new TypeError(`Colors can only be numbers or strings, recieved ${null==t?t:t.constructor.name} instead`);{let i="#"===t[0]?t.substring(1):t;3===i.length&&(i=i.split("").map((t=>t+t)).join("")),6!==i.length&&(0,s.OP)(`'${t}' is not a valid rgb color`),e=parseInt(i,16)}}return e<0?((0,s.OP)(`Colors cannot be negative: '${t}'`),e=0):(e>16777215||isNaN(e))&&((0,s.OP)(`'${t}' is not a valid rgb color`),e=16777215),e}function r(t){let e=t.toString(16);return e.length<6&&(e="0".repeat(6-e.length)+e),"#"+e}function a(t){return r(o(t))}},3858:function(t,e,i){i.d(e,{A:function(){return u}});var s=i(4765),n=i(8767),o=i(5083),r=i(1325),a=i(6256),h=i(3661),l=i(3507),u=(0,l.A)(s.A,n.A,o.A,r.A,a.A,h.A).extend({name:"v-sheet",props:{outlined:Boolean,shaped:Boolean,tag:{type:String,default:"div"}},computed:{classes(){return{"v-sheet":!0,"v-sheet--outlined":this.outlined,"v-sheet--shaped":this.shaped,...this.themeClasses,...this.elevationClasses,...this.roundedClasses}},styles(){return this.measurableStyles}},render(t){const e={class:this.classes,style:this.styles,on:this.listeners$};return t(this.tag,this.setBackgroundColor(this.color,e),this.$slots.default)}})},3882:function(t,e,i){i.d(e,{A:function(){return f}});i(4114),i(8111),i(2489);var s=i(3507),n=i(1906),o=i(7889),r=i(8767),a=i(4387),h=i(3661),l=i(9748),u=i(8010),c=i(1713),d=i(5604),f=(0,s.A)(r.A,c.A,u.A,h.A,(0,a.P)("chipGroup"),(0,l.P)("inputValue")).extend({name:"v-chip",props:{active:{type:Boolean,default:!0},activeClass:{type:String,default(){return this.chipGroup?this.chipGroup.activeClass:""}},close:Boolean,closeIcon:{type:String,default:"$delete"},closeLabel:{type:String,default:"$vuetify.close"},disabled:Boolean,draggable:Boolean,filter:Boolean,filterIcon:{type:String,default:"$complete"},label:Boolean,link:Boolean,outlined:Boolean,pill:Boolean,tag:{type:String,default:"span"},textColor:String,value:null},data:()=>({proxyClass:"v-chip--active"}),computed:{classes(){return{"v-chip":!0,...u.A.options.computed.classes.call(this),"v-chip--clickable":this.isClickable,"v-chip--disabled":this.disabled,"v-chip--draggable":this.draggable,"v-chip--label":this.label,"v-chip--link":this.isLink,"v-chip--no-color":!this.color,"v-chip--outlined":this.outlined,"v-chip--pill":this.pill,"v-chip--removable":this.hasClose,...this.themeClasses,...this.sizeableClasses,...this.groupClasses}},hasClose(){return Boolean(this.close)},isClickable(){return Boolean(u.A.options.computed.isClickable.call(this)||this.chipGroup)}},created(){const t=[["outline","outlined"],["selected","input-value"],["value","active"],["@input","@active.sync"]];t.forEach((([t,e])=>{this.$attrs.hasOwnProperty(t)&&(0,d.q4)(t,e,this)}))},methods:{click(t){this.$emit("click",t),this.chipGroup&&this.toggle()},genFilter(){const t=[];return this.isActive&&t.push(this.$createElement(o.A,{staticClass:"v-chip__filter",props:{left:!0}},this.filterIcon)),this.$createElement(n.SM,t)},genClose(){return this.$createElement(o.A,{staticClass:"v-chip__close",props:{right:!0,size:18},attrs:{"aria-label":this.$vuetify.lang.t(this.closeLabel)},on:{click:t=>{t.stopPropagation(),t.preventDefault(),this.$emit("click:close"),this.$emit("update:active",!1)}}},this.closeIcon)},genContent(){return this.$createElement("span",{staticClass:"v-chip__content"},[this.filter&&this.genFilter(),this.$slots.default,this.hasClose&&this.genClose()])}},render(t){const e=[this.genContent()];let{tag:i,data:s}=this.generateRouteLink();s.attrs={...s.attrs,draggable:this.draggable?"true":void 0,tabindex:this.chipGroup&&!this.disabled?0:s.attrs.tabindex},s.directives.push({name:"show",value:this.active}),s=this.setBackgroundColor(this.color,s);const n=this.textColor||this.outlined&&this.color;return t(i,this.setTextColor(n,s),e)}})},3916:function(t,e,i){i.d(e,{A:function(){return N}});i(4114),i(8111),i(116);var s=i(3661),n=s.A.extend({name:"v-theme-provider",props:{root:Boolean},computed:{isDark(){return this.root?this.rootIsDark:s.A.options.computed.isDark.call(this)}},render(){return this.$slots.default&&this.$slots.default.find((t=>!t.isComment&&" "!==t.text))}}),o=(i(3579),i(5471)),r=o.Ay.extend().extend({name:"delayable",props:{openDelay:{type:[Number,String],default:0},closeDelay:{type:[Number,String],default:0}},data:()=>({openTimeout:void 0,closeTimeout:void 0}),methods:{clearDelay(){clearTimeout(this.openTimeout),clearTimeout(this.closeTimeout)},runDelay(t,e){this.clearDelay();const i=parseInt(this[`${t}Delay`],10);this[`${t}Timeout`]=setTimeout(e||(()=>{this.isActive={open:!0,close:!1}[t]}),i)}}}),a=i(9748),h=i(3507),l=i(6960),u=i(5604);const c=(0,h.A)(r,a.A);var d=c.extend({name:"activatable",props:{activator:{default:null,validator:t=>["string","object"].includes(typeof t)},disabled:Boolean,internalActivator:Boolean,openOnClick:{type:Boolean,default:!0},openOnHover:Boolean,openOnFocus:Boolean},data:()=>({activatorElement:null,activatorNode:[],events:["click","mouseenter","mouseleave","focus"],listeners:{}}),watch:{activator:"resetActivator",openOnFocus:"resetActivator",openOnHover:"resetActivator"},mounted(){const t=(0,l.fo)(this,"activator",!0);t&&["v-slot","normal"].includes(t)&&(0,u.yA)('The activator slot must be bound, try \'<template v-slot:activator="{ on }"><v-btn v-on="on">\'',this),this.addActivatorEvents()},beforeDestroy(){this.removeActivatorEvents()},methods:{addActivatorEvents(){if(!this.activator||this.disabled||!this.getActivator())return;this.listeners=this.genActivatorListeners();const t=Object.keys(this.listeners);for(const e of t)this.getActivator().addEventListener(e,this.listeners[e])},genActivator(){const t=(0,l.$c)(this,"activator",Object.assign(this.getValueProxy(),{on:this.genActivatorListeners(),attrs:this.genActivatorAttributes()}))||[];return this.activatorNode=t,t},genActivatorAttributes(){return{role:this.openOnClick&&!this.openOnHover?"button":void 0,"aria-haspopup":!0,"aria-expanded":String(this.isActive)}},genActivatorListeners(){if(this.disabled)return{};const t={};return this.openOnHover?(t.mouseenter=t=>{this.getActivator(t),this.runDelay("open")},t.mouseleave=t=>{this.getActivator(t),this.runDelay("close")}):this.openOnClick&&(t.click=t=>{const e=this.getActivator(t);e&&e.focus(),t.stopPropagation(),this.isActive=!this.isActive}),this.openOnFocus&&(t.focus=t=>{this.getActivator(t),t.stopPropagation(),this.isActive=!this.isActive}),t},getActivator(t){if(this.activatorElement)return this.activatorElement;let e=null;if(this.activator){const t=this.internalActivator?this.$el:document;e="string"===typeof this.activator?t.querySelector(this.activator):this.activator.$el?this.activator.$el:this.activator}else if(1===this.activatorNode.length||this.activatorNode.length&&!t){const t=this.activatorNode[0].componentInstance;e=t&&t.$options.mixins&&t.$options.mixins.some((t=>t.options&&["activatable","menuable"].includes(t.options.name)))?t.getActivator():this.activatorNode[0].elm}else t&&(e=t.currentTarget||t.target);return this.activatorElement=(null===e||void 0===e?void 0:e.nodeType)===Node.ELEMENT_NODE?e:null,this.activatorElement},getContentSlot(){return(0,l.$c)(this,"default",this.getValueProxy(),!0)},getValueProxy(){const t=this;return{get value(){return t.isActive},set value(e){t.isActive=e}}},removeActivatorEvents(){if(!this.activator||!this.activatorElement)return;const t=Object.keys(this.listeners);for(const e of t)this.activatorElement.removeEventListener(e,this.listeners[e]);this.listeners={}},resetActivator(){this.removeActivatorEvents(),this.activatorElement=null,this.getActivator(),this.addActivatorEvents()}}}),f=i(9623),g=o.Ay.extend().extend({name:"stackable",data(){return{stackElement:null,stackExclude:null,stackMinZIndex:0,isActive:!1}},computed:{activeZIndex(){if("undefined"===typeof window)return 0;const t=this.stackElement||this.$refs.content,e=this.isActive?this.getMaxZIndex(this.stackExclude||[t])+2:(0,l.fl)(t);return null==e?e:parseInt(e)}},methods:{getMaxZIndex(t=[]){const e=this.$el,i=[this.stackMinZIndex,(0,l.fl)(e)],s=[...document.getElementsByClassName("v-menu__content--active"),...document.getElementsByClassName("v-dialog__content--active")];for(let n=0;n<s.length;n++)t.includes(s[n])||i.push((0,l.fl)(s[n]));return Math.max(...i)}}}),p=i(9923),m=(i(7588),i(2e3));function y(t){const e=typeof t;return"boolean"===e||"string"===e||t.nodeType===Node.ELEMENT_NODE}function v(t){t.forEach((t=>{t.elm&&t.elm.parentNode&&t.elm.parentNode.removeChild(t.elm)}))}var x=(0,h.A)(m.A).extend({name:"detachable",props:{attach:{default:!1,validator:y},contentClass:{type:String,default:""}},data:()=>({activatorNode:null,hasDetached:!1}),watch:{attach(){this.hasDetached=!1,this.initDetach()},hasContent(){this.$nextTick(this.initDetach)}},beforeMount(){this.$nextTick((()=>{if(this.activatorNode){const t=Array.isArray(this.activatorNode)?this.activatorNode:[this.activatorNode];t.forEach((t=>{if(!t.elm)return;if(!this.$el.parentNode)return;const e=this.$el===this.$el.parentNode.firstChild?this.$el:this.$el.nextSibling;this.$el.parentNode.insertBefore(t.elm,e)}))}}))},mounted(){this.hasContent&&this.initDetach()},deactivated(){this.isActive=!1},beforeDestroy(){this.$refs.content&&this.$refs.content.parentNode&&this.$refs.content.parentNode.removeChild(this.$refs.content)},destroyed(){if(this.activatorNode){const t=Array.isArray(this.activatorNode)?this.activatorNode:[this.activatorNode];if(this.$el.isConnected){const e=new MutationObserver((i=>{i.some((t=>Array.from(t.removedNodes).includes(this.$el)))&&(e.disconnect(),v(t))}));e.observe(this.$el.parentNode,{subtree:!1,childList:!0})}else v(t)}},methods:{getScopeIdAttrs(){const t=(0,l.no)(this.$vnode,"context.$options._scopeId");return t&&{[t]:""}},initDetach(){if(this._isDestroyed||!this.$refs.content||this.hasDetached||""===this.attach||!0===this.attach||"attach"===this.attach)return;let t;t=!1===this.attach?document.querySelector("[data-app]"):"string"===typeof this.attach?document.querySelector(this.attach):this.attach,t?(t.appendChild(this.$refs.content),this.hasDetached=!0):(0,u.OP)(`Unable to locate target ${this.attach||"[data-app]"}`,this)}}});const b=(0,h.A)(g,(0,p.P)(["top","right","bottom","left","absolute"]),d,x);var w=b.extend().extend({name:"menuable",props:{allowOverflow:Boolean,light:Boolean,dark:Boolean,maxWidth:{type:[Number,String],default:"auto"},minWidth:[Number,String],nudgeBottom:{type:[Number,String],default:0},nudgeLeft:{type:[Number,String],default:0},nudgeRight:{type:[Number,String],default:0},nudgeTop:{type:[Number,String],default:0},nudgeWidth:{type:[Number,String],default:0},offsetOverflow:Boolean,positionX:{type:Number,default:null},positionY:{type:Number,default:null},zIndex:{type:[Number,String],default:null}},data:()=>({activatorNode:[],absoluteX:0,absoluteY:0,activatedBy:null,activatorFixed:!1,dimensions:{activator:{top:0,left:0,bottom:0,right:0,width:0,height:0,offsetTop:0,scrollHeight:0,offsetLeft:0},content:{top:0,left:0,bottom:0,right:0,width:0,height:0,offsetTop:0,scrollHeight:0}},relativeYOffset:0,hasJustFocused:!1,hasWindow:!1,inputActivator:!1,isContentActive:!1,pageWidth:0,pageYOffset:0,stackClass:"v-menu__content--active",stackMinZIndex:6}),computed:{computedLeft(){const t=this.dimensions.activator,e=this.dimensions.content,i=(!1!==this.attach?t.offsetLeft:t.left)||0,s=Math.max(t.width,e.width);let n=0;if(n+=i,(this.left||this.$vuetify.rtl&&!this.right)&&(n-=s-t.width),this.offsetX){const e=isNaN(Number(this.maxWidth))?t.width:Math.min(t.width,Number(this.maxWidth));n+=this.left?-e:t.width}return this.nudgeLeft&&(n-=parseInt(this.nudgeLeft)),this.nudgeRight&&(n+=parseInt(this.nudgeRight)),n},computedTop(){const t=this.dimensions.activator,e=this.dimensions.content;let i=0;return this.top&&(i+=t.height-e.height),!1!==this.attach?i+=t.offsetTop:i+=t.top+this.pageYOffset,this.offsetY&&(i+=this.top?-t.height:t.height),this.nudgeTop&&(i-=parseInt(this.nudgeTop)),this.nudgeBottom&&(i+=parseInt(this.nudgeBottom)),i},hasActivator(){return!!this.$slots.activator||!!this.$scopedSlots.activator||!!this.activator||!!this.inputActivator},absoluteYOffset(){return this.pageYOffset-this.relativeYOffset}},watch:{disabled(t){t&&this.callDeactivate()},isActive(t){this.disabled||(t?this.callActivate():this.callDeactivate())},positionX:"updateDimensions",positionY:"updateDimensions"},beforeMount(){this.hasWindow="undefined"!==typeof window,this.hasWindow&&window.addEventListener("resize",this.updateDimensions,!1)},beforeDestroy(){this.hasWindow&&window.removeEventListener("resize",this.updateDimensions,!1)},methods:{absolutePosition(){return{offsetTop:this.positionY||this.absoluteY,offsetLeft:this.positionX||this.absoluteX,scrollHeight:0,top:this.positionY||this.absoluteY,bottom:this.positionY||this.absoluteY,left:this.positionX||this.absoluteX,right:this.positionX||this.absoluteX,height:0,width:0}},activate(){},calcLeft(t){return(0,l.Dg)(!1!==this.attach?this.computedLeft:this.calcXOverflow(this.computedLeft,t))},calcTop(){return(0,l.Dg)(!1!==this.attach?this.computedTop:this.calcYOverflow(this.computedTop))},calcXOverflow(t,e){const i=t+e-this.pageWidth+12;return t=(!this.left||this.right)&&i>0?Math.max(t-i,0):Math.max(t,12),t+this.getOffsetLeft()},calcYOverflow(t){const e=this.getInnerHeight(),i=this.absoluteYOffset+e,s=this.dimensions.activator,n=this.dimensions.content.height,o=t+n,r=i<o;return r&&this.offsetOverflow&&s.top>n?t=this.pageYOffset+(s.top-n):r&&!this.allowOverflow?t=i-n-12:t<this.absoluteYOffset&&!this.allowOverflow&&(t=this.absoluteYOffset+12),t<12?12:t},callActivate(){this.hasWindow&&this.activate()},callDeactivate(){this.isContentActive=!1,this.deactivate()},checkForPageYOffset(){this.hasWindow&&(this.pageYOffset=this.activatorFixed?0:this.getOffsetTop())},checkActivatorFixed(){if(!1!==this.attach)return void(this.activatorFixed=!1);let t=this.getActivator();while(t){if("fixed"===window.getComputedStyle(t).position)return void(this.activatorFixed=!0);t=t.offsetParent}this.activatorFixed=!1},deactivate(){},genActivatorListeners(){const t=d.options.methods.genActivatorListeners.call(this),e=t.click;return e&&(t.click=t=>{this.openOnClick&&e&&e(t),this.absoluteX=t.clientX,this.absoluteY=t.clientY}),t},getInnerHeight(){return this.hasWindow?window.innerHeight||document.documentElement.clientHeight:0},getOffsetLeft(){return this.hasWindow?window.pageXOffset||document.documentElement.scrollLeft:0},getOffsetTop(){return this.hasWindow?window.pageYOffset||document.documentElement.scrollTop:0},getRoundedBoundedClientRect(t){const e=t.getBoundingClientRect();return{top:Math.round(e.top),left:Math.round(e.left),bottom:Math.round(e.bottom),right:Math.round(e.right),width:Math.round(e.width),height:Math.round(e.height)}},measure(t){if(!t||!this.hasWindow)return null;const e=this.getRoundedBoundedClientRect(t);if(!1!==this.attach){const i=window.getComputedStyle(t);e.left=parseInt(i.marginLeft),e.top=parseInt(i.marginTop)}return e},sneakPeek(t){requestAnimationFrame((()=>{const e=this.$refs.content;e&&"none"===e.style.display?(e.style.display="inline-block",t(),e.style.display="none"):t()}))},startTransition(){return new Promise((t=>requestAnimationFrame((()=>{this.isContentActive=this.hasJustFocused=this.isActive,t()}))))},updateDimensions(){this.hasWindow="undefined"!==typeof window,this.checkActivatorFixed(),this.checkForPageYOffset(),this.pageWidth=document.documentElement.clientWidth;const t={activator:{...this.dimensions.activator},content:{...this.dimensions.content}};if(!this.hasActivator||this.absolute)t.activator=this.absolutePosition();else{const e=this.getActivator();if(!e)return;t.activator=this.measure(e),t.activator.offsetLeft=e.offsetLeft,!1!==this.attach?t.activator.offsetTop=e.offsetTop:t.activator.offsetTop=0}this.sneakPeek((()=>{if(this.$refs.content){if(this.$refs.content.offsetParent){const e=this.getRoundedBoundedClientRect(this.$refs.content.offsetParent);this.relativeYOffset=window.pageYOffset+e.top,t.activator.top-=this.relativeYOffset,t.activator.left-=window.pageXOffset+e.left}t.content=this.measure(this.$refs.content)}this.dimensions=t}))}}}),k=o.Ay.extend({name:"returnable",props:{returnValue:null},data:()=>({isActive:!1,originalValue:null}),watch:{isActive(t){t?this.originalValue=this.returnValue:this.$emit("update:return-value",this.originalValue)}},methods:{save(t){this.originalValue=t,setTimeout((()=>{this.isActive=!1}))}}}),S=i(6256),P=i(1418),M=i(2136),C=i(9683);const A=(0,h.A)(f.A,r,k,S.A,s.A,w);var N=A.extend({name:"v-menu",directives:{ClickOutside:P.A,Resize:M.A},provide(){return{isInMenu:!0,theme:this.theme}},props:{auto:Boolean,closeOnClick:{type:Boolean,default:!0},closeOnContentClick:{type:Boolean,default:!0},disabled:Boolean,disableKeys:Boolean,maxHeight:{type:[Number,String],default:"auto"},offsetX:Boolean,offsetY:Boolean,openOnHover:Boolean,origin:{type:String,default:"top left"},transition:{type:[Boolean,String],default:"v-menu-transition"}},data(){return{calculatedTopAuto:0,defaultOffset:8,hasJustFocused:!1,listIndex:-1,resizeTimeout:0,selectedIndex:null,tiles:[]}},computed:{activeTile(){return this.tiles[this.listIndex]},calculatedLeft(){const t=Math.max(this.dimensions.content.width,parseFloat(this.calculatedMinWidth));return this.auto?(0,l.Dg)(this.calcXOverflow(this.calcLeftAuto(),t))||"0":this.calcLeft(t)||"0"},calculatedMaxHeight(){const t=this.auto?"200px":(0,l.Dg)(this.maxHeight);return t||"0"},calculatedMaxWidth(){return(0,l.Dg)(this.maxWidth)||"0"},calculatedMinWidth(){if(this.minWidth)return(0,l.Dg)(this.minWidth)||"0";const t=Math.min(this.dimensions.activator.width+Number(this.nudgeWidth)+(this.auto?16:0),Math.max(this.pageWidth-24,0)),e=isNaN(parseInt(this.calculatedMaxWidth))?t:parseInt(this.calculatedMaxWidth);return(0,l.Dg)(Math.min(e,t))||"0"},calculatedTop(){const t=this.auto?(0,l.Dg)(this.calcYOverflow(this.calculatedTopAuto)):this.calcTop();return t||"0"},hasClickableTiles(){return Boolean(this.tiles.find((t=>t.tabIndex>-1)))},styles(){return{maxHeight:this.calculatedMaxHeight,minWidth:this.calculatedMinWidth,maxWidth:this.calculatedMaxWidth,top:this.calculatedTop,left:this.calculatedLeft,transformOrigin:this.origin,zIndex:this.zIndex||this.activeZIndex}}},watch:{isActive(t){t||(this.listIndex=-1)},isContentActive(t){this.hasJustFocused=t},listIndex(t,e){if(t in this.tiles){const e=this.tiles[t];e.classList.add("v-list-item--highlighted");const i=this.$refs.content.scrollTop,s=this.$refs.content.clientHeight;i>e.offsetTop-8?(0,C.A)(e.offsetTop-e.clientHeight,{appOffset:!1,duration:300,container:this.$refs.content}):i+s<e.offsetTop+e.clientHeight+8&&(0,C.A)(e.offsetTop-s+2*e.clientHeight,{appOffset:!1,duration:300,container:this.$refs.content})}e in this.tiles&&this.tiles[e].classList.remove("v-list-item--highlighted")}},created(){this.$attrs.hasOwnProperty("full-width")&&(0,u.rq)("full-width",this)},mounted(){this.isActive&&this.callActivate()},methods:{activate(){this.updateDimensions(),requestAnimationFrame((()=>{this.startTransition().then((()=>{this.$refs.content&&(this.calculatedTopAuto=this.calcTopAuto(),this.auto&&(this.$refs.content.scrollTop=this.calcScrollPosition()))}))}))},calcScrollPosition(){const t=this.$refs.content,e=t.querySelector(".v-list-item--active"),i=t.scrollHeight-t.offsetHeight;return e?Math.min(i,Math.max(0,e.offsetTop-t.offsetHeight/2+e.offsetHeight/2)):t.scrollTop},calcLeftAuto(){return parseInt(this.dimensions.activator.left-2*this.defaultOffset)},calcTopAuto(){const t=this.$refs.content,e=t.querySelector(".v-list-item--active");if(e||(this.selectedIndex=null),this.offsetY||!e)return this.computedTop;this.selectedIndex=Array.from(this.tiles).indexOf(e);const i=e.offsetTop-this.calcScrollPosition(),s=t.querySelector(".v-list-item").offsetTop;return this.computedTop-i-s-1},changeListIndex(t){if(this.getTiles(),this.isActive&&this.hasClickableTiles)if(t.keyCode!==l.uP.tab){if(t.keyCode===l.uP.down)this.nextTile();else if(t.keyCode===l.uP.up)this.prevTile();else if(t.keyCode===l.uP.end)this.lastTile();else if(t.keyCode===l.uP.home)this.firstTile();else{if(t.keyCode!==l.uP.enter||-1===this.listIndex)return;this.tiles[this.listIndex].click()}t.preventDefault()}else this.isActive=!1},closeConditional(t){const e=t.target;return this.isActive&&!this._isDestroyed&&this.closeOnClick&&!this.$refs.content.contains(e)},genActivatorAttributes(){const t=d.options.methods.genActivatorAttributes.call(this);return this.activeTile&&this.activeTile.id?{...t,"aria-activedescendant":this.activeTile.id}:t},genActivatorListeners(){const t=w.options.methods.genActivatorListeners.call(this);return this.disableKeys||(t.keydown=this.onKeyDown),t},genTransition(){const t=this.genContent();return this.transition?this.$createElement("transition",{props:{name:this.transition}},[t]):t},genDirectives(){const t=[{name:"show",value:this.isContentActive}];return!this.openOnHover&&this.closeOnClick&&t.push({name:"click-outside",value:{handler:()=>{this.isActive=!1},closeConditional:this.closeConditional,include:()=>[this.$el,...this.getOpenDependentElements()]}}),t},genContent(){const t={attrs:{...this.getScopeIdAttrs(),role:"role"in this.$attrs?this.$attrs.role:"menu"},staticClass:"v-menu__content",class:{...this.rootThemeClasses,...this.roundedClasses,"v-menu__content--auto":this.auto,"v-menu__content--fixed":this.activatorFixed,menuable__content__active:this.isActive,[this.contentClass.trim()]:!0},style:this.styles,directives:this.genDirectives(),ref:"content",on:{click:t=>{const e=t.target;e.getAttribute("disabled")||this.closeOnContentClick&&(this.isActive=!1)},keydown:this.onKeyDown}};return this.$listeners.scroll&&(t.on=t.on||{},t.on.scroll=this.$listeners.scroll),!this.disabled&&this.openOnHover&&(t.on=t.on||{},t.on.mouseenter=this.mouseEnterHandler),this.openOnHover&&(t.on=t.on||{},t.on.mouseleave=this.mouseLeaveHandler),this.$createElement("div",t,this.getContentSlot())},getTiles(){this.$refs.content&&(this.tiles=Array.from(this.$refs.content.querySelectorAll(".v-list-item, .v-divider, .v-subheader")))},mouseEnterHandler(){this.runDelay("open",(()=>{this.hasJustFocused||(this.hasJustFocused=!0)}))},mouseLeaveHandler(t){this.runDelay("close",(()=>{var e;(null===(e=this.$refs.content)||void 0===e?void 0:e.contains(t.relatedTarget))||requestAnimationFrame((()=>{this.isActive=!1,this.callDeactivate()}))}))},nextTile(){const t=this.tiles[this.listIndex+1];if(!t){if(!this.tiles.length)return;return this.listIndex=-1,void this.nextTile()}this.listIndex++,-1===t.tabIndex&&this.nextTile()},prevTile(){const t=this.tiles[this.listIndex-1];if(!t){if(!this.tiles.length)return;return this.listIndex=this.tiles.length,void this.prevTile()}this.listIndex--,-1===t.tabIndex&&this.prevTile()},lastTile(){const t=this.tiles[this.tiles.length-1];t&&(this.listIndex=this.tiles.length-1,-1===t.tabIndex&&this.prevTile())},firstTile(){const t=this.tiles[0];t&&(this.listIndex=0,-1===t.tabIndex&&this.nextTile())},onKeyDown(t){if(t.keyCode===l.uP.esc){setTimeout((()=>{this.isActive=!1}));const t=this.getActivator();this.$nextTick((()=>t&&t.focus()))}else!this.isActive&&[l.uP.up,l.uP.down].includes(t.keyCode)&&(this.isActive=!0);this.$nextTick((()=>this.changeListIndex(t)))},onResize(){this.isActive&&(this.$refs.content.offsetWidth,this.updateDimensions(),clearTimeout(this.resizeTimeout),this.resizeTimeout=window.setTimeout(this.updateDimensions,100))}},render(t){const e={staticClass:"v-menu",class:{"v-menu--attached":""===this.attach||!0===this.attach||"attach"===this.attach},directives:[{arg:"500",name:"resize",value:this.onResize}]};return t("div",e,[!this.activator&&this.genActivator(),this.showLazyContent((()=>[this.$createElement(n,{props:{root:!0,light:this.light,dark:this.dark}},[this.genTransition()])]))])}})},4055:function(t,e,i){var s=i(4576),n=i(34),o=s.document,r=n(o)&&n(o.createElement);t.exports=function(t){return r?o.createElement(t):{}}},4114:function(t,e,i){var s=i(6518),n=i(8981),o=i(6198),r=i(4527),a=i(6837),h=i(9039),l=h((function(){return 4294967297!==[].push.call({length:4294967296},1)})),u=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},c=l||!u();s({target:"Array",proto:!0,arity:1,forced:c},{push:function(t){var e=n(this),i=o(e),s=arguments.length;a(i+s);for(var h=0;h<s;h++)e[i]=arguments[h],i++;return r(e,i),i}})},4117:function(t){t.exports=function(t){return null===t||void 0===t}},4209:function(t,e,i){var s=i(8227),n=i(6269),o=s("iterator"),r=Array.prototype;t.exports=function(t){return void 0!==t&&(n.Array===t||r[o]===t)}},4270:function(t,e,i){var s=i(9565),n=i(4901),o=i(34),r=TypeError;t.exports=function(t,e){var i,a;if("string"===e&&n(i=t.toString)&&!o(a=s(i,t)))return a;if(n(i=t.valueOf)&&!o(a=s(i,t)))return a;if("string"!==e&&n(i=t.toString)&&!o(a=s(i,t)))return a;throw new r("Can't convert object to primitive value")}},4376:function(t,e,i){var s=i(2195);t.exports=Array.isArray||function(t){return"Array"===s(t)}},4387:function(t,e,i){i.d(e,{P:function(){return n}});var s=i(8652);function n(t,e,i){return(0,s.W)(t,e,i).extend({name:"groupable",props:{activeClass:{type:String,default(){if(this[t])return this[t].activeClass}},disabled:Boolean},data(){return{isActive:!1}},computed:{groupClasses(){return this.activeClass?{[this.activeClass]:this.isActive}:{}}},created(){this[t]&&this[t].register(this)},beforeDestroy(){this[t]&&this[t].unregister(this)},methods:{toggle(){this.$emit("change")}}})}n("itemGroup")},4464:function(t,e,i){var s=i(5471);function n(t="value",e="change"){return s.Ay.extend({name:"proxyable",model:{prop:t,event:e},props:{[t]:{required:!1}},data(){return{internalLazyValue:this[t]}},computed:{internalValue:{get(){return this.internalLazyValue},set(t){t!==this.internalLazyValue&&(this.internalLazyValue=t,this.$emit(e,t))}}},watch:{[t](t){this.internalLazyValue=t}}})}const o=n();e.A=o},4495:function(t,e,i){var s=i(9519),n=i(9039),o=i(4576),r=o.String;t.exports=!!Object.getOwnPropertySymbols&&!n((function(){var t=Symbol("symbol detection");return!r(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&s&&s<41}))},4527:function(t,e,i){var s=i(3724),n=i(4376),o=TypeError,r=Object.getOwnPropertyDescriptor,a=s&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=a?function(t,e){if(n(t)&&!r(t,"length").writable)throw new o("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}},4576:function(t,e,i){var s=function(t){return t&&t.Math===Math&&t};t.exports=s("object"==typeof globalThis&&globalThis)||s("object"==typeof window&&window)||s("object"==typeof self&&self)||s("object"==typeof i.g&&i.g)||s("object"==typeof this&&this)||function(){return this}()||Function("return this")()},4659:function(t,e,i){var s=i(3724),n=i(4913),o=i(6980);t.exports=function(t,e,i){s?n.f(t,e,o(0,i)):t[e]=i}},4765:function(t,e,i){var s=i(5471);function n(t){return function(e,i){for(const s in i)Object.prototype.hasOwnProperty.call(e,s)||this.$delete(this.$data[t],s);for(const s in e)this.$set(this.$data[t],s,e[s])}}e.A=s.Ay.extend({data:()=>({attrs$:{},listeners$:{}}),created(){this.$watch("$attrs",n("attrs$"),{immediate:!0}),this.$watch("$listeners",n("listeners$"),{immediate:!0})}})},4838:function(t,e,i){i.d(e,{A:function(){return o}});var s=i(9923),n=i(3507);function o(t,e=[]){return(0,n.A)((0,s.P)(["absolute","fixed"])).extend({name:"applicationable",props:{app:Boolean},computed:{applicationProperty(){return t}},watch:{app(t,e){e?this.removeApplication(!0):this.callUpdate()},applicationProperty(t,e){this.$vuetify.application.unregister(this._uid,e)}},activated(){this.callUpdate()},created(){for(let t=0,i=e.length;t<i;t++)this.$watch(e[t],this.callUpdate);this.callUpdate()},mounted(){this.callUpdate()},deactivated(){this.removeApplication()},destroyed(){this.removeApplication()},methods:{callUpdate(){this.app&&this.$vuetify.application.register(this._uid,this.applicationProperty,this.updateApplication())},removeApplication(t=!1){(t||this.app)&&this.$vuetify.application.unregister(this._uid,this.applicationProperty)},updateApplication:()=>0}})}},4901:function(t){var e="object"==typeof document&&document.all;t.exports="undefined"==typeof e&&void 0!==e?function(t){return"function"==typeof t||t===e}:function(t){return"function"==typeof t}},4913:function(t,e,i){var s=i(3724),n=i(5917),o=i(8686),r=i(8551),a=i(6969),h=TypeError,l=Object.defineProperty,u=Object.getOwnPropertyDescriptor,c="enumerable",d="configurable",f="writable";e.f=s?o?function(t,e,i){if(r(t),e=a(e),r(i),"function"===typeof t&&"prototype"===e&&"value"in i&&f in i&&!i[f]){var s=u(t,e);s&&s[f]&&(t[e]=i.value,i={configurable:d in i?i[d]:s[d],enumerable:c in i?i[c]:s[c],writable:!1})}return l(t,e,i)}:l:function(t,e,i){if(r(t),e=a(e),r(i),n)try{return l(t,e,i)}catch(s){}if("get"in i||"set"in i)throw new h("Accessors not supported");return"value"in i&&(t[e]=i.value),t}},4961:function(t,e,i){i.d(e,{Ay:function(){return r}});var s=i(6960);const n={styleList:/;(?![^(]*\))/g,styleProp:/:(.*)/};function o(t){const e={};for(const i of t.split(n.styleList)){let[t,o]=i.split(n.styleProp);t=t.trim(),t&&("string"===typeof o&&(o=o.trim()),e[(0,s.PT)(t)]=o)}return e}function r(){const t={};let e,i=arguments.length;while(i--)for(e of Object.keys(arguments[i]))switch(e){case"class":case"directives":arguments[i][e]&&(t[e]=h(t[e],arguments[i][e]));break;case"style":arguments[i][e]&&(t[e]=a(t[e],arguments[i][e]));break;case"staticClass":if(!arguments[i][e])break;void 0===t[e]&&(t[e]=""),t[e]&&(t[e]+=" "),t[e]+=arguments[i][e].trim();break;case"on":case"nativeOn":arguments[i][e]&&(t[e]=l(t[e],arguments[i][e]));break;case"attrs":case"props":case"domProps":case"scopedSlots":case"staticStyle":case"hook":case"transition":if(!arguments[i][e])break;t[e]||(t[e]={}),t[e]={...arguments[i][e],...t[e]};break;default:t[e]||(t[e]=arguments[i][e])}return t}function a(t,e){return t?e?(t=(0,s.BN)("string"===typeof t?o(t):t),t.concat("string"===typeof e?o(e):e)):t:e}function h(t,e){return e?t&&t?(0,s.BN)(t).concat(e):e:t}function l(...t){if(!t[0])return t[1];if(!t[1])return t[0];const e={};for(let i=2;i--;){const s=t[i];for(const t in s)s[t]&&(e[t]?e[t]=[].concat(s[t],e[t]):e[t]=s[t])}return e}},5031:function(t,e,i){var s=i(7751),n=i(9504),o=i(8480),r=i(3717),a=i(8551),h=n([].concat);t.exports=s("Reflect","ownKeys")||function(t){var e=o.f(a(t)),i=r.f;return i?h(e,i(t)):e}},5083:function(t,e,i){var s=i(5471);e.A=s.Ay.extend({name:"elevatable",props:{elevation:[Number,String]},computed:{computedElevation(){return this.elevation},elevationClasses(){const t=this.computedElevation;return null==t||isNaN(parseInt(t))?{}:{[`elevation-${this.elevation}`]:!0}}}})},5397:function(t,e,i){var s=i(7055),n=i(7750);t.exports=function(t){return s(n(t))}},5453:function(t,e,i){i.d(e,{A:function(){return tt}});i(4114),i(8111),i(7588);var s=i(5471),n=i(5604);function o(t,e={}){if(o.installed)return;o.installed=!0,s.Ay!==t&&(0,n.yA)("Multiple instances of Vue detected\nSee https://github.com/vuetifyjs/vuetify/issues/4068\n\nIf you're seeing \"$attrs is readonly\", it's caused by this");const i=e.components||{},r=e.directives||{};for(const s in r){const e=r[s];t.directive(s,e)}(function e(i){if(i){for(const s in i){const n=i[s];n&&!e(n.$_vuetify_subcomponents)&&t.component(s,n)}return!0}return!1})(i),t.$_vuetify_installed||(t.$_vuetify_installed=!0,t.mixin({beforeCreate(){const e=this.$options;e.vuetify?(e.vuetify.init(this,this.$ssrContext),this.$vuetify=t.observable(e.vuetify.framework)):this.$vuetify=e.parent&&e.parent.$vuetify||this},beforeMount(){this.$options.vuetify&&this.$el&&this.$el.hasAttribute("data-server-rendered")&&(this.$vuetify.isHydrating=!0,this.$vuetify.breakpoint.update(!0))},mounted(){this.$options.vuetify&&this.$vuetify.isHydrating&&(this.$vuetify.isHydrating=!1,this.$vuetify.breakpoint.update())}}))}var r={badge:"Badge",close:"Close",dataIterator:{noResultsText:"No matching records found",loadingText:"Loading items..."},dataTable:{itemsPerPageText:"Rows per page:",ariaLabel:{sortDescending:"Sorted descending.",sortAscending:"Sorted ascending.",sortNone:"Not sorted.",activateNone:"Activate to remove sorting.",activateDescending:"Activate to sort descending.",activateAscending:"Activate to sort ascending."},sortBy:"Sort by"},dataFooter:{itemsPerPageText:"Items per page:",itemsPerPageAll:"All",nextPage:"Next page",prevPage:"Previous page",firstPage:"First page",lastPage:"Last page",pageText:"{0}-{1} of {2}"},datePicker:{itemsSelected:"{0} selected",nextMonthAriaLabel:"Next month",nextYearAriaLabel:"Next year",prevMonthAriaLabel:"Previous month",prevYearAriaLabel:"Previous year"},noDataText:"No data available",carousel:{prev:"Previous visual",next:"Next visual",ariaLabel:{delimiter:"Carousel slide {0} of {1}"}},calendar:{moreEvents:"{0} more"},fileInput:{counter:"{0} files",counterSize:"{0} files ({1} in total)"},timePicker:{am:"AM",pm:"PM"},pagination:{ariaLabel:{wrapper:"Pagination Navigation",next:"Next page",previous:"Previous page",page:"Goto Page {0}",currentPage:"Current Page, Page {0}"}},rating:{ariaLabel:{icon:"Rating {0} of {1}"}}};const a={breakpoint:{mobileBreakpoint:1264,scrollBarWidth:16,thresholds:{xs:600,sm:960,md:1280,lg:1920}},icons:{iconfont:"mdi",values:{}},lang:{current:"en",locales:{en:r},t:void 0},rtl:!1,theme:{dark:!1,default:"light",disable:!1,options:{cspNonce:void 0,customProperties:void 0,minifyTheme:void 0,themeCache:void 0,variations:!0},themes:{light:{primary:"#1976D2",secondary:"#424242",accent:"#82B1FF",error:"#FF5252",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},dark:{primary:"#2196F3",secondary:"#424242",accent:"#FF4081",error:"#FF5252",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"}}}};var h=i(6960),l=i(1609);class u extends l.k{constructor(t,e){super();const i=(0,h.D9)({},a),{userPreset:s}=e,{preset:o={},...r}=s;null!=o.preset&&(0,n.OP)("Global presets do not support the **preset** option, it can be safely omitted"),e.preset=(0,h.D9)((0,h.D9)(i,o),r)}}u.property="presets";i(8237);class c extends l.k{constructor(){super(...arguments),this.bar=0,this.top=0,this.left=0,this.insetFooter=0,this.right=0,this.bottom=0,this.footer=0,this.application={bar:{},top:{},left:{},insetFooter:{},right:{},bottom:{},footer:{}}}register(t,e,i){this.application[e][t]=i,this.update(e)}unregister(t,e){null!=this.application[e][t]&&(delete this.application[e][t],this.update(e))}update(t){this[t]=Object.values(this.application[t]).reduce(((t,e)=>t+e),0)}}c.property="application";class d extends l.k{constructor(t){super(),this.xs=!1,this.sm=!1,this.md=!1,this.lg=!1,this.xl=!1,this.xsOnly=!1,this.smOnly=!1,this.smAndDown=!1,this.smAndUp=!1,this.mdOnly=!1,this.mdAndDown=!1,this.mdAndUp=!1,this.lgOnly=!1,this.lgAndDown=!1,this.lgAndUp=!1,this.xlOnly=!1,this.name="xs",this.height=0,this.width=0,this.mobile=!0,this.resizeTimeout=0;const{mobileBreakpoint:e,scrollBarWidth:i,thresholds:s}=t[d.property];this.mobileBreakpoint=e,this.scrollBarWidth=i,this.thresholds=s}init(){this.update(),"undefined"!==typeof window&&window.addEventListener("resize",this.onResize.bind(this),{passive:!0})}update(t=!1){const e=t?0:this.getClientHeight(),i=t?0:this.getClientWidth(),s=i<this.thresholds.xs,n=i<this.thresholds.sm&&!s,o=i<this.thresholds.md-this.scrollBarWidth&&!(n||s),r=i<this.thresholds.lg-this.scrollBarWidth&&!(o||n||s),a=i>=this.thresholds.lg-this.scrollBarWidth;switch(this.height=e,this.width=i,this.xs=s,this.sm=n,this.md=o,this.lg=r,this.xl=a,this.xsOnly=s,this.smOnly=n,this.smAndDown=(s||n)&&!(o||r||a),this.smAndUp=!s&&(n||o||r||a),this.mdOnly=o,this.mdAndDown=(s||n||o)&&!(r||a),this.mdAndUp=!(s||n)&&(o||r||a),this.lgOnly=r,this.lgAndDown=(s||n||o||r)&&!a,this.lgAndUp=!(s||n||o)&&(r||a),this.xlOnly=a,!0){case s:this.name="xs";break;case n:this.name="sm";break;case o:this.name="md";break;case r:this.name="lg";break;default:this.name="xl";break}if("number"===typeof this.mobileBreakpoint)return void(this.mobile=i<parseInt(this.mobileBreakpoint,10));const h={xs:0,sm:1,md:2,lg:3,xl:4},l=h[this.name],u=h[this.mobileBreakpoint];this.mobile=l<=u}onResize(){clearTimeout(this.resizeTimeout),this.resizeTimeout=window.setTimeout(this.update.bind(this),200)}getClientWidth(){return"undefined"===typeof document?0:Math.max(document.documentElement.clientWidth,window.innerWidth||0)}getClientHeight(){return"undefined"===typeof document?0:Math.max(document.documentElement.clientHeight,window.innerHeight||0)}}d.property="breakpoint";var f=i(9683);const g={complete:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z",cancel:"M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z",close:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z",delete:"M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z",clear:"M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z",success:"M12 2C6.5 2 2 6.5 2 12S6.5 22 12 22 22 17.5 22 12 17.5 2 12 2M10 17L5 12L6.41 10.59L10 14.17L17.59 6.58L19 8L10 17Z",info:"M13,9H11V7H13M13,17H11V11H13M12,2C6.48,2 2,6.48 2,12C2,17.52 6.48,22 12,22C17.52,22 22,17.52 22,12C22,6.48 17.52,2 12,2ZM13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z",warning:"M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z",error:"M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z",prev:"M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z",next:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z",checkboxOn:"M10,17L5,12L6.41,10.58L10,14.17L17.59,6.58L19,8M19,3H5C3.89,3 3,3.89 3,5V19C3,20.1 3.9,21 5,21H19C20.1,21 21,20.1 21,19V5C21,3.89 20.1,3 19,3Z",checkboxOff:"M19,3H5C3.89,3 3,3.89 3,5V19C3,20.1 3.9,21 5,21H19C20.1,21 21,20.1 21,19V5C21,3.89 20.1,3 19,3M19,5V19H5V5H19Z",checkboxIndeterminate:"M17,13H7V11H17M19,3H5C3.89,3 3,3.89 3,5V19C3,20.1 3.9,21 5,21H19C20.1,21 21,20.1 21,19V5C21,3.89 20.1,3 19,3Z",delimiter:"M12,2C6.48,2 2,6.48 2,12C2,17.52 6.48,22 12,22C17.52,22 22,17.52 22,12C22,6.48 17.52,2 12,2Z",sort:"M13,20H11V8L5.5,13.5L4.08,12.08L12,4.16L19.92,12.08L18.5,13.5L13,8V20Z",expand:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z",menu:"M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z",subgroup:"M7,10L12,15L17,10H7Z",dropdown:"M7,10L12,15L17,10H7Z",radioOn:"M12,20C7.58,20 4,16.42 4,12C4,7.58 7.58,4 12,4C16.42,4 20,7.58 20,12C20,16.42 16.42,20 12,20M12,2C6.48,2 2,6.48 2,12C2,17.52 6.48,22 12,22C17.52,22 22,17.52 22,12C22,6.48 17.52,2 12,2M12,7C9.24,7 7,9.24 7,12C7,14.76 9.24,17 12,17C14.76,17 17,14.76 17,12C17,9.24 14.76,7 12,7Z",radioOff:"M12,20C7.58,20 4,16.42 4,12C4,7.58 7.58,4 12,4C16.42,4 20,7.58 20,12C20,16.42 16.42,20 12,20M12,2C6.48,2 2,6.48 2,12C2,17.52 6.48,22 12,22C17.52,22 22,17.52 22,12C22,6.48 17.52,2 12,2Z",edit:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z",ratingEmpty:"M12,15.39L8.24,17.66L9.23,13.38L5.91,10.5L10.29,10.13L12,6.09L13.71,10.13L18.09,10.5L14.77,13.38L15.76,17.66M22,9.24L14.81,8.63L12,2L9.19,8.63L2,9.24L7.45,13.97L5.82,21L12,17.27L18.18,21L16.54,13.97L22,9.24Z",ratingFull:"M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z",ratingHalf:"M12,15.4V6.1L13.71,10.13L18.09,10.5L14.77,13.39L15.76,17.67M22,9.24L14.81,8.63L12,2L9.19,8.63L2,9.24L7.45,13.97L5.82,21L12,17.27L18.18,21L16.54,13.97L22,9.24Z",loading:"M19,8L15,12H18C18,15.31 15.31,18 12,18C11,18 10.03,17.75 9.2,17.3L7.74,18.76C8.97,19.54 10.43,20 12,20C16.42,20 20,16.42 20,12H23M6,12C6,8.69 8.69,6 12,6C13,6 13.97,6.25 14.8,6.7L16.26,5.24C15.03,4.46 13.57,4 12,4C7.58,4 4,7.58 4,12H1L5,16L9,12",first:"M18.41,16.59L13.82,12L18.41,7.41L17,6L11,12L17,18L18.41,16.59M6,6H8V18H6V6Z",last:"M5.59,7.41L10.18,12L5.59,16.59L7,18L13,12L7,6L5.59,7.41M16,6H18V18H16V6Z",unfold:"M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z",file:"M16.5,6V17.5C16.5,19.71 14.71,21.5 12.5,21.5C10.29,21.5 8.5,19.71 8.5,17.5V5C8.5,3.62 9.62,2.5 11,2.5C12.38,2.5 13.5,3.62 13.5,5V15.5C13.5,16.05 13.05,16.5 12.5,16.5C11.95,16.5 11.5,16.05 11.5,15.5V6H10V15.5C10,16.88 11.12,18 12.5,18C13.88,18 15,16.88 15,15.5V5C15,2.79 13.21,1 11,1C8.79,1 7,2.79 7,5V17.5C7,20.54 9.46,23 12.5,23C15.54,23 18,20.54 18,17.5V6H16.5Z",plus:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z",minus:"M19,13H5V11H19V13Z"};var p=g;const m={complete:"check",cancel:"cancel",close:"close",delete:"cancel",clear:"clear",success:"check_circle",info:"info",warning:"priority_high",error:"warning",prev:"chevron_left",next:"chevron_right",checkboxOn:"check_box",checkboxOff:"check_box_outline_blank",checkboxIndeterminate:"indeterminate_check_box",delimiter:"fiber_manual_record",sort:"arrow_upward",expand:"keyboard_arrow_down",menu:"menu",subgroup:"arrow_drop_down",dropdown:"arrow_drop_down",radioOn:"radio_button_checked",radioOff:"radio_button_unchecked",edit:"edit",ratingEmpty:"star_border",ratingFull:"star",ratingHalf:"star_half",loading:"cached",first:"first_page",last:"last_page",unfold:"unfold_more",file:"attach_file",plus:"add",minus:"remove"};var y=m;const v={complete:"mdi-check",cancel:"mdi-close-circle",close:"mdi-close",delete:"mdi-close-circle",clear:"mdi-close",success:"mdi-check-circle",info:"mdi-information",warning:"mdi-exclamation",error:"mdi-alert",prev:"mdi-chevron-left",next:"mdi-chevron-right",checkboxOn:"mdi-checkbox-marked",checkboxOff:"mdi-checkbox-blank-outline",checkboxIndeterminate:"mdi-minus-box",delimiter:"mdi-circle",sort:"mdi-arrow-up",expand:"mdi-chevron-down",menu:"mdi-menu",subgroup:"mdi-menu-down",dropdown:"mdi-menu-down",radioOn:"mdi-radiobox-marked",radioOff:"mdi-radiobox-blank",edit:"mdi-pencil",ratingEmpty:"mdi-star-outline",ratingFull:"mdi-star",ratingHalf:"mdi-star-half-full",loading:"mdi-cached",first:"mdi-page-first",last:"mdi-page-last",unfold:"mdi-unfold-more-horizontal",file:"mdi-paperclip",plus:"mdi-plus",minus:"mdi-minus"};var x=v;const b={complete:"fas fa-check",cancel:"fas fa-times-circle",close:"fas fa-times",delete:"fas fa-times-circle",clear:"fas fa-times-circle",success:"fas fa-check-circle",info:"fas fa-info-circle",warning:"fas fa-exclamation",error:"fas fa-exclamation-triangle",prev:"fas fa-chevron-left",next:"fas fa-chevron-right",checkboxOn:"fas fa-check-square",checkboxOff:"far fa-square",checkboxIndeterminate:"fas fa-minus-square",delimiter:"fas fa-circle",sort:"fas fa-sort-up",expand:"fas fa-chevron-down",menu:"fas fa-bars",subgroup:"fas fa-caret-down",dropdown:"fas fa-caret-down",radioOn:"far fa-dot-circle",radioOff:"far fa-circle",edit:"fas fa-edit",ratingEmpty:"far fa-star",ratingFull:"fas fa-star",ratingHalf:"fas fa-star-half",loading:"fas fa-sync",first:"fas fa-step-backward",last:"fas fa-step-forward",unfold:"fas fa-arrows-alt-v",file:"fas fa-paperclip",plus:"fas fa-plus",minus:"fas fa-minus"};var w=b;const k={complete:"fa fa-check",cancel:"fa fa-times-circle",close:"fa fa-times",delete:"fa fa-times-circle",clear:"fa fa-times-circle",success:"fa fa-check-circle",info:"fa fa-info-circle",warning:"fa fa-exclamation",error:"fa fa-exclamation-triangle",prev:"fa fa-chevron-left",next:"fa fa-chevron-right",checkboxOn:"fa fa-check-square",checkboxOff:"fa fa-square-o",checkboxIndeterminate:"fa fa-minus-square",delimiter:"fa fa-circle",sort:"fa fa-sort-up",expand:"fa fa-chevron-down",menu:"fa fa-bars",subgroup:"fa fa-caret-down",dropdown:"fa fa-caret-down",radioOn:"fa fa-dot-circle-o",radioOff:"fa fa-circle-o",edit:"fa fa-pencil",ratingEmpty:"fa fa-star-o",ratingFull:"fa fa-star",ratingHalf:"fa fa-star-half-o",loading:"fa fa-refresh",first:"fa fa-step-backward",last:"fa fa-step-forward",unfold:"fa fa-angle-double-down",file:"fa fa-paperclip",plus:"fa fa-plus",minus:"fa fa-minus"};var S=k;function P(t,e){const i={};for(const s in e)i[s]={component:t,props:{icon:e[s].split(" fa-")}};return i}var M=P("font-awesome-icon",w),C=Object.freeze({mdiSvg:p,md:y,mdi:x,fa:w,fa4:S,faSvg:M});class A extends l.k{constructor(t){super();const{iconfont:e,values:i,component:s}=t[A.property];this.component=s,this.iconfont=e,this.values=(0,h.D9)(C[e],i)}}A.property="icons";const N="$vuetify.",L=Symbol("Lang fallback");function T(t,e,i=!1,s){const o=e.replace(N,"");let r=(0,h.no)(t,o,L);return r===L&&(i?((0,n.yA)(`Translation key "${o}" not found in fallback`),r=e):((0,n.OP)(`Translation key "${o}" not found, falling back to default`),r=T(s,e,!0,s))),r}class D extends l.k{constructor(t){super(),this.defaultLocale="en";const{current:e,locales:i,t:s}=t[D.property];this.current=e,this.locales=i,this.translator=s||this.defaultTranslator}currentLocale(t){const e=this.locales[this.current],i=this.locales[this.defaultLocale];return T(e,t,!1,i)}t(t,...e){return t.startsWith(N)?this.translator(t,...e):this.replace(t,e)}defaultTranslator(t,...e){return this.replace(this.currentLocale(t),e)}replace(t,e){return t.replace(/\{(\d+)\}/g,((t,i)=>String(e[+i])))}}D.property="lang";i(116);var O=i(3805);const F=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]],R=t=>t<=.0031308?12.92*t:1.055*t**(1/2.4)-.055,E=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],B=t=>t<=.04045?t/12.92:((t+.055)/1.055)**2.4;function I(t){const e=Array(3),i=R,s=F;for(let n=0;n<3;++n)e[n]=Math.round(255*(0,h.qE)(i(s[n][0]*t[0]+s[n][1]*t[1]+s[n][2]*t[2])));return(e[0]<<16)+(e[1]<<8)+(e[2]|0)}function _(t){const e=[0,0,0],i=B,s=E,n=i((t>>16&255)/255),o=i((t>>8&255)/255),r=i((255&t)/255);for(let a=0;a<3;++a)e[a]=s[a][0]*n+s[a][1]*o+s[a][2]*r;return e}const V=.20689655172413793,z=t=>t>V**3?Math.cbrt(t):t/(3*V**2)+4/29,j=t=>t>V?t**3:3*V**2*(t-4/29);function $(t){const e=z,i=e(t[1]);return[116*i-16,500*(e(t[0]/.95047)-i),200*(i-e(t[2]/1.08883))]}function X(t){const e=j,i=(t[0]+16)/116;return[.95047*e(i+t[1]/500),e(i),1.08883*e(i-t[2]/200)]}function G(t,e=!1,i=!0){const{anchor:s,...n}=t,o=Object.keys(n),r={};for(let a=0;a<o.length;++a){const s=o[a],n=t[s];null!=n&&(i?e?("base"===s||s.startsWith("lighten")||s.startsWith("darken"))&&(r[s]=(0,O.si)(n)):r[s]="object"===typeof n?G(n,!0,i):W(s,(0,O.E8)(n)):r[s]={base:(0,O.y6)((0,O.E8)(n))})}return e||(r.anchor=s||r.base||r.primary.base),r}const Y=(t,e)=>`\n.v-application .${t} {\n  background-color: ${e} !important;\n  border-color: ${e} !important;\n}\n.v-application .${t}--text {\n  color: ${e} !important;\n  caret-color: ${e} !important;\n}`,K=(t,e,i)=>{const[s,n]=e.split(/(\d)/,2);return`\n.v-application .${t}.${s}-${n} {\n  background-color: ${i} !important;\n  border-color: ${i} !important;\n}\n.v-application .${t}--text.text--${s}-${n} {\n  color: ${i} !important;\n  caret-color: ${i} !important;\n}`},U=(t,e="base")=>`--v-${t}-${e}`,H=(t,e="base")=>`var(${U(t,e)})`;function q(t,e=!1){const{anchor:i,...s}=t,n=Object.keys(s);if(!n.length)return"";let o="",r="";const a=e?H("anchor"):i;r+=`.v-application a { color: ${a}; }`,e&&(o+=`  ${U("anchor")}: ${i};\n`);for(let l=0;l<n.length;++l){const i=n[l],s=t[i];r+=Y(i,e?H(i):s.base),e&&(o+=`  ${U(i)}: ${s.base};\n`);const a=(0,h.HP)(s);for(let t=0;t<a.length;++t){const n=a[t],h=s[n];"base"!==n&&(r+=K(i,n,e?H(i,n):h),e&&(o+=`  ${U(i,n)}: ${h};\n`))}}return e&&(o=`:root {\n${o}}\n\n`),o+r}function W(t,e){const i={base:(0,O.y6)(e)};for(let s=5;s>0;--s)i[`lighten${s}`]=(0,O.y6)(Z(e,s));for(let s=1;s<=4;++s)i[`darken${s}`]=(0,O.y6)(J(e,s));return i}function Z(t,e){const i=$(_(t));return i[0]=i[0]+10*e,I(X(i))}function J(t,e){const i=$(_(t));return i[0]=i[0]-10*e,I(X(i))}class Q extends l.k{constructor(t){super(),this.disabled=!1,this.isDark=null,this.unwatch=null,this.vueMeta=null;const{dark:e,disable:i,options:s,themes:n}=t[Q.property];this.dark=Boolean(e),this.defaults=this.themes=n,this.options=s,i?this.disabled=!0:this.themes={dark:this.fillVariant(n.dark,!0),light:this.fillVariant(n.light,!1)}}set css(t){this.vueMeta?this.isVueMeta23&&this.applyVueMeta23():this.checkOrCreateStyleElement()&&(this.styleEl.innerHTML=t)}set dark(t){const e=this.isDark;this.isDark=t,null!=e&&this.applyTheme()}get dark(){return Boolean(this.isDark)}applyTheme(){if(this.disabled)return this.clearCss();this.css=this.generatedStyles}clearCss(){this.css=""}init(t,e){this.disabled||(t.$meta?this.initVueMeta(t):e&&this.initSSR(e),this.initTheme(t))}setTheme(t,e){this.themes[t]=Object.assign(this.themes[t],e),this.applyTheme()}resetThemes(){this.themes.light=Object.assign({},this.defaults.light),this.themes.dark=Object.assign({},this.defaults.dark),this.applyTheme()}checkOrCreateStyleElement(){return this.styleEl=document.getElementById("vuetify-theme-stylesheet"),!!this.styleEl||(this.genStyleElement(),Boolean(this.styleEl))}fillVariant(t={},e){const i=this.themes[e?"dark":"light"];return Object.assign({},i,t)}genStyleElement(){"undefined"!==typeof document&&(this.styleEl=document.createElement("style"),this.styleEl.type="text/css",this.styleEl.id="vuetify-theme-stylesheet",this.options.cspNonce&&this.styleEl.setAttribute("nonce",this.options.cspNonce),document.head.appendChild(this.styleEl))}initVueMeta(t){if(this.vueMeta=t.$meta(),this.isVueMeta23)return void t.$nextTick((()=>{this.applyVueMeta23()}));const e="function"===typeof this.vueMeta.getOptions?this.vueMeta.getOptions().keyName:"metaInfo",i=t.$options[e]||{};t.$options[e]=()=>{i.style=i.style||[];const t=i.style.find((t=>"vuetify-theme-stylesheet"===t.id));return t?t.cssText=this.generatedStyles:i.style.push({cssText:this.generatedStyles,type:"text/css",id:"vuetify-theme-stylesheet",nonce:(this.options||{}).cspNonce}),i}}applyVueMeta23(){const{set:t}=this.vueMeta.addApp("vuetify");t({style:[{cssText:this.generatedStyles,type:"text/css",id:"vuetify-theme-stylesheet",nonce:this.options.cspNonce}]})}initSSR(t){const e=this.options.cspNonce?` nonce="${this.options.cspNonce}"`:"";t.head=t.head||"",t.head+=`<style type="text/css" id="vuetify-theme-stylesheet"${e}>${this.generatedStyles}</style>`}initTheme(t){"undefined"!==typeof document&&(this.unwatch&&(this.unwatch(),this.unwatch=null),t.$once("hook:created",(()=>{const e=s.Ay.observable({themes:this.themes});this.unwatch=t.$watch((()=>e.themes),(()=>this.applyTheme()),{deep:!0})})),this.applyTheme())}get currentTheme(){const t=this.dark?"dark":"light";return this.themes[t]}get generatedStyles(){const t=this.parsedTheme,e=this.options||{};let i;return null!=e.themeCache&&(i=e.themeCache.get(t),null!=i)||(i=q(t,e.customProperties),null!=e.minifyTheme&&(i=e.minifyTheme(i)),null!=e.themeCache&&e.themeCache.set(t,i)),i}get parsedTheme(){return G(this.currentTheme||{},void 0,(0,h.LJ)(this.options,["variations"],!0))}get isVueMeta23(){return"function"===typeof this.vueMeta.addApp}}Q.property="theme";class tt{constructor(t={}){this.framework={isHydrating:!1},this.installed=[],this.preset={},this.userPreset={},this.userPreset=t,this.use(u),this.use(c),this.use(d),this.use(f.I),this.use(A),this.use(D),this.use(Q)}init(t,e){this.installed.forEach((i=>{const s=this.framework[i];s.framework=this.framework,s.init(t,e)})),this.framework.rtl=Boolean(this.preset.rtl)}use(t){const e=t.property;this.installed.includes(e)||(this.framework[e]=new t(this.preset,this),this.installed.push(e))}}tt.install=o,tt.installed=!1,tt.version="2.6.13",tt.config={silent:!1}},5471:function(t,e,i){i.d(e,{Ay:function(){return Zs}});
/*!
 * Vue.js v2.7.16
 * (c) 2014-2023 Evan You
 * Released under the MIT License.
 */
var s=Object.freeze({}),n=Array.isArray;function o(t){return void 0===t||null===t}function r(t){return void 0!==t&&null!==t}function a(t){return!0===t}function h(t){return!1===t}function l(t){return"string"===typeof t||"number"===typeof t||"symbol"===typeof t||"boolean"===typeof t}function u(t){return"function"===typeof t}function c(t){return null!==t&&"object"===typeof t}var d=Object.prototype.toString;function f(t){return"[object Object]"===d.call(t)}function g(t){return"[object RegExp]"===d.call(t)}function p(t){var e=parseFloat(String(t));return e>=0&&Math.floor(e)===e&&isFinite(t)}function m(t){return r(t)&&"function"===typeof t.then&&"function"===typeof t.catch}function y(t){return null==t?"":Array.isArray(t)||f(t)&&t.toString===d?JSON.stringify(t,v,2):String(t)}function v(t,e){return e&&e.__v_isRef?e.value:e}function x(t){var e=parseFloat(t);return isNaN(e)?t:e}function b(t,e){for(var i=Object.create(null),s=t.split(","),n=0;n<s.length;n++)i[s[n]]=!0;return e?function(t){return i[t.toLowerCase()]}:function(t){return i[t]}}b("slot,component",!0);var w=b("key,ref,slot,slot-scope,is");function k(t,e){var i=t.length;if(i){if(e===t[i-1])return void(t.length=i-1);var s=t.indexOf(e);if(s>-1)return t.splice(s,1)}}var S=Object.prototype.hasOwnProperty;function P(t,e){return S.call(t,e)}function M(t){var e=Object.create(null);return function(i){var s=e[i];return s||(e[i]=t(i))}}var C=/-(\w)/g,A=M((function(t){return t.replace(C,(function(t,e){return e?e.toUpperCase():""}))})),N=M((function(t){return t.charAt(0).toUpperCase()+t.slice(1)})),L=/\B([A-Z])/g,T=M((function(t){return t.replace(L,"-$1").toLowerCase()}));function D(t,e){function i(i){var s=arguments.length;return s?s>1?t.apply(e,arguments):t.call(e,i):t.call(e)}return i._length=t.length,i}function O(t,e){return t.bind(e)}var F=Function.prototype.bind?O:D;function R(t,e){e=e||0;var i=t.length-e,s=new Array(i);while(i--)s[i]=t[i+e];return s}function E(t,e){for(var i in e)t[i]=e[i];return t}function B(t){for(var e={},i=0;i<t.length;i++)t[i]&&E(e,t[i]);return e}function I(t,e,i){}var _=function(t,e,i){return!1},V=function(t){return t};function z(t,e){if(t===e)return!0;var i=c(t),s=c(e);if(!i||!s)return!i&&!s&&String(t)===String(e);try{var n=Array.isArray(t),o=Array.isArray(e);if(n&&o)return t.length===e.length&&t.every((function(t,i){return z(t,e[i])}));if(t instanceof Date&&e instanceof Date)return t.getTime()===e.getTime();if(n||o)return!1;var r=Object.keys(t),a=Object.keys(e);return r.length===a.length&&r.every((function(i){return z(t[i],e[i])}))}catch(h){return!1}}function j(t,e){for(var i=0;i<t.length;i++)if(z(t[i],e))return i;return-1}function $(t){var e=!1;return function(){e||(e=!0,t.apply(this,arguments))}}function X(t,e){return t===e?0===t&&1/t!==1/e:t===t||e===e}var G="data-server-rendered",Y=["component","directive","filter"],K=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch","renderTracked","renderTriggered"],U={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:_,isReservedAttr:_,isUnknownElement:_,getTagNamespace:I,parsePlatformTagName:V,mustUseProp:_,async:!0,_lifecycleHooks:K},H=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function q(t){var e=(t+"").charCodeAt(0);return 36===e||95===e}function W(t,e,i,s){Object.defineProperty(t,e,{value:i,enumerable:!!s,writable:!0,configurable:!0})}var Z=new RegExp("[^".concat(H.source,".$_\\d]"));function J(t){if(!Z.test(t)){var e=t.split(".");return function(t){for(var i=0;i<e.length;i++){if(!t)return;t=t[e[i]]}return t}}}var Q="__proto__"in{},tt="undefined"!==typeof window,et=tt&&window.navigator.userAgent.toLowerCase(),it=et&&/msie|trident/.test(et),st=et&&et.indexOf("msie 9.0")>0,nt=et&&et.indexOf("edge/")>0;et&&et.indexOf("android");var ot=et&&/iphone|ipad|ipod|ios/.test(et);et&&/chrome\/\d+/.test(et),et&&/phantomjs/.test(et);var rt,at=et&&et.match(/firefox\/(\d+)/),ht={}.watch,lt=!1;if(tt)try{var ut={};Object.defineProperty(ut,"passive",{get:function(){lt=!0}}),window.addEventListener("test-passive",null,ut)}catch(Qr){}var ct=function(){return void 0===rt&&(rt=!tt&&"undefined"!==typeof i.g&&(i.g["process"]&&"server"===i.g["process"].env.VUE_ENV)),rt},dt=tt&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function ft(t){return"function"===typeof t&&/native code/.test(t.toString())}var gt,pt="undefined"!==typeof Symbol&&ft(Symbol)&&"undefined"!==typeof Reflect&&ft(Reflect.ownKeys);gt="undefined"!==typeof Set&&ft(Set)?Set:function(){function t(){this.set=Object.create(null)}return t.prototype.has=function(t){return!0===this.set[t]},t.prototype.add=function(t){this.set[t]=!0},t.prototype.clear=function(){this.set=Object.create(null)},t}();var mt=null;function yt(t){void 0===t&&(t=null),t||mt&&mt._scope.off(),mt=t,t&&t._scope.on()}var vt=function(){function t(t,e,i,s,n,o,r,a){this.tag=t,this.data=e,this.children=i,this.text=s,this.elm=n,this.ns=void 0,this.context=o,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=e&&e.key,this.componentOptions=r,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=a,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1}return Object.defineProperty(t.prototype,"child",{get:function(){return this.componentInstance},enumerable:!1,configurable:!0}),t}(),xt=function(t){void 0===t&&(t="");var e=new vt;return e.text=t,e.isComment=!0,e};function bt(t){return new vt(void 0,void 0,void 0,String(t))}function wt(t){var e=new vt(t.tag,t.data,t.children&&t.children.slice(),t.text,t.elm,t.context,t.componentOptions,t.asyncFactory);return e.ns=t.ns,e.isStatic=t.isStatic,e.key=t.key,e.isComment=t.isComment,e.fnContext=t.fnContext,e.fnOptions=t.fnOptions,e.fnScopeId=t.fnScopeId,e.asyncMeta=t.asyncMeta,e.isCloned=!0,e}"function"===typeof SuppressedError&&SuppressedError;var kt=0,St=[],Pt=function(){for(var t=0;t<St.length;t++){var e=St[t];e.subs=e.subs.filter((function(t){return t})),e._pending=!1}St.length=0},Mt=function(){function t(){this._pending=!1,this.id=kt++,this.subs=[]}return t.prototype.addSub=function(t){this.subs.push(t)},t.prototype.removeSub=function(t){this.subs[this.subs.indexOf(t)]=null,this._pending||(this._pending=!0,St.push(this))},t.prototype.depend=function(e){t.target&&t.target.addDep(this)},t.prototype.notify=function(t){var e=this.subs.filter((function(t){return t}));for(var i=0,s=e.length;i<s;i++){var n=e[i];0,n.update()}},t}();Mt.target=null;var Ct=[];function At(t){Ct.push(t),Mt.target=t}function Nt(){Ct.pop(),Mt.target=Ct[Ct.length-1]}var Lt=Array.prototype,Tt=Object.create(Lt),Dt=["push","pop","shift","unshift","splice","sort","reverse"];Dt.forEach((function(t){var e=Lt[t];W(Tt,t,(function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];var n,o=e.apply(this,i),r=this.__ob__;switch(t){case"push":case"unshift":n=i;break;case"splice":n=i.slice(2);break}return n&&r.observeArray(n),r.dep.notify(),o}))}));var Ot=Object.getOwnPropertyNames(Tt),Ft={},Rt=!0;function Et(t){Rt=t}var Bt={notify:I,depend:I,addSub:I,removeSub:I},It=function(){function t(t,e,i){if(void 0===e&&(e=!1),void 0===i&&(i=!1),this.value=t,this.shallow=e,this.mock=i,this.dep=i?Bt:new Mt,this.vmCount=0,W(t,"__ob__",this),n(t)){if(!i)if(Q)t.__proto__=Tt;else for(var s=0,o=Ot.length;s<o;s++){var r=Ot[s];W(t,r,Tt[r])}e||this.observeArray(t)}else{var a=Object.keys(t);for(s=0;s<a.length;s++){r=a[s];Vt(t,r,Ft,void 0,e,i)}}}return t.prototype.observeArray=function(t){for(var e=0,i=t.length;e<i;e++)_t(t[e],!1,this.mock)},t}();function _t(t,e,i){return t&&P(t,"__ob__")&&t.__ob__ instanceof It?t.__ob__:!Rt||!i&&ct()||!n(t)&&!f(t)||!Object.isExtensible(t)||t.__v_skip||Kt(t)||t instanceof vt?void 0:new It(t,e,i)}function Vt(t,e,i,s,o,r,a){void 0===a&&(a=!1);var h=new Mt,l=Object.getOwnPropertyDescriptor(t,e);if(!l||!1!==l.configurable){var u=l&&l.get,c=l&&l.set;u&&!c||i!==Ft&&2!==arguments.length||(i=t[e]);var d=o?i&&i.__ob__:_t(i,!1,r);return Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){var e=u?u.call(t):i;return Mt.target&&(h.depend(),d&&(d.dep.depend(),n(e)&&$t(e))),Kt(e)&&!o?e.value:e},set:function(e){var s=u?u.call(t):i;if(X(s,e)){if(c)c.call(t,e);else{if(u)return;if(!o&&Kt(s)&&!Kt(e))return void(s.value=e);i=e}d=o?e&&e.__ob__:_t(e,!1,r),h.notify()}}}),h}}function zt(t,e,i){if(!Yt(t)){var s=t.__ob__;return n(t)&&p(e)?(t.length=Math.max(t.length,e),t.splice(e,1,i),s&&!s.shallow&&s.mock&&_t(i,!1,!0),i):e in t&&!(e in Object.prototype)?(t[e]=i,i):t._isVue||s&&s.vmCount?i:s?(Vt(s.value,e,i,void 0,s.shallow,s.mock),s.dep.notify(),i):(t[e]=i,i)}}function jt(t,e){if(n(t)&&p(e))t.splice(e,1);else{var i=t.__ob__;t._isVue||i&&i.vmCount||Yt(t)||P(t,e)&&(delete t[e],i&&i.dep.notify())}}function $t(t){for(var e=void 0,i=0,s=t.length;i<s;i++)e=t[i],e&&e.__ob__&&e.__ob__.dep.depend(),n(e)&&$t(e)}function Xt(t){return Gt(t,!0),W(t,"__v_isShallow",!0),t}function Gt(t,e){if(!Yt(t)){_t(t,e,ct());0}}function Yt(t){return!(!t||!t.__v_isReadonly)}function Kt(t){return!(!t||!0!==t.__v_isRef)}function Ut(t,e,i){Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:function(){var t=e[i];if(Kt(t))return t.value;var s=t&&t.__ob__;return s&&s.dep.depend(),t},set:function(t){var s=e[i];Kt(s)&&!Kt(t)?s.value=t:e[i]=t}})}var Ht="watcher";"".concat(Ht," callback"),"".concat(Ht," getter"),"".concat(Ht," cleanup");var qt;var Wt=function(){function t(t){void 0===t&&(t=!1),this.detached=t,this.active=!0,this.effects=[],this.cleanups=[],this.parent=qt,!t&&qt&&(this.index=(qt.scopes||(qt.scopes=[])).push(this)-1)}return t.prototype.run=function(t){if(this.active){var e=qt;try{return qt=this,t()}finally{qt=e}}else 0},t.prototype.on=function(){qt=this},t.prototype.off=function(){qt=this.parent},t.prototype.stop=function(t){if(this.active){var e=void 0,i=void 0;for(e=0,i=this.effects.length;e<i;e++)this.effects[e].teardown();for(e=0,i=this.cleanups.length;e<i;e++)this.cleanups[e]();if(this.scopes)for(e=0,i=this.scopes.length;e<i;e++)this.scopes[e].stop(!0);if(!this.detached&&this.parent&&!t){var s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this.active=!1}},t}();function Zt(t,e){void 0===e&&(e=qt),e&&e.active&&e.effects.push(t)}function Jt(){return qt}function Qt(t){var e=t._provided,i=t.$parent&&t.$parent._provided;return i===e?t._provided=Object.create(i):e}var te=M((function(t){var e="&"===t.charAt(0);t=e?t.slice(1):t;var i="~"===t.charAt(0);t=i?t.slice(1):t;var s="!"===t.charAt(0);return t=s?t.slice(1):t,{name:t,once:i,capture:s,passive:e}}));function ee(t,e){function i(){var t=i.fns;if(!n(t))return Ze(t,null,arguments,e,"v-on handler");for(var s=t.slice(),o=0;o<s.length;o++)Ze(s[o],null,arguments,e,"v-on handler")}return i.fns=t,i}function ie(t,e,i,s,n,r){var h,l,u,c;for(h in t)l=t[h],u=e[h],c=te(h),o(l)||(o(u)?(o(l.fns)&&(l=t[h]=ee(l,r)),a(c.once)&&(l=t[h]=n(c.name,l,c.capture)),i(c.name,l,c.capture,c.passive,c.params)):l!==u&&(u.fns=l,t[h]=u));for(h in e)o(t[h])&&(c=te(h),s(c.name,e[h],c.capture))}function se(t,e,i){var s;t instanceof vt&&(t=t.data.hook||(t.data.hook={}));var n=t[e];function h(){i.apply(this,arguments),k(s.fns,h)}o(n)?s=ee([h]):r(n.fns)&&a(n.merged)?(s=n,s.fns.push(h)):s=ee([n,h]),s.merged=!0,t[e]=s}function ne(t,e,i){var s=e.options.props;if(!o(s)){var n={},a=t.attrs,h=t.props;if(r(a)||r(h))for(var l in s){var u=T(l);oe(n,h,l,u,!0)||oe(n,a,l,u,!1)}return n}}function oe(t,e,i,s,n){if(r(e)){if(P(e,i))return t[i]=e[i],n||delete e[i],!0;if(P(e,s))return t[i]=e[s],n||delete e[s],!0}return!1}function re(t){for(var e=0;e<t.length;e++)if(n(t[e]))return Array.prototype.concat.apply([],t);return t}function ae(t){return l(t)?[bt(t)]:n(t)?le(t):void 0}function he(t){return r(t)&&r(t.text)&&h(t.isComment)}function le(t,e){var i,s,h,u,c=[];for(i=0;i<t.length;i++)s=t[i],o(s)||"boolean"===typeof s||(h=c.length-1,u=c[h],n(s)?s.length>0&&(s=le(s,"".concat(e||"","_").concat(i)),he(s[0])&&he(u)&&(c[h]=bt(u.text+s[0].text),s.shift()),c.push.apply(c,s)):l(s)?he(u)?c[h]=bt(u.text+s):""!==s&&c.push(bt(s)):he(s)&&he(u)?c[h]=bt(u.text+s.text):(a(t._isVList)&&r(s.tag)&&o(s.key)&&r(e)&&(s.key="__vlist".concat(e,"_").concat(i,"__")),c.push(s)));return c}function ue(t,e){var i,s,o,a,h=null;if(n(t)||"string"===typeof t)for(h=new Array(t.length),i=0,s=t.length;i<s;i++)h[i]=e(t[i],i);else if("number"===typeof t)for(h=new Array(t),i=0;i<t;i++)h[i]=e(i+1,i);else if(c(t))if(pt&&t[Symbol.iterator]){h=[];var l=t[Symbol.iterator](),u=l.next();while(!u.done)h.push(e(u.value,h.length)),u=l.next()}else for(o=Object.keys(t),h=new Array(o.length),i=0,s=o.length;i<s;i++)a=o[i],h[i]=e(t[a],a,i);return r(h)||(h=[]),h._isVList=!0,h}function ce(t,e,i,s){var n,o=this.$scopedSlots[t];o?(i=i||{},s&&(i=E(E({},s),i)),n=o(i)||(u(e)?e():e)):n=this.$slots[t]||(u(e)?e():e);var r=i&&i.slot;return r?this.$createElement("template",{slot:r},n):n}function de(t){return Ps(this.$options,"filters",t,!0)||V}function fe(t,e){return n(t)?-1===t.indexOf(e):t!==e}function ge(t,e,i,s,n){var o=U.keyCodes[e]||i;return n&&s&&!U.keyCodes[e]?fe(n,s):o?fe(o,t):s?T(s)!==e:void 0===t}function pe(t,e,i,s,o){if(i)if(c(i)){n(i)&&(i=B(i));var r=void 0,a=function(n){if("class"===n||"style"===n||w(n))r=t;else{var a=t.attrs&&t.attrs.type;r=s||U.mustUseProp(e,a,n)?t.domProps||(t.domProps={}):t.attrs||(t.attrs={})}var h=A(n),l=T(n);if(!(h in r)&&!(l in r)&&(r[n]=i[n],o)){var u=t.on||(t.on={});u["update:".concat(n)]=function(t){i[n]=t}}};for(var h in i)a(h)}else;return t}function me(t,e){var i=this._staticTrees||(this._staticTrees=[]),s=i[t];return s&&!e||(s=i[t]=this.$options.staticRenderFns[t].call(this._renderProxy,this._c,this),ve(s,"__static__".concat(t),!1)),s}function ye(t,e,i){return ve(t,"__once__".concat(e).concat(i?"_".concat(i):""),!0),t}function ve(t,e,i){if(n(t))for(var s=0;s<t.length;s++)t[s]&&"string"!==typeof t[s]&&xe(t[s],"".concat(e,"_").concat(s),i);else xe(t,e,i)}function xe(t,e,i){t.isStatic=!0,t.key=e,t.isOnce=i}function be(t,e){if(e)if(f(e)){var i=t.on=t.on?E({},t.on):{};for(var s in e){var n=i[s],o=e[s];i[s]=n?[].concat(n,o):o}}else;return t}function we(t,e,i,s){e=e||{$stable:!i};for(var o=0;o<t.length;o++){var r=t[o];n(r)?we(r,e,i):r&&(r.proxy&&(r.fn.proxy=!0),e[r.key]=r.fn)}return s&&(e.$key=s),e}function ke(t,e){for(var i=0;i<e.length;i+=2){var s=e[i];"string"===typeof s&&s&&(t[e[i]]=e[i+1])}return t}function Se(t,e){return"string"===typeof t?e+t:t}function Pe(t){t._o=ye,t._n=x,t._s=y,t._l=ue,t._t=ce,t._q=z,t._i=j,t._m=me,t._f=de,t._k=ge,t._b=pe,t._v=bt,t._e=xt,t._u=we,t._g=be,t._d=ke,t._p=Se}function Me(t,e){if(!t||!t.length)return{};for(var i={},s=0,n=t.length;s<n;s++){var o=t[s],r=o.data;if(r&&r.attrs&&r.attrs.slot&&delete r.attrs.slot,o.context!==e&&o.fnContext!==e||!r||null==r.slot)(i.default||(i.default=[])).push(o);else{var a=r.slot,h=i[a]||(i[a]=[]);"template"===o.tag?h.push.apply(h,o.children||[]):h.push(o)}}for(var l in i)i[l].every(Ce)&&delete i[l];return i}function Ce(t){return t.isComment&&!t.asyncFactory||" "===t.text}function Ae(t){return t.isComment&&t.asyncFactory}function Ne(t,e,i,n){var o,r=Object.keys(i).length>0,a=e?!!e.$stable:!r,h=e&&e.$key;if(e){if(e._normalized)return e._normalized;if(a&&n&&n!==s&&h===n.$key&&!r&&!n.$hasNormal)return n;for(var l in o={},e)e[l]&&"$"!==l[0]&&(o[l]=Le(t,i,l,e[l]))}else o={};for(var u in i)u in o||(o[u]=Te(i,u));return e&&Object.isExtensible(e)&&(e._normalized=o),W(o,"$stable",a),W(o,"$key",h),W(o,"$hasNormal",r),o}function Le(t,e,i,s){var o=function(){var e=mt;yt(t);var i=arguments.length?s.apply(null,arguments):s({});i=i&&"object"===typeof i&&!n(i)?[i]:ae(i);var o=i&&i[0];return yt(e),i&&(!o||1===i.length&&o.isComment&&!Ae(o))?void 0:i};return s.proxy&&Object.defineProperty(e,i,{get:o,enumerable:!0,configurable:!0}),o}function Te(t,e){return function(){return t[e]}}function De(t){var e=t.$options,i=e.setup;if(i){var s=t._setupContext=Oe(t);yt(t),At();var n=Ze(i,null,[t._props||Xt({}),s],t,"setup");if(Nt(),yt(),u(n))e.render=n;else if(c(n))if(t._setupState=n,n.__sfc){var o=t._setupProxy={};for(var r in n)"__sfc"!==r&&Ut(o,n,r)}else for(var r in n)q(r)||Ut(t,n,r);else 0}}function Oe(t){return{get attrs(){if(!t._attrsProxy){var e=t._attrsProxy={};W(e,"_v_attr_proxy",!0),Fe(e,t.$attrs,s,t,"$attrs")}return t._attrsProxy},get listeners(){if(!t._listenersProxy){var e=t._listenersProxy={};Fe(e,t.$listeners,s,t,"$listeners")}return t._listenersProxy},get slots(){return Ee(t)},emit:F(t.$emit,t),expose:function(e){e&&Object.keys(e).forEach((function(i){return Ut(t,e,i)}))}}}function Fe(t,e,i,s,n){var o=!1;for(var r in e)r in t?e[r]!==i[r]&&(o=!0):(o=!0,Re(t,r,s,n));for(var r in t)r in e||(o=!0,delete t[r]);return o}function Re(t,e,i,s){Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){return i[s][e]}})}function Ee(t){return t._slotsProxy||Be(t._slotsProxy={},t.$scopedSlots),t._slotsProxy}function Be(t,e){for(var i in e)t[i]=e[i];for(var i in t)i in e||delete t[i]}function Ie(t){t._vnode=null,t._staticTrees=null;var e=t.$options,i=t.$vnode=e._parentVnode,n=i&&i.context;t.$slots=Me(e._renderChildren,n),t.$scopedSlots=i?Ne(t.$parent,i.data.scopedSlots,t.$slots):s,t._c=function(e,i,s,n){return Ke(t,e,i,s,n,!1)},t.$createElement=function(e,i,s,n){return Ke(t,e,i,s,n,!0)};var o=i&&i.data;Vt(t,"$attrs",o&&o.attrs||s,null,!0),Vt(t,"$listeners",e._parentListeners||s,null,!0)}var _e=null;function Ve(t){Pe(t.prototype),t.prototype.$nextTick=function(t){return li(t,this)},t.prototype._render=function(){var t=this,e=t.$options,i=e.render,s=e._parentVnode;s&&t._isMounted&&(t.$scopedSlots=Ne(t.$parent,s.data.scopedSlots,t.$slots,t.$scopedSlots),t._slotsProxy&&Be(t._slotsProxy,t.$scopedSlots)),t.$vnode=s;var o,r=mt,a=_e;try{yt(t),_e=t,o=i.call(t._renderProxy,t.$createElement)}catch(Qr){We(Qr,t,"render"),o=t._vnode}finally{_e=a,yt(r)}return n(o)&&1===o.length&&(o=o[0]),o instanceof vt||(o=xt()),o.parent=s,o}}function ze(t,e){return(t.__esModule||pt&&"Module"===t[Symbol.toStringTag])&&(t=t.default),c(t)?e.extend(t):t}function je(t,e,i,s,n){var o=xt();return o.asyncFactory=t,o.asyncMeta={data:e,context:i,children:s,tag:n},o}function $e(t,e){if(a(t.error)&&r(t.errorComp))return t.errorComp;if(r(t.resolved))return t.resolved;var i=_e;if(i&&r(t.owners)&&-1===t.owners.indexOf(i)&&t.owners.push(i),a(t.loading)&&r(t.loadingComp))return t.loadingComp;if(i&&!r(t.owners)){var s=t.owners=[i],n=!0,h=null,l=null;i.$on("hook:destroyed",(function(){return k(s,i)}));var u=function(t){for(var e=0,i=s.length;e<i;e++)s[e].$forceUpdate();t&&(s.length=0,null!==h&&(clearTimeout(h),h=null),null!==l&&(clearTimeout(l),l=null))},d=$((function(i){t.resolved=ze(i,e),n?s.length=0:u(!0)})),f=$((function(e){r(t.errorComp)&&(t.error=!0,u(!0))})),g=t(d,f);return c(g)&&(m(g)?o(t.resolved)&&g.then(d,f):m(g.component)&&(g.component.then(d,f),r(g.error)&&(t.errorComp=ze(g.error,e)),r(g.loading)&&(t.loadingComp=ze(g.loading,e),0===g.delay?t.loading=!0:h=setTimeout((function(){h=null,o(t.resolved)&&o(t.error)&&(t.loading=!0,u(!1))}),g.delay||200)),r(g.timeout)&&(l=setTimeout((function(){l=null,o(t.resolved)&&f(null)}),g.timeout)))),n=!1,t.loading?t.loadingComp:t.resolved}}function Xe(t){if(n(t))for(var e=0;e<t.length;e++){var i=t[e];if(r(i)&&(r(i.componentOptions)||Ae(i)))return i}}var Ge=1,Ye=2;function Ke(t,e,i,s,o,r){return(n(i)||l(i))&&(o=s,s=i,i=void 0),a(r)&&(o=Ye),Ue(t,e,i,s,o)}function Ue(t,e,i,s,o){if(r(i)&&r(i.__ob__))return xt();if(r(i)&&r(i.is)&&(e=i.is),!e)return xt();var a,h;if(n(s)&&u(s[0])&&(i=i||{},i.scopedSlots={default:s[0]},s.length=0),o===Ye?s=ae(s):o===Ge&&(s=re(s)),"string"===typeof e){var l=void 0;h=t.$vnode&&t.$vnode.ns||U.getTagNamespace(e),a=U.isReservedTag(e)?new vt(U.parsePlatformTagName(e),i,s,void 0,void 0,t):i&&i.pre||!r(l=Ps(t.$options,"components",e))?new vt(e,i,s,void 0,void 0,t):as(l,i,t,s,e)}else a=as(e,i,t,s);return n(a)?a:r(a)?(r(h)&&He(a,h),r(i)&&qe(i),a):xt()}function He(t,e,i){if(t.ns=e,"foreignObject"===t.tag&&(e=void 0,i=!0),r(t.children))for(var s=0,n=t.children.length;s<n;s++){var h=t.children[s];r(h.tag)&&(o(h.ns)||a(i)&&"svg"!==h.tag)&&He(h,e,i)}}function qe(t){c(t.style)&&gi(t.style),c(t.class)&&gi(t.class)}function We(t,e,i){At();try{if(e){var s=e;while(s=s.$parent){var n=s.$options.errorCaptured;if(n)for(var o=0;o<n.length;o++)try{var r=!1===n[o].call(s,t,e,i);if(r)return}catch(Qr){Je(Qr,s,"errorCaptured hook")}}}Je(t,e,i)}finally{Nt()}}function Ze(t,e,i,s,n){var o;try{o=i?t.apply(e,i):t.call(e),o&&!o._isVue&&m(o)&&!o._handled&&(o.catch((function(t){return We(t,s,n+" (Promise/async)")})),o._handled=!0)}catch(Qr){We(Qr,s,n)}return o}function Je(t,e,i){if(U.errorHandler)try{return U.errorHandler.call(null,t,e,i)}catch(Qr){Qr!==t&&Qe(Qr,null,"config.errorHandler")}Qe(t,e,i)}function Qe(t,e,i){if(!tt||"undefined"===typeof console)throw t;console.error(t)}var ti,ei=!1,ii=[],si=!1;function ni(){si=!1;var t=ii.slice(0);ii.length=0;for(var e=0;e<t.length;e++)t[e]()}if("undefined"!==typeof Promise&&ft(Promise)){var oi=Promise.resolve();ti=function(){oi.then(ni),ot&&setTimeout(I)},ei=!0}else if(it||"undefined"===typeof MutationObserver||!ft(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())ti="undefined"!==typeof setImmediate&&ft(setImmediate)?function(){setImmediate(ni)}:function(){setTimeout(ni,0)};else{var ri=1,ai=new MutationObserver(ni),hi=document.createTextNode(String(ri));ai.observe(hi,{characterData:!0}),ti=function(){ri=(ri+1)%2,hi.data=String(ri)},ei=!0}function li(t,e){var i;if(ii.push((function(){if(t)try{t.call(e)}catch(Qr){We(Qr,e,"nextTick")}else i&&i(e)})),si||(si=!0,ti()),!t&&"undefined"!==typeof Promise)return new Promise((function(t){i=t}))}function ui(t){return function(e,i){if(void 0===i&&(i=mt),i)return ci(i,t,e)}}function ci(t,e,i){var s=t.$options;s[e]=ms(s[e],i)}ui("beforeMount"),ui("mounted"),ui("beforeUpdate"),ui("updated"),ui("beforeDestroy"),ui("destroyed"),ui("activated"),ui("deactivated"),ui("serverPrefetch"),ui("renderTracked"),ui("renderTriggered"),ui("errorCaptured");var di="2.7.16";var fi=new gt;function gi(t){return pi(t,fi),fi.clear(),t}function pi(t,e){var i,s,o=n(t);if(!(!o&&!c(t)||t.__v_skip||Object.isFrozen(t)||t instanceof vt)){if(t.__ob__){var r=t.__ob__.dep.id;if(e.has(r))return;e.add(r)}if(o){i=t.length;while(i--)pi(t[i],e)}else if(Kt(t))pi(t.value,e);else{s=Object.keys(t),i=s.length;while(i--)pi(t[s[i]],e)}}}var mi,yi=0,vi=function(){function t(t,e,i,s,n){Zt(this,qt&&!qt._vm?qt:t?t._scope:void 0),(this.vm=t)&&n&&(t._watcher=this),s?(this.deep=!!s.deep,this.user=!!s.user,this.lazy=!!s.lazy,this.sync=!!s.sync,this.before=s.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=i,this.id=++yi,this.active=!0,this.post=!1,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new gt,this.newDepIds=new gt,this.expression="",u(e)?this.getter=e:(this.getter=J(e),this.getter||(this.getter=I)),this.value=this.lazy?void 0:this.get()}return t.prototype.get=function(){var t;At(this);var e=this.vm;try{t=this.getter.call(e,e)}catch(Qr){if(!this.user)throw Qr;We(Qr,e,'getter for watcher "'.concat(this.expression,'"'))}finally{this.deep&&gi(t),Nt(),this.cleanupDeps()}return t},t.prototype.addDep=function(t){var e=t.id;this.newDepIds.has(e)||(this.newDepIds.add(e),this.newDeps.push(t),this.depIds.has(e)||t.addSub(this))},t.prototype.cleanupDeps=function(){var t=this.deps.length;while(t--){var e=this.deps[t];this.newDepIds.has(e.id)||e.removeSub(this)}var i=this.depIds;this.depIds=this.newDepIds,this.newDepIds=i,this.newDepIds.clear(),i=this.deps,this.deps=this.newDeps,this.newDeps=i,this.newDeps.length=0},t.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():Wi(this)},t.prototype.run=function(){if(this.active){var t=this.get();if(t!==this.value||c(t)||this.deep){var e=this.value;if(this.value=t,this.user){var i='callback for watcher "'.concat(this.expression,'"');Ze(this.cb,this.vm,[t,e],this.vm,i)}else this.cb.call(this.vm,t,e)}}},t.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},t.prototype.depend=function(){var t=this.deps.length;while(t--)this.deps[t].depend()},t.prototype.teardown=function(){if(this.vm&&!this.vm._isBeingDestroyed&&k(this.vm._scope.effects,this),this.active){var t=this.deps.length;while(t--)this.deps[t].removeSub(this);this.active=!1,this.onStop&&this.onStop()}},t}();function xi(t){t._events=Object.create(null),t._hasHookEvent=!1;var e=t.$options._parentListeners;e&&Si(t,e)}function bi(t,e){mi.$on(t,e)}function wi(t,e){mi.$off(t,e)}function ki(t,e){var i=mi;return function s(){var n=e.apply(null,arguments);null!==n&&i.$off(t,s)}}function Si(t,e,i){mi=t,ie(e,i||{},bi,wi,ki,t),mi=void 0}function Pi(t){var e=/^hook:/;t.prototype.$on=function(t,i){var s=this;if(n(t))for(var o=0,r=t.length;o<r;o++)s.$on(t[o],i);else(s._events[t]||(s._events[t]=[])).push(i),e.test(t)&&(s._hasHookEvent=!0);return s},t.prototype.$once=function(t,e){var i=this;function s(){i.$off(t,s),e.apply(i,arguments)}return s.fn=e,i.$on(t,s),i},t.prototype.$off=function(t,e){var i=this;if(!arguments.length)return i._events=Object.create(null),i;if(n(t)){for(var s=0,o=t.length;s<o;s++)i.$off(t[s],e);return i}var r,a=i._events[t];if(!a)return i;if(!e)return i._events[t]=null,i;var h=a.length;while(h--)if(r=a[h],r===e||r.fn===e){a.splice(h,1);break}return i},t.prototype.$emit=function(t){var e=this,i=e._events[t];if(i){i=i.length>1?R(i):i;for(var s=R(arguments,1),n='event handler for "'.concat(t,'"'),o=0,r=i.length;o<r;o++)Ze(i[o],e,s,e,n)}return e}}var Mi=null;function Ci(t){var e=Mi;return Mi=t,function(){Mi=e}}function Ai(t){var e=t.$options,i=e.parent;if(i&&!e.abstract){while(i.$options.abstract&&i.$parent)i=i.$parent;i.$children.push(t)}t.$parent=i,t.$root=i?i.$root:t,t.$children=[],t.$refs={},t._provided=i?i._provided:Object.create(null),t._watcher=null,t._inactive=null,t._directInactive=!1,t._isMounted=!1,t._isDestroyed=!1,t._isBeingDestroyed=!1}function Ni(t){t.prototype._update=function(t,e){var i=this,s=i.$el,n=i._vnode,o=Ci(i);i._vnode=t,i.$el=n?i.__patch__(n,t):i.__patch__(i.$el,t,e,!1),o(),s&&(s.__vue__=null),i.$el&&(i.$el.__vue__=i);var r=i;while(r&&r.$vnode&&r.$parent&&r.$vnode===r.$parent._vnode)r.$parent.$el=r.$el,r=r.$parent},t.prototype.$forceUpdate=function(){var t=this;t._watcher&&t._watcher.update()},t.prototype.$destroy=function(){var t=this;if(!t._isBeingDestroyed){Ri(t,"beforeDestroy"),t._isBeingDestroyed=!0;var e=t.$parent;!e||e._isBeingDestroyed||t.$options.abstract||k(e.$children,t),t._scope.stop(),t._data.__ob__&&t._data.__ob__.vmCount--,t._isDestroyed=!0,t.__patch__(t._vnode,null),Ri(t,"destroyed"),t.$off(),t.$el&&(t.$el.__vue__=null),t.$vnode&&(t.$vnode.parent=null)}}}function Li(t,e,i){var s;t.$el=e,t.$options.render||(t.$options.render=xt),Ri(t,"beforeMount"),s=function(){t._update(t._render(),i)};var n={before:function(){t._isMounted&&!t._isDestroyed&&Ri(t,"beforeUpdate")}};new vi(t,s,I,n,!0),i=!1;var o=t._preWatchers;if(o)for(var r=0;r<o.length;r++)o[r].run();return null==t.$vnode&&(t._isMounted=!0,Ri(t,"mounted")),t}function Ti(t,e,i,n,o){var r=n.data.scopedSlots,a=t.$scopedSlots,h=!!(r&&!r.$stable||a!==s&&!a.$stable||r&&t.$scopedSlots.$key!==r.$key||!r&&t.$scopedSlots.$key),l=!!(o||t.$options._renderChildren||h),u=t.$vnode;t.$options._parentVnode=n,t.$vnode=n,t._vnode&&(t._vnode.parent=n),t.$options._renderChildren=o;var c=n.data.attrs||s;t._attrsProxy&&Fe(t._attrsProxy,c,u.data&&u.data.attrs||s,t,"$attrs")&&(l=!0),t.$attrs=c,i=i||s;var d=t.$options._parentListeners;if(t._listenersProxy&&Fe(t._listenersProxy,i,d||s,t,"$listeners"),t.$listeners=t.$options._parentListeners=i,Si(t,i,d),e&&t.$options.props){Et(!1);for(var f=t._props,g=t.$options._propKeys||[],p=0;p<g.length;p++){var m=g[p],y=t.$options.props;f[m]=Ms(m,y,e,t)}Et(!0),t.$options.propsData=e}l&&(t.$slots=Me(o,n.context),t.$forceUpdate())}function Di(t){while(t&&(t=t.$parent))if(t._inactive)return!0;return!1}function Oi(t,e){if(e){if(t._directInactive=!1,Di(t))return}else if(t._directInactive)return;if(t._inactive||null===t._inactive){t._inactive=!1;for(var i=0;i<t.$children.length;i++)Oi(t.$children[i]);Ri(t,"activated")}}function Fi(t,e){if((!e||(t._directInactive=!0,!Di(t)))&&!t._inactive){t._inactive=!0;for(var i=0;i<t.$children.length;i++)Fi(t.$children[i]);Ri(t,"deactivated")}}function Ri(t,e,i,s){void 0===s&&(s=!0),At();var n=mt,o=Jt();s&&yt(t);var r=t.$options[e],a="".concat(e," hook");if(r)for(var h=0,l=r.length;h<l;h++)Ze(r[h],t,i||null,t,a);t._hasHookEvent&&t.$emit("hook:"+e),s&&(yt(n),o&&o.on()),Nt()}var Ei=[],Bi=[],Ii={},_i=!1,Vi=!1,zi=0;function ji(){zi=Ei.length=Bi.length=0,Ii={},_i=Vi=!1}var $i=0,Xi=Date.now;if(tt&&!it){var Gi=window.performance;Gi&&"function"===typeof Gi.now&&Xi()>document.createEvent("Event").timeStamp&&(Xi=function(){return Gi.now()})}var Yi=function(t,e){if(t.post){if(!e.post)return 1}else if(e.post)return-1;return t.id-e.id};function Ki(){var t,e;for($i=Xi(),Vi=!0,Ei.sort(Yi),zi=0;zi<Ei.length;zi++)t=Ei[zi],t.before&&t.before(),e=t.id,Ii[e]=null,t.run();var i=Bi.slice(),s=Ei.slice();ji(),qi(i),Ui(s),Pt(),dt&&U.devtools&&dt.emit("flush")}function Ui(t){var e=t.length;while(e--){var i=t[e],s=i.vm;s&&s._watcher===i&&s._isMounted&&!s._isDestroyed&&Ri(s,"updated")}}function Hi(t){t._inactive=!1,Bi.push(t)}function qi(t){for(var e=0;e<t.length;e++)t[e]._inactive=!0,Oi(t[e],!0)}function Wi(t){var e=t.id;if(null==Ii[e]&&(t!==Mt.target||!t.noRecurse)){if(Ii[e]=!0,Vi){var i=Ei.length-1;while(i>zi&&Ei[i].id>t.id)i--;Ei.splice(i+1,0,t)}else Ei.push(t);_i||(_i=!0,li(Ki))}}function Zi(t){var e=t.$options.provide;if(e){var i=u(e)?e.call(t):e;if(!c(i))return;for(var s=Qt(t),n=pt?Reflect.ownKeys(i):Object.keys(i),o=0;o<n.length;o++){var r=n[o];Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(i,r))}}}function Ji(t){var e=Qi(t.$options.inject,t);e&&(Et(!1),Object.keys(e).forEach((function(i){Vt(t,i,e[i])})),Et(!0))}function Qi(t,e){if(t){for(var i=Object.create(null),s=pt?Reflect.ownKeys(t):Object.keys(t),n=0;n<s.length;n++){var o=s[n];if("__ob__"!==o){var r=t[o].from;if(r in e._provided)i[o]=e._provided[r];else if("default"in t[o]){var a=t[o].default;i[o]=u(a)?a.call(e):a}else 0}}return i}}function ts(t,e,i,o,r){var h,l=this,u=r.options;P(o,"_uid")?(h=Object.create(o),h._original=o):(h=o,o=o._original);var c=a(u._compiled),d=!c;this.data=t,this.props=e,this.children=i,this.parent=o,this.listeners=t.on||s,this.injections=Qi(u.inject,o),this.slots=function(){return l.$slots||Ne(o,t.scopedSlots,l.$slots=Me(i,o)),l.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return Ne(o,t.scopedSlots,this.slots())}}),c&&(this.$options=u,this.$slots=this.slots(),this.$scopedSlots=Ne(o,t.scopedSlots,this.$slots)),u._scopeId?this._c=function(t,e,i,s){var r=Ke(h,t,e,i,s,d);return r&&!n(r)&&(r.fnScopeId=u._scopeId,r.fnContext=o),r}:this._c=function(t,e,i,s){return Ke(h,t,e,i,s,d)}}function es(t,e,i,o,a){var h=t.options,l={},u=h.props;if(r(u))for(var c in u)l[c]=Ms(c,u,e||s);else r(i.attrs)&&ss(l,i.attrs),r(i.props)&&ss(l,i.props);var d=new ts(i,l,a,o,t),f=h.render.call(null,d._c,d);if(f instanceof vt)return is(f,i,d.parent,h,d);if(n(f)){for(var g=ae(f)||[],p=new Array(g.length),m=0;m<g.length;m++)p[m]=is(g[m],i,d.parent,h,d);return p}}function is(t,e,i,s,n){var o=wt(t);return o.fnContext=i,o.fnOptions=s,e.slot&&((o.data||(o.data={})).slot=e.slot),o}function ss(t,e){for(var i in e)t[A(i)]=e[i]}function ns(t){return t.name||t.__name||t._componentTag}Pe(ts.prototype);var os={init:function(t,e){if(t.componentInstance&&!t.componentInstance._isDestroyed&&t.data.keepAlive){var i=t;os.prepatch(i,i)}else{var s=t.componentInstance=hs(t,Mi);s.$mount(e?t.elm:void 0,e)}},prepatch:function(t,e){var i=e.componentOptions,s=e.componentInstance=t.componentInstance;Ti(s,i.propsData,i.listeners,e,i.children)},insert:function(t){var e=t.context,i=t.componentInstance;i._isMounted||(i._isMounted=!0,Ri(i,"mounted")),t.data.keepAlive&&(e._isMounted?Hi(i):Oi(i,!0))},destroy:function(t){var e=t.componentInstance;e._isDestroyed||(t.data.keepAlive?Fi(e,!0):e.$destroy())}},rs=Object.keys(os);function as(t,e,i,s,n){if(!o(t)){var h=i.$options._base;if(c(t)&&(t=h.extend(t)),"function"===typeof t){var l;if(o(t.cid)&&(l=t,t=$e(l,h),void 0===t))return je(l,e,i,s,n);e=e||{},qs(t),r(e.model)&&cs(t.options,e);var u=ne(e,t,n);if(a(t.options.functional))return es(t,u,e,i,s);var d=e.on;if(e.on=e.nativeOn,a(t.options.abstract)){var f=e.slot;e={},f&&(e.slot=f)}ls(e);var g=ns(t.options)||n,p=new vt("vue-component-".concat(t.cid).concat(g?"-".concat(g):""),e,void 0,void 0,void 0,i,{Ctor:t,propsData:u,listeners:d,tag:n,children:s},l);return p}}}function hs(t,e){var i={_isComponent:!0,_parentVnode:t,parent:e},s=t.data.inlineTemplate;return r(s)&&(i.render=s.render,i.staticRenderFns=s.staticRenderFns),new t.componentOptions.Ctor(i)}function ls(t){for(var e=t.hook||(t.hook={}),i=0;i<rs.length;i++){var s=rs[i],n=e[s],o=os[s];n===o||n&&n._merged||(e[s]=n?us(o,n):o)}}function us(t,e){var i=function(i,s){t(i,s),e(i,s)};return i._merged=!0,i}function cs(t,e){var i=t.model&&t.model.prop||"value",s=t.model&&t.model.event||"input";(e.attrs||(e.attrs={}))[i]=e.model.value;var o=e.on||(e.on={}),a=o[s],h=e.model.callback;r(a)?(n(a)?-1===a.indexOf(h):a!==h)&&(o[s]=[h].concat(a)):o[s]=h}var ds=I,fs=U.optionMergeStrategies;function gs(t,e,i){if(void 0===i&&(i=!0),!e)return t;for(var s,n,o,r=pt?Reflect.ownKeys(e):Object.keys(e),a=0;a<r.length;a++)s=r[a],"__ob__"!==s&&(n=t[s],o=e[s],i&&P(t,s)?n!==o&&f(n)&&f(o)&&gs(n,o):zt(t,s,o));return t}function ps(t,e,i){return i?function(){var s=u(e)?e.call(i,i):e,n=u(t)?t.call(i,i):t;return s?gs(s,n):n}:e?t?function(){return gs(u(e)?e.call(this,this):e,u(t)?t.call(this,this):t)}:e:t}function ms(t,e){var i=e?t?t.concat(e):n(e)?e:[e]:t;return i?ys(i):i}function ys(t){for(var e=[],i=0;i<t.length;i++)-1===e.indexOf(t[i])&&e.push(t[i]);return e}function vs(t,e,i,s){var n=Object.create(t||null);return e?E(n,e):n}fs.data=function(t,e,i){return i?ps(t,e,i):e&&"function"!==typeof e?t:ps(t,e)},K.forEach((function(t){fs[t]=ms})),Y.forEach((function(t){fs[t+"s"]=vs})),fs.watch=function(t,e,i,s){if(t===ht&&(t=void 0),e===ht&&(e=void 0),!e)return Object.create(t||null);if(!t)return e;var o={};for(var r in E(o,t),e){var a=o[r],h=e[r];a&&!n(a)&&(a=[a]),o[r]=a?a.concat(h):n(h)?h:[h]}return o},fs.props=fs.methods=fs.inject=fs.computed=function(t,e,i,s){if(!t)return e;var n=Object.create(null);return E(n,t),e&&E(n,e),n},fs.provide=function(t,e){return t?function(){var i=Object.create(null);return gs(i,u(t)?t.call(this):t),e&&gs(i,u(e)?e.call(this):e,!1),i}:e};var xs=function(t,e){return void 0===e?t:e};function bs(t,e){var i=t.props;if(i){var s,o,r,a={};if(n(i)){s=i.length;while(s--)o=i[s],"string"===typeof o&&(r=A(o),a[r]={type:null})}else if(f(i))for(var h in i)o=i[h],r=A(h),a[r]=f(o)?o:{type:o};else 0;t.props=a}}function ws(t,e){var i=t.inject;if(i){var s=t.inject={};if(n(i))for(var o=0;o<i.length;o++)s[i[o]]={from:i[o]};else if(f(i))for(var r in i){var a=i[r];s[r]=f(a)?E({from:r},a):{from:a}}else 0}}function ks(t){var e=t.directives;if(e)for(var i in e){var s=e[i];u(s)&&(e[i]={bind:s,update:s})}}function Ss(t,e,i){if(u(e)&&(e=e.options),bs(e,i),ws(e,i),ks(e),!e._base&&(e.extends&&(t=Ss(t,e.extends,i)),e.mixins))for(var s=0,n=e.mixins.length;s<n;s++)t=Ss(t,e.mixins[s],i);var o,r={};for(o in t)a(o);for(o in e)P(t,o)||a(o);function a(s){var n=fs[s]||xs;r[s]=n(t[s],e[s],i,s)}return r}function Ps(t,e,i,s){if("string"===typeof i){var n=t[e];if(P(n,i))return n[i];var o=A(i);if(P(n,o))return n[o];var r=N(o);if(P(n,r))return n[r];var a=n[i]||n[o]||n[r];return a}}function Ms(t,e,i,s){var n=e[t],o=!P(i,t),r=i[t],a=Ts(Boolean,n.type);if(a>-1)if(o&&!P(n,"default"))r=!1;else if(""===r||r===T(t)){var h=Ts(String,n.type);(h<0||a<h)&&(r=!0)}if(void 0===r){r=Cs(s,n,t);var l=Rt;Et(!0),_t(r),Et(l)}return r}function Cs(t,e,i){if(P(e,"default")){var s=e.default;return t&&t.$options.propsData&&void 0===t.$options.propsData[i]&&void 0!==t._props[i]?t._props[i]:u(s)&&"Function"!==Ns(e.type)?s.call(t):s}}var As=/^\s*function (\w+)/;function Ns(t){var e=t&&t.toString().match(As);return e?e[1]:""}function Ls(t,e){return Ns(t)===Ns(e)}function Ts(t,e){if(!n(e))return Ls(e,t)?0:-1;for(var i=0,s=e.length;i<s;i++)if(Ls(e[i],t))return i;return-1}var Ds={enumerable:!0,configurable:!0,get:I,set:I};function Os(t,e,i){Ds.get=function(){return this[e][i]},Ds.set=function(t){this[e][i]=t},Object.defineProperty(t,i,Ds)}function Fs(t){var e=t.$options;if(e.props&&Rs(t,e.props),De(t),e.methods&&$s(t,e.methods),e.data)Es(t);else{var i=_t(t._data={});i&&i.vmCount++}e.computed&&_s(t,e.computed),e.watch&&e.watch!==ht&&Xs(t,e.watch)}function Rs(t,e){var i=t.$options.propsData||{},s=t._props=Xt({}),n=t.$options._propKeys=[],o=!t.$parent;o||Et(!1);var r=function(o){n.push(o);var r=Ms(o,e,i,t);Vt(s,o,r,void 0,!0),o in t||Os(t,"_props",o)};for(var a in e)r(a);Et(!0)}function Es(t){var e=t.$options.data;e=t._data=u(e)?Bs(e,t):e||{},f(e)||(e={});var i=Object.keys(e),s=t.$options.props,n=(t.$options.methods,i.length);while(n--){var o=i[n];0,s&&P(s,o)||q(o)||Os(t,"_data",o)}var r=_t(e);r&&r.vmCount++}function Bs(t,e){At();try{return t.call(e,e)}catch(Qr){return We(Qr,e,"data()"),{}}finally{Nt()}}var Is={lazy:!0};function _s(t,e){var i=t._computedWatchers=Object.create(null),s=ct();for(var n in e){var o=e[n],r=u(o)?o:o.get;0,s||(i[n]=new vi(t,r||I,I,Is)),n in t||Vs(t,n,o)}}function Vs(t,e,i){var s=!ct();u(i)?(Ds.get=s?zs(e):js(i),Ds.set=I):(Ds.get=i.get?s&&!1!==i.cache?zs(e):js(i.get):I,Ds.set=i.set||I),Object.defineProperty(t,e,Ds)}function zs(t){return function(){var e=this._computedWatchers&&this._computedWatchers[t];if(e)return e.dirty&&e.evaluate(),Mt.target&&e.depend(),e.value}}function js(t){return function(){return t.call(this,this)}}function $s(t,e){t.$options.props;for(var i in e)t[i]="function"!==typeof e[i]?I:F(e[i],t)}function Xs(t,e){for(var i in e){var s=e[i];if(n(s))for(var o=0;o<s.length;o++)Gs(t,i,s[o]);else Gs(t,i,s)}}function Gs(t,e,i,s){return f(i)&&(s=i,i=i.handler),"string"===typeof i&&(i=t[i]),t.$watch(e,i,s)}function Ys(t){var e={get:function(){return this._data}},i={get:function(){return this._props}};Object.defineProperty(t.prototype,"$data",e),Object.defineProperty(t.prototype,"$props",i),t.prototype.$set=zt,t.prototype.$delete=jt,t.prototype.$watch=function(t,e,i){var s=this;if(f(e))return Gs(s,t,e,i);i=i||{},i.user=!0;var n=new vi(s,t,e,i);if(i.immediate){var o='callback for immediate watcher "'.concat(n.expression,'"');At(),Ze(e,s,[n.value],s,o),Nt()}return function(){n.teardown()}}}var Ks=0;function Us(t){t.prototype._init=function(t){var e=this;e._uid=Ks++,e._isVue=!0,e.__v_skip=!0,e._scope=new Wt(!0),e._scope.parent=void 0,e._scope._vm=!0,t&&t._isComponent?Hs(e,t):e.$options=Ss(qs(e.constructor),t||{},e),e._renderProxy=e,e._self=e,Ai(e),xi(e),Ie(e),Ri(e,"beforeCreate",void 0,!1),Ji(e),Fs(e),Zi(e),Ri(e,"created"),e.$options.el&&e.$mount(e.$options.el)}}function Hs(t,e){var i=t.$options=Object.create(t.constructor.options),s=e._parentVnode;i.parent=e.parent,i._parentVnode=s;var n=s.componentOptions;i.propsData=n.propsData,i._parentListeners=n.listeners,i._renderChildren=n.children,i._componentTag=n.tag,e.render&&(i.render=e.render,i.staticRenderFns=e.staticRenderFns)}function qs(t){var e=t.options;if(t.super){var i=qs(t.super),s=t.superOptions;if(i!==s){t.superOptions=i;var n=Ws(t);n&&E(t.extendOptions,n),e=t.options=Ss(i,t.extendOptions),e.name&&(e.components[e.name]=t)}}return e}function Ws(t){var e,i=t.options,s=t.sealedOptions;for(var n in i)i[n]!==s[n]&&(e||(e={}),e[n]=i[n]);return e}function Zs(t){this._init(t)}function Js(t){t.use=function(t){var e=this._installedPlugins||(this._installedPlugins=[]);if(e.indexOf(t)>-1)return this;var i=R(arguments,1);return i.unshift(this),u(t.install)?t.install.apply(t,i):u(t)&&t.apply(null,i),e.push(t),this}}function Qs(t){t.mixin=function(t){return this.options=Ss(this.options,t),this}}function tn(t){t.cid=0;var e=1;t.extend=function(t){t=t||{};var i=this,s=i.cid,n=t._Ctor||(t._Ctor={});if(n[s])return n[s];var o=ns(t)||ns(i.options);var r=function(t){this._init(t)};return r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.cid=e++,r.options=Ss(i.options,t),r["super"]=i,r.options.props&&en(r),r.options.computed&&sn(r),r.extend=i.extend,r.mixin=i.mixin,r.use=i.use,Y.forEach((function(t){r[t]=i[t]})),o&&(r.options.components[o]=r),r.superOptions=i.options,r.extendOptions=t,r.sealedOptions=E({},r.options),n[s]=r,r}}function en(t){var e=t.options.props;for(var i in e)Os(t.prototype,"_props",i)}function sn(t){var e=t.options.computed;for(var i in e)Vs(t.prototype,i,e[i])}function nn(t){Y.forEach((function(e){t[e]=function(t,i){return i?("component"===e&&f(i)&&(i.name=i.name||t,i=this.options._base.extend(i)),"directive"===e&&u(i)&&(i={bind:i,update:i}),this.options[e+"s"][t]=i,i):this.options[e+"s"][t]}}))}function on(t){return t&&(ns(t.Ctor.options)||t.tag)}function rn(t,e){return n(t)?t.indexOf(e)>-1:"string"===typeof t?t.split(",").indexOf(e)>-1:!!g(t)&&t.test(e)}function an(t,e){var i=t.cache,s=t.keys,n=t._vnode,o=t.$vnode;for(var r in i){var a=i[r];if(a){var h=a.name;h&&!e(h)&&hn(i,r,s,n)}}o.componentOptions.children=void 0}function hn(t,e,i,s){var n=t[e];!n||s&&n.tag===s.tag||n.componentInstance.$destroy(),t[e]=null,k(i,e)}Us(Zs),Ys(Zs),Pi(Zs),Ni(Zs),Ve(Zs);var ln=[String,RegExp,Array],un={name:"keep-alive",abstract:!0,props:{include:ln,exclude:ln,max:[String,Number]},methods:{cacheVNode:function(){var t=this,e=t.cache,i=t.keys,s=t.vnodeToCache,n=t.keyToCache;if(s){var o=s.tag,r=s.componentInstance,a=s.componentOptions;e[n]={name:on(a),tag:o,componentInstance:r},i.push(n),this.max&&i.length>parseInt(this.max)&&hn(e,i[0],i,this._vnode),this.vnodeToCache=null}}},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var t in this.cache)hn(this.cache,t,this.keys)},mounted:function(){var t=this;this.cacheVNode(),this.$watch("include",(function(e){an(t,(function(t){return rn(e,t)}))})),this.$watch("exclude",(function(e){an(t,(function(t){return!rn(e,t)}))}))},updated:function(){this.cacheVNode()},render:function(){var t=this.$slots.default,e=Xe(t),i=e&&e.componentOptions;if(i){var s=on(i),n=this,o=n.include,r=n.exclude;if(o&&(!s||!rn(o,s))||r&&s&&rn(r,s))return e;var a=this,h=a.cache,l=a.keys,u=null==e.key?i.Ctor.cid+(i.tag?"::".concat(i.tag):""):e.key;h[u]?(e.componentInstance=h[u].componentInstance,k(l,u),l.push(u)):(this.vnodeToCache=e,this.keyToCache=u),e.data.keepAlive=!0}return e||t&&t[0]}},cn={KeepAlive:un};function dn(t){var e={get:function(){return U}};Object.defineProperty(t,"config",e),t.util={warn:ds,extend:E,mergeOptions:Ss,defineReactive:Vt},t.set=zt,t.delete=jt,t.nextTick=li,t.observable=function(t){return _t(t),t},t.options=Object.create(null),Y.forEach((function(e){t.options[e+"s"]=Object.create(null)})),t.options._base=t,E(t.options.components,cn),Js(t),Qs(t),tn(t),nn(t)}dn(Zs),Object.defineProperty(Zs.prototype,"$isServer",{get:ct}),Object.defineProperty(Zs.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(Zs,"FunctionalRenderContext",{value:ts}),Zs.version=di;var fn=b("style,class"),gn=b("input,textarea,option,select,progress"),pn=function(t,e,i){return"value"===i&&gn(t)&&"button"!==e||"selected"===i&&"option"===t||"checked"===i&&"input"===t||"muted"===i&&"video"===t},mn=b("contenteditable,draggable,spellcheck"),yn=b("events,caret,typing,plaintext-only"),vn=function(t,e){return Sn(e)||"false"===e?"false":"contenteditable"===t&&yn(e)?e:"true"},xn=b("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,truespeed,typemustmatch,visible"),bn="http://www.w3.org/1999/xlink",wn=function(t){return":"===t.charAt(5)&&"xlink"===t.slice(0,5)},kn=function(t){return wn(t)?t.slice(6,t.length):""},Sn=function(t){return null==t||!1===t};function Pn(t){var e=t.data,i=t,s=t;while(r(s.componentInstance))s=s.componentInstance._vnode,s&&s.data&&(e=Mn(s.data,e));while(r(i=i.parent))i&&i.data&&(e=Mn(e,i.data));return Cn(e.staticClass,e.class)}function Mn(t,e){return{staticClass:An(t.staticClass,e.staticClass),class:r(t.class)?[t.class,e.class]:e.class}}function Cn(t,e){return r(t)||r(e)?An(t,Nn(e)):""}function An(t,e){return t?e?t+" "+e:t:e||""}function Nn(t){return Array.isArray(t)?Ln(t):c(t)?Tn(t):"string"===typeof t?t:""}function Ln(t){for(var e,i="",s=0,n=t.length;s<n;s++)r(e=Nn(t[s]))&&""!==e&&(i&&(i+=" "),i+=e);return i}function Tn(t){var e="";for(var i in t)t[i]&&(e&&(e+=" "),e+=i);return e}var Dn={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},On=b("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),Fn=b("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignobject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),Rn=function(t){return On(t)||Fn(t)};function En(t){return Fn(t)?"svg":"math"===t?"math":void 0}var Bn=Object.create(null);function In(t){if(!tt)return!0;if(Rn(t))return!1;if(t=t.toLowerCase(),null!=Bn[t])return Bn[t];var e=document.createElement(t);return t.indexOf("-")>-1?Bn[t]=e.constructor===window.HTMLUnknownElement||e.constructor===window.HTMLElement:Bn[t]=/HTMLUnknownElement/.test(e.toString())}var _n=b("text,number,password,search,email,tel,url");function Vn(t){if("string"===typeof t){var e=document.querySelector(t);return e||document.createElement("div")}return t}function zn(t,e){var i=document.createElement(t);return"select"!==t||e.data&&e.data.attrs&&void 0!==e.data.attrs.multiple&&i.setAttribute("multiple","multiple"),i}function jn(t,e){return document.createElementNS(Dn[t],e)}function $n(t){return document.createTextNode(t)}function Xn(t){return document.createComment(t)}function Gn(t,e,i){t.insertBefore(e,i)}function Yn(t,e){t.removeChild(e)}function Kn(t,e){t.appendChild(e)}function Un(t){return t.parentNode}function Hn(t){return t.nextSibling}function qn(t){return t.tagName}function Wn(t,e){t.textContent=e}function Zn(t,e){t.setAttribute(e,"")}var Jn=Object.freeze({__proto__:null,createElement:zn,createElementNS:jn,createTextNode:$n,createComment:Xn,insertBefore:Gn,removeChild:Yn,appendChild:Kn,parentNode:Un,nextSibling:Hn,tagName:qn,setTextContent:Wn,setStyleScope:Zn}),Qn={create:function(t,e){to(e)},update:function(t,e){t.data.ref!==e.data.ref&&(to(t,!0),to(e))},destroy:function(t){to(t,!0)}};function to(t,e){var i=t.data.ref;if(r(i)){var s=t.context,o=t.componentInstance||t.elm,a=e?null:o,h=e?void 0:o;if(u(i))Ze(i,s,[a],s,"template ref function");else{var l=t.data.refInFor,c="string"===typeof i||"number"===typeof i,d=Kt(i),f=s.$refs;if(c||d)if(l){var g=c?f[i]:i.value;e?n(g)&&k(g,o):n(g)?g.includes(o)||g.push(o):c?(f[i]=[o],eo(s,i,f[i])):i.value=[o]}else if(c){if(e&&f[i]!==o)return;f[i]=h,eo(s,i,a)}else if(d){if(e&&i.value!==o)return;i.value=a}else 0}}}function eo(t,e,i){var s=t._setupState;s&&P(s,e)&&(Kt(s[e])?s[e].value=i:s[e]=i)}var io=new vt("",{},[]),so=["create","activate","update","remove","destroy"];function no(t,e){return t.key===e.key&&t.asyncFactory===e.asyncFactory&&(t.tag===e.tag&&t.isComment===e.isComment&&r(t.data)===r(e.data)&&oo(t,e)||a(t.isAsyncPlaceholder)&&o(e.asyncFactory.error))}function oo(t,e){if("input"!==t.tag)return!0;var i,s=r(i=t.data)&&r(i=i.attrs)&&i.type,n=r(i=e.data)&&r(i=i.attrs)&&i.type;return s===n||_n(s)&&_n(n)}function ro(t,e,i){var s,n,o={};for(s=e;s<=i;++s)n=t[s].key,r(n)&&(o[n]=s);return o}function ao(t){var e,i,s={},h=t.modules,u=t.nodeOps;for(e=0;e<so.length;++e)for(s[so[e]]=[],i=0;i<h.length;++i)r(h[i][so[e]])&&s[so[e]].push(h[i][so[e]]);function c(t){return new vt(u.tagName(t).toLowerCase(),{},[],void 0,t)}function d(t,e){function i(){0===--i.listeners&&f(t)}return i.listeners=e,i}function f(t){var e=u.parentNode(t);r(e)&&u.removeChild(e,t)}function g(t,e,i,s,n,o,h){if(r(t.elm)&&r(o)&&(t=o[h]=wt(t)),t.isRootInsert=!n,!p(t,e,i,s)){var l=t.data,c=t.children,d=t.tag;r(d)?(t.elm=t.ns?u.createElementNS(t.ns,d):u.createElement(d,t),S(t),x(t,c,e),r(l)&&k(t,e),v(i,t.elm,s)):a(t.isComment)?(t.elm=u.createComment(t.text),v(i,t.elm,s)):(t.elm=u.createTextNode(t.text),v(i,t.elm,s))}}function p(t,e,i,s){var n=t.data;if(r(n)){var o=r(t.componentInstance)&&n.keepAlive;if(r(n=n.hook)&&r(n=n.init)&&n(t,!1),r(t.componentInstance))return m(t,e),v(i,t.elm,s),a(o)&&y(t,e,i,s),!0}}function m(t,e){r(t.data.pendingInsert)&&(e.push.apply(e,t.data.pendingInsert),t.data.pendingInsert=null),t.elm=t.componentInstance.$el,w(t)?(k(t,e),S(t)):(to(t),e.push(t))}function y(t,e,i,n){var o,a=t;while(a.componentInstance)if(a=a.componentInstance._vnode,r(o=a.data)&&r(o=o.transition)){for(o=0;o<s.activate.length;++o)s.activate[o](io,a);e.push(a);break}v(i,t.elm,n)}function v(t,e,i){r(t)&&(r(i)?u.parentNode(i)===t&&u.insertBefore(t,e,i):u.appendChild(t,e))}function x(t,e,i){if(n(e)){0;for(var s=0;s<e.length;++s)g(e[s],i,t.elm,null,!0,e,s)}else l(t.text)&&u.appendChild(t.elm,u.createTextNode(String(t.text)))}function w(t){while(t.componentInstance)t=t.componentInstance._vnode;return r(t.tag)}function k(t,i){for(var n=0;n<s.create.length;++n)s.create[n](io,t);e=t.data.hook,r(e)&&(r(e.create)&&e.create(io,t),r(e.insert)&&i.push(t))}function S(t){var e;if(r(e=t.fnScopeId))u.setStyleScope(t.elm,e);else{var i=t;while(i)r(e=i.context)&&r(e=e.$options._scopeId)&&u.setStyleScope(t.elm,e),i=i.parent}r(e=Mi)&&e!==t.context&&e!==t.fnContext&&r(e=e.$options._scopeId)&&u.setStyleScope(t.elm,e)}function P(t,e,i,s,n,o){for(;s<=n;++s)g(i[s],o,t,e,!1,i,s)}function M(t){var e,i,n=t.data;if(r(n))for(r(e=n.hook)&&r(e=e.destroy)&&e(t),e=0;e<s.destroy.length;++e)s.destroy[e](t);if(r(e=t.children))for(i=0;i<t.children.length;++i)M(t.children[i])}function C(t,e,i){for(;e<=i;++e){var s=t[e];r(s)&&(r(s.tag)?(A(s),M(s)):f(s.elm))}}function A(t,e){if(r(e)||r(t.data)){var i,n=s.remove.length+1;for(r(e)?e.listeners+=n:e=d(t.elm,n),r(i=t.componentInstance)&&r(i=i._vnode)&&r(i.data)&&A(i,e),i=0;i<s.remove.length;++i)s.remove[i](t,e);r(i=t.data.hook)&&r(i=i.remove)?i(t,e):e()}else f(t.elm)}function N(t,e,i,s,n){var a,h,l,c,d=0,f=0,p=e.length-1,m=e[0],y=e[p],v=i.length-1,x=i[0],b=i[v],w=!n;while(d<=p&&f<=v)o(m)?m=e[++d]:o(y)?y=e[--p]:no(m,x)?(T(m,x,s,i,f),m=e[++d],x=i[++f]):no(y,b)?(T(y,b,s,i,v),y=e[--p],b=i[--v]):no(m,b)?(T(m,b,s,i,v),w&&u.insertBefore(t,m.elm,u.nextSibling(y.elm)),m=e[++d],b=i[--v]):no(y,x)?(T(y,x,s,i,f),w&&u.insertBefore(t,y.elm,m.elm),y=e[--p],x=i[++f]):(o(a)&&(a=ro(e,d,p)),h=r(x.key)?a[x.key]:L(x,e,d,p),o(h)?g(x,s,t,m.elm,!1,i,f):(l=e[h],no(l,x)?(T(l,x,s,i,f),e[h]=void 0,w&&u.insertBefore(t,l.elm,m.elm)):g(x,s,t,m.elm,!1,i,f)),x=i[++f]);d>p?(c=o(i[v+1])?null:i[v+1].elm,P(t,c,i,f,v,s)):f>v&&C(e,d,p)}function L(t,e,i,s){for(var n=i;n<s;n++){var o=e[n];if(r(o)&&no(t,o))return n}}function T(t,e,i,n,h,l){if(t!==e){r(e.elm)&&r(n)&&(e=n[h]=wt(e));var c=e.elm=t.elm;if(a(t.isAsyncPlaceholder))r(e.asyncFactory.resolved)?F(t.elm,e,i):e.isAsyncPlaceholder=!0;else if(a(e.isStatic)&&a(t.isStatic)&&e.key===t.key&&(a(e.isCloned)||a(e.isOnce)))e.componentInstance=t.componentInstance;else{var d,f=e.data;r(f)&&r(d=f.hook)&&r(d=d.prepatch)&&d(t,e);var g=t.children,p=e.children;if(r(f)&&w(e)){for(d=0;d<s.update.length;++d)s.update[d](t,e);r(d=f.hook)&&r(d=d.update)&&d(t,e)}o(e.text)?r(g)&&r(p)?g!==p&&N(c,g,p,i,l):r(p)?(r(t.text)&&u.setTextContent(c,""),P(c,null,p,0,p.length-1,i)):r(g)?C(g,0,g.length-1):r(t.text)&&u.setTextContent(c,""):t.text!==e.text&&u.setTextContent(c,e.text),r(f)&&r(d=f.hook)&&r(d=d.postpatch)&&d(t,e)}}}function D(t,e,i){if(a(i)&&r(t.parent))t.parent.data.pendingInsert=e;else for(var s=0;s<e.length;++s)e[s].data.hook.insert(e[s])}var O=b("attrs,class,staticClass,staticStyle,key");function F(t,e,i,s){var n,o=e.tag,h=e.data,l=e.children;if(s=s||h&&h.pre,e.elm=t,a(e.isComment)&&r(e.asyncFactory))return e.isAsyncPlaceholder=!0,!0;if(r(h)&&(r(n=h.hook)&&r(n=n.init)&&n(e,!0),r(n=e.componentInstance)))return m(e,i),!0;if(r(o)){if(r(l))if(t.hasChildNodes())if(r(n=h)&&r(n=n.domProps)&&r(n=n.innerHTML)){if(n!==t.innerHTML)return!1}else{for(var u=!0,c=t.firstChild,d=0;d<l.length;d++){if(!c||!F(c,l[d],i,s)){u=!1;break}c=c.nextSibling}if(!u||c)return!1}else x(e,l,i);if(r(h)){var f=!1;for(var g in h)if(!O(g)){f=!0,k(e,i);break}!f&&h["class"]&&gi(h["class"])}}else t.data!==e.text&&(t.data=e.text);return!0}return function(t,e,i,n){if(!o(e)){var h=!1,l=[];if(o(t))h=!0,g(e,l);else{var d=r(t.nodeType);if(!d&&no(t,e))T(t,e,l,null,null,n);else{if(d){if(1===t.nodeType&&t.hasAttribute(G)&&(t.removeAttribute(G),i=!0),a(i)&&F(t,e,l))return D(e,l,!0),t;t=c(t)}var f=t.elm,p=u.parentNode(f);if(g(e,l,f._leaveCb?null:p,u.nextSibling(f)),r(e.parent)){var m=e.parent,y=w(e);while(m){for(var v=0;v<s.destroy.length;++v)s.destroy[v](m);if(m.elm=e.elm,y){for(var x=0;x<s.create.length;++x)s.create[x](io,m);var b=m.data.hook.insert;if(b.merged)for(var k=b.fns.slice(1),S=0;S<k.length;S++)k[S]()}else to(m);m=m.parent}}r(p)?C([t],0,0):r(t.tag)&&M(t)}}return D(e,l,h),e.elm}r(t)&&M(t)}}var ho={create:lo,update:lo,destroy:function(t){lo(t,io)}};function lo(t,e){(t.data.directives||e.data.directives)&&uo(t,e)}function uo(t,e){var i,s,n,o=t===io,r=e===io,a=fo(t.data.directives,t.context),h=fo(e.data.directives,e.context),l=[],u=[];for(i in h)s=a[i],n=h[i],s?(n.oldValue=s.value,n.oldArg=s.arg,po(n,"update",e,t),n.def&&n.def.componentUpdated&&u.push(n)):(po(n,"bind",e,t),n.def&&n.def.inserted&&l.push(n));if(l.length){var c=function(){for(var i=0;i<l.length;i++)po(l[i],"inserted",e,t)};o?se(e,"insert",c):c()}if(u.length&&se(e,"postpatch",(function(){for(var i=0;i<u.length;i++)po(u[i],"componentUpdated",e,t)})),!o)for(i in a)h[i]||po(a[i],"unbind",t,t,r)}var co=Object.create(null);function fo(t,e){var i,s,n=Object.create(null);if(!t)return n;for(i=0;i<t.length;i++){if(s=t[i],s.modifiers||(s.modifiers=co),n[go(s)]=s,e._setupState&&e._setupState.__sfc){var o=s.def||Ps(e,"_setupState","v-"+s.name);s.def="function"===typeof o?{bind:o,update:o}:o}s.def=s.def||Ps(e.$options,"directives",s.name,!0)}return n}function go(t){return t.rawName||"".concat(t.name,".").concat(Object.keys(t.modifiers||{}).join("."))}function po(t,e,i,s,n){var o=t.def&&t.def[e];if(o)try{o(i.elm,t,i,s,n)}catch(Qr){We(Qr,i.context,"directive ".concat(t.name," ").concat(e," hook"))}}var mo=[Qn,ho];function yo(t,e){var i=e.componentOptions;if((!r(i)||!1!==i.Ctor.options.inheritAttrs)&&(!o(t.data.attrs)||!o(e.data.attrs))){var s,n,h,l=e.elm,u=t.data.attrs||{},c=e.data.attrs||{};for(s in(r(c.__ob__)||a(c._v_attr_proxy))&&(c=e.data.attrs=E({},c)),c)n=c[s],h=u[s],h!==n&&vo(l,s,n,e.data.pre);for(s in(it||nt)&&c.value!==u.value&&vo(l,"value",c.value),u)o(c[s])&&(wn(s)?l.removeAttributeNS(bn,kn(s)):mn(s)||l.removeAttribute(s))}}function vo(t,e,i,s){s||t.tagName.indexOf("-")>-1?xo(t,e,i):xn(e)?Sn(i)?t.removeAttribute(e):(i="allowfullscreen"===e&&"EMBED"===t.tagName?"true":e,t.setAttribute(e,i)):mn(e)?t.setAttribute(e,vn(e,i)):wn(e)?Sn(i)?t.removeAttributeNS(bn,kn(e)):t.setAttributeNS(bn,e,i):xo(t,e,i)}function xo(t,e,i){if(Sn(i))t.removeAttribute(e);else{if(it&&!st&&"TEXTAREA"===t.tagName&&"placeholder"===e&&""!==i&&!t.__ieph){var s=function(e){e.stopImmediatePropagation(),t.removeEventListener("input",s)};t.addEventListener("input",s),t.__ieph=!0}t.setAttribute(e,i)}}var bo={create:yo,update:yo};function wo(t,e){var i=e.elm,s=e.data,n=t.data;if(!(o(s.staticClass)&&o(s.class)&&(o(n)||o(n.staticClass)&&o(n.class)))){var a=Pn(e),h=i._transitionClasses;r(h)&&(a=An(a,Nn(h))),a!==i._prevClass&&(i.setAttribute("class",a),i._prevClass=a)}}var ko,So={create:wo,update:wo},Po="__r",Mo="__c";function Co(t){if(r(t[Po])){var e=it?"change":"input";t[e]=[].concat(t[Po],t[e]||[]),delete t[Po]}r(t[Mo])&&(t.change=[].concat(t[Mo],t.change||[]),delete t[Mo])}function Ao(t,e,i){var s=ko;return function n(){var o=e.apply(null,arguments);null!==o&&To(t,n,i,s)}}var No=ei&&!(at&&Number(at[1])<=53);function Lo(t,e,i,s){if(No){var n=$i,o=e;e=o._wrapper=function(t){if(t.target===t.currentTarget||t.timeStamp>=n||t.timeStamp<=0||t.target.ownerDocument!==document)return o.apply(this,arguments)}}ko.addEventListener(t,e,lt?{capture:i,passive:s}:i)}function To(t,e,i,s){(s||ko).removeEventListener(t,e._wrapper||e,i)}function Do(t,e){if(!o(t.data.on)||!o(e.data.on)){var i=e.data.on||{},s=t.data.on||{};ko=e.elm||t.elm,Co(i),ie(i,s,Lo,To,Ao,e.context),ko=void 0}}var Oo,Fo={create:Do,update:Do,destroy:function(t){return Do(t,io)}};function Ro(t,e){if(!o(t.data.domProps)||!o(e.data.domProps)){var i,s,n=e.elm,h=t.data.domProps||{},l=e.data.domProps||{};for(i in(r(l.__ob__)||a(l._v_attr_proxy))&&(l=e.data.domProps=E({},l)),h)i in l||(n[i]="");for(i in l){if(s=l[i],"textContent"===i||"innerHTML"===i){if(e.children&&(e.children.length=0),s===h[i])continue;1===n.childNodes.length&&n.removeChild(n.childNodes[0])}if("value"===i&&"PROGRESS"!==n.tagName){n._value=s;var u=o(s)?"":String(s);Eo(n,u)&&(n.value=u)}else if("innerHTML"===i&&Fn(n.tagName)&&o(n.innerHTML)){Oo=Oo||document.createElement("div"),Oo.innerHTML="<svg>".concat(s,"</svg>");var c=Oo.firstChild;while(n.firstChild)n.removeChild(n.firstChild);while(c.firstChild)n.appendChild(c.firstChild)}else if(s!==h[i])try{n[i]=s}catch(Qr){}}}}function Eo(t,e){return!t.composing&&("OPTION"===t.tagName||Bo(t,e)||Io(t,e))}function Bo(t,e){var i=!0;try{i=document.activeElement!==t}catch(Qr){}return i&&t.value!==e}function Io(t,e){var i=t.value,s=t._vModifiers;if(r(s)){if(s.number)return x(i)!==x(e);if(s.trim)return i.trim()!==e.trim()}return i!==e}var _o={create:Ro,update:Ro},Vo=M((function(t){var e={},i=/;(?![^(]*\))/g,s=/:(.+)/;return t.split(i).forEach((function(t){if(t){var i=t.split(s);i.length>1&&(e[i[0].trim()]=i[1].trim())}})),e}));function zo(t){var e=jo(t.style);return t.staticStyle?E(t.staticStyle,e):e}function jo(t){return Array.isArray(t)?B(t):"string"===typeof t?Vo(t):t}function $o(t,e){var i,s={};if(e){var n=t;while(n.componentInstance)n=n.componentInstance._vnode,n&&n.data&&(i=zo(n.data))&&E(s,i)}(i=zo(t.data))&&E(s,i);var o=t;while(o=o.parent)o.data&&(i=zo(o.data))&&E(s,i);return s}var Xo,Go=/^--/,Yo=/\s*!important$/,Ko=function(t,e,i){if(Go.test(e))t.style.setProperty(e,i);else if(Yo.test(i))t.style.setProperty(T(e),i.replace(Yo,""),"important");else{var s=Ho(e);if(Array.isArray(i))for(var n=0,o=i.length;n<o;n++)t.style[s]=i[n];else t.style[s]=i}},Uo=["Webkit","Moz","ms"],Ho=M((function(t){if(Xo=Xo||document.createElement("div").style,t=A(t),"filter"!==t&&t in Xo)return t;for(var e=t.charAt(0).toUpperCase()+t.slice(1),i=0;i<Uo.length;i++){var s=Uo[i]+e;if(s in Xo)return s}}));function qo(t,e){var i=e.data,s=t.data;if(!(o(i.staticStyle)&&o(i.style)&&o(s.staticStyle)&&o(s.style))){var n,a,h=e.elm,l=s.staticStyle,u=s.normalizedStyle||s.style||{},c=l||u,d=jo(e.data.style)||{};e.data.normalizedStyle=r(d.__ob__)?E({},d):d;var f=$o(e,!0);for(a in c)o(f[a])&&Ko(h,a,"");for(a in f)n=f[a],Ko(h,a,null==n?"":n)}}var Wo={create:qo,update:qo},Zo=/\s+/;function Jo(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(Zo).forEach((function(e){return t.classList.add(e)})):t.classList.add(e);else{var i=" ".concat(t.getAttribute("class")||""," ");i.indexOf(" "+e+" ")<0&&t.setAttribute("class",(i+e).trim())}}function Qo(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(Zo).forEach((function(e){return t.classList.remove(e)})):t.classList.remove(e),t.classList.length||t.removeAttribute("class");else{var i=" ".concat(t.getAttribute("class")||""," "),s=" "+e+" ";while(i.indexOf(s)>=0)i=i.replace(s," ");i=i.trim(),i?t.setAttribute("class",i):t.removeAttribute("class")}}function tr(t){if(t){if("object"===typeof t){var e={};return!1!==t.css&&E(e,er(t.name||"v")),E(e,t),e}return"string"===typeof t?er(t):void 0}}var er=M((function(t){return{enterClass:"".concat(t,"-enter"),enterToClass:"".concat(t,"-enter-to"),enterActiveClass:"".concat(t,"-enter-active"),leaveClass:"".concat(t,"-leave"),leaveToClass:"".concat(t,"-leave-to"),leaveActiveClass:"".concat(t,"-leave-active")}})),ir=tt&&!st,sr="transition",nr="animation",or="transition",rr="transitionend",ar="animation",hr="animationend";ir&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(or="WebkitTransition",rr="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(ar="WebkitAnimation",hr="webkitAnimationEnd"));var lr=tt?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(t){return t()};function ur(t){lr((function(){lr(t)}))}function cr(t,e){var i=t._transitionClasses||(t._transitionClasses=[]);i.indexOf(e)<0&&(i.push(e),Jo(t,e))}function dr(t,e){t._transitionClasses&&k(t._transitionClasses,e),Qo(t,e)}function fr(t,e,i){var s=pr(t,e),n=s.type,o=s.timeout,r=s.propCount;if(!n)return i();var a=n===sr?rr:hr,h=0,l=function(){t.removeEventListener(a,u),i()},u=function(e){e.target===t&&++h>=r&&l()};setTimeout((function(){h<r&&l()}),o+1),t.addEventListener(a,u)}var gr=/\b(transform|all)(,|$)/;function pr(t,e){var i,s=window.getComputedStyle(t),n=(s[or+"Delay"]||"").split(", "),o=(s[or+"Duration"]||"").split(", "),r=mr(n,o),a=(s[ar+"Delay"]||"").split(", "),h=(s[ar+"Duration"]||"").split(", "),l=mr(a,h),u=0,c=0;e===sr?r>0&&(i=sr,u=r,c=o.length):e===nr?l>0&&(i=nr,u=l,c=h.length):(u=Math.max(r,l),i=u>0?r>l?sr:nr:null,c=i?i===sr?o.length:h.length:0);var d=i===sr&&gr.test(s[or+"Property"]);return{type:i,timeout:u,propCount:c,hasTransform:d}}function mr(t,e){while(t.length<e.length)t=t.concat(t);return Math.max.apply(null,e.map((function(e,i){return yr(e)+yr(t[i])})))}function yr(t){return 1e3*Number(t.slice(0,-1).replace(",","."))}function vr(t,e){var i=t.elm;r(i._leaveCb)&&(i._leaveCb.cancelled=!0,i._leaveCb());var s=tr(t.data.transition);if(!o(s)&&!r(i._enterCb)&&1===i.nodeType){var n=s.css,a=s.type,h=s.enterClass,l=s.enterToClass,d=s.enterActiveClass,f=s.appearClass,g=s.appearToClass,p=s.appearActiveClass,m=s.beforeEnter,y=s.enter,v=s.afterEnter,b=s.enterCancelled,w=s.beforeAppear,k=s.appear,S=s.afterAppear,P=s.appearCancelled,M=s.duration,C=Mi,A=Mi.$vnode;while(A&&A.parent)C=A.context,A=A.parent;var N=!C._isMounted||!t.isRootInsert;if(!N||k||""===k){var L=N&&f?f:h,T=N&&p?p:d,D=N&&g?g:l,O=N&&w||m,F=N&&u(k)?k:y,R=N&&S||v,E=N&&P||b,B=x(c(M)?M.enter:M);0;var I=!1!==n&&!st,_=wr(F),V=i._enterCb=$((function(){I&&(dr(i,D),dr(i,T)),V.cancelled?(I&&dr(i,L),E&&E(i)):R&&R(i),i._enterCb=null}));t.data.show||se(t,"insert",(function(){var e=i.parentNode,s=e&&e._pending&&e._pending[t.key];s&&s.tag===t.tag&&s.elm._leaveCb&&s.elm._leaveCb(),F&&F(i,V)})),O&&O(i),I&&(cr(i,L),cr(i,T),ur((function(){dr(i,L),V.cancelled||(cr(i,D),_||(br(B)?setTimeout(V,B):fr(i,a,V)))}))),t.data.show&&(e&&e(),F&&F(i,V)),I||_||V()}}}function xr(t,e){var i=t.elm;r(i._enterCb)&&(i._enterCb.cancelled=!0,i._enterCb());var s=tr(t.data.transition);if(o(s)||1!==i.nodeType)return e();if(!r(i._leaveCb)){var n=s.css,a=s.type,h=s.leaveClass,l=s.leaveToClass,u=s.leaveActiveClass,d=s.beforeLeave,f=s.leave,g=s.afterLeave,p=s.leaveCancelled,m=s.delayLeave,y=s.duration,v=!1!==n&&!st,b=wr(f),w=x(c(y)?y.leave:y);0;var k=i._leaveCb=$((function(){i.parentNode&&i.parentNode._pending&&(i.parentNode._pending[t.key]=null),v&&(dr(i,l),dr(i,u)),k.cancelled?(v&&dr(i,h),p&&p(i)):(e(),g&&g(i)),i._leaveCb=null}));m?m(S):S()}function S(){k.cancelled||(!t.data.show&&i.parentNode&&((i.parentNode._pending||(i.parentNode._pending={}))[t.key]=t),d&&d(i),v&&(cr(i,h),cr(i,u),ur((function(){dr(i,h),k.cancelled||(cr(i,l),b||(br(w)?setTimeout(k,w):fr(i,a,k)))}))),f&&f(i,k),v||b||k())}}function br(t){return"number"===typeof t&&!isNaN(t)}function wr(t){if(o(t))return!1;var e=t.fns;return r(e)?wr(Array.isArray(e)?e[0]:e):(t._length||t.length)>1}function kr(t,e){!0!==e.data.show&&vr(e)}var Sr=tt?{create:kr,activate:kr,remove:function(t,e){!0!==t.data.show?xr(t,e):e()}}:{},Pr=[bo,So,Fo,_o,Wo,Sr],Mr=Pr.concat(mo),Cr=ao({nodeOps:Jn,modules:Mr});st&&document.addEventListener("selectionchange",(function(){var t=document.activeElement;t&&t.vmodel&&Rr(t,"input")}));var Ar={inserted:function(t,e,i,s){"select"===i.tag?(s.elm&&!s.elm._vOptions?se(i,"postpatch",(function(){Ar.componentUpdated(t,e,i)})):Nr(t,e,i.context),t._vOptions=[].map.call(t.options,Dr)):("textarea"===i.tag||_n(t.type))&&(t._vModifiers=e.modifiers,e.modifiers.lazy||(t.addEventListener("compositionstart",Or),t.addEventListener("compositionend",Fr),t.addEventListener("change",Fr),st&&(t.vmodel=!0)))},componentUpdated:function(t,e,i){if("select"===i.tag){Nr(t,e,i.context);var s=t._vOptions,n=t._vOptions=[].map.call(t.options,Dr);if(n.some((function(t,e){return!z(t,s[e])}))){var o=t.multiple?e.value.some((function(t){return Tr(t,n)})):e.value!==e.oldValue&&Tr(e.value,n);o&&Rr(t,"change")}}}};function Nr(t,e,i){Lr(t,e,i),(it||nt)&&setTimeout((function(){Lr(t,e,i)}),0)}function Lr(t,e,i){var s=e.value,n=t.multiple;if(!n||Array.isArray(s)){for(var o,r,a=0,h=t.options.length;a<h;a++)if(r=t.options[a],n)o=j(s,Dr(r))>-1,r.selected!==o&&(r.selected=o);else if(z(Dr(r),s))return void(t.selectedIndex!==a&&(t.selectedIndex=a));n||(t.selectedIndex=-1)}}function Tr(t,e){return e.every((function(e){return!z(e,t)}))}function Dr(t){return"_value"in t?t._value:t.value}function Or(t){t.target.composing=!0}function Fr(t){t.target.composing&&(t.target.composing=!1,Rr(t.target,"input"))}function Rr(t,e){var i=document.createEvent("HTMLEvents");i.initEvent(e,!0,!0),t.dispatchEvent(i)}function Er(t){return!t.componentInstance||t.data&&t.data.transition?t:Er(t.componentInstance._vnode)}var Br={bind:function(t,e,i){var s=e.value;i=Er(i);var n=i.data&&i.data.transition,o=t.__vOriginalDisplay="none"===t.style.display?"":t.style.display;s&&n?(i.data.show=!0,vr(i,(function(){t.style.display=o}))):t.style.display=s?o:"none"},update:function(t,e,i){var s=e.value,n=e.oldValue;if(!s!==!n){i=Er(i);var o=i.data&&i.data.transition;o?(i.data.show=!0,s?vr(i,(function(){t.style.display=t.__vOriginalDisplay})):xr(i,(function(){t.style.display="none"}))):t.style.display=s?t.__vOriginalDisplay:"none"}},unbind:function(t,e,i,s,n){n||(t.style.display=t.__vOriginalDisplay)}},Ir={model:Ar,show:Br},_r={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function Vr(t){var e=t&&t.componentOptions;return e&&e.Ctor.options.abstract?Vr(Xe(e.children)):t}function zr(t){var e={},i=t.$options;for(var s in i.propsData)e[s]=t[s];var n=i._parentListeners;for(var s in n)e[A(s)]=n[s];return e}function jr(t,e){if(/\d-keep-alive$/.test(e.tag))return t("keep-alive",{props:e.componentOptions.propsData})}function $r(t){while(t=t.parent)if(t.data.transition)return!0}function Xr(t,e){return e.key===t.key&&e.tag===t.tag}var Gr=function(t){return t.tag||Ae(t)},Yr=function(t){return"show"===t.name},Kr={name:"transition",props:_r,abstract:!0,render:function(t){var e=this,i=this.$slots.default;if(i&&(i=i.filter(Gr),i.length)){0;var s=this.mode;0;var n=i[0];if($r(this.$vnode))return n;var o=Vr(n);if(!o)return n;if(this._leaving)return jr(t,n);var r="__transition-".concat(this._uid,"-");o.key=null==o.key?o.isComment?r+"comment":r+o.tag:l(o.key)?0===String(o.key).indexOf(r)?o.key:r+o.key:o.key;var a=(o.data||(o.data={})).transition=zr(this),h=this._vnode,u=Vr(h);if(o.data.directives&&o.data.directives.some(Yr)&&(o.data.show=!0),u&&u.data&&!Xr(o,u)&&!Ae(u)&&(!u.componentInstance||!u.componentInstance._vnode.isComment)){var c=u.data.transition=E({},a);if("out-in"===s)return this._leaving=!0,se(c,"afterLeave",(function(){e._leaving=!1,e.$forceUpdate()})),jr(t,n);if("in-out"===s){if(Ae(o))return h;var d,f=function(){d()};se(a,"afterEnter",f),se(a,"enterCancelled",f),se(c,"delayLeave",(function(t){d=t}))}}return n}}},Ur=E({tag:String,moveClass:String},_r);delete Ur.mode;var Hr={props:Ur,beforeMount:function(){var t=this,e=this._update;this._update=function(i,s){var n=Ci(t);t.__patch__(t._vnode,t.kept,!1,!0),t._vnode=t.kept,n(),e.call(t,i,s)}},render:function(t){for(var e=this.tag||this.$vnode.data.tag||"span",i=Object.create(null),s=this.prevChildren=this.children,n=this.$slots.default||[],o=this.children=[],r=zr(this),a=0;a<n.length;a++){var h=n[a];if(h.tag)if(null!=h.key&&0!==String(h.key).indexOf("__vlist"))o.push(h),i[h.key]=h,(h.data||(h.data={})).transition=r;else;}if(s){var l=[],u=[];for(a=0;a<s.length;a++){h=s[a];h.data.transition=r,h.data.pos=h.elm.getBoundingClientRect(),i[h.key]?l.push(h):u.push(h)}this.kept=t(e,null,l),this.removed=u}return t(e,null,o)},updated:function(){var t=this.prevChildren,e=this.moveClass||(this.name||"v")+"-move";t.length&&this.hasMove(t[0].elm,e)&&(t.forEach(qr),t.forEach(Wr),t.forEach(Zr),this._reflow=document.body.offsetHeight,t.forEach((function(t){if(t.data.moved){var i=t.elm,s=i.style;cr(i,e),s.transform=s.WebkitTransform=s.transitionDuration="",i.addEventListener(rr,i._moveCb=function t(s){s&&s.target!==i||s&&!/transform$/.test(s.propertyName)||(i.removeEventListener(rr,t),i._moveCb=null,dr(i,e))})}})))},methods:{hasMove:function(t,e){if(!ir)return!1;if(this._hasMove)return this._hasMove;var i=t.cloneNode();t._transitionClasses&&t._transitionClasses.forEach((function(t){Qo(i,t)})),Jo(i,e),i.style.display="none",this.$el.appendChild(i);var s=pr(i);return this.$el.removeChild(i),this._hasMove=s.hasTransform}}};function qr(t){t.elm._moveCb&&t.elm._moveCb(),t.elm._enterCb&&t.elm._enterCb()}function Wr(t){t.data.newPos=t.elm.getBoundingClientRect()}function Zr(t){var e=t.data.pos,i=t.data.newPos,s=e.left-i.left,n=e.top-i.top;if(s||n){t.data.moved=!0;var o=t.elm.style;o.transform=o.WebkitTransform="translate(".concat(s,"px,").concat(n,"px)"),o.transitionDuration="0s"}}var Jr={Transition:Kr,TransitionGroup:Hr};Zs.config.mustUseProp=pn,Zs.config.isReservedTag=Rn,Zs.config.isReservedAttr=fn,Zs.config.getTagNamespace=En,Zs.config.isUnknownElement=In,E(Zs.options.directives,Ir),E(Zs.options.components,Jr),Zs.prototype.__patch__=tt?Cr:I,Zs.prototype.$mount=function(t,e){return t=t&&tt?Vn(t):void 0,Li(this,t,e)},tt&&setTimeout((function(){U.devtools&&dt&&dt.emit("init",Zs)}),0)},5604:function(t,e,i){i.d(e,{CI:function(){return a},OP:function(){return o},q4:function(){return h},rq:function(){return l},yA:function(){return r}});i(4114);var s=i(5453);function n(t,e,i){if(!s.A.config.silent){if(i&&(e={_isVue:!0,$parent:i,$options:e}),e){if(e.$_alreadyWarned=e.$_alreadyWarned||[],e.$_alreadyWarned.includes(t))return;e.$_alreadyWarned.push(t)}return`[Vuetify] ${t}`+(e?f(e):"")}}function o(t,e,i){const s=n(t,e,i);null!=s&&console.warn(s)}function r(t,e,i){const s=n(t,e,i);null!=s&&console.error(s)}function a(t,e,i,s){o(`[UPGRADE] '${t}' is deprecated, use '${e}' instead.`,i,s)}function h(t,e,i,s){r(`[BREAKING] '${t}' has been removed, use '${e}' instead. For more information, see the upgrade guide https://github.com/vuetifyjs/vuetify/releases/tag/v2.0.0#user-content-upgrade-guide`,i,s)}function l(t,e,i){o(`[REMOVED] '${t}' has been removed. You can safely omit it.`,e,i)}const u=/(?:^|[-_])(\w)/g,c=t=>t.replace(u,(t=>t.toUpperCase())).replace(/[-_]/g,"");function d(t,e){if(t.$root===t)return"<Root>";const i="function"===typeof t&&null!=t.cid?t.options:t._isVue?t.$options||t.constructor.options:t||{};let s=i.name||i._componentTag;const n=i.__file;if(!s&&n){const t=n.match(/([^/\\]+)\.vue$/);s=t&&t[1]}return(s?`<${c(s)}>`:"<Anonymous>")+(n&&!1!==e?` at ${n}`:"")}function f(t){if(t._isVue&&t.$parent){const e=[];let i=0;while(t){if(e.length>0){const s=e[e.length-1];if(s.constructor===t.constructor){i++,t=t.$parent;continue}i>0&&(e[e.length-1]=[s,i],i=0)}e.push(t),t=t.$parent}return"\n\nfound in\n\n"+e.map(((t,e)=>`${0===e?"---\x3e ":" ".repeat(5+2*e)}${Array.isArray(t)?`${d(t[0])}... (${t[1]} recursive calls)`:d(t)}`)).join("\n")}return`\n\n(found in ${d(t)})`}},5610:function(t,e,i){var s=i(1291),n=Math.max,o=Math.min;t.exports=function(t,e){var i=s(t);return i<0?n(i+e,0):o(i,e)}},5745:function(t,e,i){var s=i(7629);t.exports=function(t,e){return s[t]||(s[t]=e||{})}},5768:function(t,e,i){i.d(e,{A:function(){return T}});i(4114);var s=i(980),n=i(4838),o=i(8767),r=i(9623),a=i(5604),h=i(5471),l=h.Ay.extend({name:"mobile",props:{mobileBreakpoint:{type:[Number,String],default(){return this.$vuetify?this.$vuetify.breakpoint.mobileBreakpoint:void 0},validator:t=>!isNaN(Number(t))||["xs","sm","md","lg","xl"].includes(String(t))}},computed:{isMobile(){const{mobile:t,width:e,name:i,mobileBreakpoint:s}=this.$vuetify.breakpoint;if(s===this.mobileBreakpoint)return t;const n=parseInt(this.mobileBreakpoint,10),o=!isNaN(n);return o?e<n:i===this.mobileBreakpoint}},created(){this.$attrs.hasOwnProperty("mobile-break-point")&&(0,a.CI)("mobile-break-point","mobile-breakpoint",this)}}),u=i(3661),c=i(9748),d=i(3507),f=(0,d.A)(o.A,u.A,c.A).extend({name:"v-overlay",props:{absolute:Boolean,color:{type:String,default:"#212121"},dark:{type:Boolean,default:!0},opacity:{type:[Number,String],default:.46},value:{default:!0},zIndex:{type:[Number,String],default:5}},computed:{__scrim(){const t=this.setBackgroundColor(this.color,{staticClass:"v-overlay__scrim",style:{opacity:this.computedOpacity}});return this.$createElement("div",t)},classes(){return{"v-overlay--absolute":this.absolute,"v-overlay--active":this.isActive,...this.themeClasses}},computedOpacity(){return Number(this.isActive?this.opacity:0)},styles(){return{zIndex:this.zIndex}}},methods:{genContent(){return this.$createElement("div",{staticClass:"v-overlay__content"},this.$slots.default)}},render(t){const e=[this.__scrim];return this.isActive&&e.push(this.genContent()),t("div",{staticClass:"v-overlay",on:this.$listeners,class:this.classes,style:this.styles},e)}}),g=f,p=i(6960),m=h.Ay.extend().extend({name:"overlayable",props:{hideOverlay:Boolean,overlayColor:String,overlayOpacity:[Number,String]},data(){return{animationFrame:0,overlay:null}},watch:{hideOverlay(t){this.isActive&&(t?this.removeOverlay():this.genOverlay())}},beforeDestroy(){this.removeOverlay()},methods:{createOverlay(){const t=new g({propsData:{absolute:this.absolute,value:!1,color:this.overlayColor,opacity:this.overlayOpacity}});t.$mount();const e=this.absolute?this.$el.parentNode:document.querySelector("[data-app]");e&&e.insertBefore(t.$el,e.firstChild),this.overlay=t},genOverlay(){if(this.hideScroll(),!this.hideOverlay)return this.overlay||this.createOverlay(),this.animationFrame=requestAnimationFrame((()=>{this.overlay&&(void 0!==this.activeZIndex?this.overlay.zIndex=String(this.activeZIndex-1):this.$el&&(this.overlay.zIndex=(0,p.fl)(this.$el)),this.overlay.value=!0)})),!0},removeOverlay(t=!0){this.overlay&&((0,p.d7)(this.overlay.$el,"transitionend",(()=>{this.overlay&&this.overlay.$el&&this.overlay.$el.parentNode&&!this.overlay.value&&!this.isActive&&(this.overlay.$el.parentNode.removeChild(this.overlay.$el),this.overlay.$destroy(),this.overlay=null)})),cancelAnimationFrame(this.animationFrame),this.overlay.value=!1),t&&this.showScroll()},scrollListener(t){if("key"in t){if(["INPUT","TEXTAREA","SELECT"].includes(t.target.tagName)||t.target.isContentEditable)return;const e=[p.uP.up,p.uP.pageup],i=[p.uP.down,p.uP.pagedown];if(e.includes(t.keyCode))t.deltaY=-1;else{if(!i.includes(t.keyCode))return;t.deltaY=1}}(t.target===this.overlay||"keydown"!==t.type&&t.target===document.body||this.checkPath(t))&&t.preventDefault()},hasScrollbar(t){if(!t||t.nodeType!==Node.ELEMENT_NODE)return!1;const e=window.getComputedStyle(t);return(["auto","scroll"].includes(e.overflowY)||"SELECT"===t.tagName)&&t.scrollHeight>t.clientHeight||["auto","scroll"].includes(e.overflowX)&&t.scrollWidth>t.clientWidth},shouldScroll(t,e){if(t.hasAttribute("data-app"))return!1;const i=e.shiftKey||e.deltaX?"x":"y",s="y"===i?e.deltaY:e.deltaX||e.deltaY;let n,o;"y"===i?(n=0===t.scrollTop,o=t.scrollTop+t.clientHeight===t.scrollHeight):(n=0===t.scrollLeft,o=t.scrollLeft+t.clientWidth===t.scrollWidth);const r=s<0,a=s>0;return!(n||!r)||(!(o||!a)||!(!n&&!o)&&this.shouldScroll(t.parentNode,e))},isInside(t,e){return t===e||null!==t&&t!==document.body&&this.isInside(t.parentNode,e)},checkPath(t){const e=(0,p.K9)(t);if("keydown"===t.type&&e[0]===document.body){const e=this.$refs.dialog,i=window.getSelection().anchorNode;return!(e&&this.hasScrollbar(e)&&this.isInside(i,e))||!this.shouldScroll(e,t)}for(let i=0;i<e.length;i++){const s=e[i];if(s===document)return!0;if(s===document.documentElement)return!0;if(s===this.$refs.content)return!0;if(this.hasScrollbar(s))return!this.shouldScroll(s,t)}return!0},hideScroll(){this.$vuetify.breakpoint.smAndDown?document.documentElement.classList.add("overflow-y-hidden"):((0,p.P4)(window,"wheel",this.scrollListener,{passive:!1}),window.addEventListener("keydown",this.scrollListener))},showScroll(){document.documentElement.classList.remove("overflow-y-hidden"),window.removeEventListener("wheel",this.scrollListener),window.removeEventListener("keydown",this.scrollListener)}}}),y=i(6543),v=i(1418),x=i(2136);i(8111),i(7588);const b=t=>{const{touchstartX:e,touchendX:i,touchstartY:s,touchendY:n}=t,o=.5,r=16;t.offsetX=i-e,t.offsetY=n-s,Math.abs(t.offsetY)<o*Math.abs(t.offsetX)&&(t.left&&i<e-r&&t.left(t),t.right&&i>e+r&&t.right(t)),Math.abs(t.offsetX)<o*Math.abs(t.offsetY)&&(t.up&&n<s-r&&t.up(t),t.down&&n>s+r&&t.down(t))};function w(t,e){const i=t.changedTouches[0];e.touchstartX=i.clientX,e.touchstartY=i.clientY,e.start&&e.start(Object.assign(t,e))}function k(t,e){const i=t.changedTouches[0];e.touchendX=i.clientX,e.touchendY=i.clientY,e.end&&e.end(Object.assign(t,e)),b(e)}function S(t,e){const i=t.changedTouches[0];e.touchmoveX=i.clientX,e.touchmoveY=i.clientY,e.move&&e.move(Object.assign(t,e))}function P(t){const e={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:t.left,right:t.right,up:t.up,down:t.down,start:t.start,move:t.move,end:t.end};return{touchstart:t=>w(t,e),touchend:t=>k(t,e),touchmove:t=>S(t,e)}}function M(t,e,i){const s=e.value,n=s.parent?t.parentElement:t,o=s.options||{passive:!0};if(!n)return;const r=P(e.value);n._touchHandlers=Object(n._touchHandlers),n._touchHandlers[i.context._uid]=r,(0,p.HP)(r).forEach((t=>{n.addEventListener(t,r[t],o)}))}function C(t,e,i){const s=e.value.parent?t.parentElement:t;if(!s||!s._touchHandlers)return;const n=s._touchHandlers[i.context._uid];(0,p.HP)(n).forEach((t=>{s.removeEventListener(t,n[t])})),delete s._touchHandlers[i.context._uid]}const A={inserted:M,unbind:C};var N=A;const L=(0,d.A)((0,n.A)("left",["isActive","isMobile","miniVariant","expandOnHover","permanent","right","temporary","width"]),o.A,r.A,l,m,y.A,u.A);var T=L.extend({name:"v-navigation-drawer",directives:{ClickOutside:v.A,Resize:x.A,Touch:N},provide(){return{isInNav:"nav"===this.tag}},props:{bottom:Boolean,clipped:Boolean,disableResizeWatcher:Boolean,disableRouteWatcher:Boolean,expandOnHover:Boolean,floating:Boolean,height:{type:[Number,String],default(){return this.app?"100vh":"100%"}},miniVariant:Boolean,miniVariantWidth:{type:[Number,String],default:56},permanent:Boolean,right:Boolean,src:{type:[String,Object],default:""},stateless:Boolean,tag:{type:String,default(){return this.app?"nav":"aside"}},temporary:Boolean,touchless:Boolean,width:{type:[Number,String],default:256},value:null},data:()=>({isMouseover:!1,touchArea:{left:0,right:0},stackMinZIndex:6}),computed:{applicationProperty(){return this.right?"right":"left"},classes(){return{"v-navigation-drawer":!0,"v-navigation-drawer--absolute":this.absolute,"v-navigation-drawer--bottom":this.bottom,"v-navigation-drawer--clipped":this.clipped,"v-navigation-drawer--close":!this.isActive,"v-navigation-drawer--fixed":!this.absolute&&(this.app||this.fixed),"v-navigation-drawer--floating":this.floating,"v-navigation-drawer--is-mobile":this.isMobile,"v-navigation-drawer--is-mouseover":this.isMouseover,"v-navigation-drawer--mini-variant":this.isMiniVariant,"v-navigation-drawer--custom-mini-variant":56!==Number(this.miniVariantWidth),"v-navigation-drawer--open":this.isActive,"v-navigation-drawer--open-on-hover":this.expandOnHover,"v-navigation-drawer--right":this.right,"v-navigation-drawer--temporary":this.temporary,...this.themeClasses}},computedMaxHeight(){if(!this.hasApp)return null;const t=this.$vuetify.application.bottom+this.$vuetify.application.footer+this.$vuetify.application.bar;return this.clipped?t+this.$vuetify.application.top:t},computedTop(){if(!this.hasApp)return 0;let t=this.$vuetify.application.bar;return t+=this.clipped?this.$vuetify.application.top:0,t},computedTransform(){return this.isActive?0:this.isBottom||this.right?100:-100},computedWidth(){return this.isMiniVariant?this.miniVariantWidth:this.width},hasApp(){return this.app&&!this.isMobile&&!this.temporary},isBottom(){return this.bottom&&this.isMobile},isMiniVariant(){return!this.expandOnHover&&this.miniVariant||this.expandOnHover&&!this.isMouseover},isMobile(){return!this.stateless&&!this.permanent&&l.options.computed.isMobile.call(this)},reactsToClick(){return!this.stateless&&!this.permanent&&(this.isMobile||this.temporary)},reactsToMobile(){return this.app&&!this.disableResizeWatcher&&!this.permanent&&!this.stateless&&!this.temporary},reactsToResize(){return!this.disableResizeWatcher&&!this.stateless},reactsToRoute(){return!this.disableRouteWatcher&&!this.stateless&&(this.temporary||this.isMobile)},showOverlay(){return!this.hideOverlay&&this.isActive&&(this.isMobile||this.temporary)},styles(){const t=this.isBottom?"translateY":"translateX";return{height:(0,p.Dg)(this.height),top:this.isBottom?"auto":(0,p.Dg)(this.computedTop),maxHeight:null!=this.computedMaxHeight?`calc(100% - ${(0,p.Dg)(this.computedMaxHeight)})`:void 0,transform:`${t}(${(0,p.Dg)(this.computedTransform,"%")})`,width:(0,p.Dg)(this.computedWidth)}}},watch:{$route:"onRouteChange",isActive(t){this.$emit("input",t)},isMobile(t,e){!t&&this.isActive&&!this.temporary&&this.removeOverlay(),null!=e&&this.reactsToResize&&this.reactsToMobile&&(this.isActive=!t)},permanent(t){t&&(this.isActive=!0)},showOverlay(t){t?this.genOverlay():this.removeOverlay()},value(t){this.permanent||(null!=t?t!==this.isActive&&(this.isActive=t):this.init())},expandOnHover:"updateMiniVariant",isMouseover(t){this.updateMiniVariant(!t)}},beforeMount(){this.init()},methods:{calculateTouchArea(){const t=this.$el.parentNode;if(!t)return;const e=t.getBoundingClientRect();this.touchArea={left:e.left+50,right:e.right-50}},closeConditional(){return this.isActive&&!this._isDestroyed&&this.reactsToClick},genAppend(){return this.genPosition("append")},genBackground(){const t={height:"100%",width:"100%",src:this.src},e=this.$scopedSlots.img?this.$scopedSlots.img(t):this.$createElement(s.A,{props:t});return this.$createElement("div",{staticClass:"v-navigation-drawer__image"},[e])},genDirectives(){const t=[{name:"click-outside",value:{handler:()=>{this.isActive=!1},closeConditional:this.closeConditional,include:this.getOpenDependentElements}}];return this.touchless||this.stateless||t.push({name:"touch",value:{parent:!0,left:this.swipeLeft,right:this.swipeRight}}),t},genListeners(){const t={mouseenter:()=>this.isMouseover=!0,mouseleave:()=>this.isMouseover=!1,transitionend:t=>{if(t.target!==t.currentTarget)return;this.$emit("transitionend",t);const e=document.createEvent("UIEvents");e.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(e)}};return this.miniVariant&&(t.click=()=>this.$emit("update:mini-variant",!1)),t},genPosition(t){const e=(0,p.$c)(this,t);return e?this.$createElement("div",{staticClass:`v-navigation-drawer__${t}`},e):e},genPrepend(){return this.genPosition("prepend")},genContent(){return this.$createElement("div",{staticClass:"v-navigation-drawer__content"},this.$slots.default)},genBorder(){return this.$createElement("div",{staticClass:"v-navigation-drawer__border"})},init(){this.permanent?this.isActive=!0:this.stateless||null!=this.value?this.isActive=this.value:this.temporary||(this.isActive=!this.isMobile)},onRouteChange(){this.reactsToRoute&&this.closeConditional()&&(this.isActive=!1)},swipeLeft(t){this.isActive&&this.right||(this.calculateTouchArea(),Math.abs(t.touchendX-t.touchstartX)<100||(this.right&&t.touchstartX>=this.touchArea.right?this.isActive=!0:!this.right&&this.isActive&&(this.isActive=!1)))},swipeRight(t){this.isActive&&!this.right||(this.calculateTouchArea(),Math.abs(t.touchendX-t.touchstartX)<100||(!this.right&&t.touchstartX<=this.touchArea.left?this.isActive=!0:this.right&&this.isActive&&(this.isActive=!1)))},updateApplication(){if(!this.isActive||this.isMobile||this.temporary||!this.$el)return 0;const t=Number(this.miniVariant?this.miniVariantWidth:this.width);return isNaN(t)?this.$el.clientWidth:t},updateMiniVariant(t){this.expandOnHover&&this.miniVariant!==t&&this.$emit("update:mini-variant",t)}},render(t){const e=[this.genPrepend(),this.genContent(),this.genAppend(),this.genBorder()];return(this.src||(0,p.$c)(this,"img"))&&e.unshift(this.genBackground()),t(this.tag,this.setBackgroundColor(this.color,{class:this.classes,style:this.styles,directives:this.genDirectives(),on:this.genListeners()}),e)}})},5917:function(t,e,i){var s=i(3724),n=i(9039),o=i(4055);t.exports=!s&&!n((function(){return 7!==Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},5966:function(t,e,i){var s=i(9306),n=i(4117);t.exports=function(t,e){var i=t[e];return n(i)?void 0:s(i)}},5971:function(t,e,i){i.d(e,{A:function(){return m}});var s=i(7889),n=i(1075),o=i(24),r=i(4765),a=i(2e3),h=i(8767),l=i(9748),u=i(8652),c=i(1723),d=i(1906),f=i(3507),g=i(6960);const p=(0,f.A)(r.A,a.A,h.A,(0,u.W)("list"),l.A);var m=p.extend().extend({name:"v-list-group",directives:{ripple:c.A},props:{activeClass:{type:String,default:""},appendIcon:{type:String,default:"$expand"},color:{type:String,default:"primary"},disabled:Boolean,group:[String,RegExp],noAction:Boolean,prependIcon:String,ripple:{type:[Boolean,Object],default:!0},subGroup:Boolean},computed:{classes(){return{"v-list-group--active":this.isActive,"v-list-group--disabled":this.disabled,"v-list-group--no-action":this.noAction,"v-list-group--sub-group":this.subGroup}}},watch:{isActive(t){!this.subGroup&&t&&this.list&&this.list.listClick(this._uid)},$route:"onRouteChange"},created(){this.list&&this.list.register(this),this.group&&this.$route&&null==this.value&&(this.isActive=this.matchRoute(this.$route.path))},beforeDestroy(){this.list&&this.list.unregister(this)},methods:{click(t){this.disabled||(this.isBooted=!0,this.$emit("click",t),this.$nextTick((()=>this.isActive=!this.isActive)))},genIcon(t){return this.$createElement(s.A,t)},genAppendIcon(){const t=!this.subGroup&&this.appendIcon;return t||this.$slots.appendIcon?this.$createElement(o.A,{staticClass:"v-list-group__header__append-icon"},[this.$slots.appendIcon||this.genIcon(t)]):null},genHeader(){return this.$createElement(n.A,{staticClass:"v-list-group__header",attrs:{"aria-expanded":String(this.isActive),role:"button"},class:{[this.activeClass]:this.isActive},props:{inputValue:this.isActive},directives:[{name:"ripple",value:this.ripple}],on:{...this.listeners$,click:this.click}},[this.genPrependIcon(),this.$slots.activator,this.genAppendIcon()])},genItems(){return this.showLazyContent((()=>[this.$createElement("div",{staticClass:"v-list-group__items",directives:[{name:"show",value:this.isActive}]},(0,g.$c)(this))]))},genPrependIcon(){const t=this.subGroup&&null==this.prependIcon?"$subgroup":this.prependIcon;return t||this.$slots.prependIcon?this.$createElement(o.A,{staticClass:"v-list-group__header__prepend-icon"},[this.$slots.prependIcon||this.genIcon(t)]):null},onRouteChange(t){if(!this.group)return;const e=this.matchRoute(t.path);e&&this.isActive!==e&&this.list&&this.list.listClick(this._uid),this.isActive=e},toggle(t){const e=this._uid===t;e&&(this.isBooted=!0),this.$nextTick((()=>this.isActive=e))},matchRoute(t){return null!==t.match(this.group)}},render(t){return t("div",this.setTextColor(this.isActive&&this.color,{staticClass:"v-list-group",class:this.classes}),[this.genHeader(),t(d.Qo,this.genItems())])}})},6080:function(t,e,i){var s=i(7476),n=i(9306),o=i(616),r=s(s.bind);t.exports=function(t,e){return n(t),void 0===e?t:o?r(t,e):function(){return t.apply(e,arguments)}}},6119:function(t,e,i){var s=i(5745),n=i(3392),o=s("keys");t.exports=function(t){return o[t]||(o[t]=n(t))}},6198:function(t,e,i){var s=i(8014);t.exports=function(t){return s(t.length)}},6256:function(t,e,i){i(4114);var s=i(5471);e.A=s.Ay.extend({name:"roundable",props:{rounded:[Boolean,String],tile:Boolean},computed:{roundedClasses(){const t=[],e="string"===typeof this.rounded?String(this.rounded):!0===this.rounded;if(this.tile)t.push("rounded-0");else if("string"===typeof e){const i=e.split(" ");for(const e of i)t.push(`rounded-${e}`)}else e&&t.push("rounded");return t.length>0?{[t.join(" ")]:!0}:{}}}})},6269:function(t){t.exports={}},6278:function(t,e,i){i.d(e,{A:function(){return r}});i(8111),i(2489),i(158),i(125);var s=i(5471);function n(t){return s.Ay.extend({name:`v-${t}`,functional:!0,props:{id:String,tag:{type:String,default:"div"}},render(e,{props:i,data:s,children:n}){s.staticClass=`${t} ${s.staticClass||""}`.trim();const{attrs:o}=s;if(o){s.attrs={};const t=Object.keys(o).filter((t=>{if("slot"===t)return!1;const e=o[t];return t.startsWith("data-")?(s.attrs[t]=e,!1):e||"string"===typeof e}));t.length&&(s.staticClass+=` ${t.join(" ")}`)}return i.id&&(s.domProps=s.domProps||{},s.domProps.id=i.id),e(i.tag,s,n)}})}var o=i(4961),r=n("container").extend({name:"v-container",functional:!0,props:{id:String,tag:{type:String,default:"div"},fluid:{type:Boolean,default:!1}},render(t,{props:e,data:i,children:s}){let n;const{attrs:r}=i;return r&&(i.attrs={},n=Object.keys(r).filter((t=>{if("slot"===t)return!1;const e=r[t];return t.startsWith("data-")?(i.attrs[t]=e,!1):e||"string"===typeof e}))),e.id&&(i.domProps=i.domProps||{},i.domProps.id=e.id),t(e.tag,(0,o.Ay)(i,{staticClass:"container",class:Array({"container--fluid":e.fluid}).concat(n||[])}),s)}})},6279:function(t,e,i){var s=i(6840);t.exports=function(t,e,i){for(var n in e)s(t,n,e[n],i);return t}},6315:function(t,e,i){i(8111),i(2489);var s=i(5471);e.A=s.Ay.extend({name:"v-list-item-action",functional:!0,render(t,{data:e,children:i=[]}){e.staticClass=e.staticClass?`v-list-item__action ${e.staticClass}`:"v-list-item__action";const s=i.filter((t=>!1===t.isComment&&" "!==t.text));return s.length>1&&(e.staticClass+=" v-list-item__action--stack"),t("div",e,i)}})},6319:function(t,e,i){var s=i(8551),n=i(9539);t.exports=function(t,e,i,o){try{return o?e(s(i)[0],i[1]):e(i)}catch(r){n(t,"throw",r)}}},6329:function(t,e,i){i.d(e,{A:function(){return v}});var s=i(7495),n=i(5471),o=i(1906),r=i(6965),a=i(8767),h=i(9923),l=i(4464),u=i(3661),c=i(6960),d=i(3507);const f=(0,d.A)(a.A,(0,h.P)(["absolute","fixed","top","bottom"]),l.A,u.A);var g=f.extend({name:"v-progress-linear",directives:{intersect:r.A},props:{active:{type:Boolean,default:!0},backgroundColor:{type:String,default:null},backgroundOpacity:{type:[Number,String],default:null},bufferValue:{type:[Number,String],default:100},color:{type:String,default:"primary"},height:{type:[Number,String],default:4},indeterminate:Boolean,query:Boolean,reverse:Boolean,rounded:Boolean,stream:Boolean,striped:Boolean,value:{type:[Number,String],default:0}},data(){return{internalLazyValue:this.value||0,isVisible:!0}},computed:{__cachedBackground(){return this.$createElement("div",this.setBackgroundColor(this.backgroundColor||this.color,{staticClass:"v-progress-linear__background",style:this.backgroundStyle}))},__cachedBar(){return this.$createElement(this.computedTransition,[this.__cachedBarType])},__cachedBarType(){return this.indeterminate?this.__cachedIndeterminate:this.__cachedDeterminate},__cachedBuffer(){return this.$createElement("div",{staticClass:"v-progress-linear__buffer",style:this.styles})},__cachedDeterminate(){return this.$createElement("div",this.setBackgroundColor(this.color,{staticClass:"v-progress-linear__determinate",style:{width:(0,c.Dg)(this.normalizedValue,"%")}}))},__cachedIndeterminate(){return this.$createElement("div",{staticClass:"v-progress-linear__indeterminate",class:{"v-progress-linear__indeterminate--active":this.active}},[this.genProgressBar("long"),this.genProgressBar("short")])},__cachedStream(){return this.stream?this.$createElement("div",this.setTextColor(this.color,{staticClass:"v-progress-linear__stream",style:{width:(0,c.Dg)(100-this.normalizedBuffer,"%")}})):null},backgroundStyle(){const t=null==this.backgroundOpacity?this.backgroundColor?1:.3:parseFloat(this.backgroundOpacity);return{opacity:t,[this.isReversed?"right":"left"]:(0,c.Dg)(this.normalizedValue,"%"),width:(0,c.Dg)(Math.max(0,this.normalizedBuffer-this.normalizedValue),"%")}},classes(){return{"v-progress-linear--absolute":this.absolute,"v-progress-linear--fixed":this.fixed,"v-progress-linear--query":this.query,"v-progress-linear--reactive":this.reactive,"v-progress-linear--reverse":this.isReversed,"v-progress-linear--rounded":this.rounded,"v-progress-linear--striped":this.striped,"v-progress-linear--visible":this.isVisible,...this.themeClasses}},computedTransition(){return this.indeterminate?o.mM:o.vt},isReversed(){return this.$vuetify.rtl!==this.reverse},normalizedBuffer(){return this.normalize(this.bufferValue)},normalizedValue(){return this.normalize(this.internalLazyValue)},reactive(){return Boolean(this.$listeners.change)},styles(){const t={};return this.active||(t.height=0),this.indeterminate||100===parseFloat(this.normalizedBuffer)||(t.width=(0,c.Dg)(this.normalizedBuffer,"%")),t}},methods:{genContent(){const t=(0,c.$c)(this,"default",{value:this.internalLazyValue});return t?this.$createElement("div",{staticClass:"v-progress-linear__content"},t):null},genListeners(){const t=this.$listeners;return this.reactive&&(t.click=this.onClick),t},genProgressBar(t){return this.$createElement("div",this.setBackgroundColor(this.color,{staticClass:"v-progress-linear__indeterminate",class:{[t]:!0}}))},onClick(t){if(!this.reactive)return;const{width:e}=this.$el.getBoundingClientRect();this.internalValue=t.offsetX/e*100},onObserve(t,e,i){this.isVisible=i},normalize(t){return t<0?0:t>100?100:parseFloat(t)}},render(t){const e={staticClass:"v-progress-linear",attrs:{role:"progressbar","aria-valuemin":0,"aria-valuemax":this.normalizedBuffer,"aria-valuenow":this.indeterminate?void 0:this.normalizedValue},class:this.classes,directives:[{name:"intersect",value:this.onObserve}],style:{bottom:this.bottom?0:void 0,height:this.active?(0,c.Dg)(this.height):0,top:this.top?0:void 0},on:this.genListeners()};return t("div",e,[this.__cachedStream,this.__cachedBackground,this.__cachedBuffer,this.__cachedBar,this.genContent()])}}),p=g,m=n.Ay.extend().extend({name:"loadable",props:{loading:{type:[Boolean,String],default:!1},loaderHeight:{type:[Number,String],default:2}},methods:{genProgress(){return!1===this.loading?null:this.$slots.progress||this.$createElement(p,{props:{absolute:!0,color:!0===this.loading||""===this.loading?this.color||"primary":this.loading,height:this.loaderHeight,indeterminate:!0}})}}}),y=i(8010),v=(0,d.A)(m,y.A,s.A).extend({name:"v-card",props:{flat:Boolean,hover:Boolean,img:String,link:Boolean,loaderHeight:{type:[Number,String],default:4},raised:Boolean},computed:{classes(){return{"v-card":!0,...y.A.options.computed.classes.call(this),"v-card--flat":this.flat,"v-card--hover":this.hover,"v-card--link":this.isClickable,"v-card--loading":this.loading,"v-card--disabled":this.disabled,"v-card--raised":this.raised,...s.A.options.computed.classes.call(this)}},styles(){const t={...s.A.options.computed.styles.call(this)};return this.img&&(t.background=`url("${this.img}") center center / cover no-repeat`),t}},methods:{genProgress(){const t=m.options.methods.genProgress.call(this);return t?this.$createElement("div",{staticClass:"v-card__progress",key:"progress"},[t]):null}},render(t){const{tag:e,data:i}=this.generateRouteLink();return i.style=this.styles,this.isClickable&&(i.attrs=i.attrs||{},i.attrs.tabindex=0),t(e,this.setBackgroundColor(this.color,i),[this.genProgress(),this.$slots.default])}})},6395:function(t){t.exports=!1},6518:function(t,e,i){var s=i(4576),n=i(7347).f,o=i(6699),r=i(6840),a=i(9433),h=i(7740),l=i(2796);t.exports=function(t,e){var i,u,c,d,f,g,p=t.target,m=t.global,y=t.stat;if(u=m?s:y?s[p]||a(p,{}):s[p]&&s[p].prototype,u)for(c in e){if(f=e[c],t.dontCallGetSet?(g=n(u,c),d=g&&g.value):d=u[c],i=l(m?c:p+(y?".":"#")+c,t.forced),!i&&void 0!==d){if(typeof f==typeof d)continue;h(f,d)}(t.sham||d&&d.sham)&&o(f,"sham",!0),r(u,c,f,t)}}},6521:function(t,e,i){i.d(e,{A:function(){return v}});var s=i(7495),n=i(6965),o=i(8767),r=i(6960),a=o.A.extend({name:"v-progress-circular",directives:{intersect:n.A},props:{button:Boolean,indeterminate:Boolean,rotate:{type:[Number,String],default:0},size:{type:[Number,String],default:32},width:{type:[Number,String],default:4},value:{type:[Number,String],default:0}},data:()=>({radius:20,isVisible:!0}),computed:{calculatedSize(){return Number(this.size)+(this.button?8:0)},circumference(){return 2*Math.PI*this.radius},classes(){return{"v-progress-circular--visible":this.isVisible,"v-progress-circular--indeterminate":this.indeterminate,"v-progress-circular--button":this.button}},normalizedValue(){return this.value<0?0:this.value>100?100:parseFloat(this.value)},strokeDashArray(){return Math.round(1e3*this.circumference)/1e3},strokeDashOffset(){return(100-this.normalizedValue)/100*this.circumference+"px"},strokeWidth(){return Number(this.width)/+this.size*this.viewBoxSize*2},styles(){return{height:(0,r.Dg)(this.calculatedSize),width:(0,r.Dg)(this.calculatedSize)}},svgStyles(){return{transform:`rotate(${Number(this.rotate)}deg)`}},viewBoxSize(){return this.radius/(1-Number(this.width)/+this.size)}},methods:{genCircle(t,e){return this.$createElement("circle",{class:`v-progress-circular__${t}`,attrs:{fill:"transparent",cx:2*this.viewBoxSize,cy:2*this.viewBoxSize,r:this.radius,"stroke-width":this.strokeWidth,"stroke-dasharray":this.strokeDashArray,"stroke-dashoffset":e}})},genSvg(){const t=[this.indeterminate||this.genCircle("underlay",0),this.genCircle("overlay",this.strokeDashOffset)];return this.$createElement("svg",{style:this.svgStyles,attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:`${this.viewBoxSize} ${this.viewBoxSize} ${2*this.viewBoxSize} ${2*this.viewBoxSize}`}},t)},genInfo(){return this.$createElement("div",{staticClass:"v-progress-circular__info"},this.$slots.default)},onObserve(t,e,i){this.isVisible=i}},render(t){return t("div",this.setTextColor(this.color,{staticClass:"v-progress-circular",attrs:{role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":this.indeterminate?void 0:this.normalizedValue},class:this.classes,directives:[{name:"intersect",value:this.onObserve}],style:this.styles,on:this.$listeners}),[this.genSvg(),this.genInfo()])}}),h=a,l=i(4387),u=i(9748),c=i(5083),d=i(9923),f=i(8010),g=i(1713),p=i(3507),m=i(5604);const y=(0,p.A)(s.A,f.A,d.A,g.A,(0,l.P)("btnToggle"),(0,u.P)("inputValue"));var v=y.extend().extend({name:"v-btn",props:{activeClass:{type:String,default(){return this.btnToggle?this.btnToggle.activeClass:""}},block:Boolean,depressed:Boolean,fab:Boolean,icon:Boolean,loading:Boolean,outlined:Boolean,plain:Boolean,retainFocusOnClick:Boolean,rounded:Boolean,tag:{type:String,default:"button"},text:Boolean,tile:Boolean,type:{type:String,default:"button"},value:null},data:()=>({proxyClass:"v-btn--active"}),computed:{classes(){return{"v-btn":!0,...f.A.options.computed.classes.call(this),"v-btn--absolute":this.absolute,"v-btn--block":this.block,"v-btn--bottom":this.bottom,"v-btn--disabled":this.disabled,"v-btn--is-elevated":this.isElevated,"v-btn--fab":this.fab,"v-btn--fixed":this.fixed,"v-btn--has-bg":this.hasBg,"v-btn--icon":this.icon,"v-btn--left":this.left,"v-btn--loading":this.loading,"v-btn--outlined":this.outlined,"v-btn--plain":this.plain,"v-btn--right":this.right,"v-btn--round":this.isRound,"v-btn--rounded":this.rounded,"v-btn--router":this.to,"v-btn--text":this.text,"v-btn--tile":this.tile,"v-btn--top":this.top,...this.themeClasses,...this.groupClasses,...this.elevationClasses,...this.sizeableClasses}},computedElevation(){if(!this.disabled)return c.A.options.computed.computedElevation.call(this)},computedRipple(){var t;const e=!this.icon&&!this.fab||{circle:!0};return!this.disabled&&(null!==(t=this.ripple)&&void 0!==t?t:e)},hasBg(){return!this.text&&!this.plain&&!this.outlined&&!this.icon},isElevated(){return Boolean(!this.icon&&!this.text&&!this.outlined&&!this.depressed&&!this.disabled&&!this.plain&&(null==this.elevation||Number(this.elevation)>0))},isRound(){return Boolean(this.icon||this.fab)},styles(){return{...this.measurableStyles}}},created(){const t=[["flat","text"],["outline","outlined"],["round","rounded"]];t.forEach((([t,e])=>{this.$attrs.hasOwnProperty(t)&&(0,m.q4)(t,e,this)}))},methods:{click(t){!this.retainFocusOnClick&&!this.fab&&t.detail&&this.$el.blur(),this.$emit("click",t),this.btnToggle&&this.toggle()},genContent(){return this.$createElement("span",{staticClass:"v-btn__content"},this.$slots.default)},genLoader(){return this.$createElement("span",{class:"v-btn__loader"},this.$slots.loader||[this.$createElement(h,{props:{indeterminate:!0,size:23,width:2}})])}},render(t){const e=[this.genContent(),this.loading&&this.genLoader()],{tag:i,data:s}=this.generateRouteLink(),n=this.hasBg?this.setBackgroundColor:this.setTextColor;return"button"===i&&(s.attrs.type=this.type,s.attrs.disabled=this.disabled),s.attrs.value=["string","number"].includes(typeof this.value)?this.value:JSON.stringify(this.value),t(i,this.disabled?s:n(this.color,s),e)}})},6543:function(t,e,i){var s=i(5471);e.A=s.Ay.extend({name:"ssr-bootable",data:()=>({isBooted:!1}),mounted(){window.requestAnimationFrame((()=>{this.$el.setAttribute("data-booted","true"),this.isBooted=!0}))}})},6699:function(t,e,i){var s=i(3724),n=i(4913),o=i(6980);t.exports=s?function(t,e,i){return n.f(t,e,o(1,i))}:function(t,e,i){return t[e]=i,t}},6801:function(t,e,i){var s=i(3724),n=i(8686),o=i(4913),r=i(8551),a=i(5397),h=i(1072);e.f=s&&!n?Object.defineProperties:function(t,e){r(t);var i,s=a(e),n=h(e),l=n.length,u=0;while(l>u)o.f(t,i=n[u++],s[i]);return t}},6823:function(t){var e=String;t.exports=function(t){try{return e(t)}catch(i){return"Object"}}},6837:function(t){var e=TypeError,i=9007199254740991;t.exports=function(t){if(t>i)throw e("Maximum allowed index exceeded");return t}},6840:function(t,e,i){var s=i(4901),n=i(4913),o=i(283),r=i(9433);t.exports=function(t,e,i,a){a||(a={});var h=a.enumerable,l=void 0!==a.name?a.name:e;if(s(i)&&o(i,l,a),a.global)h?t[e]=i:r(e,i);else{try{a.unsafe?t[e]&&(h=!0):delete t[e]}catch(u){}h?t[e]=i:n.f(t,e,{value:i,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return t}},6929:function(t,e,i){i.d(e,{A:function(){return y}});i(4114);var s=i(7043);function n(t,e,i){const{self:s=!1}=e.modifiers||{},n=e.value,o="object"===typeof n&&n.options||{passive:!0},r="function"===typeof n||"handleEvent"in n?n:n.handler,a=s?t:e.arg?document.querySelector(e.arg):window;a&&(a.addEventListener("scroll",r,o),t._onScroll=Object(t._onScroll),t._onScroll[i.context._uid]={handler:r,options:o,target:s?void 0:a})}function o(t,e,i){var s;if(!(null===(s=t._onScroll)||void 0===s?void 0:s[i.context._uid]))return;const{handler:n,options:o,target:r=t}=t._onScroll[i.context._uid];r.removeEventListener("scroll",n,o),delete t._onScroll[i.context._uid]}const r={inserted:n,unbind:o};var a=r,h=i(4838),l=i(5604),u=i(5471),c=u.Ay.extend({name:"scrollable",directives:{Scroll:r},props:{scrollTarget:String,scrollThreshold:[String,Number]},data:()=>({currentScroll:0,currentThreshold:0,isActive:!1,isScrollingUp:!1,previousScroll:0,savedScroll:0,target:null}),computed:{canScroll(){return"undefined"!==typeof window},computedScrollThreshold(){return this.scrollThreshold?Number(this.scrollThreshold):300}},watch:{isScrollingUp(){this.savedScroll=this.savedScroll||this.currentScroll},isActive(){this.savedScroll=0}},mounted(){this.scrollTarget&&(this.target=document.querySelector(this.scrollTarget),this.target||(0,l.OP)(`Unable to locate element with identifier ${this.scrollTarget}`,this))},methods:{onScroll(){this.canScroll&&(this.previousScroll=this.currentScroll,this.currentScroll=this.target?this.target.scrollTop:window.pageYOffset,this.isScrollingUp=this.currentScroll<this.previousScroll,this.currentThreshold=Math.abs(this.currentScroll-this.computedScrollThreshold),this.$nextTick((()=>{Math.abs(this.currentScroll-this.savedScroll)>this.computedScrollThreshold&&this.thresholdMet()})))},thresholdMet(){}}}),d=i(6543),f=i(9748),g=i(6960),p=i(3507);const m=(0,p.A)(s.A,c,d.A,f.A,(0,h.A)("top",["clippedLeft","clippedRight","computedHeight","invertedScroll","isExtended","isProminent","value"]));var y=m.extend({name:"v-app-bar",directives:{Scroll:a},provide(){return{VAppBar:this}},props:{clippedLeft:Boolean,clippedRight:Boolean,collapseOnScroll:Boolean,elevateOnScroll:Boolean,fadeImgOnScroll:Boolean,hideOnScroll:Boolean,invertedScroll:Boolean,scrollOffScreen:Boolean,shrinkOnScroll:Boolean,value:{type:Boolean,default:!0}},data(){return{isActive:this.value}},computed:{applicationProperty(){return this.bottom?"bottom":"top"},canScroll(){return c.options.computed.canScroll.call(this)&&(this.invertedScroll||this.elevateOnScroll||this.hideOnScroll||this.collapseOnScroll||this.isBooted||!this.value)},classes(){return{...s.A.options.computed.classes.call(this),"v-toolbar--collapse":this.collapse||this.collapseOnScroll,"v-app-bar":!0,"v-app-bar--clipped":this.clippedLeft||this.clippedRight,"v-app-bar--fade-img-on-scroll":this.fadeImgOnScroll,"v-app-bar--elevate-on-scroll":this.elevateOnScroll,"v-app-bar--fixed":!this.absolute&&(this.app||this.fixed),"v-app-bar--hide-shadow":this.hideShadow,"v-app-bar--is-scrolled":this.currentScroll>0,"v-app-bar--shrink-on-scroll":this.shrinkOnScroll}},scrollRatio(){const t=this.computedScrollThreshold;return Math.max((t-this.currentScroll)/t,0)},computedContentHeight(){if(!this.shrinkOnScroll)return s.A.options.computed.computedContentHeight.call(this);const t=this.dense?48:56,e=this.computedOriginalHeight;return t+(e-t)*this.scrollRatio},computedFontSize(){if(!this.isProminent)return;const t=1.25,e=1.5;return t+(e-t)*this.scrollRatio},computedLeft(){return!this.app||this.clippedLeft?0:this.$vuetify.application.left},computedMarginTop(){return this.app?this.$vuetify.application.bar:0},computedOpacity(){if(this.fadeImgOnScroll)return this.scrollRatio},computedOriginalHeight(){let t=s.A.options.computed.computedContentHeight.call(this);return this.isExtended&&(t+=parseInt(this.extensionHeight)),t},computedRight(){return!this.app||this.clippedRight?0:this.$vuetify.application.right},computedScrollThreshold(){return this.scrollThreshold?Number(this.scrollThreshold):this.computedOriginalHeight-(this.dense?48:56)},computedTransform(){if(!this.canScroll||this.elevateOnScroll&&0===this.currentScroll&&this.isActive)return 0;if(this.isActive)return 0;const t=this.scrollOffScreen?this.computedHeight:this.computedContentHeight;return this.bottom?t:-t},hideShadow(){return this.elevateOnScroll&&this.isExtended?this.currentScroll<this.computedScrollThreshold:this.elevateOnScroll?0===this.currentScroll||this.computedTransform<0:(!this.isExtended||this.scrollOffScreen)&&0!==this.computedTransform},isCollapsed(){return this.collapseOnScroll?this.currentScroll>0:s.A.options.computed.isCollapsed.call(this)},isProminent(){return s.A.options.computed.isProminent.call(this)||this.shrinkOnScroll},styles(){return{...s.A.options.computed.styles.call(this),fontSize:(0,g.Dg)(this.computedFontSize,"rem"),marginTop:(0,g.Dg)(this.computedMarginTop),transform:`translateY(${(0,g.Dg)(this.computedTransform)})`,left:(0,g.Dg)(this.computedLeft),right:(0,g.Dg)(this.computedRight)}}},watch:{canScroll:"onScroll",computedTransform(){this.canScroll&&(this.clippedLeft||this.clippedRight)&&this.callUpdate()},invertedScroll(t){this.isActive=!t||0!==this.currentScroll},hideOnScroll(t){this.isActive=!t||this.currentScroll<this.computedScrollThreshold}},created(){this.invertedScroll&&(this.isActive=!1)},methods:{genBackground(){const t=s.A.options.methods.genBackground.call(this);return t.data=this._b(t.data||{},t.tag,{style:{opacity:this.computedOpacity}}),t},updateApplication(){return this.invertedScroll?0:this.computedHeight+this.computedTransform},thresholdMet(){this.invertedScroll?this.isActive=this.currentScroll>this.computedScrollThreshold:(this.hideOnScroll&&(this.isActive=this.isScrollingUp||this.currentScroll<this.computedScrollThreshold),this.currentThreshold<this.computedScrollThreshold||(this.savedScroll=this.currentScroll))}},render(t){const e=s.A.options.render.call(this,t);return e.data=e.data||{},this.canScroll&&(e.data.directives=e.data.directives||[],e.data.directives.push({arg:this.scrollTarget,name:"scroll",value:this.onScroll})),e}})},6955:function(t,e,i){var s=i(2140),n=i(4901),o=i(2195),r=i(8227),a=r("toStringTag"),h=Object,l="Arguments"===o(function(){return arguments}()),u=function(t,e){try{return t[e]}catch(i){}};t.exports=s?o:function(t){var e,i,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=u(e=h(t),a))?i:l?o(e):"Object"===(s=o(e))&&n(e.callee)?"Arguments":s}},6960:function(t,e,i){i.d(e,{$c:function(){return S},BN:function(){return w},D9:function(){return M},Dg:function(){return f},Gn:function(){return n},HP:function(){return y},K9:function(){return C},LJ:function(){return h},P4:function(){return a},PT:function(){return x},Zb:function(){return b},bD:function(){return l},d7:function(){return o},fF:function(){return d},fl:function(){return c},fo:function(){return k},g8:function(){return m},no:function(){return u},qE:function(){return P},uP:function(){return p}});i(4114),i(8111),i(1148),i(2489),i(8237),i(3579);var s=i(5471);function n(t,e="div",i){return s.Ay.extend({name:i||t.replace(/__/g,"-"),functional:!0,props:{tag:{type:String,default:e}},render(e,{data:i,props:s,children:n}){return i.staticClass=`${t} ${i.staticClass||""}`.trim(),e(s.tag,i,n)}})}function o(t,e,i,s=!1){const n=o=>{i(o),t.removeEventListener(e,n,s)};t.addEventListener(e,n,s)}let r=!1;try{if("undefined"!==typeof window){const t=Object.defineProperty({},"passive",{get:()=>{r=!0}});window.addEventListener("testListener",t,t),window.removeEventListener("testListener",t,t)}}catch(A){console.warn(A)}function a(t,e,i,s){t.addEventListener(e,i,!!r&&s)}function h(t,e,i){const s=e.length-1;if(s<0)return void 0===t?i:t;for(let n=0;n<s;n++){if(null==t)return i;t=t[e[n]]}return null==t||void 0===t[e[s]]?i:t[e[s]]}function l(t,e){if(t===e)return!0;if(t instanceof Date&&e instanceof Date&&t.getTime()!==e.getTime())return!1;if(t!==Object(t)||e!==Object(e))return!1;const i=Object.keys(t);return i.length===Object.keys(e).length&&i.every((i=>l(t[i],e[i])))}function u(t,e,i){return null!=t&&e&&"string"===typeof e?void 0!==t[e]?t[e]:(e=e.replace(/\[(\w+)\]/g,".$1"),e=e.replace(/^\./,""),h(t,e.split("."),i)):i}function c(t){if(!t||t.nodeType!==Node.ELEMENT_NODE)return 0;const e=+window.getComputedStyle(t).getPropertyValue("z-index");return e||c(t.parentNode)}function d(t,e){const i={};for(let s=0;s<e.length;s++){const n=e[s];"undefined"!==typeof t[n]&&(i[n]=t[n])}return i}function f(t,e="px"){return null==t||""===t?void 0:isNaN(+t)?String(t):`${Number(t)}${e}`}function g(t){return null!==t&&"object"===typeof t}const p=Object.freeze({enter:13,tab:9,delete:46,esc:27,space:32,up:38,down:40,left:37,right:39,end:35,home:36,del:46,backspace:8,insert:45,pageup:33,pagedown:34,shift:16});function m(t,e){const i=t.$vuetify.icons.component;if(e.startsWith("$")){const i=`$vuetify.icons.values.${e.split("$").pop().split(".").pop()}`,s=u(t,i,e);if("string"!==typeof s)return s;e=s}return null==i?e:{component:i,props:{icon:e}}}function y(t){return Object.keys(t)}const v=/-(\w)/g,x=t=>t.replace(v,((t,e)=>e?e.toUpperCase():""));function b(t){return t.charAt(0).toUpperCase()+t.slice(1)}function w(t){return null!=t?Array.isArray(t)?t:[t]:[]}function k(t,e,i){return t.$slots.hasOwnProperty(e)&&t.$scopedSlots.hasOwnProperty(e)&&t.$scopedSlots[e].name?i?"v-slot":"scoped":t.$slots.hasOwnProperty(e)?"normal":t.$scopedSlots.hasOwnProperty(e)?"scoped":void 0}function S(t,e="default",i,s=!1){return t.$scopedSlots.hasOwnProperty(e)?t.$scopedSlots[e](i instanceof Function?i():i):!t.$slots.hasOwnProperty(e)||i&&!s?void 0:t.$slots[e]}function P(t,e=0,i=1){return Math.max(e,Math.min(i,t))}function M(t={},e={}){for(const i in e){const s=t[i],n=e[i];g(s)&&g(n)?t[i]=M(s,n):t[i]=n}return t}function C(t){if(t.composedPath)return t.composedPath();const e=[];let i=t.target;while(i){if(e.push(i),"HTML"===i.tagName)return e.push(document),e.push(window),e;i=i.parentElement}return e}},6965:function(t,e,i){i(8111),i(3579);function s(t,e,i){if("undefined"===typeof window||!("IntersectionObserver"in window))return;const s=e.modifiers||{},o=e.value,{handler:r,options:a}="object"===typeof o?o:{handler:o,options:{}},h=new IntersectionObserver(((o=[],a)=>{var h;const l=null===(h=t._observe)||void 0===h?void 0:h[i.context._uid];if(!l)return;const u=o.some((t=>t.isIntersecting));!r||s.quiet&&!l.init||s.once&&!u&&!l.init||r(o,a,u),u&&s.once?n(t,e,i):l.init=!0}),a);t._observe=Object(t._observe),t._observe[i.context._uid]={init:!1,observer:h},h.observe(t)}function n(t,e,i){var s;const n=null===(s=t._observe)||void 0===s?void 0:s[i.context._uid];n&&(n.observer.unobserve(t),delete t._observe[i.context._uid])}const o={inserted:s,unbind:n};e.A=o},6969:function(t,e,i){var s=i(2777),n=i(757);t.exports=function(t){var e=s(t,"string");return n(e)?e:e+""}},6980:function(t){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},7040:function(t,e,i){var s=i(4495);t.exports=s&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},7043:function(t,e,i){i.d(e,{A:function(){return a}});i(4114);var s=i(3858),n=i(980),o=i(6960),r=i(5604),a=s.A.extend({name:"v-toolbar",props:{absolute:Boolean,bottom:Boolean,collapse:Boolean,dense:Boolean,extended:Boolean,extensionHeight:{default:48,type:[Number,String]},flat:Boolean,floating:Boolean,prominent:Boolean,short:Boolean,src:{type:[String,Object],default:""},tag:{type:String,default:"header"}},data:()=>({isExtended:!1}),computed:{computedHeight(){const t=this.computedContentHeight;if(!this.isExtended)return t;const e=parseInt(this.extensionHeight);return this.isCollapsed?t:t+(isNaN(e)?0:e)},computedContentHeight(){return this.height?parseInt(this.height):this.isProminent&&this.dense?96:this.isProminent&&this.short?112:this.isProminent?128:this.dense?48:this.short||this.$vuetify.breakpoint.smAndDown?56:64},classes(){return{...s.A.options.computed.classes.call(this),"v-toolbar":!0,"v-toolbar--absolute":this.absolute,"v-toolbar--bottom":this.bottom,"v-toolbar--collapse":this.collapse,"v-toolbar--collapsed":this.isCollapsed,"v-toolbar--dense":this.dense,"v-toolbar--extended":this.isExtended,"v-toolbar--flat":this.flat,"v-toolbar--floating":this.floating,"v-toolbar--prominent":this.isProminent}},isCollapsed(){return this.collapse},isProminent(){return this.prominent},styles(){return{...this.measurableStyles,height:(0,o.Dg)(this.computedHeight)}}},created(){const t=[["app","<v-app-bar app>"],["manual-scroll",'<v-app-bar :value="false">'],["clipped-left","<v-app-bar clipped-left>"],["clipped-right","<v-app-bar clipped-right>"],["inverted-scroll","<v-app-bar inverted-scroll>"],["scroll-off-screen","<v-app-bar scroll-off-screen>"],["scroll-target","<v-app-bar scroll-target>"],["scroll-threshold","<v-app-bar scroll-threshold>"],["card","<v-app-bar flat>"]];t.forEach((([t,e])=>{this.$attrs.hasOwnProperty(t)&&(0,r.q4)(t,e,this)}))},methods:{genBackground(){const t={height:(0,o.Dg)(this.computedHeight),src:this.src},e=this.$scopedSlots.img?this.$scopedSlots.img({props:t}):this.$createElement(n.A,{props:t});return this.$createElement("div",{staticClass:"v-toolbar__image"},[e])},genContent(){return this.$createElement("div",{staticClass:"v-toolbar__content",style:{height:(0,o.Dg)(this.computedContentHeight)}},(0,o.$c)(this))},genExtension(){return this.$createElement("div",{staticClass:"v-toolbar__extension",style:{height:(0,o.Dg)(this.extensionHeight)}},(0,o.$c)(this,"extension"))}},render(t){this.isExtended=this.extended||!!this.$scopedSlots.extension;const e=[this.genContent()],i=this.setBackgroundColor(this.color,{class:this.classes,style:this.styles,on:this.$listeners});return this.isExtended&&e.push(this.genExtension()),(this.src||this.$scopedSlots.img)&&e.unshift(this.genBackground()),t(this.tag,i,e)}})},7055:function(t,e,i){var s=i(9504),n=i(9039),o=i(2195),r=Object,a=s("".split);t.exports=n((function(){return!r("z").propertyIsEnumerable(0)}))?function(t){return"String"===o(t)?a(t,""):r(t)}:r},7347:function(t,e,i){var s=i(3724),n=i(9565),o=i(8773),r=i(6980),a=i(5397),h=i(6969),l=i(9297),u=i(5917),c=Object.getOwnPropertyDescriptor;e.f=s?c:function(t,e){if(t=a(t),e=h(e),u)try{return c(t,e)}catch(i){}if(l(t,e))return r(!n(o.f,t,e),t[e])}},7348:function(t,e,i){i.d(e,{pr:function(){return P},UZ:function(){return M}});var s=i(6960),n=i(2987),o=i(5971),r=i(1075),a=(i(4114),i(8111),i(2489),i(116),i(7588),i(3579),i(5471)),h=a.Ay.extend({name:"comparable",props:{valueComparator:{type:Function,default:s.bD}}}),l=i(4464),u=i(3661),c=i(3507),d=i(5604);const f=(0,c.A)(h,l.A,u.A).extend({name:"base-item-group",props:{activeClass:{type:String,default:"v-item--active"},mandatory:Boolean,max:{type:[Number,String],default:null},multiple:Boolean,tag:{type:String,default:"div"}},data(){return{internalLazyValue:void 0!==this.value?this.value:this.multiple?[]:void 0,items:[]}},computed:{classes(){return{"v-item-group":!0,...this.themeClasses}},selectedIndex(){return this.selectedItem&&this.items.indexOf(this.selectedItem)||-1},selectedItem(){if(!this.multiple)return this.selectedItems[0]},selectedItems(){return this.items.filter(((t,e)=>this.toggleMethod(this.getValue(t,e))))},selectedValues(){return null==this.internalValue?[]:Array.isArray(this.internalValue)?this.internalValue:[this.internalValue]},toggleMethod(){if(!this.multiple)return t=>this.valueComparator(this.internalValue,t);const t=this.internalValue;return Array.isArray(t)?e=>t.some((t=>this.valueComparator(t,e))):()=>!1}},watch:{internalValue:"updateItemsState",items:"updateItemsState"},created(){this.multiple&&!Array.isArray(this.internalValue)&&(0,d.OP)("Model must be bound to an array if the multiple property is true.",this)},methods:{genData(){return{class:this.classes}},getValue(t,e){return void 0===t.value?e:t.value},onClick(t){this.updateInternalValue(this.getValue(t,this.items.indexOf(t)))},register(t){const e=this.items.push(t)-1;t.$on("change",(()=>this.onClick(t))),this.mandatory&&!this.selectedValues.length&&this.updateMandatory(),this.updateItem(t,e)},unregister(t){if(this._isDestroyed)return;const e=this.items.indexOf(t),i=this.getValue(t,e);this.items.splice(e,1);const s=this.selectedValues.indexOf(i);if(!(s<0)){if(!this.mandatory)return this.updateInternalValue(i);this.multiple&&Array.isArray(this.internalValue)?this.internalValue=this.internalValue.filter((t=>t!==i)):this.internalValue=void 0,this.selectedItems.length||this.updateMandatory(!0)}},updateItem(t,e){const i=this.getValue(t,e);t.isActive=this.toggleMethod(i)},updateItemsState(){this.$nextTick((()=>{if(this.mandatory&&!this.selectedItems.length)return this.updateMandatory();this.items.forEach(this.updateItem)}))},updateInternalValue(t){this.multiple?this.updateMultiple(t):this.updateSingle(t)},updateMandatory(t){if(!this.items.length)return;const e=this.items.slice();t&&e.reverse();const i=e.find((t=>!t.disabled));if(!i)return;const s=this.items.indexOf(i);this.updateInternalValue(this.getValue(i,s))},updateMultiple(t){const e=Array.isArray(this.internalValue)?this.internalValue:[],i=e.slice(),s=i.findIndex((e=>this.valueComparator(e,t)));this.mandatory&&s>-1&&i.length-1<1||null!=this.max&&s<0&&i.length+1>this.max||(s>-1?i.splice(s,1):i.push(t),this.internalValue=i)},updateSingle(t){const e=this.valueComparator(this.internalValue,t);this.mandatory&&e||(this.internalValue=e?void 0:t)}},render(t){return t(this.tag,this.genData(),this.$slots.default)}});f.extend({name:"v-item-group",provide(){return{itemGroup:this}}});var g=i(8767),p=(0,c.A)(f,g.A).extend({name:"v-list-item-group",provide(){return{isInGroup:!0,listItemGroup:this}},computed:{classes(){return{...f.options.computed.classes.call(this),"v-list-item-group":!0}}},methods:{genData(){return this.setTextColor(this.color,{...f.options.methods.genData.call(this),attrs:{role:"listbox"}})}}}),m=i(6315),y=i(1325),v=i(6256),x=(0,c.A)(g.A,y.A,v.A).extend({name:"v-avatar",props:{left:Boolean,right:Boolean,size:{type:[Number,String],default:48}},computed:{classes(){return{"v-avatar--left":this.left,"v-avatar--right":this.right,...this.roundedClasses}},styles(){return{height:(0,s.Dg)(this.size),minWidth:(0,s.Dg)(this.size),width:(0,s.Dg)(this.size),...this.measurableStyles}}},render(t){const e={staticClass:"v-avatar",class:this.classes,style:this.styles,on:this.$listeners};return t("div",this.setBackgroundColor(this.color,e),this.$slots.default)}}),b=x,w=b.extend({name:"v-list-item-avatar",props:{horizontal:Boolean,size:{type:[Number,String],default:40}},computed:{classes(){return{"v-list-item__avatar--horizontal":this.horizontal,...b.options.computed.classes.call(this),"v-avatar--tile":this.tile||this.horizontal}}},render(t){const e=b.options.render.call(this,t);return e.data=e.data||{},e.data.staticClass+=" v-list-item__avatar",e}}),k=i(24);const S=(0,s.Gn)("v-list-item__action-text","span"),P=(0,s.Gn)("v-list-item__content","div"),M=(0,s.Gn)("v-list-item__title","div"),C=(0,s.Gn)("v-list-item__subtitle","div");n.A,o.A,r.A,m.A,k.A},7410:function(t,e,i){i(158);var s=i(6960);e.A=(0,s.Gn)("spacer","div","v-spacer")},7476:function(t,e,i){var s=i(2195),n=i(9504);t.exports=function(t){if("Function"===s(t))return n(t)}},7495:function(t,e,i){var s=i(3858);e.A=s.A},7588:function(t,e,i){var s=i(6518),n=i(2652),o=i(9306),r=i(8551),a=i(1767);s({target:"Iterator",proto:!0,real:!0},{forEach:function(t){r(this),o(t);var e=a(this),i=0;n(e,(function(e){t(e,i++)}),{IS_RECORD:!0})}})},7629:function(t,e,i){var s=i(6395),n=i(4576),o=i(9433),r="__core-js_shared__",a=t.exports=n[r]||o(r,{});(a.versions||(a.versions=[])).push({version:"3.41.0",mode:s?"pure":"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.41.0/LICENSE",source:"https://github.com/zloirock/core-js"})},7657:function(t,e,i){var s,n,o,r=i(9039),a=i(4901),h=i(34),l=i(2360),u=i(2787),c=i(6840),d=i(8227),f=i(6395),g=d("iterator"),p=!1;[].keys&&(o=[].keys(),"next"in o?(n=u(u(o)),n!==Object.prototype&&(s=n)):p=!0);var m=!h(s)||r((function(){var t={};return s[g].call(t)!==t}));m?s={}:f&&(s=l(s)),a(s[g])||c(s,g,(function(){return this})),t.exports={IteratorPrototype:s,BUGGY_SAFARI_ITERATORS:p}},7740:function(t,e,i){var s=i(9297),n=i(5031),o=i(7347),r=i(4913);t.exports=function(t,e,i){for(var a=n(e),h=r.f,l=o.f,u=0;u<a.length;u++){var c=a[u];s(t,c)||i&&s(i,c)||h(t,c,l(e,c))}}},7750:function(t,e,i){var s=i(4117),n=TypeError;t.exports=function(t){if(s(t))throw new n("Can't call method on "+t);return t}},7751:function(t,e,i){var s=i(4576),n=i(4901),o=function(t){return n(t)?t:void 0};t.exports=function(t,e){return arguments.length<2?o(s[t]):s[t]&&s[t][e]}},7832:function(t,e,i){(function(){const t="object"==typeof globalThis&&globalThis||"object"==typeof global&&global.global===global&&global||"object"==typeof self&&self.self===self&&self||{};void 0===t.requestAnimationFrame&&(void 0===t.setImmediate?t.requestAnimationFrame=e=>t.setTimeout(e,0):t.requestAnimationFrame=t.setImmediate);class e{static _o=void 0!==t.navigator&&void 0!==t.navigator.platform&&null!==t.navigator.platform.match(/(iPhone|iPod|iPad|Mac)/i);static Fk(t,i,s){let n=-1;return function(){const o=this,r=arguments;-1!==n&&e.Tg(n),n=e.tr((()=>{n=-1,s||t.apply(o,r)}),i),s&&!n&&t.apply(o,r)}}static tr(e,i){return t.setTimeout(e,i)}static Tg(e){t.clearTimeout(e)}static hs(e){return t.document.createElement(e)}static o(t){throw new Error(t)}static L(t,i){let s="The object is frozen, so its properties cannot be set: "+t.toString();void 0!==i&&(s+="  to value: "+i),e.o(s)}static uE(t,e,i,s){}static s(t,e,i,s){}static dE(t,e,i){}static ec(t,i,s){if(null===t||"object"!=typeof t){let n=e.fC(i);void 0!==s&&(n+="."+s),e.Zi(t,"object",n)}}static k(t,i,s){e.s(t,"function",i,s)}static gE(t,e,i){}static Zi(t,e,i,s){}static W(t,i,s,n){let o=e.fC(s);void 0!==n&&(o+="."+n),e.o(o+" is not in the range "+i+": "+t)}static Re(t){}static ir(t,e){}static ni(e){t.console&&t.console.log(e)}static K(t){return null!==t&&"object"==typeof t}static it(t){return"function"==typeof t}static Rk=[];static et(){const t=e.Rk.pop();return void 0===t?[]:t}static J(t){t.length=0,e.Rk.push(t)}static mE=Object.freeze([]);static fC(t){return null===t?"*":"string"==typeof t?t:e.it(t)?t.name:""}static Dn(t){return e.it(t)?t.className?t.className:t.name:e.K(t)&&t.constructor?e.Dn(t.constructor):typeof t}static Eh(t,i){return null==i||""===i?null:e.K(t)&&i in t||t[i]?t[i]:null}static toString(t){let i=t;return e.K(t)&&(t.text?i=t.text:t.name?i=t.name:void 0!==t.key?i=t.key:void 0!==t.id?i=t.id:t.constructor===Object&&(t.Text?i=t.Text:t.Name?i=t.Name:void 0!==t.Key?i=t.Key:void 0!==t.Id?i=t.Id:void 0!==t.ID&&(i=t.ID))),void 0===i?"undefined":null===i?"null":i.toString()}static uw(t,e){if(t.hasOwnProperty(e))return!0;let i=Object.getPrototypeOf(t);for(;i&&i!==Function;){if(i.hasOwnProperty(e))return!0;const t=i.pE;if(t&&t[e])return!0;i=Object.getPrototypeOf(i)}return!1}static qD(t){const e=[];let i=0;for(i=0;i<256;i++)e[i]=i;let s=0,n=0;for(i=0;i<256;i++)s=(s+e[i]+119)%256,n=e[i],e[i]=e[s],e[s]=n;i=0,s=0;let o="";for(let r=0;r<t.length;r++)i=(i+1)%256,s=(s+e[i])%256,n=e[i],e[i]=e[s],e[s]=n,o+=String.fromCharCode(t.charCodeAt(r)^e[(e[i]+e[s])%256]);return o}static WD(t){const e="0123456789abcdef",i=[];for(let r=0;r<256;r++)i[e.charAt(r>>4)+e.charAt(15&r)]=String.fromCharCode(r);t.length%2&&(t="0"+t);const s=[];let n=0;for(let r=0;r<t.length;r+=2)s[n++]=i[t.substring(r,r+2)];const o=s.join("");return""===o?"0":o}static Ts(t){return e.qD(e.WD(t))}static color1="@COLOR1";static color2="@COLOR2";static dw="32ab5ff3b26f42dc0ed90f21412913b5"}e.vfo="29e646fdb167";class i{vk;constructor(){this.vk=[]}toString(){return this.vk.join("")}add(t){""!==t&&this.vk.push(t)}}class s{}class n{g;constructor(){this.g=[]}[Symbol.iterator](){return this.g.values()}key;value;get iterator(){return this}reset(){}next(){return!1}hasNext(){return!1}first(){return null}any(){return!1}all(){return!0}each(){return this}map(t){return this}filter(){return this}get count(){return 0}fl(){}toString(){return"EmptyIterator"}static instance=new n}class o{constructor(t){this.key=-1,this.value=t}[Symbol.iterator](){return[this.value].values()}key;value;get iterator(){return this}reset(){this.key=-1}next(){return-1===this.key&&(this.key=0,!0)}hasNext(){return this.next()}first(){return this.key=0,this.value}any(t){return this.key=-1,t(this.value)}all(t){return this.key=-1,t(this.value)}each(t){return this.key=-1,t(this.value),this}map(t){return new o(t(this.value))}filter(t){return t(this.value)?new o(this.value):n.instance}get count(){return 1}fl(){this.value=null}toString(){return"SingletonIterator("+this.value+")"}}class r{qt;Ds;Kt;At;constructor(t){this.qt=t,this.Ds=null,t.er=null,this.Kt=t.nt,this.At=-1}[Symbol.iterator](){return null===this.Ds?this.qt.r.values():this.qt.r.filter(this.Ds).values()}key;value;get iterator(){return this}get predicate(){return this.Ds}set predicate(t){this.Ds=t}reset(){const t=this.qt;t.er=null,this.Kt=t.nt,this.At=-1}next(){const t=this.qt;if(t.nt!==this.Kt){if(this.key<0)return!1;e.Re(t)}const i=t.r,s=i.length;let n=++this.At;const o=this.Ds;if(null!==o)for(;n<s;){const t=i[n];if(o(t))return this.At=n,this.key=n,this.value=t,!0;n++}else{if(n<s)return this.key=n,this.value=i[n],!0;this.fl()}return!1}hasNext(){return this.next()}first(){const t=this.qt;this.Kt=t.nt,this.At=0;const e=t.r,i=e.length,s=this.Ds;if(null!==s){let t=0;for(;t<i;){const i=e[t];if(s(i))return this.At=t,this.key=t,this.value=i,i;t++}return null}if(i>0){const t=e[0];return this.key=0,this.value=t,t}return null}any(t){const i=this.qt;i.er=null;const s=i.nt;this.At=-1;const n=i.r,o=n.length,r=this.Ds;for(let a=0;a<o;a++){const o=n[a];if(null===r||r(o)){if(t(o))return!0;i.nt!==s&&e.Re(i)}}return!1}all(t){const i=this.qt;i.er=null;const s=i.nt;this.At=-1;const n=i.r,o=n.length,r=this.Ds;for(let a=0;a<o;a++){const o=n[a];if(null===r||r(o)){if(!t(o))return!1;i.nt!==s&&e.Re(i)}}return!0}each(t){const i=this.qt;i.er=null;const s=i.nt;this.At=-1;const n=i.r,o=n.length,r=this.Ds;for(let a=0;a<o;a++){const o=n[a];null!==r&&!r(o)||(t(o),i.nt!==s&&e.Re(i))}return this}map(t){const i=this.qt;i.er=null;const s=i.nt;this.At=-1;const n=[],o=i.r,r=o.length,a=this.Ds;for(let h=0;h<r;h++){const r=o[h];null!==a&&!a(r)||(n.push(t(r)),i.nt!==s&&e.Re(i))}const l=new h;return l.r=n,l.ve(),l.iterator}filter(t){const i=this.qt;i.er=null;const s=i.nt;this.At=-1;const n=[],o=i.r,r=o.length,a=this.Ds;for(let h=0;h<r;h++){const r=o[h];null!==a&&!a(r)||(t(r)&&n.push(r),i.nt!==s&&e.Re(i))}const l=new h;return l.r=n,l.ve(),l.iterator}get count(){const t=this.Ds;if(null!==t){let e=0;const i=this.qt.r,s=i.length;for(let n=0;n<s;n++)t(i[n])&&e++;return e}return this.qt.r.length}fl(){this.key=-1,this.value=null,this.Kt=-1,this.Ds=null,this.qt.er=this}toString(){return"ListIterator@"+this.At+"/"+this.qt.count}}class a{qt;Kt;At;constructor(t){this.qt=t,t.sr=null,this.Kt=t.nt,this.At=t.r.length}[Symbol.iterator](){return this.qt.r.reverse().values()}key;value;get iterator(){return this}reset(){const t=this.qt;t.sr=null,this.Kt=t.nt,this.At=t.r.length}next(){const t=this.qt;if(t.nt!==this.Kt){if(this.key<0)return!1;e.Re(t)}const i=--this.At;return i>=0?(this.key=i,this.value=t.r[i],!0):(this.fl(),!1)}hasNext(){return this.next()}first(){const t=this.qt;this.Kt=t.nt;const e=t.r,i=e.length-1;if(this.At=i,i>=0){const t=e[i];return this.key=i,this.value=t,t}return null}any(t){const i=this.qt;i.sr=null;const s=i.nt,n=i.r,o=n.length;this.At=o;for(let r=o-1;r>=0;r--){const o=n[r];if(t(o))return!0;i.nt!==s&&e.Re(i)}return!1}all(t){const i=this.qt;i.sr=null;const s=i.nt,n=i.r,o=n.length;this.At=o;for(let r=o-1;r>=0;r--){const o=n[r];if(!t(o))return!1;i.nt!==s&&e.Re(i)}return!0}each(t){const i=this.qt;i.sr=null;const s=i.nt,n=i.r,o=n.length;this.At=o;for(let r=o-1;r>=0;r--){const o=n[r];t(o),i.nt!==s&&e.Re(i)}return this}map(t){const i=this.qt;i.sr=null;const s=i.nt,n=[],o=i.r,r=o.length;this.At=r;for(let h=r-1;h>=0;h--){const r=o[h];n.push(t(r)),i.nt!==s&&e.Re(i)}const a=new h;return a.r=n,a.ve(),a.iterator}filter(t){const i=this.qt;i.sr=null;const s=i.nt,n=[],o=i.r,r=o.length;this.At=r;for(let h=r-1;h>=0;h--){const r=o[h];t(r)&&n.push(r),i.nt!==s&&e.Re(i)}const a=new h;return a.r=n,a.ve(),a.iterator}get count(){return this.qt.r.length}fl(){this.key=-1,this.value=null,this.Kt=-1,this.qt.sr=this}toString(){return"ListIteratorBackwards("+this.At+"/"+this.qt.count+")"}}class h{h;r;nt;er;sr;constructor(t){u.Gi(this),this.h=!1,this.r=[],this.nt=0,this.er=null,this.sr=null,void 0!==t&&this.addAll(t)}[Symbol.iterator](){return this.r.values()}ve(){let t=this.nt;t++,t>999999999&&(t=0),this.nt=t}u(){return this.h=!0,this}Nt(){return this.h=!1,this}toString(){return"List()#"+u.as(this)}add(t){return this.h&&e.L(this,t),this.r.push(t),this.ve(),this}push(t){this.add(t)}addAll(t){if(null===t)return this;this.h&&e.L(this);const i=this.r;if(Array.isArray(t)){const e=t.length;for(let s=0;s<e;s++){const e=t[s];i.push(e)}}else{const e=t.iterator;for(;e.next();){const t=e.value;i.push(t)}}return this.ve(),this}clear(){this.h&&e.L(this),this.r.length=0,this.ve()}contains(t){return this.has(t)}has(t){return null!==t&&-1!==this.r.indexOf(t)}indexOf(t){return null===t?-1:this.r.indexOf(t)}elt(t){const i=this.r;return(t<0||t>=i.length)&&e.W(t,"0 <= i < length",h,"elt:i"),i[t]}get(t){return this.elt(t)}setElt(t,i){const s=this.r;(t<0||t>=s.length)&&e.W(t,"0 <= i < length",h,"setElt:i"),this.h&&e.L(this,t),s[t]=i}set(t,e){this.setElt(t,e)}first(){const t=this.r;return 0===t.length?null:t[0]}last(){const t=this.r,e=t.length;return e>0?t[e-1]:null}pop(){this.h&&e.L(this);const t=this.r;return t.length>0?t.pop():null}any(t){const i=this.r,s=this.nt,n=i.length;for(let o=0;o<n;o++){if(t(i[o]))return!0;this.nt!==s&&e.Re(this)}return!1}all(t){const i=this.r,s=this.nt,n=i.length;for(let o=0;o<n;o++){if(!t(i[o]))return!1;this.nt!==s&&e.Re(this)}return!0}each(t){const i=this.r,s=this.nt,n=i.length;for(let o=0;o<n;o++)t(i[o]),this.nt!==s&&e.Re(this);return this}map(t){const i=new h,s=[],n=this.r,o=this.nt,r=n.length;for(let a=0;a<r;a++)s.push(t(n[a])),this.nt!==o&&e.Re(this);return i.r=s,i.ve(),i}filter(t){const i=new h,s=[],n=this.r,o=this.nt,r=n.length;for(let a=0;a<r;a++){const i=n[a];t(i)&&s.push(i),this.nt!==o&&e.Re(this)}return i.r=s,i.ve(),i}insertAt(t,i){t<0&&e.W(t,">= 0",h,"insertAt:i"),this.h&&e.L(this,t);const s=this.r;t>=s.length?s.push(i):s.splice(t,0,i),this.ve()}remove(t){return this.delete(t)}delete(t){if(null===t)return!1;this.h&&e.L(this,t);const i=this.r,s=i.indexOf(t);return-1!==s&&(s===i.length-1?i.pop():i.splice(s,1),this.ve(),!0)}removeAt(t){const i=this.r;(t<0||t>=i.length)&&e.W(t,"0 <= i < length",h,"removeAt:i"),this.h&&e.L(this,t),t===i.length-1?i.pop():i.splice(t,1),this.ve()}removeRange(t,i){const s=this.r,n=s.length;if(t<0)t=0;else if(t>=n)return this;if(i<0)return this;if(i>=n&&(i=n-1),t>i)return this;this.h&&e.L(this);let o=t,r=i+1;for(;r<n;)s[o++]=s[r++];return s.length=n-(i-t+1),this.ve(),this}copy(){const t=new h,e=this.r;return e.length>0&&(t.r=Array.prototype.slice.call(e)),t}toArray(){const t=this.r,e=this.count,i=new Array(e);for(let s=0;s<e;s++)i[s]=t[s];return i}get uC(){return this.r}toSet(){const t=new u,e=this.r,i=this.count;for(let s=0;s<i;s++)t.add(e[s]);return t}sort(t){return this.h&&e.L(this),this.r.sort(t),this.ve(),this}sortRange(t,i,s){const n=this.r,o=n.length;void 0===i&&(i=0),void 0===s&&(s=o),this.h&&e.L(this);const r=s-i;if(r<=1)return this;if((i<0||i>=o-1)&&e.W(i,"0 <= from < length",h,"sortRange:from"),2===r){const e=n[i],s=n[i+1];return t(e,s)>0&&(n[i]=s,n[i+1]=e,this.ve()),this}if(0===i)if(s>=o)n.sort(t);else{const e=n.slice(0,s);e.sort(t);for(let t=0;t<s;t++)n[t]=e[t]}else if(s>=o){const e=n.slice(i);e.sort(t);for(let t=i;t<o;t++)n[t]=e[t-i]}else{const e=n.slice(i,s);e.sort(t);for(let t=i;t<s;t++)n[t]=e[t-i]}return this.ve(),this}reverse(){return this.h&&e.L(this),this.r.reverse(),this.ve(),this}get count(){return this.r.length}get size(){return this.r.length}get length(){return this.r.length}get iterator(){if(this.r.length<=0)return n.instance;const t=this.er;return null!==t?(t.reset(),t):new r(this)}get iteratorBackwards(){if(this.r.length<=0)return n.instance;const t=this.sr;return null!==t?(t.reset(),t):new a(this)}}class l{yo;ii;constructor(t){this.yo=t,this.ii=t.g.values()}[Symbol.iterator](){return this.yo.g.values()}key;value;get iterator(){return this}reset(){const t=this.yo;this.ii=t.g.values()}next(){const t=this.ii.next();return this.value=t.value,this.key=t.value,!t.done}hasNext(){return this.next()}first(){return 0===this.yo.g.size?null:(this.ii=this.yo.g.values(),this.ii.next().value)}any(t){return this.yo.any(t)}all(t){return this.yo.all(t)}each(t){return this.yo.each(t),this}map(t){const e=new h;return this.yo.g.forEach((i=>e.add(t(i)))),e.iterator}filter(t){const e=new h;return this.yo.g.forEach((i=>{t(i)&&e.add(i)})),e.iterator}get count(){return this.yo.count}fl(){this.key=null,this.value=null,this.ii=null}toString(){return"SetIterator"}}class u{h;g;constructor(t){this.h=!1,this.g=new Set,void 0!==t&&this.addAll(t)}[Symbol.iterator](){return this.g.values()}values(){return this.g.values()}u(){return this.h=!0,this}Nt(){return this.h=!1,this}toString(){return"Set()#"+u.as(this)}add(t){return null===t||this.g.add(t),this}addAll(t){if(null===t)return this;if(Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++){const e=t[i];null!==e&&this.g.add(e)}}else{const e=t.iterator;for(;e.next();){const t=e.value;null!==t&&this.g.add(t)}}return this}has(t){return this.g.has(t)}contains(t){return this.has(t)}containsAll(t){if(null===t)return!0;const e=t.iterator;for(;e.next();)if(!this.has(e.value))return!1;return!0}containsAny(t){if(null===t)return!0;const e=t.iterator;for(;e.next();)if(this.has(e.value))return!0;return!1}first(){return 0===this.g.size?null:this.g.values().next().value}any(t){for(const e of this.g)if(t(e))return!0;return!1}all(t){for(const e of this.g)if(!t(e))return!1;return!0}each(t){for(const e of this.g)t(e);return this}map(t){const e=new u;for(const i of this.g)e.add(t(i));return e}filter(t){const e=new u;for(const i of this.g)t(i)&&e.add(i);return e}delete(t){return this.h&&e.L(this),this.g.delete(t)}remove(t){return this.delete(t)}removeAll(t){if(null===t)return this;if(this.h&&e.L(this),Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++)this.delete(t[i])}else{const e=t.iterator;for(;e.next();)this.delete(e.value)}return this}retainAll(t){if(null===t)return this;if(0===this.count)return this;this.h&&e.L(this);const i=new u;i.addAll(t);const s=[],n=this.iterator;for(;n.next();){const t=n.value;i.has(t)||s.push(t)}return this.removeAll(s),this}clear(){this.h&&e.L(this),this.g.clear()}copy(){const t=new u;return this.g.forEach((e=>t.add(e))),t}toArray(){return Array.from(this.g)}toList(){const t=new h;return this.g.forEach((e=>t.add(e))),t}get count(){return this.g.size}get size(){return this.g.size}get iterator(){return this.g.size<=0?n.instance:new l(this)}entries(){return this.g.entries()}keys(){return this.g.keys()}forEach(t,e){return this.g.forEach(t,e)}static gw=1;static Gi(t){t.__gohashid=u.gw++}static as(t){return t.__gohashid}}class c{q;ii;constructor(t){this.q=t,this.ii=t.g.keys()}[Symbol.iterator](){return this.q.g.keys()}key;value;get iterator(){return this}reset(){const t=this.q;this.ii=t.g.keys()}next(){const t=this.ii.next();return this.value=t.value,this.key=t.value,!t.done}hasNext(){return this.next()}first(){return 0===this.q.g.size?null:(this.ii=this.q.g.keys(),this.ii.next().value)}any(t){for(const e of this.q.g)if(t(e[0]))return!0;return!1}all(t){for(const e of this.q.g)if(!t(e[0]))return!1;return!0}each(t){for(const e of this.q.g)t(e[0]);return this}map(t){const e=this.q,i=new h;for(const s of e.g)i.add(t(s[0]));return i.iterator}filter(t){const e=this.q,i=new h;for(const s of e.g){const e=s[0];t(e)&&i.add(e)}return i.iterator}get count(){return this.q.size}fl(){this.key=null,this.value=null,this.ii=null}toString(){return"MapKeySetIterator"}}class d extends u{q;constructor(t){super(),u.Gi(this),this.h=!0,this.q=t}[Symbol.iterator](){return this.g.keys()}values(){return this.g.keys()}u(){return this}Nt(){return this}toString(){return"MapKeySet("+this.q.toString()+")"}add(t){e.o("This Set is read-only: "+this.toString())}has(t){return this.q.has(t)}contains(t){return this.has(t)}delete(t){e.o("This Set is read-only: "+this.toString())}remove(t){return this.delete(t)}clear(){e.o("This Set is read-only: "+this.toString())}first(){return 0===this.q.g.size?null:this.q.g.keys().next().value}any(t){for(const e of this.q.g)if(t(e[0]))return!0;return!1}all(t){for(const e of this.q.g)if(!t(e[0]))return!1;return!0}each(t){for(const e of this.q.g)t(e[0]);return this}map(t){const e=new u;for(const i of this.q.g)e.add(t(i[0]));return e}filter(t){const e=new u;for(const i of this.q.g){const s=i[0];t(s)&&e.add(s)}return e}copy(){return new d(this.q)}toSet(){const t=new u,e=this.q.g;for(const i of e)t.add(i[0]);return t}toArray(){const t=this.q.g,e=new Array(t.size);let i=0;for(const s of t)e[i]=s[0],i++;return e}toList(){const t=new h,e=this.q.g;for(const i of e)t.add(i[0]);return t}get count(){return this.q.size}get size(){return this.q.size}get iterator(){return this.q.size<=0?n.instance:new c(this.q)}}class f{q;ii;constructor(t){this.q=t,this.ii=t.g.values()}[Symbol.iterator](){return this.q.g.values()}key;value;get iterator(){return this}reset(){const t=this.q;this.ii=t.g.values()}next(){const t=this.ii.next();return this.value=t.value,this.key=t.value,!t.done}hasNext(){return this.next()}first(){return 0===this.q.g.size?null:(this.ii=this.q.g.values(),this.ii.next().value)}any(t){for(const e of this.q.g)if(t(e[1]))return!0;return!1}all(t){for(const e of this.q.g)if(!t(e[1]))return!1;return!0}each(t){for(const e of this.q.g)t(e[1]);return this}map(t){const e=this.q,i=new h;for(const s of e.g)i.add(t(s[1]));return i.iterator}filter(t){const e=this.q,i=new h;for(const s of e.g){const e=s[1];t(e)&&i.add(e)}return i.iterator}get count(){return this.q.size}fl(){this.key=null,this.value=null,this.ii=null}toString(){return"MapValueSetIterator"}}class g{constructor(t,e){this.key=t,this.value=e}toString(){return"{"+this.key+":"+this.value+"}"}key;value}class p{q;ii;constructor(t){this.q=t,this.ii=t.g.entries()}[Symbol.iterator](){return this.q.g.entries()}key;value;get iterator(){return this}reset(){const t=this.q;this.ii=t.g.entries()}next(){const t=this.ii.next();return t.done?(this.key=null,this.value=null,!1):(this.key=t.value[0],this.value=t.value[1],!0)}hasNext(){return this.next()}first(){if(0===this.q.g.size)return null;this.ii=this.q.g.entries();const t=this.ii.next().value;return this.key=t[0],this.value=t[1],new g(t[0],t[1])}any(t){return this.q.any(t)}all(t){return this.q.all(t)}each(t){return this.q.each(t),this}map(t){const e=new h;let i=null;return this.q.g.forEach(((s,n)=>{null===i?i=new g(n,s):(i.key=n,i.value=s),e.add(t(i))})),e.iterator}filter(t){const e=new h;let i=null;return this.q.g.forEach(((s,n)=>{null===i?i=new g(n,s):(i.key=n,i.value=s),t(i)&&(e.add(i),i=null)})),e.iterator}get count(){return this.q.size}fl(){this.key=null,this.value=null,this.ii=null}toString(){return"MapIterator"}}class m{h;g;constructor(t){u.Gi(this),this.h=!1,this.g=new Map,void 0!==t&&this.addAll(t)}[Symbol.iterator](){return this.g.entries()}entries(){return this.g.entries()}u(){return this.h=!0,this}Nt(){return this.h=!1,this}toString(){return"Map()#"+u.as(this)}set(t,i){return this.h&&e.L(this,t),this.g.set(t,i),this}add(t,e){return this.set(t,e)}addAll(t){if(null===t)return this;if(this.h&&e.L(this),Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++){const e=t[i];this.set(e.key,e.value)}}else if(t instanceof m){const e=t.iterator;for(;e.next();)this.set(e.key,e.value)}else{const e=t.iterator;for(;e.next();){const t=e.value;this.set(t.key,t.value)}}return this}first(){if(0===this.g.size)return null;const t=this.g.entries().next().value;return new g(t[0],t[1])}any(t){let e=null;for(const[i,s]of this.g)if(null===e?e=new g(i,s):(e.key=i,e.value=s),t(e))return!0;return!1}all(t){let e=null;for(const[i,s]of this.g)if(null===e?e=new g(i,s):(e.key=i,e.value=s),!t(e))return!1;return!0}each(t){let e=null;for(const[i,s]of this.g)null===e?e=new g(i,s):(e.key=i,e.value=s),t(e);return this}map(t){const e=new m;let i=null;for(const[s,n]of this.g)null===i?i=new g(s,n):(i.key=s,i.value=n),e.set(s,t(i));return e}filter(t){const e=new m;let i=null;for(const[s,n]of this.g)null===i?i=new g(s,n):(i.key=s,i.value=n),t(i)&&e.set(s,n);return e}has(t){return this.g.has(t)}contains(t){return this.has(t)}get(t){const e=this.g.get(t);return void 0===e?null:e}getValue(t){return this.get(t)}delete(t){return null!==t&&(this.h&&e.L(this,t),this.g.delete(t))}remove(t){return this.delete(t)}clear(){this.h&&e.L(this),this.g.clear()}copy(){const t=new m;return t.g=new Map(this.g),t}toArray(){const t=this.g,e=new Array(t.size);let i=0;for(const s of t)e[i]=new g(s[0],s[1]),i++;return e}toKeySet(){return new d(this)}get count(){return this.g.size}get size(){return this.g.size}get iterator(){return this.g.size<=0?n.instance:new p(this)}get iteratorKeys(){return this.count<=0?n.instance:new c(this)}keys(){return this.g.keys()}get iteratorValues(){return this.count<=0?n.instance:new f(this)}values(){return this.g.values()}forEach(t,e){return this.g.forEach(t,e)}}class y{px;py;h;constructor(t,i){void 0===t?(this.px=0,this.py=0):"number"==typeof t&&"number"==typeof i?(this.px=t,this.py=i):e.o("Invalid arguments to Point constructor: "+t+", "+i),this.h=!1}a(t){return this.px=t.px,this.py=t.py,this}i(t,e){return this.px=t,this.py=e,this}setTo(t,e){return this.px=t,this.py=e,this}set(t){return this.px=t.px,this.py=t.py,this}copy(){const t=new y;return t.px=this.px,t.py=this.py,t}$(){return this.h=!0,Object.freeze(this),this}P(){return this.h||Object.isFrozen(this)?this:this.copy().u()}u(){return this.h||(this.h=!0),this}Nt(){return this.h&&(Object.isFrozen(this)&&e.o("cannot thaw constant: "+this),this.h=!1),this}mw(t){}static parse(t){if("string"==typeof t){const e=t.split(" ");let i=0,s=0;for(;""===e[i];)i++;let n=e[i++];n&&(s=parseFloat(n));let o=0;for(;""===e[i];)i++;return n=e[i++],n&&(o=parseFloat(n)),new y(s,o)}return new y}static stringify(t){return t.x.toString()+" "+t.y.toString()}static stringifyFixed(t){return e.s(t,"number",y,"stringifyFixed:digits"),e=>e.x.toFixed(t)+" "+e.y.toFixed(t)}toString(){return"Point("+this.x+","+this.y+")"}equals(t){return t instanceof y&&(this.px===t.x&&this.py===t.y)}equalTo(t,e){return this.px===t&&this.py===e}equalsApprox(t){return S.f(this.px,t.x)&&S.f(this.py,t.y)}add(t){return this.px+=t.x,this.py+=t.y,this}subtract(t){return this.px-=t.x,this.py-=t.y,this}offset(t,e){return this.px+=t,this.py+=e,this}rotate(t){if(0===t)return this;const e=this.px,i=this.py;if(0===e&&0===i)return this;let s=0,n=0;if(t>=360?t-=360:t<0&&(t+=360),90===t)s=0,n=1;else if(180===t)s=-1,n=0;else if(270===t)s=0,n=-1;else{const e=t*Math.PI/180;s=Math.cos(e),n=Math.sin(e)}return this.px=s*e-n*i,this.py=n*e+s*i,this}scale(t,e){return this.px*=t,this.py*=e,this}distanceSquaredPoint(t){const e=t.x-this.px,i=t.y-this.py;return e*e+i*i}distanceSquared(t,e){const i=t-this.px,s=e-this.py;return i*i+s*s}normalize(){const t=this.px,e=this.py,i=Math.sqrt(t*t+e*e);return i>0&&(this.px=t/i,this.py=e/i),this}directionPoint(t){return this.dC(t.x-this.px,t.y-this.py)}direction(t,e){return this.dC(t-this.px,e-this.py)}dC(t,e){if(0===t)return e>0?90:e<0?270:0;if(0===e)return t>0?0:180;{if(isNaN(t)||isNaN(e))return 0;let i=180*Math.atan(Math.abs(e/t))/Math.PI;return t<0?e<0?i+=180:i=180-i:e<0&&(i=360-i),i}}static compareWithLineSegment(t,e,i,s,n,o){return S.eu(t,e,i,s,n,o)}compareWithLineSegmentPoint(t,e){return S.eu(t.x,t.y,e.x,e.y,this.x,this.y)}static intersectingLineSegments(t,e,i,s,n,o,r,a){return S.su(t,e,i,s,n,o,r,a)}projectOntoLineSegment(t,e,i,s){return S.ul(t,e,i,s,this.px,this.py,this),this}projectOntoLineSegmentPoint(t,e){return S.ul(t.x,t.y,e.x,e.y,this.px,this.py,this),this}snapToGrid(t,e,i,s){return S.Dg(this.px,this.py,t,e,i,s,this),this}snapToGridPoint(t,e){return S.Dg(this.px,this.py,t.x,t.y,e.width,e.height,this),this}setRectSpot(t,e){return this.px=t.x+e.x*t.width+e.offsetX,this.py=t.y+e.y*t.height+e.offsetY,this}setSpot(t,e,i,s,n){return this.px=t+n.x*i+n.offsetX,this.py=e+n.y*s+n.offsetY,this}T(t){return t.gt(this),this}Oe(t){return t.$e(this),this}static distanceLineSegmentSquared(t,e,i,s,n,o){let r=n-i,a=o-s;const h=r*r+a*a,l=i-t,u=s-e,c=-l*r-u*a;if(c<=0||c>=h)return r=n-t,a=o-e,Math.min(l*l+u*u,r*r+a*a);{const t=r*u-a*l;return t*t/h}}static distanceSquared(t,e,i,s){const n=i-t,o=s-e;return n*n+o*o}static direction(t,e,i,s){const n=i-t,o=s-e;if(0===n)return o>0?90:o<0?270:0;if(0===o)return n>0?0:180;{if(isNaN(n)||isNaN(o))return 0;let t=180*Math.atan(Math.abs(o/n))/Math.PI;return n<0?o<0?t+=180:t=180-t:o<0&&(t=360-t),t}}get x(){return this.px}set x(t){this.px=t}get y(){return this.py}set y(t){this.py=t}isReal(){return isFinite(this.x)&&isFinite(this.y)}static wo=new y(0,0).$();static gC=new y(-1/0,-1/0).$();static mC=new y(1/0,1/0).$();static pC=new y(6,6).$();static Ok=new y(NaN,NaN).$();static Ik=[];static l(){const t=y.Ik.pop();return void 0===t?new y:t}static V(t,e){const i=y.Ik.pop();return void 0===i?new y(t,e):(i.x=t,i.y=e,i)}static e(t){y.Ik.push(t)}}class v{sw;sh;h;constructor(t,i){void 0===t?(this.sw=0,this.sh=0):"number"==typeof t&&(t>=0||isNaN(t))&&"number"==typeof i&&(i>=0||isNaN(i))?(this.sw=t,this.sh=i):e.o("Invalid arguments to Size constructor: "+t+", "+i),this.h=!1}a(t){return this.sw=t.sw,this.sh=t.sh,this}i(t,e){return this.sw=t,this.sh=e,this}setTo(t,e){return this.sw=t,this.sh=e,this}set(t){return this.sw=t.sw,this.sh=t.sh,this}copy(){const t=new v;return t.sw=this.sw,t.sh=this.sh,t}$(){return this.h=!0,Object.freeze(this),this}P(){return this.h||Object.isFrozen(this)?this:this.copy().u()}u(){return this.h||(this.h=!0),this}Nt(){return this.h&&(Object.isFrozen(this)&&e.o("cannot thaw constant: "+this),this.h=!1),this}mw(t){}static parse(t){if("string"==typeof t){const e=t.split(" ");let i=0,s=0;for(;""===e[i];)i++;let n=e[i++];n&&(s=parseFloat(n));let o=0;for(;""===e[i];)i++;return n=e[i++],n&&(o=parseFloat(n)),new v(s,o)}return new v}static stringify(t){return t.width.toString()+" "+t.height.toString()}static stringifyFixed(t){return e.s(t,"number",v,"stringifyFixed:digits"),e=>e.width.toFixed(t)+" "+e.height.toFixed(t)}toString(){return"Size("+this.width+","+this.height+")"}equals(t){return t instanceof v&&(this.sw===t.width&&this.sh===t.height)}equalTo(t,e){return this.sw===t&&this.sh===e}equalsApprox(t){return S.f(this.sw,t.width)&&S.f(this.sh,t.height)}inflate(t,e){const i=this.width+t;this.sw=i>=0?i:0;const s=this.height+e;return this.sh=s>=0?s:0,this}get width(){return this.sw}set width(t){t<0&&e.W(t,">= 0",v,"width"),this.sw=t}get height(){return this.sh}set height(t){t<0&&e.W(t,">= 0",v,"height"),this.sh=t}isReal(){return isFinite(this.width)&&isFinite(this.height)}static sc=new v(0,0).$();static Ek=new v(1,1).$();static yC=new v(6,6).$();static nu=new v(8,8).$();static wC=new v(10,10).$();static Bk=new v(1/0,1/0).$();static pw=new v(NaN,NaN).$();static xC=[];static l(){const t=v.xC.pop();return void 0===t?new v:t}static e(t){v.xC.push(t)}}class x{rx;ry;rw;rh;h;constructor(t,i,s,n){if(void 0===t)this.rx=0,this.ry=0,this.rw=0,this.rh=0;else if("number"==typeof t&&"number"==typeof i&&"number"==typeof s&&(s>=0||isNaN(s))&&"number"==typeof n&&(n>=0||isNaN(n)))this.rx=t,this.ry=i,this.rw=s,this.rh=n;else if(t instanceof y){const s=t.x,n=t.y;if(i instanceof y){const t=i.x,e=i.y;this.rx=Math.min(s,t),this.ry=Math.min(n,e),this.rw=Math.abs(s-t),this.rh=Math.abs(n-e)}else i instanceof v?(this.rx=s,this.ry=n,this.rw=i.width,this.rh=i.height):e.o("Incorrect second argument supplied to Rect constructor "+i)}else e.o("Invalid arguments to Rect constructor: "+t+", "+i+", "+s+", "+n);this.h=!1}a(t){return this.rx=t.rx,this.ry=t.ry,this.rw=t.rw,this.rh=t.rh,this}i(t,e,i,s){return this.rx=t,this.ry=e,this.rw=i,this.rh=s,this}Fn(t,e){return this.rw=t,this.rh=e,this}setTo(t,e,i,s){return this.rx=t,this.ry=e,this.rw=i,this.rh=s,this}set(t){return this.rx=t.rx,this.ry=t.ry,this.rw=t.rw,this.rh=t.rh,this}setPoint(t){return this.rx=t.x,this.ry=t.y,this}setSize(t){return this.rw=t.width,this.rh=t.height,this}copy(){const t=new x;return t.rx=this.rx,t.ry=this.ry,t.rw=this.rw,t.rh=this.rh,t}$(){return this.h=!0,Object.freeze(this),this}P(){return this.h||Object.isFrozen(this)?this:this.copy().u()}u(){return this.h||(this.h=!0),this}Nt(){return this.h&&(Object.isFrozen(this)&&e.o("cannot thaw constant: "+this),this.h=!1),this}mw(t){}static parse(t){if("string"==typeof t){const e=t.split(" ");let i=0,s=0;for(;""===e[i];)i++;let n=e[i++];n&&(s=parseFloat(n));let o=0;for(;""===e[i];)i++;n=e[i++],n&&(o=parseFloat(n));let r=0;for(;""===e[i];)i++;n=e[i++],n&&(r=parseFloat(n));let a=0;for(;""===e[i];)i++;return n=e[i++],n&&(a=parseFloat(n)),new x(s,o,r,a)}return new x}static stringify(t){return t.x.toString()+" "+t.y.toString()+" "+t.width.toString()+" "+t.height.toString()}static stringifyFixed(t){return e.s(t,"number",x,"stringifyFixed:digits"),e=>e.x.toFixed(t)+" "+e.y.toFixed(t)+" "+e.width.toFixed(t)+" "+e.height.toFixed(t)}toString(){return"Rect("+this.x+","+this.y+","+this.width+","+this.height+")"}equals(t){return t instanceof x&&(this.rx===t.x&&this.ry===t.y&&this.rw===t.width&&this.rh===t.height)}equalTo(t,e,i,s){return this.rx===t&&this.ry===e&&this.rw===i&&this.rh===s}equalsApprox(t){return S.f(this.rx,t.x)&&S.f(this.ry,t.y)&&S.f(this.rw,t.width)&&S.f(this.rh,t.height)}equalsApproxTo(t,e,i,s){return S.f(this.rx,t)&&S.f(this.ry,e)&&S.f(this.rw,i)&&S.f(this.rh,s)}equalsApproxClose(t){return S.z(this.rx,t.x)&&S.z(this.ry,t.y)&&S.z(this.rw,t.width)&&S.z(this.rh,t.height)}containsPoint(t){return this.rx<=t.x&&this.rx+this.rw>=t.x&&this.ry<=t.y&&this.ry+this.rh>=t.y}containsRect(t){return this.rx<=t.x&&t.x+t.width<=this.rx+this.rw&&this.ry<=t.y&&t.y+t.height<=this.ry+this.rh}contains(t,e,i,s){return void 0===i&&(i=0),void 0===s&&(s=0),this.rx<=t&&t+i<=this.rx+this.rw&&this.ry<=e&&e+s<=this.ry+this.rh}offset(t,e){return this.rx+=t,this.ry+=e,this}inflate(t,e){return this.yw(e,t,e,t)}addMargin(t){return this.yw(t.top,t.right,t.bottom,t.left)}subtractMargin(t){return this.yw(-t.top,-t.right,-t.bottom,-t.left)}grow(t,e,i,s){return this.yw(t,e,i,s)}yw(t,e,i,s){const n=this.rw;e+s<=-n?(this.rx+=n/2,this.rw=0):(this.rx-=s,this.rw+=e+s);const o=this.rh;return t+i<=-o?(this.ry+=o/2,this.rh=0):(this.ry-=t,this.rh+=t+i),this}intersectRect(t){return this.bC(t.x,t.y,t.width,t.height)}intersect(t,e,i,s){return this.bC(t,e,i,s)}bC(t,e,i,s){const n=Math.max(this.rx,t),o=Math.max(this.ry,e),r=Math.min(this.rx+this.rw,t+i),a=Math.min(this.ry+this.rh,e+s);return this.rx=n,this.ry=o,this.rw=Math.max(0,r-n),this.rh=Math.max(0,a-o),this}intersectsRect(t){return this.intersects(t.x,t.y,t.width,t.height)}intersects(t,e,i,s){let n=this.rw;const o=this.rx;if(n!==1/0&&i!==1/0&&(n+=o,i+=t,isNaN(i)||isNaN(n)||o>i||t>n))return!1;let r=this.rh;const a=this.ry;return!(r!==1/0&&s!==1/0&&(r+=a,s+=e,isNaN(s)||isNaN(r)||a>s||e>r))}intersectsRectPlus(t,e){let i=this.rw,s=t.width+e+e;const n=this.rx,o=t.x-e;if(i+=n,s+=o,n>s||o>i)return!1;let r=this.rh,a=t.height+e+e;const h=this.ry,l=t.y-e;return r+=h,a+=l,!(h>a||l>r)}unionPoint(t){return this.unionNoCheck(t.x,t.y,0,0)}unionRect(t){return this.unionNoCheck(t.rx,t.ry,t.rw,t.rh)}union(t,e,i,s){return void 0===i&&(i=0),void 0===s&&(s=0),this.unionNoCheck(t,e,i,s)}unionNoCheck(t,e,i,s){const n=Math.min(this.rx,t),o=Math.min(this.ry,e),r=Math.max(this.rx+this.rw,t+i),a=Math.max(this.ry+this.rh,e+s);return this.rx=n,this.ry=o,this.rw=r-n,this.rh=a-o,this}setSpot(t,e,i){return this.rx=t-i.offsetX-i.x*this.rw,this.ry=e-i.offsetY-i.y*this.rh,this}static contains(t,e,i,s,n,o,r,a){return void 0===r&&(r=0),void 0===a&&(a=0),t<=n&&n+r<=t+i&&e<=o&&o+a<=e+s}static intersects(t,e,i,s,n,o,r,a){let h=i,l=r;const u=t,c=n;if(h+=u,l+=c,u>l||c>h)return!1;let d=s,f=a;const g=e,p=o;return d+=g,f+=p,!(g>f||p>d)}static intersectsLineSegment(t,e,i,s,n,o,r,a){return S.kC(t,e,i,s,n,o,r,a)}get x(){return this.rx}set x(t){this.rx=t}get y(){return this.ry}set y(t){this.ry=t}get width(){return this.rw}set width(t){t<0&&e.W(t,">= 0",x,"width"),this.rw=t}get height(){return this.rh}set height(t){t<0&&e.W(t,">= 0",x,"height"),this.rh=t}get left(){return this.rx}set left(t){this.rx=t}get top(){return this.ry}set top(t){this.ry=t}get right(){return this.rx+this.rw}set right(t){this.rx+=t-(this.rx+this.rw)}get bottom(){return this.ry+this.rh}set bottom(t){this.ry+=t-(this.ry+this.rh)}get position(){return new y(this.rx,this.ry)}set position(t){this.rx=t.x,this.ry=t.y}get size(){return new v(this.rw,this.rh)}set size(t){this.rw=t.width,this.rh=t.height}get center(){return new y(this.rx+this.rw/2,this.ry+this.rh/2)}set center(t){this.rx=t.x-this.rw/2,this.ry=t.y-this.rh/2}get centerX(){return this.rx+this.rw/2}set centerX(t){this.rx=t-this.rw/2}get centerY(){return this.ry+this.rh/2}set centerY(t){this.ry=t-this.rh/2}isReal(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)}isEmpty(){return 0===this.width&&0===this.height}static Fg=new x(0,0,0,0).$();static JD=new x(NaN,NaN,NaN,NaN).$();static Uk=[];static l(){const t=x.Uk.pop();return void 0===t?new x:t}static V(t,e,i,s){const n=x.Uk.pop();return void 0===n?new x(t,e,i,s):n.i(t,e,i,s)}static e(t){x.Uk.push(t)}}class b{mt;mr;mb;ml;h;constructor(t,i,s,n){void 0===t?(this.mt=0,this.mr=0,this.mb=0,this.ml=0):void 0===i?(i=t,s=t,n=t,this.mt=t,this.mr=i,this.mb=s,this.ml=n):void 0===s?(s=t,n=i,this.mt=t,this.mr=i,this.mb=s,this.ml=n):void 0!==n?(this.mt=t,this.mr=i,this.mb=s,this.ml=n):e.o("Invalid arguments to Margin constructor: "+t+", "+i+", "+s+", "+n),this.h=!1}a(t){return this.mt=t.mt,this.mr=t.mr,this.mb=t.mb,this.ml=t.ml,this}setTo(t,e,i,s){return this.mt=t,this.mr=e,this.mb=i,this.ml=s,this}set(t){return this.mt=t.mt,this.mr=t.mr,this.mb=t.mb,this.ml=t.ml,this}copy(){const t=new b;return t.mt=this.mt,t.mr=this.mr,t.mb=this.mb,t.ml=this.ml,t}$(){return this.h=!0,Object.freeze(this),this}P(){return this.h||Object.isFrozen(this)?this:this.copy().u()}u(){return this.h||(this.h=!0),this}Nt(){return this.h&&(Object.isFrozen(this)&&e.o("cannot thaw constant: "+this),this.h=!1),this}mw(t){}static parse(t){if("string"==typeof t){const e=t.split(" ");let i=0,s=NaN;for(;""===e[i];)i++;let n=e[i++];if(n&&(s=parseFloat(n)),isNaN(s))return new b;let o=NaN;for(;""===e[i];)i++;if(n=e[i++],n&&(o=parseFloat(n)),isNaN(o))return new b(s);let r=NaN;for(;""===e[i];)i++;if(n=e[i++],n&&(r=parseFloat(n)),isNaN(r))return new b(s,o);let a=NaN;for(;""===e[i];)i++;return n=e[i++],n&&(a=parseFloat(n)),isNaN(a)?new b(s,o):new b(s,o,r,a)}return new b}static stringify(t){return t.top.toString()+" "+t.right.toString()+" "+t.bottom.toString()+" "+t.left.toString()}static stringifyFixed(t){return e.s(t,"number",b,"stringifyFixed:digits"),e=>e.top.toFixed(t)+" "+e.right.toFixed(t)+" "+e.bottom.toFixed(t)+" "+e.left.toFixed(t)}toString(){return"Margin("+this.top+","+this.right+","+this.bottom+","+this.left+")"}equals(t){return t instanceof b&&(this.mt===t.top&&this.mr===t.right&&this.mb===t.bottom&&this.ml===t.left)}equalTo(t,e,i,s){return this.mt===t&&this.mr===e&&this.mb===i&&this.ml===s}equalsApprox(t){return S.f(this.mt,t.top)&&S.f(this.mr,t.right)&&S.f(this.mb,t.bottom)&&S.f(this.ml,t.left)}get top(){return this.mt}set top(t){this.mt=t}get right(){return this.mr}set right(t){this.mr=t}get bottom(){return this.mb}set bottom(t){this.mb=t}get left(){return this.ml}set left(t){this.ml=t}isReal(){return isFinite(this.top)&&isFinite(this.right)&&isFinite(this.bottom)&&isFinite(this.left)}static Rg=new b(0,0,0,0).$();static PC=new b(2,2,2,2).$();static SC=[];static l(){const t=b.SC.pop();return void 0===t?new b:t}static e(t){b.SC.push(t)}}class w{sx;sy;ox;oy;h;constructor(t,e,i,s){void 0===t?(this.sx=0,this.sy=0,this.ox=0,this.oy=0):(void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),this.sx=t,this.sy=e,this.ox=i,this.oy=s),this.h=!1}a(t){return this.sx=t.sx,this.sy=t.sy,this.ox=t.ox,this.oy=t.oy,this}setTo(t,e,i,s){return this.sx=t,this.sy=e,this.ox=i,this.oy=s,this}set(t){return this.sx=t.sx,this.sy=t.sy,this.ox=t.ox,this.oy=t.oy,this}copy(){const t=new w;return t.sx=this.sx,t.sy=this.sy,t.ox=this.ox,t.oy=this.oy,t}$(){return this.h=!0,Object.freeze(this),this}P(){return this.h||Object.isFrozen(this)?this:this.copy().u()}u(){return this.h||(this.h=!0),this}Nt(){return this.h&&(Object.isFrozen(this)&&e.o("cannot thaw constant: "+this),this.h=!1),this}mw(t){}Ie(t){return this.sx=NaN,this.sy=NaN,this.ox=t,this}yE(t,i){(isNaN(t)||t>1||t<0)&&e.W(t,"0 <= "+i+" <= 1",w,i)}wE(t,i){(isNaN(t)||t===1/0||t===-1/0)&&e.W(t,"real number, not NaN or Infinity",w,i)}static parse(t){if("string"==typeof t){if(t=t.trim(),"None"===t)return w.None;if("TopLeft"===t)return w.TopLeft;if("Top"===t||"TopCenter"===t||"MiddleTop"===t)return w.TopCenter;if("TopRight"===t)return w.TopRight;if("Left"===t||"LeftCenter"===t||"MiddleLeft"===t)return w.LeftCenter;if("Center"===t)return w.Center;if("Right"===t||"RightCenter"===t||"MiddleRight"===t)return w.RightCenter;if("BottomLeft"===t)return w.BottomLeft;if("Bottom"===t||"BottomCenter"===t||"MiddleBottom"===t)return w.BottomCenter;if("BottomRight"===t)return w.BottomRight;if("TopSide"===t)return w.TopSide;if("LeftSide"===t)return w.LeftSide;if("RightSide"===t)return w.RightSide;if("BottomSide"===t)return w.BottomSide;if("TopBottomSides"===t)return w.TopBottomSides;if("LeftRightSides"===t)return w.LeftRightSides;if("TopLeftSides"===t)return w.TopLeftSides;if("TopRightSides"===t)return w.TopRightSides;if("BottomLeftSides"===t)return w.BottomLeftSides;if("BottomRightSides"===t)return w.BottomRightSides;if("NotTopSide"===t)return w.NotTopSide;if("NotLeftSide"===t)return w.NotLeftSide;if("NotRightSide"===t)return w.NotRightSide;if("NotBottomSide"===t)return w.NotBottomSide;if("AllSides"===t)return w.AllSides;if("Default"===t)return w.Default;const e=t.split(" ");let i=0,s=0;for(;""===e[i];)i++;let n=e[i++];void 0!==n&&n.length>0&&(s=parseFloat(n));let o=0;for(;""===e[i];)i++;n=e[i++],void 0!==n&&n.length>0&&(o=parseFloat(n));let r=0;for(;""===e[i];)i++;n=e[i++],void 0!==n&&n.length>0&&(r=parseFloat(n));let a=0;for(;""===e[i];)i++;return n=e[i++],void 0!==n&&n.length>0&&(a=parseFloat(n)),new w(s,o,r,a)}return new w}static stringify(t){return t.isSpot()?t.x.toString()+" "+t.y.toString()+" "+t.offsetX.toString()+" "+t.offsetY.toString():t.toString()}static stringifyFixed(t){return e.s(t,"number",w,"stringifyFixed:digits"),e=>e.x.toFixed(t)+" "+e.y.toFixed(t)+" "+e.offsetX.toFixed(t)+" "+e.offsetY.toFixed(t)}toString(){return this.isSpot()?0===this.ox&&0===this.oy?"Spot("+this.x+","+this.y+")":"Spot("+this.x+","+this.y+","+this.offsetX+","+this.offsetY+")":this.equals(w.None)?"None":this.equals(w.TopLeft)?"TopLeft":this.equals(w.TopCenter)?"Top":this.equals(w.TopRight)?"TopRight":this.equals(w.LeftCenter)?"Left":this.equals(w.Center)?"Center":this.equals(w.RightCenter)?"Right":this.equals(w.BottomLeft)?"BottomLeft":this.equals(w.BottomCenter)?"Bottom":this.equals(w.BottomRight)?"BottomRight":this.equals(w.TopSide)?"TopSide":this.equals(w.LeftSide)?"LeftSide":this.equals(w.RightSide)?"RightSide":this.equals(w.BottomSide)?"BottomSide":this.equals(w.TopBottomSides)?"TopBottomSides":this.equals(w.LeftRightSides)?"LeftRightSides":this.equals(w.TopLeftSides)?"TopLeftSides":this.equals(w.TopRightSides)?"TopRightSides":this.equals(w.BottomLeftSides)?"BottomLeftSides":this.equals(w.BottomRightSides)?"BottomRightSides":this.equals(w.NotTopSide)?"NotTopSide":this.equals(w.NotLeftSide)?"NotLeftSide":this.equals(w.NotRightSide)?"NotRightSide":this.equals(w.NotBottomSide)?"NotBottomSide":this.equals(w.AllSides)?"AllSides":this.equals(w.Default)?"Default":"None"}equals(t){return t instanceof w&&((this.sx===t.x||isNaN(this.sx)&&isNaN(t.x))&&(this.sy===t.y||isNaN(this.sy)&&isNaN(t.y))&&this.ox===t.offsetX&&this.oy===t.offsetY)}opposite(){return new w(.5-(this.sx-.5),.5-(this.sy-.5),-this.ox,-this.oy)}includesSide(t){if(!this.isSide())return!1;if(!t.isSide())if(t.equals(w.Left))t=w.LeftSide;else if(t.equals(w.Right))t=w.RightSide;else if(t.equals(w.Top))t=w.TopSide;else{if(!t.equals(w.Bottom))return!1;t=w.BottomSide}const e=this.oy,i=t.offsetY;return(e&i)===i}get x(){return this.sx}set x(t){this.sx=t}get y(){return this.sy}set y(t){this.sy=t}get offsetX(){return this.ox}set offsetX(t){this.ox=t}get offsetY(){return this.oy}set offsetY(t){this.oy=t}isSpot(){return!isNaN(this.x)&&!isNaN(this.y)}isNoSpot(){return isNaN(this.x)||isNaN(this.y)}isSide(){return isNaN(this.x)&&isNaN(this.y)&&1===this.offsetX&&0!==this.offsetY}isNone(){return isNaN(this.x)&&isNaN(this.y)&&0===this.offsetX&&0===this.offsetY}isDefault(){return isNaN(this.x)&&isNaN(this.y)&&-1===this.offsetX&&0===this.offsetY}static None=new w(0,0,0,0).Ie(0).$();static Default=new w(0,0,-1,0).Ie(-1).$();static TopLeft=new w(0,0,0,0).$();static TopCenter=new w(.5,0,0,0).$();static TopRight=new w(1,0,0,0).$();static LeftCenter=new w(0,.5,0,0).$();static Center=new w(.5,.5,0,0).$();static RightCenter=new w(1,.5,0,0).$();static BottomLeft=new w(0,1,0,0).$();static BottomCenter=new w(.5,1,0,0).$();static BottomRight=new w(1,1,0,0).$();static MiddleTop=w.TopCenter;static MiddleLeft=w.LeftCenter;static MiddleRight=w.RightCenter;static MiddleBottom=w.BottomCenter;static Top=w.TopCenter;static Left=w.LeftCenter;static Right=w.RightCenter;static Bottom=w.BottomCenter;static TopSide=new w(0,0,1,1).Ie(1).$();static LeftSide=new w(0,0,1,2).Ie(1).$();static RightSide=new w(0,0,1,4).Ie(1).$();static BottomSide=new w(0,0,1,8).Ie(1).$();static TopBottomSides=new w(0,0,1,9).Ie(1).$();static LeftRightSides=new w(0,0,1,6).Ie(1).$();static TopLeftSides=new w(0,0,1,3).Ie(1).$();static TopRightSides=new w(0,0,1,5).Ie(1).$();static BottomLeftSides=new w(0,0,1,10).Ie(1).$();static BottomRightSides=new w(0,0,1,12).Ie(1).$();static NotTopSide=new w(0,0,1,14).Ie(1).$();static NotLeftSide=new w(0,0,1,13).Ie(1).$();static NotRightSide=new w(0,0,1,11).Ie(1).$();static NotBottomSide=new w(0,0,1,7).Ie(1).$();static AllSides=new w(0,0,1,15).Ie(1).$();static Vk=new w(.156,.156).$();static zk=new w(.844,.844).$();static MC=[];static l(){const t=w.MC.pop();return void 0===t?new w:t}static e(t){w.MC.push(t)}}class k{m11;m12;m21;m22;dx;dy;constructor(){this.m11=1,this.m12=0,this.m21=0,this.m22=1,this.dx=0,this.dy=0}set(t){return this.m11=t.m11,this.m12=t.m12,this.m21=t.m21,this.m22=t.m22,this.dx=t.dx,this.dy=t.dy,this}setTo(t,e,i,s,n,o){return this.m11=t,this.m12=e,this.m21=i,this.m22=s,this.dx=n,this.dy=o,this}copy(){const t=new k;return t.m11=this.m11,t.m12=this.m12,t.m21=this.m21,t.m22=this.m22,t.dx=this.dx,t.dy=this.dy,t}toString(){return"Transform("+this.m11+","+this.m12+","+this.m21+","+this.m22+","+this.dx+","+this.dy+")"}equals(t){return this.m11===t.m11&&this.m12===t.m12&&this.m21===t.m21&&this.m22===t.m22&&this.dx===t.dx&&this.dy===t.dy}Xk(){return 0===this.dx&&0===this.dy&&1===this.m11&&0===this.m12&&0===this.m21&&1===this.m22}Ri(){return this.m11=1,this.m12=0,this.m21=0,this.m22=1,this.dx=0,this.dy=0,this}nc(t){const e=this.m11*t.m11+this.m21*t.m12,i=this.m12*t.m11+this.m22*t.m12,s=this.m11*t.m21+this.m21*t.m22,n=this.m12*t.m21+this.m22*t.m22;return this.dx=this.m11*t.dx+this.m21*t.dy+this.dx,this.dy=this.m12*t.dx+this.m22*t.dy+this.dy,this.m11=e,this.m12=i,this.m21=s,this.m22=n,this}NC(t){const e=1/(t.m11*t.m22-t.m12*t.m21),i=t.m22*e,s=-t.m12*e,n=-t.m21*e,o=t.m11*e,r=e*(t.m21*t.dy-t.m22*t.dx),a=e*(t.m12*t.dx-t.m11*t.dy),h=this.m11*i+this.m21*s,l=this.m12*i+this.m22*s,u=this.m11*n+this.m21*o,c=this.m12*n+this.m22*o;return this.dx=this.m11*r+this.m21*a+this.dx,this.dy=this.m12*r+this.m22*a+this.dy,this.m11=h,this.m12=l,this.m21=u,this.m22=c,this}ww(){const t=1/(this.m11*this.m22-this.m12*this.m21),e=this.m22*t,i=-this.m12*t,s=-this.m21*t,n=this.m11*t,o=t*(this.m21*this.dy-this.m22*this.dx),r=t*(this.m12*this.dx-this.m11*this.dy);return this.m11=e,this.m12=i,this.m21=s,this.m22=n,this.dx=o,this.dy=r,this}cs(t,e,i){if(t>=360?t-=360:t<0&&(t+=360),0===t)return this;this.Fs(e,i);let s=0,n=0;if(90===t)s=0,n=1;else if(180===t)s=-1,n=0;else if(270===t)s=0,n=-1;else{const e=t*Math.PI/180;s=Math.cos(e),n=Math.sin(e)}const o=this.m11*s+this.m21*n,r=this.m12*s+this.m22*n,a=this.m11*-n+this.m21*s,h=this.m12*-n+this.m22*s;return this.m11=o,this.m12=r,this.m21=a,this.m22=h,this.Fs(-e,-i),this}Fs(t,e){return this.dx+=this.m11*t+this.m21*e,this.dy+=this.m12*t+this.m22*e,this}tt(t,e){return void 0===e&&(e=t),this.m11*=t,this.m12*=t,this.m21*=e,this.m22*=e,this}$D(){if(1===this.m11&&0===this.m12)return 0;let t=180*Math.atan2(this.m12,this.m11)/Math.PI;return t<0&&(t+=360),t}gt(t){const e=t.x,i=t.y;return t.i(e*this.m11+i*this.m21+this.dx,e*this.m12+i*this.m22+this.dy)}$e(t){const e=1/(this.m11*this.m22-this.m12*this.m21),i=this.m22*e,s=-this.m12*e,n=-this.m21*e,o=this.m11*e,r=t.x-this.dx,a=t.y-this.dy;return t.i(r*i+a*n,r*s+a*o)}xw(t){const e=1/(this.m11*this.m22-this.m12*this.m21),i=this.m22*e,s=-this.m12*e,n=-this.m21*e,o=this.m11*e,r=e*(this.m21*this.dy-this.m22*this.dx),a=e*(this.m12*this.dx-this.m11*this.dy),h=1.25*t.x,l=1.2*t.y;return t.i(h*i+l*n+r,h*s+l*o+a)}vg(t){const e=t.x,i=t.y,s=e+t.width,n=i+t.height,o=this.m11,r=this.m12,a=this.m21,h=this.m22,l=this.dx,u=this.dy,c=e*o+i*a+l,d=e*r+i*h+u,f=s*o+i*a+l,g=s*r+i*h+u,p=e*o+n*a+l,m=e*r+n*h+u,y=s*o+n*a+l,v=s*r+n*h+u;let x=c,b=c,w=d,k=d;return x=Math.min(x,f),b=Math.max(b,f),w=Math.min(w,g),k=Math.max(k,g),x=Math.min(x,p),b=Math.max(b,p),w=Math.min(w,m),k=Math.max(k,m),x=Math.min(x,y),b=Math.max(b,y),w=Math.min(w,v),k=Math.max(k,v),t.i(x,w,b-x,k-w),t}static CC=[];static l(){const t=k.CC.pop();return void 0===t?new k:t}static e(t){k.CC.push(t)}static Yk="54a702f3e53909c447824c6706603faf4c"}const S={ZD:"7da71ca0ad381e90",Rn:(Math.sqrt(2)-1)/3*4,LC:null,bw:t=>{if(t<=0)return 0;let e=S.LC;if(null===e){e=[];for(let t=0;t<=2e3;t++)e[t]=Math.sqrt(t);S.LC=e}if(t<1){const i=1/t;return i<=2e3?1/e[0|i]:Math.sqrt(t)}return t<=2e3?e[0|t]:Math.sqrt(t)},f:(t,e)=>{const i=t-e;return i<.5&&i>-.5},z:(t,e)=>{const i=t-e;return i<5e-8&&i>-5e-8},vi:(t,e,i,s,n,o,r)=>{n<=0&&(n=1e-6);let a=0,h=0,l=0,u=0;if(t<i?(h=t,a=i):(h=i,a=t),e<s?(u=e,l=s):(u=s,l=e),t===i)return u<=r&&r<=l&&t-n<=o&&o<=t+n;if(e===s)return h<=o&&o<=a&&e-n<=r&&r<=e+n;const c=a+n,d=h-n;if(d<=o&&o<=c){const a=l+n,h=u-n;if(h<=r&&r<=a)if(c-d>a-h){if(!(t-i>n||i-t>n))return!0;{const a=(s-e)/(i-t)*(o-t)+e;if(a-n<=r&&r<=a+n)return!0}}else{if(!(e-s>n||s-e>n))return!0;{const a=(i-t)/(s-e)*(r-e)+t;if(a-n<=o&&o<=a+n)return!0}}}return!1},kw:(t,e,i,s,n,o,r,a,h,l,u,c)=>{if(S.vi(t,e,r,a,c,i,s)&&S.vi(t,e,r,a,c,n,o))return S.vi(t,e,r,a,c,l,u);{const d=(t+i)/2,f=(e+s)/2,g=(i+n)/2,p=(s+o)/2,m=(n+r)/2,y=(o+a)/2,v=(d+g)/2,x=(f+p)/2,b=(g+m)/2,w=(p+y)/2,k=(v+b)/2,P=(x+w)/2;return S.kw(t,e,d,f,v,x,k,P,h,l,u,c)||S.kw(k,P,b,w,m,y,r,a,h,l,u,c)}},AC:(t,e,i,s,n,o,r,a,h)=>{const l=(t+i)/2,u=(e+s)/2,c=(i+n)/2,d=(s+o)/2,f=(n+r)/2,g=(o+a)/2,p=(l+c)/2,m=(u+d)/2,y=(c+f)/2,v=(d+g)/2;return h.i((p+y)/2,(m+v)/2),h},QD:(t,e,i,s,n,o,r,a)=>{const h=(t+i)/2,l=(e+s)/2,u=(i+n)/2,c=(s+o)/2,d=(n+r)/2,f=(o+a)/2,g=(h+u)/2,p=(l+c)/2,m=(u+d)/2,v=(c+f)/2;return y.direction(g,p,m,v)},ou:(t,e,i,s,n,o,r,a,h,l)=>{if(S.vi(t,e,r,a,h,i,s)&&S.vi(t,e,r,a,h,n,o))l.unionNoCheck(t,e,0,0),l.unionNoCheck(r,a,0,0);else{const u=(t+i)/2,c=(e+s)/2,d=(i+n)/2,f=(s+o)/2,g=(n+r)/2,p=(o+a)/2,m=(u+d)/2,y=(c+f)/2,v=(d+g)/2,x=(f+p)/2,b=(m+v)/2,w=(y+x)/2;S.ou(t,e,u,c,m,y,b,w,h,l),S.ou(b,w,v,x,g,p,r,a,h,l)}return l},vn:(t,e,i,s,n,o,r,a,h,l)=>{if(S.vi(t,e,r,a,h,i,s)&&S.vi(t,e,r,a,h,n,o))0===l.length&&(l.push(t),l.push(e)),l.push(r),l.push(a);else{const u=(t+i)/2,c=(e+s)/2,d=(i+n)/2,f=(s+o)/2,g=(n+r)/2,p=(o+a)/2,m=(u+d)/2,y=(c+f)/2,v=(d+g)/2,x=(f+p)/2,b=(m+v)/2,w=(y+x)/2;S.vn(t,e,u,c,m,y,b,w,h,l),S.vn(b,w,v,x,g,p,r,a,h,l)}return l},Kk:(t,e,i,s,n,o,r,a,h,l)=>{if(S.vi(t,e,n,o,l,i,s))return S.vi(t,e,n,o,l,a,h);{const u=(t+i)/2,c=(e+s)/2,d=(i+n)/2,f=(s+o)/2,g=(u+d)/2,p=(c+f)/2;return S.Kk(t,e,u,c,g,p,r,a,h,l)||S.Kk(g,p,d,f,n,o,r,a,h,l)}},xE:(t,e,i,s,n,o,r)=>{const a=(t+i)/2,h=(e+s)/2,l=(i+n)/2,u=(s+o)/2;return r.i((a+l)/2,(h+u)/2),r},Gk:(t,e,i,s,n,o,r,a)=>{if(S.vi(t,e,n,o,r,i,s))a.unionNoCheck(t,e,0,0),a.unionNoCheck(n,o,0,0);else{const h=(t+i)/2,l=(e+s)/2,u=(i+n)/2,c=(s+o)/2,d=(h+u)/2,f=(l+c)/2;S.Gk(t,e,h,l,d,f,r,a),S.Gk(d,f,u,c,n,o,r,a)}return a},Og:(t,e,i,s,n,o,r,a)=>{if(S.vi(t,e,n,o,r,i,s))0===a.length&&(a.push(t),a.push(e)),a.push(n),a.push(o);else{const h=(t+i)/2,l=(e+s)/2,u=(i+n)/2,c=(s+o)/2,d=(h+u)/2,f=(l+c)/2;S.Og(t,e,h,l,d,f,r,a),S.Og(d,f,u,c,n,o,r,a)}return a},Ig:(t,e,i,s,n,o,r,a,h,l,u,c,d,f)=>{if(S.vi(t,e,r,a,d,i,s)&&S.vi(t,e,r,a,d,n,o)){if(!S.su(t,e,r,a,h,l,u,c))return!1;const i=(t-r)*(l-c)-(e-a)*(h-u);if(0===i)return!1;const s=((t*a-e*r)*(h-u)-(t-r)*(h*c-l*u))/i,n=((t*a-e*r)*(l-c)-(e-a)*(h*c-l*u))/i;return f.i(s,n),!0}{const g=(t+i)/2,p=(e+s)/2,m=(i+n)/2,y=(s+o)/2,v=(n+r)/2,x=(o+a)/2,b=(g+m)/2,w=(p+y)/2,k=(m+v)/2,P=(y+x)/2,M=(b+k)/2,C=(w+P)/2;let A=1/0,N=!1,L=0,T=0;if(S.Ig(t,e,g,p,b,w,M,C,h,l,u,c,d,f)){const t=(f.x-h)**2+(f.y-l)**2;t<A&&(A=t,N=!0,L=f.x,T=f.y)}if(S.Ig(M,C,k,P,v,x,r,a,h,l,u,c,d,f)){const t=(f.x-h)**2+(f.y-l)**2;t<A&&(A=t,N=!0,L=f.x,T=f.y)}return N&&(f.x=L,f.y=T),N}},Eg:(t,e,i,s,n,o,r,a,h,l,u,c,d)=>{let f=0;if(S.vi(t,e,r,a,d,i,s)&&S.vi(t,e,r,a,d,n,o)){const i=(t-r)*(l-c)-(e-a)*(h-u);if(0===i)return f;const s=((t*a-e*r)*(h-u)-(t-r)*(h*c-l*u))/i,n=((t*a-e*r)*(l-c)-(e-a)*(h*c-l*u))/i;if(s>=u)return f;let o=0,d=0;if((h>u?h-u:u-h)<(l>c?l-c:c-l)){if(e<a?(o=e,d=a):(o=a,d=e),n<o||n>d)return f}else if(t<r?(o=t,d=r):(o=r,d=t),s<o||s>d)return f;i>0?f++:i<0&&f--}else{const g=(t+i)/2,p=(e+s)/2,m=(i+n)/2,y=(s+o)/2,v=(n+r)/2,x=(o+a)/2,b=(g+m)/2,w=(p+y)/2,k=(m+v)/2,P=(y+x)/2,M=(b+k)/2,C=(w+P)/2;f+=S.Eg(t,e,g,p,b,w,M,C,h,l,u,c,d),f+=S.Eg(M,C,k,P,v,x,r,a,h,l,u,c,d)}return f},ul:(t,e,i,s,n,o,r)=>{if(S.z(t,i)){let i=0,n=0;e<s?(i=e,n=s):(i=s,n=e);const a=o;return a<i?(r.i(t,i),!1):a>n?(r.i(t,n),!1):(r.i(t,a),!0)}if(S.z(e,s)){let s=0,o=0;t<i?(s=t,o=i):(s=i,o=t);const a=n;return a<s?(r.i(s,e),!1):a>o?(r.i(o,e),!1):(r.i(a,e),!0)}{const a=(i-t)**2+(s-e)**2,h=((t-n)*(t-i)+(e-o)*(e-s))/a;if(h<-5e-6)return r.i(t,e),!1;if(h>1.000005)return r.i(i,s),!1;{const n=t+h*(i-t),o=e+h*(s-e);return r.i(n,o),!0}}},On:(t,e,i,s,n,o,r,a,h)=>{if(S.f(t,i)&&S.f(e,s))return h.i(t,e),!1;if(S.z(n,r)){if(S.z(t,i))return S.ul(t,e,i,s,n,o,h),!1;{const o=(s-e)/(i-t)*(n-t)+e;return S.ul(t,e,i,s,n,o,h)}}{const l=(a-o)/(r-n);if(S.z(t,i)){const i=l*(t-n)+o;let r=0,a=0;return e<s?(r=e,a=s):(r=s,a=e),i<r?(h.i(t,r),!1):i>a?(h.i(t,a),!1):(h.i(t,i),!0)}{const r=(s-e)/(i-t);if(S.z(l,r))return S.ul(t,e,i,s,n,o,h),!1;{const a=(r*t-l*n+o-e)/(r-l);if(S.z(r,0)){let s=0,n=0;return t<i?(s=t,n=i):(s=i,n=t),a<s?(h.i(s,e),!1):a>n?(h.i(n,e),!1):(h.i(a,e),!0)}{const n=r*(a-t)+e;return S.ul(t,e,i,s,a,n,h)}}}}},bE:(t,e,i,s,n)=>S.On(i.x,i.y,s.x,s.y,t.x,t.y,e.x,e.y,n),kE:(t,e,i,s,n,o,r,a,h,l)=>{let u=1/0;function c(i,s){const n=(i-t)**2+(s-e)**2;n<u&&(u=n,h.i(i,s))}c(h.x,h.y);let d=0,f=0,g=0,p=0;n<r?(d=n,f=r):(d=r,f=n),o<a?(g=n,p=r):(g=r,p=n);const m=f-d,y=p-g,v=m/2+l,x=y/2+l,b=(n+r)/2,w=(o+a)/2;if(0===v||0===x)return h;if(S.f(t,i)){const t=1-(i-b)**2/(v*v);if(t<0)return h;const e=Math.sqrt(t),s=x*e+w,n=-x*e+w;c(i,s),c(i,n)}else{const n=(s-e)/(i-t),o=1/(v*v)+n*n/(x*x),r=2*n*(e-n*t)/(x*x)-2*n*w/(x*x)-2*b/(v*v),a=2*n*t*w/(x*x)-2*e*w/(x*x)+w*w/(x*x)+b*b/(v*v)-1+(e-n*t)*(e-n*t)/(x*x),l=r*r-4*o*a;if(l<0)return h;const u=Math.sqrt(l),d=(-r+u)/(2*o);c(d,n*d-n*t+e);const f=(-r-u)/(2*o);c(f,n*f-n*t+e)}return h},dl:(t,e,i,s,n,o,r,a,h)=>{let l=1e21,u=t,c=e;if(S.On(t,e,t,s,n,o,r,a,h)){const t=(h.x-n)**2+(h.y-o)**2;t<l&&(l=t,u=h.x,c=h.y)}if(S.On(i,e,i,s,n,o,r,a,h)){const t=(h.x-n)**2+(h.y-o)**2;t<l&&(l=t,u=h.x,c=h.y)}if(S.On(t,e,i,e,n,o,r,a,h)){const t=(h.x-n)**2+(h.y-o)**2;t<l&&(l=t,u=h.x,c=h.y)}if(S.On(t,s,i,s,n,o,r,a,h)){const t=(h.x-n)**2+(h.y-o)**2;t<l&&(l=t,u=h.x,c=h.y)}return h.i(u,c),l<1e21},Pw:(t,e,i)=>S.kC(t.x,t.y,t.width,t.height,e.x,e.y,i.x,i.y),kC:(t,e,i,s,n,o,r,a)=>{const h=t,l=t+i,u=e,c=e+s;if(n===r){let t=0,e=0;return o<a?(t=o,e=a):(t=a,e=o),h<=n&&n<=l&&t<=c&&e>=u}if(o===a){let t=0,e=0;return n<r?(t=n,e=r):(t=r,e=n),u<=o&&o<=c&&t<=l&&e>=h}return!!(x.contains(t,e,i,s,n,o)||x.contains(t,e,i,s,r,a)||S.su(h,u,l,u,n,o,r,a)||S.su(l,u,l,c,n,o,r,a)||S.su(l,c,h,c,n,o,r,a)||S.su(h,c,h,u,n,o,r,a))},su:(t,e,i,s,n,o,r,a)=>t===i&&e===s&&n===r&&o===a?t===n&&e===o:S.eu(t,e,i,s,n,o)*S.eu(t,e,i,s,r,a)<=0&&S.eu(n,o,r,a,t,e)*S.eu(n,o,r,a,i,s)<=0,eu:(t,e,i,s,n,o)=>{const r=i-t,a=s-e;let h=n-t,l=o-e,u=h*a-l*r;return 0===u&&(u=h*r+l*a,u>0&&(h-=r,l-=a,u=h*r+l*a,u<0&&(u=0))),u},Bg:t=>(t<0&&(t+=360),t>=360&&(t-=360),t),TC:(t,e,i,s,n,o)=>{const r=Math.PI;o||(s*=r/180,n*=r/180);const a=s>n?-1:1,h=1e-5,l=2*r,u=[],c=r/2;let d=s,f=Math.min(l,Math.abs(n-s));if(f<h){const s=d+a*Math.min(f,c),n=t+i*Math.cos(d),o=e+i*Math.sin(d),r=t+i*Math.cos(s),h=e+i*Math.sin(s),l=(n+r)/2,g=(o+h)/2;return u.push([n,o,l,g,l,g,r,h]),u}for(;f>h;){const s=d+a*Math.min(f,c);u.push(S._D(i,d,s,t,e)),f-=Math.abs(s-d),d=s}return u},_D:(t,e,i,s,n)=>{const o=(i-e)/2,r=t*Math.cos(o),a=t*Math.sin(o),h=r,l=-a,u=h*h+l*l,c=u+h*r+l*a,d=4/3*(Math.sqrt(2*u*c)-c)/(h*a-l*r),f=h-d*l,g=l+d*h,p=f,m=-g,y=o+e,v=Math.cos(y),x=Math.sin(y);return[s+t*Math.cos(e),n+t*Math.sin(e),s+f*v-g*x,n+f*x+g*v,s+p*v-m*x,n+p*x+m*v,s+t*Math.cos(i),n+t*Math.sin(i)]},Dg:(t,e,i,s,n,o,r)=>{const a=n,h=o,l=Math.floor((t-i)/a)*a+i,u=Math.floor((e-s)/h)*h+s;let c=l;l+a-t<a/2&&(c=l+a);let d=u;return u+h-e<h/2&&(d=u+h),r.i(c,d),r},DC:(t,e)=>{let i=Math.max(t,e),s=Math.min(t,e),n=1,o=1;do{n=i%s,o=s,i=s,s=n}while(n>0);return o},tF:(t,e,i,s)=>{const n=i<0,o=s<0;let r=0,a=0,h=0;t<e?(a=1,h=0):(a=0,h=1);let l=0,u=0,c=0,d=0;return r=a,l=0===r?t:e,c=0===r?i:s,(0===r?n:o)&&(c=-c),r=h,u=0===r?t:e,d=0===r?i:s,(0===r?n:o)&&(d=-d),S.iF(l,u,c,d,0,0)},iF:(t,e,i,s,n,o)=>{let r=0;if(s>0)if(i>0){const a=t*t,h=e*e,l=t*i,u=e*s;let c=-h+u,d=-h+Math.sqrt(l*l+u*u),f=c;const g=9999999999;for(let t=0;t<g&&(f=.5*(c+d),f!==c&&f!==d);++t){const t=l/(f+a),e=u/(f+h),i=t*t+e*e-1;if(i>0)c=f;else{if(!(i<0))break;d=f}}n=a*i/(f+a),o=h*s/(f+h);const p=n-i,m=o-s;r=Math.sqrt(p*p+m*m)}else n=0,o=e,r=Math.abs(s-e);else{const s=t*t-e*e,a=t*i;if(a<s){const h=a/s,l=h*h;n=t*h,o=e*Math.sqrt(Math.abs(1-l));const u=n-i;r=Math.sqrt(u*u+o*o)}else n=t,o=0,r=Math.abs(i-t)}return r},In:new s,Ug:new s,nr:new s,or:0,Vg:100};S.za=S.ZD;var P=(t=>(t[t.Line=1]="Line",t[t.Rectangle=2]="Rectangle",t[t.Ellipse=3]="Ellipse",t[t.Path=4]="Path",t))(P||{}),M=(t=>(t[t.None=0]="None",t[t.Default=1]="Default",t[t.Fill=2]="Fill",t[t.Uniform=6]="Uniform",t))(M||{});class C{n;zg;Xg;oc;ru;lu;En;Bn;Un;j;we;xe;Qi;_i;Rs;rc;lc;constructor(t){u.Gi(this),this.n=2,void 0===t&&(t=4),this.j=t,this.we=0,this.xe=0,this.Qi=0,this._i=0,this.Rs=4===t?new h:C.Sw,this.zg=this.Rs.nt,this.Xg=(new x).u(),this.oc=null,this.ru=null,this.lu=NaN,this.En=w.TopLeft,this.Bn=w.BottomRight,this.rc=NaN,this.lc=NaN,this.Un=2}copy(){const t=new C;if(t.n=-2&this.n,t.j=this.j,t.we=this.we,t.xe=this.xe,t.Qi=this.Qi,t._i=this._i,4===this.j){const e=this.Rs.r,i=t.Rs;for(let t=0;t<e.length;t++){const s=e[t];i.add(s.copy())}t.Rs=i}else t.Rs=this.Rs;return t.zg=this.zg,t.Xg.a(this.Xg),t.oc=this.oc,t.ru=this.ru,t.lu=this.lu,t.En=this.En.P(),t.Bn=this.Bn.P(),t.rc=this.rc,t.lc=this.lc,t.Un=this.Un,t}static Line=1;static Rectangle=2;static Ellipse=3;static Path=4;static Sw=(new h).u();get h(){return 0!==(1&this.n)}set h(t){t?this.n|=1:this.n&=-2}get wt(){return 0!==(2&this.n)}set wt(t){t?this.n|=2:this.n&=-3}u(){if(this.h=!0,4!==this.type)return this;const t=this.figures;t.u();for(const e of t)e.u();return this}equalsApprox(t){if(!(t instanceof C))return!1;if(this.type!==t.type)return 1===this.type&&4===t.type?this.FC(t):1===t.type&&4===this.type&&t.FC(this);if(4===this.type){const e=this.figures.r,i=t.figures.r,s=e.length;if(s!==i.length)return!1;for(let t=0;t<s;t++){const s=e[t],n=i[t];if(!s.equalsApprox(n))return!1}return!0}return S.f(this.startX,t.startX)&&S.f(this.startY,t.startY)&&S.f(this.endX,t.endX)&&S.f(this.endY,t.endY)}FC(t){if(1!==this.type||4!==t.type)return!1;if(1===t.figures.count){const e=t.figures.elt(0);if(1===e.segments.count&&S.f(this.startX,e.startX)&&S.f(this.startY,e.startY)){const t=e.segments.elt(0);if(2===t.type&&S.f(this.endX,t.endX)&&S.f(this.endY,t.endY))return!0}}return!1}static stringify(t){return t.toString()}static stringifyFixed(t){return e.s(t,"number",C,"stringifyFixed:digits"),e=>e.toString(t)}oi(t){t in P?this.type=t:e.ir(this,t)}toString(t){void 0===t&&(t=-1);const e=e=>0===e?"0":e.toFixed(t);let i;switch(this.type){case 1:return t<0?"M"+this.startX.toString()+" "+this.startY.toString()+"L"+this.endX.toString()+" "+this.endY.toString():"M"+e(this.startX)+" "+e(this.startY)+"L"+e(this.endX)+" "+e(this.endY);case 2:return i=new x(this.startX,this.startY,0,0),i.union(this.endX,this.endY,0,0),t<0?"M"+i.x.toString()+" "+i.y.toString()+"H"+i.right.toString()+"V"+i.bottom.toString()+"H"+i.left.toString()+"z":"M"+e(i.x)+" "+e(i.y)+"H"+e(i.right)+"V"+e(i.bottom)+"H"+e(i.left)+"z";case 3:if(i=new x(this.startX,this.startY,0,0),i.union(this.endX,this.endY,0,0),t<0){const t=i.left.toString()+" "+(i.y+i.height/2).toString(),e=i.right.toString()+" "+(i.y+i.height/2).toString();return"M"+t+"A"+(i.width/2).toString()+" "+(i.height/2).toString()+" 0 0 1 "+e+"A"+(i.width/2).toString()+" "+(i.height/2).toString()+" 0 0 1 "+t}{const t=e(i.left)+" "+e(i.y+i.height/2),s=e(i.right)+" "+e(i.y+i.height/2);return"M"+t+"A"+e(i.width/2)+" "+e(i.height/2)+" 0 0 1 "+s+"A"+e(i.width/2)+" "+e(i.height/2)+" 0 0 1 "+t}case 4:let s="";const n=this.figures.r,o=n.length;for(let e=0;e<o;e++){const i=n[e];e>0&&(s+=" x "),i.isFilled&&(s+="F "),s+=i.toString(t)}return s;default:return P[this.type]}}static fillPath(t){"string"!=typeof t&&e.Zi(t,"string",C,"fillPath:str");const i=t.split(/[Xx]/),s=i.length;let n="";for(let e=0;e<s;e++){const t=i[e];null===t.match(/[Ff]/)?n+=(0===e?"":"X ")+"F"+(" "===t[0]?"":" ")+t:n+=0===e?t:"X"+(" "===t[0]?"":" ")+t}return n}static Yg="UuBbMmZzLlHhVvCcSsQqTtAaFfXx";static parse(t,i){void 0===i&&(i=!1),"string"!=typeof t&&e.Zi(t,"string",C,"parse:str");const s=new RegExp("(["+C.Yg+"])(["+C.Yg+"])","gm"),n=new RegExp("(["+C.Yg+"])([^s])","gm"),o=new RegExp("([^s])(["+C.Yg+"])","gm");t=t.replace(/,/gm," "),t=t.replace(s,"$1 $2"),t=t.replace(s,"$1 $2"),t=t.replace(n,"$1 $2"),t=t.replace(o,"$1 $2"),t=t.replace(/([0-9])([+\-])/gm,"$1 $2"),t=t.replace(/[\s\r\t\n]+/gm," "),t=t.replace(/^\s+|\s+$/g,"");const r=t.split(" ");for(let y=0;y<r.length;y++){const t=r[y];if(null!==t.match(/(\.[0-9]*)(\.)/gm)){const i=e.et();let s="",n=!1;for(let e=0;e<t.length;e++){const o=t[e];"."!==o||n?"."===o?(i.push(s),s="."):s+=o:(n=!0,s+=o)}i.push(s),r.splice(y,1);for(let t=0;t<i.length;t++)r.splice(y+t,0,i[t]);y+=i.length-1,e.J(i)}}let a=-1,h="",l="";const u=new y(0,0),c=new y(0,0),d=new y(0,0);let f=!0;function g(){return a>=w-1||null!==r[a+1].match(N)||(f=!1,!1)}function p(){return a++,r[a]}function m(t){let e=parseFloat(p()),i=parseFloat(p());h===h.toLowerCase()&&(e=d.x+e,i=d.y+i),t.i(e,i)}function v(){return m(d),d}function x(){return m(c),c}function b(){const t=l.toLowerCase();return"c"===t||"s"===t||"q"===t||"t"===t?new y(2*d.x-c.x,2*d.y-c.y):new y(d.x,d.y)}const w=r.length,k=be.RC(null);let S=!1,P=!1,M=!1,A=!0;const N=new RegExp("["+C.Yg+"]");for(;!(a>=w-1);){if(l=h,h=p(),""===h)continue;f=!0;let i=!1;switch(h.toUpperCase()){case"X":A=!0,S=!1,P=!1;break;case"M":const t=v();for(null===k.bi||!0===A?(k.hu(t.x,t.y,S,!1,!P,M),A=!1):k.eF(t.x,t.y),u.a(d);!g();){const t=v();k.rr(t.x,t.y)}break;case"L":for(;!g();){const t=v();k.rr(t.x,t.y)}f&&(i=!0);break;case"H":for(;!g();)d.i((h===h.toLowerCase()?d.x:0)+parseFloat(p()),d.y),k.rr(d.x,d.y);break;case"V":for(;!g();)d.i(d.x,(h===h.toLowerCase()?d.y:0)+parseFloat(p())),k.rr(d.x,d.y);f&&(i=!0);break;case"C":for(;!g();){const t=new y;m(t);const e=x(),i=v();k.lr(t.x,t.y,e.x,e.y,i.x,i.y)}f&&(i=!0);break;case"S":for(;!g();){const t=b(),e=x(),i=v();k.lr(t.x,t.y,e.x,e.y,i.x,i.y)}f&&(i=!0);break;case"Q":for(;!g();){const t=x(),e=v();k.Mw(t.x,t.y,e.x,e.y)}f&&(i=!0);break;case"T":for(;!g();){const t=b();c.a(t);const e=v();k.Mw(t.x,t.y,e.x,e.y),c.a(e)}f&&(i=!0);break;case"B":for(;!g();){const t=parseFloat(p()),e=parseFloat(p());let i=parseFloat(p()),s=parseFloat(p());const n=parseFloat(p());let o=n,r=!1;g()||(o=parseFloat(p()),g()||(r=0!==parseFloat(p()))),h===h.toLowerCase()&&(i+=d.x,s+=d.y),k.sF(t,e,i,s,n,o,r)}f&&(i=!0);break;case"A":for(;!g();){const t=Math.abs(parseFloat(p())),e=Math.abs(parseFloat(p())),i=parseFloat(p());let s=!1,n=!1,o=0,r=0;const a=p();1===a.length?(s=!!parseFloat(a),n=!!parseFloat(p()),o=parseFloat(p()),r=parseFloat(p())):2===a.length?(s=!!parseFloat(a[0]),n=!!parseFloat(a[1]),o=parseFloat(p()),r=parseFloat(p())):(s=!!parseFloat(a[0]),n=!!parseFloat(a[1]),o=parseFloat(a.slice(2)),r=parseFloat(p())),h===h.toLowerCase()&&(o=d.x+o,r=d.y+r),d.i(o,r),k.nF(t,e,i,s,n,o,r)}f&&(i=!0);break;case"Z":k.oF(),d.a(u);break;case"F":{let t="",e=1;for(;r[a+e];)if("0"!==r[a+e])if(null===r[a+e].match(/[Uu]/)){if(null!==r[a+e].match(N)){t=r[a+e];break}e++}else e++;else M=!0,e++;t.match(/[Mm]/)?S=!0:k.rF();break}case"U":{let t="",e=1;for(;r[a+e];)if(null===r[a+e].match(/[Ff]/)){if(null!==r[a+e].match(N)){t=r[a+e];break}e++}else e++;t.match(/[Mm]/)?P=!0:k.lF(!1);break}default:if("0"===h||"1"===h)break;e.ni("Unknown geometry command: "+h);break}if(i){e.ni(`Bad geometry command: ${h}, next token: ${p()},\nstring: ${t}`);break}}const L=k.Kg;if(be.vC(k),i){const t=L.figures.iterator;for(;t.next();){const e=t.value;e.isFilled=!0}}return L}static OC(t,e){const i=t.length,s=y.l();for(let n=0;n<i;n++){const i=t[n];s.x=i[0],s.y=i[1],e.gt(s),i[0]=s.x,i[1]=s.y,s.x=i[2],s.y=i[3],e.gt(s),i[2]=s.x,i[3]=s.y,s.x=i[4],s.y=i[5],e.gt(s),i[4]=s.x,i[5]=s.y,s.x=i[6],s.y=i[7],e.gt(s),i[6]=s.x,i[7]=s.y}y.e(s)}Hk(){if(this.wt)return!0;if(4===this.type){const t=this.figures;if(this.zg!==t.nt)return!0;const e=this.figures.r,i=e.length;for(let s=0;s<i;s++)if(e[s].Hk())return!0}return!1}Nw(){if(this.wt=!1,this.oc=null,this.ru=null,this.lu=NaN,4===this.type){const t=this.figures;this.zg=t.nt;const e=this.figures.r,i=e.length;for(let s=0;s<i;s++)e[s].hF()}const t=this.Xg;t.Nt(),isNaN(this.rc)||isNaN(this.lc)?t.i(0,0,0,0):t.i(0,0,this.rc,this.lc),this.IC(t,!1),t.unionNoCheck(0,0,0,0),t.u()}computeBoundsWithoutOrigin(){const t=new x;return this.IC(t,!0),t}IC(t,i){switch(this.type){case 1:case 2:case 3:i?t.i(this.we,this.xe,0,0):t.unionNoCheck(this.we,this.xe,0,0),t.unionNoCheck(this.Qi,this._i,0,0);break;case 4:const s=this.figures,n=s.r,o=s.length;for(let r=0;r<o;r++){const s=n[r];i&&0===r?t.i(s.startX,s.startY,0,0):t.unionNoCheck(s.startX,s.startY,0,0);const o=s.segments.r,a=o.length;let h=s.startX,l=s.startY;for(let i=0;i<a;i++){const n=o[i];switch(n.type){case 2:case 1:h=n.endX,l=n.endY,t.unionNoCheck(h,l,0,0);break;case 3:S.ou(h,l,n.point1X,n.point1Y,n.point2X,n.point2Y,n.endX,n.endY,.5,t),h=n.endX,l=n.endY;break;case 4:S.Gk(h,l,n.point1X,n.point1Y,n.endX,n.endY,.5,t),h=n.endX,l=n.endY;break;case 5:case 6:const i=5===n.type?n.xo(s):n.Bh(s,h,l),o=i.length;if(0===o){h=5===n.type?n.centerX:n.endX,l=5===n.type?n.centerY:n.endY,t.unionNoCheck(h,l,0,0);break}let r=null;for(let e=0;e<o;e++)r=i[e],S.ou(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],.5,t);null!==r&&(h=r[6],l=r[7]);break;default:e.o("Unknown Segment type: "+n.type)}}}break;default:e.o("Unknown Geometry type: "+this.type)}}aF(t,e){const i=this.bounds;let s=t/i.width,n=e/i.height;return isFinite(s)||(s=1),isFinite(n)||(n=1),1===s&&1===n?this:this.copy().scale(s,n)}normalize(){this.h&&e.L(this);const t=this.computeBoundsWithoutOrigin();return this.offset(-t.x,-t.y),new y(-t.x,-t.y)}offset(t,i){return this.h&&e.L(this),this.T(1,0,0,1,t,i),this}scale(t,i){return this.h&&e.L(this),this.T(t,0,0,i,0,0),this}rotate(t,i,s){this.h&&e.L(this),void 0===i&&(i=0),void 0===s&&(s=0);const n=k.l();return n.Ri(),n.cs(t,i,s),this.T(n.m11,n.m12,n.m21,n.m22,n.dx,n.dy),k.e(n),this}T(t,i,s,n,o,r){let a=0,h=0;switch(this.type){case 1:case 2:case 3:a=this.we,h=this.xe,this.we=a*t+h*s+o,this.xe=a*i+h*n+r,a=this.Qi,h=this._i,this.Qi=a*t+h*s+o,this._i=a*i+h*n+r;break;case 4:const l=this.figures.r,u=l.length;for(let c=0;c<u;c++){const u=l[c];a=u.startX,h=u.startY,u.startX=a*t+h*s+o,u.startY=a*i+h*n+r;const d=u.segments.r,f=d.length;for(let l=0;l<f;l++){const u=d[l];switch(u.type){case 2:case 1:a=u.endX,h=u.endY,u.endX=a*t+h*s+o,u.endY=a*i+h*n+r;break;case 3:a=u.point1X,h=u.point1Y,u.point1X=a*t+h*s+o,u.point1Y=a*i+h*n+r,a=u.point2X,h=u.point2Y,u.point2X=a*t+h*s+o,u.point2Y=a*i+h*n+r,a=u.endX,h=u.endY,u.endX=a*t+h*s+o,u.endY=a*i+h*n+r;break;case 4:a=u.point1X,h=u.point1Y,u.point1X=a*t+h*s+o,u.point1Y=a*i+h*n+r,a=u.endX,h=u.endY,u.endX=a*t+h*s+o,u.endY=a*i+h*n+r;break;case 5:if(a=u.centerX,h=u.centerY,u.centerX=a*t+h*s+o,u.centerY=a*i+h*n+r,0!==i){let e=180*Math.atan2(i,t)/Math.PI;e<0&&(e+=360),u.startAngle+=e}t<0&&(u.startAngle=180-u.startAngle,u.sweepAngle=-u.sweepAngle),n<0&&(u.startAngle=-u.startAngle,u.sweepAngle=-u.sweepAngle),u.radiusX*=Math.sqrt(t*t+s*s),void 0!==u.radiusY&&(u.radiusY*=Math.sqrt(i*i+n*n));break;case 6:if(a=u.endX,h=u.endY,u.endX=a*t+h*s+o,u.endY=a*i+h*n+r,0===u.radiusX||0===u.radiusY)break;if(0!==i){let e=180*Math.atan2(i,t)/Math.PI;e<0&&(e+=360),u.xAxisRotation+=e}t<0&&(u.xAxisRotation=180-u.xAxisRotation,u.isClockwiseArc=!u.isClockwiseArc),n<0&&(u.xAxisRotation=-u.xAxisRotation,u.isClockwiseArc=!u.isClockwiseArc),u.radiusX*=Math.sqrt(t*t+s*s),u.radiusY*=Math.sqrt(i*i+n*n);break;default:e.o("Unknown Segment type: "+u.type)}}}break}return this.wt=!0,this}containsPoint(t,e){void 0===e&&(e=0);const i=this.we,s=this.xe,n=this.Qi,o=this._i;switch(this.type){case 1:return S.vi(i,s,n,o,e,t.x,t.y);case 2:{const r=Math.min(i,n)-e,a=Math.min(s,o)-e,h=Math.abs(n-i)+2*e,l=Math.abs(o-s)+2*e,u=x.V(r,a,h,l),c=u.containsPoint(t);return x.e(u),c}case 3:{let r=Math.min(i,n)-e,a=Math.min(s,o)-e;const h=Math.abs(n-i)+2*e,l=Math.abs(o-s)+2*e,u=h/2,c=l/2;return!(u<=0||c<=0)&&(r=t.x-(r+u),a=t.y-(a+c),r*r/(u*u)+a*a/(c*c)<=1)}case 4:return this.jk(t,e,!0,!1);default:return!1}}jk(t,i,s,n){const o=t.x,r=t.y,a=this.bounds.x-20,h=r;let l=0,u=0,c=0,d=0,f=0,g=0;const p=this.figures.r,m=p.length;for(let y=0;y<m;y++){const t=p[y],m=!t.isEvenOdd;if(!t.isFilled){if(t.qk(o,r,n?i:i+2))return!0;continue}if(s&&t.qk(o,r,i))return!0;const v=t.segments;u=t.startX,c=t.startY;let x=u,b=c;const w=v.r;for(let i=0;i<=v.length;i++){let s,n;switch(i!==v.length?(s=w[i],n=s.type,f=s.endX,g=s.endY):(n=2,f=x,g=b),n){case 1:{const t=this.Cw(o,r,a,h,u,c,x,b);if(isNaN(t))return!0;l+=t,x=f,b=g;break}case 2:{const t=this.Cw(o,r,a,h,u,c,f,g);if(isNaN(t))return!0;l+=t;break}case 3:d=S.Eg(u,c,s.point1X,s.point1Y,s.point2X,s.point2Y,f,g,a,h,o,r,.5),l+=d;break;case 4:{const t=(u+2*s.point1X)/3,e=(c+2*s.point1Y)/3,i=(2*s.point1X+f)/3,n=(2*s.point1Y+g)/3;d=S.Eg(u,c,t,e,i,n,f,g,a,h,o,r,.5),l+=d;break}case 5:case 6:{const e=5===s.type?s.xo(t):s.Bh(t,u,c),i=e.length;if(0===i){const t=this.Cw(o,r,a,h,u,c,5===s.type?s.centerX:s.endX,5===s.type?s.centerY:s.endY);if(isNaN(t))return!0;l+=t;break}let n=null;for(let t=0;t<i;t++){if(n=e[t],0===t){const t=this.Cw(o,r,a,h,u,c,n[0],n[1]);if(isNaN(t))return!0;l+=t}d=S.Eg(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],a,h,o,r,.5),l+=d}null!==n&&(f=n[6],g=n[7]);break}default:e.o("Unknown Segment type: "+s.type)}u=f,c=g}if(m){if(0!==l)return!0}else if(l%2!==0)return!0;l=0}return!1}Cw(t,e,i,s,n,o,r,a){if(S.vi(n,o,r,a,.05,t,e))return NaN;const h=(t-i)*(o-a);if(0===h)return 0;const l=((t*s-e*i)*(n-r)-(t-i)*(n*a-o*r))/h,u=(t*s-e*i)*(o-a)/h;if(l>=t)return 0;if((n>r?n-r:r-n)<(o>a?o-a:a-o)){if(o<a){if(u<o||u>a)return 0}else if(u<a||u>o)return 0}else if(n<r){if(l<n||l>r)return 0}else if(l<r||l>n)return 0;return h>0?1:-1}EC(t,e,i){const s=this.figures.r,n=s.length;for(let o=0;o<n;o++)if(s[o].qk(t,e,i))return!0;return!1}getPointAlongPath(t,e){if(t<0?t=0:t>1&&(t=1),void 0===e&&(e=new y),1===this.type)return e.i(this.startX+t*(this.endX-this.startX),this.startY+t*(this.endY-this.startY)),e;const i=this.flattenedSegments,s=this.flattenedLengths,n=this.flattenedTotalLength,o=i.length,r=n*t;let a=0;for(let h=0;h<o;h++){const t=s[h],n=t.length;for(let s=0;s<n;s++){const n=t[s];if(a+n>=r){const t=r-a,o=0===n?0:t/n,l=i[h],u=l[2*s],c=l[2*s+1],d=l[2*s+2],f=l[2*s+3];return e.i(u+(d-u)*o,c+(f-c)*o),e}a+=n}}return e}getAngleAlongPath(t){if(t<0?t=0:t>1&&(t=1),1===this.type)return 180*Math.atan2(this.endY-this.startY,this.endX-this.startX)/Math.PI;const e=this.flattenedSegments,i=this.flattenedLengths,s=this.flattenedTotalLength,n=e.length,o=s*t;let r=0;for(let a=0;a<n;a++){const t=i[a],s=t.length;for(let i=0;i<s;i++){const s=t[i];if(r+s>=o){const t=e[a],s=t[2*i],n=t[2*i+1],o=t[2*i+2],r=t[2*i+3];return Math.abs(o-s)<1&&Math.abs(r-n)<1?0:Math.abs(o-s)<1?r-n>=0?90:270:Math.abs(r-n)<1?o-s>=0?0:180:180*Math.atan2(r-n,o-s)/Math.PI}r+=s}}return NaN}getPointAndAngleAlongPath(t,e){if(t<0?t=0:t>1&&(t=1),void 0===e&&(e=[]),e.length=3,1===this.type)return e[0]=this.startX+t*(this.endX-this.startX),e[1]=this.startY+t*(this.endY-this.startY),e[2]=180*Math.atan2(this.endY-this.startY,this.endX-this.startX)/Math.PI,e;const i=this.flattenedSegments,s=this.flattenedLengths,n=this.flattenedTotalLength,o=i.length,r=n*t;let a=0;for(let h=0;h<o;h++){const t=s[h],n=t.length;for(let s=0;s<n;s++){const n=t[s];if(a+n>=r){const t=r-a,o=0===n?0:t/n,l=i[h],u=l[2*s],c=l[2*s+1],d=l[2*s+2],f=l[2*s+3];let g;return e[0]=u+(d-u)*o,e[1]=c+(f-c)*o,g=Math.abs(d-u)<1&&Math.abs(f-c)<1?0:Math.abs(d-u)<1?f-c>=0?90:270:Math.abs(f-c)<1?d-u>=0?0:180:180*Math.atan2(f-c,d-u)/Math.PI,e[2]=g,e}a+=n}}return e}getFractionForPoint(t){if(1===this.type){const e=this.startX,i=this.startY,s=this.endX,n=this.endY;if(e===s&&i===n)return 0;{const o=t.x,r=t.y;let a=0,h=0;if(e===s)return i<n?(a=i,h=n):(a=n,h=i),r<=a?a===i?0:1:r>=h?h===i?0:1:Math.abs(r-i)/(h-a);if(i===n)return e<s?(a=e,h=s):(a=s,h=e),o<=a?a===e?0:1:o>=h?h===e?0:1:Math.abs(o-e)/(h-a);{const t=(s-e)**2+(n-i)**2,a=y.l();S.ul(e,i,s,n,o,r,a);const h=a.x,l=a.y;return y.e(a),Math.sqrt(((h-e)**2+(l-i)**2)/t)}}}if(2!==this.type){const e=this.flattenedSegments,i=this.flattenedLengths,s=this.flattenedTotalLength,n=y.l();let o=1/0,r=0,a=0;const h=e.length;let l=0,u=0;for(let d=0;d<h;d++){const s=e[d],h=i[d],c=s.length;for(let e=0;e<c;e+=2){const i=s[e],c=s[e+1];if(0===e){l=i,u=c;continue}S.ul(l,u,i,c,t.x,t.y,n);const d=(n.x-t.x)**2+(n.y-t.y)**2;d<o&&(o=d,r=a,r+=Math.sqrt((n.x-l)**2+(n.y-u)**2)),a+=h[(e-2)/2],l=i,u=c}}y.e(n);const c=r/s;return c<0?0:c>1?1:c}{const e=this.startX,i=this.startY,s=this.endX,n=this.endY;if(e===s&&i===n)return 0;{const o=s-e,r=n-i,a=2*o+2*r;let h=t.x,l=t.y;h=Math.min(Math.max(h,e),s),l=Math.min(Math.max(l,i),n);const u=Math.abs(h-e),c=Math.abs(h-s),d=Math.abs(l-i),f=Math.abs(l-n),g=Math.min(u,c,d,f);if(g===d)return h/a;if(g===c)return(o+l)/a;if(g===f)return(2*o+r-h)/a;if(g===u)return(2*o+2*r-l)/a}}return 0}get flattenedSegments(){return this.BC(),this.oc}BC(){if(null===this.oc){const t=this.oc=[],e=this.ru=[];this.cF(t,e)}}get flattenedLengths(){return this.BC(),this.ru}get flattenedTotalLength(){let t=this.lu;if(isNaN(t)){if(1===this.type){const e=Math.abs(this.endX-this.startX),i=Math.abs(this.endY-this.startY);t=Math.sqrt(e*e+i*i)}else if(2===this.type){const e=Math.abs(this.endX-this.startX),i=Math.abs(this.endY-this.startY);t=2*e+2*i}else{const e=this.flattenedLengths,i=e.length;t=0;for(let s=0;s<i;s++){const i=e[s],n=i.length;for(let e=0;e<n;e++)t+=i[e]}}this.lu=t}return t}Wk(t){const e=[];let i=0,s=0;const n=t.length;for(let o=0;o<n;o+=2){const n=t[o],r=t[o+1];if(0===o){i=n,s=r;continue}const a=Math.sqrt(y.distanceSquared(i,s,n,r));e.push(a),i=n,s=r}return e}cF(t,i){let s=[];const n=[];if(1===this.type)s.push(this.startX),s.push(this.startY),s.push(this.endX),s.push(this.endY),t.push(s),n.push(Math.sqrt((this.startX-this.endX)**2+(this.startY-this.endY)**2)),i.push(n);else if(2===this.type)s.push(this.startX),s.push(this.startY),s.push(this.endX),s.push(this.startY),s.push(this.endX),s.push(this.endY),s.push(this.startX),s.push(this.endY),s.push(this.startX),s.push(this.startY),t.push(s),n.push(Math.abs(this.startX-this.endX)),n.push(Math.abs(this.startY-this.endY)),n.push(Math.abs(this.startX-this.endX)),n.push(Math.abs(this.startY-this.endY)),i.push(n);else if(3===this.type){const e=new A;e.startX=this.endX,e.startY=(this.startY+this.endY)/2;const n=new L(5);n.startAngle=0,n.sweepAngle=360,n.centerX=(this.startX+this.endX)/2,n.centerY=(this.startY+this.endY)/2,n.radiusX=Math.abs(this.startX-this.endX)/2,n.radiusY=Math.abs(this.startY-this.endY)/2,e.add(n);const o=n.xo(e),r=o.length;if(0===r)s.push(n.centerX),s.push(n.centerY);else{let t=e.startX,i=e.startY;for(let e=0;e<r;e++){const n=o[e];S.vn(t,i,n[2],n[3],n[4],n[5],n[6],n[7],.5,s),t=n[6],i=n[7]}}t.push(s),i.push(this.Wk(s))}else{const n=this.figures.iterator;for(;n.next();){const o=n.value;s=[],s.push(o.startX),s.push(o.startY);let r=o.startX,a=o.startY,h=r,l=a;const u=o.segments.r,c=u.length;for(let n=0;n<c;n++){const c=u[n];switch(c.type){case 1:s.length>=4&&(t.push(s),i.push(this.Wk(s))),s=[],s.push(c.endX),s.push(c.endY),r=c.endX,a=c.endY,h=r,l=a;break;case 2:s.push(c.endX),s.push(c.endY),r=c.endX,a=c.endY;break;case 3:S.vn(r,a,c.point1X,c.point1Y,c.point2X,c.point2Y,c.endX,c.endY,.5,s),r=c.endX,a=c.endY;break;case 4:S.Og(r,a,c.point1X,c.point1Y,c.endX,c.endY,.5,s),r=c.endX,a=c.endY;break;case 5:{const t=c.xo(o),e=t.length;if(0===e){s.push(c.centerX),s.push(c.centerY),r=c.centerX,a=c.centerY;break}for(let i=0;i<e;i++){const e=t[i];S.vn(r,a,e[2],e[3],e[4],e[5],e[6],e[7],.5,s),r=e[6],a=e[7]}break}case 6:{const t=c.Bh(o,r,a),e=t.length,i=c.endX,n=c.endY;if(0===e){s.push(i),s.push(n),r=i,a=n;break}for(let o=0;o<e;o++){const e=t[o];S.vn(r,a,e[2],e[3],e[4],e[5],e[6],e[7],.5,s),r=e[6],a=e[7]}break}default:e.o("Segment not of valid type: "+c.type)}c.isClosed&&(s.push(h),s.push(l))}s.length>=4&&(t.push(s),i.push(this.Wk(s)))}}}get type(){return this.j}set type(t){this.j!==t&&(this.h&&e.L(this,t),this.j=t,4===t?this.Rs=new h:(null===C.Sw&&(C.Sw=(new h).u()),this.Rs=C.Sw),this.wt=!0)}get startX(){return this.we}set startX(t){this.we!==t&&(this.h&&e.L(this,t),this.we=t,this.wt=!0)}get startY(){return this.xe}set startY(t){this.xe!==t&&(this.h&&e.L(this,t),this.xe=t,this.wt=!0)}get endX(){return this.Qi}set endX(t){this.Qi!==t&&(this.h&&e.L(this,t),this.Qi=t,this.wt=!0)}get endY(){return this._i}set endY(t){this._i!==t&&(this.h&&e.L(this,t),this._i=t,this.wt=!0)}get figures(){return this.Rs}set figures(t){this.Rs!==t&&(this.h&&e.L(this,t),this.Rs=t,this.wt=!0)}add(t){return this.Rs.add(t),this}setSpots(t,i,s,n,o,r,a,h){return this.h&&e.L(this),this.En=new w(t,i,o,r).u(),this.Bn=new w(s,n,a,h).u(),this}get spot1(){return this.En}set spot1(t){this.h&&e.L(this,t),this.En=t.P()}get spot2(){return this.Bn}set spot2(t){this.h&&e.L(this,t),this.Bn=t.P()}get defaultStretch(){return this.Un}set defaultStretch(t){this.Un=t}get bounds(){return this.Hk()&&this.Nw(),this.Xg}}C.stringify=C.stringify,C.stringifyFixed=C.stringifyFixed,C.fillPath=C.fillPath,C.parse=C.parse;class A{n;we;xe;hc;Gg;Ee;constructor(t,e,i,s,n){void 0===i&&(i=!0),void 0===s&&(s=!0),void 0===n&&(n=!1),this.n=2|(i?4:0)|(s?8:0)|(n?16:0),this.we=void 0!==t?t:0,this.xe=void 0!==e?e:0,this.hc=new h,this.Gg=this.hc.nt,this.Ee=null}copy(){const t=new A;t.n=-2&this.n,t.we=this.we,t.xe=this.xe;const e=this.hc.r,i=e.length,s=t.hc;for(let n=0;n<i;n++){const t=e[n].copy();s.add(t)}return t.Gg=this.Gg,t.Ee=this.Ee,t}equalsApprox(t){if(!(t instanceof A)||!S.f(this.startX,t.startX)||!S.f(this.startY,t.startY))return!1;const e=this.segments.r,i=t.segments.r,s=e.length;if(s!==i.length)return!1;for(let n=0;n<s;n++){const t=e[n],s=i[n];if(!t.equalsApprox(s))return!1}return!0}toString(t){void 0===t&&(t=-1);let e="";if(t<0)e="M"+this.startX.toString()+" "+this.startY.toString();else{const i=e=>0===e?"0":e.toFixed(t);e="M"+i(this.startX)+" "+i(this.startY)}const i=this.segments.r,s=i.length;for(let n=0;n<s;n++){const s=i[n];e+=" "+s.toString(t)}return e}get h(){return 0!==(1&this.n)}set h(t){t?this.n|=1:this.n&=-2}get wt(){return 0!==(2&this.n)}set wt(t){t?this.n|=2:this.n&=-3}u(){this.h=!0;const t=this.segments;t.u();const e=t.r,i=t.length;for(let s=0;s<i;s++)e[s].u();return this}Hk(){if(this.wt)return!0;const t=this.segments;if(this.Gg!==t.nt)return!0;for(const e of t)if(e.wt)return!0;return!1}hF(){this.wt=!1,this.Ee=null;const t=this.segments;this.Gg=t.nt;for(const e of t)e.wt=!1,e.vs=null}get isFilled(){return 0!==(4&this.n)}set isFilled(t){this.h&&e.L(this,t),t?this.n|=4:this.n&=-5}get isShadowed(){return 0!==(8&this.n)}set isShadowed(t){this.h&&e.L(this,t),t?this.n|=8:this.n&=-9}get isEvenOdd(){return 0!==(16&this.n)}set isEvenOdd(t){this.h&&e.L(this,t),t?this.n|=16:this.n&=-17}get startX(){return this.we}set startX(t){this.h&&e.L(this,t),this.we=t,this.Ee=null,this.wt=!0}get startY(){return this.xe}set startY(t){this.h&&e.L(this,t),this.xe=t,this.Ee=null,this.wt=!0}get segments(){return this.hc}set segments(t){this.h&&e.L(this,t),this.hc=t,this.Ee=null,this.wt=!0}add(t){return this.hc.add(t),this.Ee=null,this}qk(t,i,s){const n=this;let o=n.startX,r=n.startY,a=o,h=r;const l=n.segments.r,u=l.length;for(let c=0;c<u;c++){const u=l[c];switch(u.type){case 1:a=u.endX,h=u.endY,o=u.endX,r=u.endY;break;case 2:if(S.vi(o,r,u.endX,u.endY,s,t,i))return!0;o=u.endX,r=u.endY;break;case 3:if(S.kw(o,r,u.point1X,u.point1Y,u.point2X,u.point2Y,u.endX,u.endY,.5,t,i,s))return!0;o=u.endX,r=u.endY;break;case 4:if(S.Kk(o,r,u.point1X,u.point1Y,u.endX,u.endY,.5,t,i,s))return!0;o=u.endX,r=u.endY;break;case 5:case 6:const l=5===u.type?u.xo(n):u.Bh(n,o,r),c=l.length,d=5===u.type?u.centerX:u.endX,f=5===u.type?u.centerY:u.endY;if(0===c){if(S.vi(o,r,d,f,s,t,i))return!0;o=d,r=f;break}let g=null;for(let e=0;e<c;e++)if(g=l[e],0===e&&S.vi(o,r,g[0],g[1],s,t,i)||S.kw(g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],.5,t,i,s))return!0;null!==g&&(o=g[6],r=g[7]);break;default:e.o("Unknown Segment type: "+u.type)}if(u.isClosed&&(o!==a||r!==h)&&S.vi(o,r,a,h,s,t,i))return!0}return!1}}var N=(t=>(t[t.Move=1]="Move",t[t.Line=2]="Line",t[t.Bezier=3]="Bezier",t[t.QuadraticBezier=4]="QuadraticBezier",t[t.Arc=5]="Arc",t[t.SvgArc=6]="SvgArc",t))(N||{});class L{j;n;Qi;_i;tn;gl;pl;hr;vs;constructor(t,e,i,s,n,o,r,a){if(u.Gi(this),void 0===t&&(t=2),this.j=t,this.n=2,this.Qi=void 0!==e?e:0,this._i=void 0!==i?i:0,void 0===s&&(s=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===r&&(r=0),6===t){let t=o;t%=360,t<0&&(t+=360),this.tn=t,this.gl=0,this.pl=Math.max(s,0),this.hr=Math.max(n,0),"boolean"==typeof r?r&&(this.isLargeArc=!0):"number"==typeof r&&r&&(this.isLargeArc=!0),a&&(this.isClockwiseArc=!0)}else this.tn=s,this.gl=n,5===t&&(o=Math.max(o,0)),this.pl=o,"number"==typeof r?(5===t&&(r=Math.max(r,0)),this.hr=r):this.hr=0;this.vs=null}copy(){const t=new L;return t.j=this.j,t.n=-2&this.n,t.Qi=this.Qi,t._i=this._i,t.tn=this.tn,t.gl=this.gl,t.pl=this.pl,t.hr=this.hr,t}equalsApprox(t){if(!(t instanceof L)||this.type!==t.type||this.isClosed!==t.isClosed)return!1;switch(this.type){case 1:case 2:return S.f(this.endX,t.endX)&&S.f(this.endY,t.endY);case 3:return S.f(this.endX,t.endX)&&S.f(this.endY,t.endY)&&S.f(this.point1X,t.point1X)&&S.f(this.point1Y,t.point1Y)&&S.f(this.point2X,t.point2X)&&S.f(this.point2Y,t.point2Y);case 4:return S.f(this.endX,t.endX)&&S.f(this.endY,t.endY)&&S.f(this.point1X,t.point1X)&&S.f(this.point1Y,t.point1Y);case 5:return S.f(this.startAngle,t.startAngle)&&S.f(this.sweepAngle,t.sweepAngle)&&S.f(this.centerX,t.centerX)&&S.f(this.centerY,t.centerY)&&S.f(this.radiusX,t.radiusX)&&S.f(this.radiusY,t.radiusY);case 6:return this.isClockwiseArc===t.isClockwiseArc&&this.isLargeArc===t.isLargeArc&&S.f(this.xAxisRotation,t.xAxisRotation)&&S.f(this.endX,t.endX)&&S.f(this.endY,t.endY)&&S.f(this.radiusX,t.radiusX)&&S.f(this.radiusY,t.radiusY);default:return!1}}oi(t){t in N?this.type=t:e.ir(this,t)}toString(t){void 0===t&&(t=-1);const e=e=>0===e?"0":e.toFixed(t);let i="";switch(this.type){case 1:i=t<0?"M"+this.endX.toString()+" "+this.endY.toString():"M"+e(this.endX)+" "+e(this.endY);break;case 2:i=t<0?"L"+this.endX.toString()+" "+this.endY.toString():"L"+e(this.endX)+" "+e(this.endY);break;case 3:i=t<0?"C"+this.point1X.toString()+" "+this.point1Y.toString()+" "+this.point2X.toString()+" "+this.point2Y.toString()+" "+this.endX.toString()+" "+this.endY.toString():"C"+e(this.point1X)+" "+e(this.point1Y)+" "+e(this.point2X)+" "+e(this.point2Y)+" "+e(this.endX)+" "+e(this.endY);break;case 4:i=t<0?"Q"+this.point1X.toString()+" "+this.point1Y.toString()+" "+this.endX.toString()+" "+this.endY.toString():"Q"+e(this.point1X)+" "+e(this.point1Y)+" "+e(this.endX)+" "+e(this.endY);break;case 5:i=t<0?"B"+this.startAngle.toString()+" "+this.sweepAngle.toString()+" "+this.centerX.toString()+" "+this.centerY.toString()+" "+this.radiusX.toString()+" "+this.radiusY.toString():"B"+e(this.startAngle)+" "+e(this.sweepAngle)+" "+e(this.centerX)+" "+e(this.centerY)+" "+e(this.radiusX)+" "+e(this.radiusY);break;case 6:i=t<0?"A"+this.radiusX.toString()+" "+this.radiusY.toString()+" "+this.xAxisRotation.toString()+" "+(this.isLargeArc?1:0)+" "+(this.isClockwiseArc?1:0)+" "+this.endX.toString()+" "+this.endY.toString():"A"+e(this.radiusX)+" "+e(this.radiusY)+" "+e(this.xAxisRotation)+" "+(this.isLargeArc?1:0)+" "+(this.isClockwiseArc?1:0)+" "+e(this.endX)+" "+e(this.endY);break;default:i=N[this.type]}return i+(this.isClosed?"z":"")}static Move=1;static Line=2;static Bezier=3;static QuadraticBezier=4;static Arc=5;static SvgArc=6;get h(){return 0!==(1&this.n)}set h(t){t?this.n|=1:this.n&=-2}get wt(){return 0!==(2&this.n)}set wt(t){t?this.n|=2:this.n&=-3}u(){return this.h=!0,this}close(){return this.isClosed=!0,this}xo(t){if(null!==this.vs&&!1===t.wt)return this.vs;const e=this.radiusX;let i=this.radiusY;if(void 0===i&&(i=e),0===e||0===i)return this.vs=[],this.vs;const s=this.tn,n=this.gl,o=S.TC(0,0,e<i?e:i,this.startAngle,this.startAngle+this.sweepAngle,!1);if(e!==i){const t=k.l();t.Ri(),e<i?t.tt(1,i/e):t.tt(e/i,1),C.OC(o,t),k.e(t)}const r=o.length;for(let a=0;a<r;a++){const t=o[a];t[0]+=s,t[1]+=n,t[2]+=s,t[3]+=n,t[4]+=s,t[5]+=n,t[6]+=s,t[7]+=n}return this.vs=o,this.vs}Bh(t,e,i){if(null!==this.vs&&!1===t.wt)return this.vs;if(0===this.radiusX||0===this.radiusY)return this.vs=[],this.vs;const s=e,n=i;let o=this.pl,r=this.hr;0===o&&(o=1e-4),0===r&&(r=1e-4);const a=this.tn*(Math.PI/180),h=this.isLargeArc,l=this.isClockwiseArc,u=this.Qi,c=this._i,d=Math.cos(a),f=Math.sin(a),g=d*(s-u)/2+f*(n-c)/2,p=-f*(s-u)/2+d*(n-c)/2,m=g*g/(o*o)+p*p/(r*r);m>1&&(o*=Math.sqrt(m),r*=Math.sqrt(m));let y=(h===l?-1:1)*Math.sqrt((o*o*r*r-o*o*p*p-r*r*g*g)/(o*o*p*p+r*r*g*g));isNaN(y)&&(y=0);let v=y*o*p/r,x=y*-r*g/o;isNaN(v)&&(v=0),isNaN(x)&&(x=0);const b=(s+u)/2+d*v-f*x,w=(n+c)/2+f*v+d*x,P=(t,e)=>Math.sqrt(t*t+e*e),M=(t,e,i,s)=>(t*i+e*s)/(P(t,e)*P(i,s)),A=(t,e,i,s)=>(t*s<e*i?-1:1)*Math.acos(M(t,e,i,s)),N=A(1,0,(g-v)/o,(p-x)/r),L=(g-v)/o,T=(p-x)/r,D=(-g-v)/o,O=(-p-x)/r;let F=A(L,T,D,O);const R=M(L,T,D,O);R<=-1?F=Math.PI:R>=1&&(F=0),!l&&F>0&&(F-=2*Math.PI),l&&F<0&&(F+=2*Math.PI);const E=o>r?o:r,B=o>r?1:o/r,I=o>r?r/o:1,_=S.TC(0,0,E,N,N+F,!0),V=k.l();return V.Ri(),V.Fs(b,w),V.cs(this.tn,0,0),V.tt(B,I),C.OC(_,V),k.e(V),this.vs=_,this.vs}get isClosed(){return 0!==(8&this.n)}set isClosed(t){this.isClosed!==t&&(t?this.n|=8:this.n&=-9,this.wt=!0)}get type(){return this.j}set type(t){this.h&&e.L(this,t),this.j=t,this.wt=!0}get endX(){return this.Qi}set endX(t){this.h&&e.L(this,t),this.Qi=t,this.wt=!0}get endY(){return this._i}set endY(t){this.h&&e.L(this,t),this._i=t,this.wt=!0}get point1X(){return this.tn}set point1X(t){this.h&&e.L(this,t),this.tn=t,this.wt=!0}get point1Y(){return this.gl}set point1Y(t){this.h&&e.L(this,t),this.gl=t,this.wt=!0}get point2X(){return this.pl}set point2X(t){this.h&&e.L(this,t),this.pl=t,this.wt=!0}get point2Y(){return this.hr}set point2Y(t){this.h&&e.L(this,t),this.hr=t,this.wt=!0}get centerX(){return this.tn}set centerX(t){this.h&&e.L(this,t),this.tn=t,this.wt=!0}get centerY(){return this.gl}set centerY(t){this.h&&e.L(this,t),this.gl=t,this.wt=!0}get radiusX(){return this.pl}set radiusX(t){t<0&&e.W(t,">= zero",L,"radiusX"),this.h&&e.L(this,t),this.pl=t,this.wt=!0}get radiusY(){return this.hr}set radiusY(t){t<0&&e.W(t,">= zero",L,"radiusY"),this.h&&e.L(this,t),this.hr=t,this.wt=!0}get startAngle(){return this.Qi}set startAngle(t){this.h&&e.L(this,t),t%=360,t<0&&(t+=360),this.Qi=t,this.wt=!0}get sweepAngle(){return this._i}set sweepAngle(t){this.h&&e.L(this,t),t>360&&(t=360),t<-360&&(t=-360),this._i=t,this.wt=!0}get isClockwiseArc(){return 0!==(4&this.n)}set isClockwiseArc(t){this.h&&e.L(this,t),t?this.n|=4:this.n&=-5,this.wt=!0}get isLargeArc(){return 0!==(16&this.n)}set isLargeArc(t){this.h&&e.L(this,t),t?this.n|=16:this.n&=-17,this.wt=!0}get xAxisRotation(){return this.tn}set xAxisRotation(t){this.h&&e.L(this,t),t%=360,t<0&&(t+=360),this.tn=t,this.wt=!0}}class T{N;Lw;Aw;Hg;jg;qg;Wg;Jg;$g;Zg;Qg;_g;tm;im;bo;em;sm;nm;be;constructor(){this.N=null,this.Lw=new y(0,0).u(),this.Aw=new y(0,0).u(),this.Hg=0,this.jg=0,this.qg=1,this.Wg="",this.Jg="",this.$g=!1,this.Zg=!1,this.Qg=0,this._g=0,this.tm=!1,this.im=!1,this.bo=!1,this.em=null,this.sm=0,this.nm=null,this.be=null}copy(){const t=new T;return this.clone(t)}clone(t){return t.N=this.N,t.Lw.a(this.viewPoint),t.Aw.a(this.documentPoint),t.Hg=this.Hg,t.jg=this.jg,t.qg=this.qg,t.Wg=this.Wg,t.Jg=this.Jg,t.$g=this.$g,t.Zg=this.Zg,t.Qg=this.Qg,t._g=this._g,t.tm=this.tm,t.im=this.im,t.bo=this.bo,t.em=this.em,t.sm=this.sm,t.nm=this.nm,t.be=this.be,t}toString(){let t="^";return 0!==this.modifiers&&(t+="M:"+this.modifiers),0!==this.button&&(t+="B:"+this.button),""!==this.key&&(t+="K:"+this.key),0!==this.clickCount&&(t+="C:"+this.clickCount),0!==this.delta&&(t+="D:"+this.delta),this.handled&&(t+="h"),this.bubbles&&(t+="b"),null!==this.documentPoint&&(t+="@"+this.documentPoint.toString()),t}get diagram(){return this.N}set diagram(t){this.N=t}get viewPoint(){return this.Lw}set viewPoint(t){this.Lw.a(t)}get documentPoint(){return this.Aw}set documentPoint(t){this.Aw.a(t)}getMultiTouchViewPoint(t,e){const i=this.diagram;return null===i||i.UC(this.event,t,e),e}getMultiTouchDocumentPoint(t,e){const i=this.diagram;return null===i||(i.UC(this.event,t,e),e.a(i.transformViewToDoc(e))),e}get modifiers(){return this.Hg}set modifiers(t){this.Hg=t}get button(){return this.jg}set button(t){if(this.jg=t,null===this.event)switch(t){case 0:return void(this.buttons=1);case 1:return void(this.buttons=4);case 2:return void(this.buttons=2)}}get buttons(){return this.qg}set buttons(t){this.qg=t}get key(){return this.Wg}set key(t){this.Wg=t}get code(){return this.Jg}set code(t){this.Jg=t}get down(){return this.$g}set down(t){this.$g=t}get up(){return this.Zg}set up(t){this.Zg=t}get clickCount(){return this.Qg}set clickCount(t){this.Qg=t}get delta(){return this._g}set delta(t){this._g=t}get isMultiTouch(){return this.tm}set isMultiTouch(t){this.tm=t}get handled(){return this.im}set handled(t){this.im=t}get bubbles(){return this.bo}set bubbles(t){this.bo=t}get event(){return this.em}set event(t){this.em=t}get isTouchEvent(){const t=this.event;return null!==t&&("touch"===t.pointerType||"pen"===t.pointerType)}get timestamp(){return this.sm}set timestamp(t){this.sm=t}get targetDiagram(){return this.nm}set targetDiagram(t){this.nm=t}get targetObject(){return this.be}set targetObject(t){this.be=t}get control(){return 0!==(1&this.modifiers)}set control(t){this.modifiers=t?1|this.modifiers:-2&this.modifiers}get shift(){return 0!==(4&this.modifiers)}set shift(t){this.modifiers=t?4|this.modifiers:-5&this.modifiers}get alt(){return 0!==(2&this.modifiers)}set alt(t){this.modifiers=t?2|this.modifiers:-3&this.modifiers}get meta(){return 0!==(8&this.modifiers)}set meta(t){this.modifiers=t?8|this.modifiers:-9&this.modifiers}get left(){const t=this.event;return null===t||"mousedown"!==t.type&&"mouseup"!==t.type&&"pointerdown"!==t.type&&"pointerup"!==t.type?0!==(1&this.buttons):0===this.button}set left(t){t?this.buttons|=1:this.buttons&=-2}get right(){const t=this.event;return null===t||"mousedown"!==t.type&&"mouseup"!==t.type&&"pointerdown"!==t.type&&"pointerup"!==t.type?0!==(2&this.buttons):2===this.button}set right(t){t?this.buttons|=2:this.buttons&=-3}get middle(){const t=this.event;return null===t||"mousedown"!==t.type&&"mouseup"!==t.type&&"pointerdown"!==t.type&&"pointerup"!==t.type?0!==(4&this.buttons):1===this.button}set middle(t){t?this.buttons|=4:this.buttons&=-5}get commandKey(){const t=this.code,e=this.key;return"cxvyzagCXVYZAG".includes(e)?e.toLowerCase():"KeyC"===t?"c":"KeyX"===t?"x":"KeyV"===t?"v":"KeyY"===t?"y":"KeyZ"===t?"z":"KeyA"===t?"a":"KeyG"===t?"g":""!==t?t:e}}class D{N;Pt;om;rm;constructor(){this.N=null,this.Pt="",this.om=null,this.rm=null}copy(){const t=new D;return t.N=this.N,t.Pt=this.Pt,t.om=this.om,t.rm=this.rm,t}toString(){let t="*"+this.name;return null!==this.subject&&(t+=":"+this.subject.toString()),null!==this.parameter&&(t+="("+this.parameter.toString()+")"),t}get diagram(){return this.N}set diagram(t){this.N=t}get name(){return this.Pt}set name(t){this.Pt=t}get subject(){return this.om}set subject(t){this.om=t}get parameter(){return this.rm}set parameter(t){this.rm=t}}var O=(t=>(t[t.Transaction=1]="Transaction",t[t.Property=2]="Property",t[t.Insert=3]="Insert",t[t.Remove=4]="Remove",t))(O||{});class F{au;lm;en;ki;N;cu;ac;cc;fc;uc;constructor(){this.au=2,this.lm="",this.en="",this.ki=null,this.N=null,this.cu=null,this.ac=null,this.cc=null,this.fc=null,this.uc=null}static Transaction=1;static Property=2;static Insert=3;static Remove=4;clear(){this.ki=null,this.N=null,this.cu=null,this.ac=null,this.cc=null,this.fc=null,this.uc=null}copy(){const t=new F;t.au=this.au,t.lm=this.lm,t.en=this.en,t.ki=this.ki,t.N=this.N,t.cu=this.cu;let i=this.ac;return e.K(i)&&e.it(i.copyFrozen)?t.ac=i.copyFrozen():t.ac=i,i=this.cc,e.K(i)&&e.it(i.copyFrozen)?t.cc=i.copyFrozen():t.cc=i,i=this.fc,e.K(i)&&e.it(i.copyFrozen)?t.fc=i.copyFrozen():t.fc=i,i=this.uc,e.K(i)&&e.it(i.copyFrozen)?t.uc=i.copyFrozen():t.uc=i,t}oi(t){t in O?this.change=t:e.ir(this,t)}toString(){let t="";return 1===this.change?t+="* ":2===this.change?t+=null!==this.model?"!m":"!d":t+=(null!==this.model?"!m":"!d")+this.change,this.propertyName&&"string"==typeof this.propertyName&&(t+=" "+this.propertyName),this.modelChange&&this.modelChange!==this.propertyName&&(t+=" "+this.modelChange),t+=": ",1===this.change?null!==this.oldValue&&(t+=" "+this.oldValue):(null!==this.object&&(t+=e.toString(this.object)),null!==this.oldValue&&(t+="  old: "+e.toString(this.oldValue)),null!==this.oldParam&&(t+=" "+this.oldParam),null!==this.newValue&&(t+="  new: "+e.toString(this.newValue)),null!==this.newParam&&(t+=" "+this.newParam)),t}getValue(t){return t?this.oldValue:this.newValue}getParam(t){return t?this.oldParam:this.newParam}canUndo(){return null!==this.model||null!==this.diagram}undo(){this.canUndo()&&(null!==this.model?this.model.changeState(this,!0):null!==this.diagram&&this.diagram.VC(this,!0))}canRedo(){return null!==this.model||null!==this.diagram}redo(){this.canRedo()&&(null!==this.model?this.model.changeState(this,!1):null!==this.diagram&&this.diagram.VC(this,!1))}get model(){return this.ki}set model(t){this.ki=t}get diagram(){return this.N}set diagram(t){this.N=t}get change(){return this.au}set change(t){this.au=t}get modelChange(){return this.lm}set modelChange(t){this.lm=t}get propertyName(){return this.en}set propertyName(t){this.en=t}get isTransactionFinished(){return 1===this.au&&("CommittedTransaction"===this.en||"FinishedUndo"===this.en||"FinishedRedo"===this.en)}get object(){return this.cu}set object(t){this.cu=t}get oldValue(){return this.ac}set oldValue(t){this.ac=t}get oldParam(){return this.cc}set oldParam(t){this.cc=t}get newValue(){return this.fc}set newValue(t){this.fc=t}get newParam(){return this.uc}set newParam(t){this.uc=t}}class R{zC;Pt;Jk;constructor(){this.zC=(new h).u(),this.Pt="",this.Jk=!1}toString(t){let e="Transaction: "+this.name+" "+this.changes.count.toString()+(this.isComplete?"":", incomplete");if(void 0!==t&&t>0){const t=this.changes.count;for(let i=0;i<t;i++){const t=this.changes.elt(i);null!==t&&(e+="\n  "+t.toString())}}return e}clear(){const t=this.changes;t.Nt();for(let e=t.count-1;e>=0;e--){const i=t.elt(e);null!==i&&i.clear()}t.clear(),t.u()}canUndo(){return this.isComplete}undo(){if(this.canUndo())for(let t=this.changes.count-1;t>=0;t--){const e=this.changes.elt(t);null!==e&&e.undo()}}canRedo(){return this.isComplete}redo(){if(!this.canRedo())return;const t=this.changes.count;for(let e=0;e<t;e++){const t=this.changes.elt(e);null!==t&&t.redo()}}fF(t){const e=this.changes;for(let i=e.count-1;i>=t;i--){const t=e.elt(i);null!==t&&t.undo(),e.Nt(),e.removeAt(i)}e.u()}optimize(){if(!this.isComplete)return;const t=this.changes;t.Nt();const e=new m;for(let s=0;s<t.count;s++){const i=t.elt(s);if(null===i||2!==i.change||!i.object)continue;let n=e.get(i.object);n||(n=new m,e.set(i.object,n));const o=n.get(i.propertyName);null===o?n.set(i.propertyName,-1):(o>0&&t.setElt(o,null),n.set(i.propertyName,s))}let i=0;for(let s=0;s<t.count;s++){const e=t.elt(s);null!==e&&(s>i&&t.setElt(i,e),i++)}for(;t.length>i;)t.pop();t.u()}get changes(){return this.zC}get name(){return this.Pt}set name(t){this.Pt=t}get isComplete(){return this.Jk}set isComplete(t){this.Jk=t}}class E{Tw;Oi;XC;Os;$k;hm;Vn;Zk;Qk;sn;dc;Dw;Is;Fw;Rw;am;vw;constructor(t){this.Tw=new u,this.Oi=!1,this.XC=(new h).u(),this.Os=-1,this.$k=999,this.Is=!1,this.hm=null,this.Vn=0,this.Zk=!1,this.Qk=23,this.sn=(new h).u(),this.dc=new h,this.Dw=!0,this.Fw=!1,this.Rw=!1,this.am=!1,this.vw=!1,t&&Object.assign(this,t)}toString(t){let e="UndoManager "+this.historyIndex+"<"+this.history.count+"<="+this.maxHistoryLength;e+="[";let i=this.nestedTransactionNames.count;for(let s=0;s<i;s++)s>0&&(e+=" "),e+=this.nestedTransactionNames.elt(s);if(e+="]",void 0!==t&&t>0){i=this.history.count;for(let s=0;s<i;s++)e+="\n "+this.history.elt(s).toString(t-1)}return e}clear(){const t=this.history;t.Nt();for(let e=t.count-1;e>=0;e--){const i=t.elt(e);null!==i&&i.clear()}t.clear(),this.Os=-1,t.u(),this.Is=!1,this.hm=null,this.Vn=0,this.sn.Nt(),this.sn.clear(),this.sn.u(),this.dc.clear(),this.Fw=!1,this.Rw=!1,this.am=!1,this.vw=!1}copyProperties(t){this.isEnabled=t.isEnabled,this.maxHistoryLength=t.maxHistoryLength,this.cm=t.cm}addModel(t){this.Tw.add(t)}removeModel(t){this.Tw.delete(t)}startTransaction(t){if(void 0===t&&(t=""),null===t&&(t=""),this.isUndoingRedoing)return!1;!0===this.Dw&&(this.Dw=!1,this.Vn++,this.yl||this.wl("StartingFirstTransaction",t,this.currentTransaction),this.Vn>0&&this.Vn--),this.isEnabled&&(this.sn.Nt(),this.sn.add(t),this.sn.u(),null===this.currentTransaction?this.dc.add(0):this.dc.add(this.currentTransaction.changes.count)),this.Vn++;const e=1===this.transactionLevel;return e&&(this.yl||this.wl("StartedTransaction",t,this.currentTransaction)),e}commitTransaction(t){return void 0===t&&(t=""),this.YC(!0,t)}rollbackTransaction(){return this.YC(!1,"")}YC(t,i){if(this.isUndoingRedoing)return!1;this.cm&&this.transactionLevel<1&&e.ni("Ending transaction without having started a transaction: "+i);const s=1===this.transactionLevel;let n=this.currentTransaction;s&&t&&(this.yl||this.wl("CommittingTransaction",i,n));let o=0;if(this.transactionLevel>0&&(this.Vn--,this.isEnabled)){const t=this.sn.count;t>0&&(""===i&&(i=this.sn.elt(0)),this.sn.Nt(),this.sn.removeAt(t-1),this.sn.u());const e=this.dc.count;e>0&&(o=this.dc.elt(e-1),this.dc.removeAt(e-1))}if(s){if(t){if(this.am=!1,null===n&&""!==i&&(n=this.currentTransaction),this.isEnabled&&null!==n){const t=n;t.isComplete||(t.isComplete=!0,t.name=i),this.discardHistoryAfterIndex();const e=this.history;e.Nt();const s=this.maxHistoryLength;if(s>=0)if(0===s)e.clear();else if(e.count>=s){const t=e.elt(0);null!==t&&t.clear(),e.removeAt(0),this.Os--}0!==s&&(0===e.count||e.get(e.count-1)!==t)&&(e.add(t),this.Os++),e.u(),n=t}this.yl||this.wl("CommittedTransaction",i,n)}else{this.Is=!0;try{this.isEnabled&&null!==n&&(n.isComplete=!0,n.undo())}finally{this.yl||this.wl("RolledBackTransaction",i,n),this.Is=!1}null!==n&&n.clear()}return this.hm=null,this.Ow&&this.clear(),this.Ow=!1,this.Iw=!1,!0}return this.isEnabled&&!t&&null!==n&&n.fF(o),!1}discardHistoryAfterIndex(){if(this.isUndoingRedoing||!this.canRedo())return;const t=this.history;t.Nt();for(let e=t.count-1;e>this.historyIndex;e--){const i=t.elt(e);null!==i&&i.clear(),t.removeAt(e),this.am=!0}t.u()}PE(t){this.Vn+=t,this.Vn<0&&(this.Vn=0)}canUndo(){if(!this.isEnabled||this.transactionLevel>0)return!1;const t=this.transactionToUndo;return!(null===t||!t.canUndo())}undo(){if(!this.canUndo())return;const t=this.transactionToUndo;try{this.Is=!0,this.wl("StartingUndo","Undo",t),this.Os--,t.undo()}catch(i){e.ni("undo error: "+i.toString())}finally{this.wl("FinishedUndo","Undo",t),this.Is=!1}}canRedo(){if(!this.isEnabled||this.transactionLevel>0)return!1;const t=this.transactionToRedo;return!(null===t||!t.canRedo())}redo(){if(!this.canRedo())return;const t=this.transactionToRedo;try{this.Is=!0,this.wl("StartingRedo","Redo",t),this.Os++,t.redo()}catch(i){e.ni("redo error: "+i.toString())}finally{this.wl("FinishedRedo","Redo",t),this.Is=!1}}wl(t,e,i){void 0===i&&(i=null);const s=new F;s.change=1,s.propertyName=t,s.object=i,s.oldValue=e;const n=this.models;for(;n.next();){const t=n.value;s.model=t,t.uF(s)}}handleChanged(t){if(this.isEnabled&&!this.isUndoingRedoing&&!this.skipsEvent(t)){let i=this.currentTransaction;null===i&&(i=new R,this.hm=i);const s=t.copy(),n=i.changes;if(n.Nt(),n.add(s),n.u(),this.cm&&this.Qk>0&&this.transactionLevel<=0&&!this.Dw){const i=t.diagram;if(null!==i&&!1===i.Uh)return;e.ni("Change not within a transaction: "+s.toString()),this.Qk--}}}skipsEvent(t){if(null===t||1===t.change)return!0;const e=t.object;if(null===e)return!1;if(void 0!==e.layer){const t=e.layer;if(null!==t&&t.isTemporary)return!0}else if(e.isTemporary)return!0;return!1}get models(){return this.Tw.iterator}get isEnabled(){return this.Oi}set isEnabled(t){this.Oi=t}get transactionToUndo(){return this.historyIndex>=0&&this.historyIndex<=this.history.count-1?this.history.elt(this.historyIndex):null}get transactionToRedo(){return this.historyIndex<this.history.count-1?this.history.elt(this.historyIndex+1):null}get isUndoingRedoing(){return this.Is}get history(){return this.XC}get maxHistoryLength(){return this.$k}set maxHistoryLength(t){this.$k=t}get historyIndex(){return this.Os}get currentTransaction(){return this.hm}get transactionLevel(){return this.Vn}get isInTransaction(){return this.Vn>0}get cm(){return this.Zk}set cm(t){this.Zk=t}get nestedTransactionNames(){return this.sn}get Ow(){return this.Fw}set Ow(t){this.Fw=t}get Iw(){return this.Rw}set Iw(t){this.Rw=t}get yl(){return this.vw}set yl(t){this.vw=t}get isJustDiscarded(){return this.am}}class B{N;Pt;Oi;_k;tP;fm;KC;constructor(){u.Gi(this),this.N=vt.um(),this.Pt="",this.Oi=!0,this._k=!1,this.tP=null,this.KC=new T,this.fm=-1}get diagram(){return this.N}set diagram(t){t instanceof vt&&(this.N=t)}toString(){return""!==this.name?this.name+" Tool":e.Dn(this.constructor)}updateAdornments(t){}canStart(){return this.isEnabled}doStart(){}doActivate(){this.isActive=!0}doDeactivate(){this.isActive=!1}doStop(){}doCancel(){this.transactionResult=null,this.stopTool()}stopTool(){const t=this.diagram;t.currentTool===this&&(t.currentTool=null,t.currentCursor="")}doMouseDown(){!this.isActive&&this.canStart()&&this.doActivate()}doMouseMove(){}doMouseUp(){this.stopTool()}doMouseWheel(){}canStartMultiTouch(){return!0}standardPinchZoomStart(){const t=this.diagram,e=t.lastInput,i=e.getMultiTouchViewPoint(0,y.V(NaN,NaN)),s=e.getMultiTouchViewPoint(1,y.V(NaN,NaN));if(!i.isReal()||!s.isReal())return y.e(i),void y.e(s);if(this.doCancel(),t.getInputOption("hasGestureZoom")){t.iP=t.scale;const n=s.x-i.x,o=s.y-i.y,r=Math.sqrt(n*n+o*o);t.eP=r,e.bubbles=!1}y.e(i),y.e(s)}standardPinchZoomMove(){const t=this.diagram,e=t.lastInput,i=e.getMultiTouchViewPoint(0,y.V(NaN,NaN)),s=e.getMultiTouchViewPoint(1,y.V(NaN,NaN));if(!i.isReal()||!s.isReal())return y.e(i),void y.e(s);if(this.doCancel(),t.getInputOption("hasGestureZoom")){const n=s.x-i.x,o=s.y-i.y,r=Math.sqrt(n*n+o*o)/t.eP,a=new y((Math.min(s.x,i.x)+Math.max(s.x,i.x))/2,(Math.min(s.y,i.y)+Math.max(s.y,i.y))/2),h=t.iP*r,l=t.commandHandler;if(h!==t.scale&&l.canResetZoom(h)){const e=t.zoomPoint;t.zoomPoint=a,l.resetZoom(h),t.zoomPoint=e}e.bubbles=!1}y.e(i),y.e(s)}doKeyDown(){"Escape"===this.diagram.lastInput.code&&this.doCancel()}doKeyUp(){}startTransaction(t){return void 0===t&&(t=this.name),this.transactionResult=null,this.diagram.startTransaction(t)}stopTransaction(){const t=this.diagram;return null===this.transactionResult?t.rollbackTransaction():t.commitTransaction(this.transactionResult)}standardMouseSelect(){const t=this.diagram;if(!t.allowSelect)return;const i=t.lastInput,s=t.findPartAt(i.documentPoint,!1);if(null!==s){if(e._o?i.meta:i.control){t.D("ChangingSelection",t.selection);let e=s;for(;null!==e&&!e.canSelect();)e=e.containingGroup;null!==e&&(e.isSelected=!e.isSelected),t.D("ChangedSelection",t.selection)}else if(i.shift){if(!s.isSelected){t.D("ChangingSelection",t.selection);let e=s;for(;null!==e&&!e.canSelect();)e=e.containingGroup;null!==e&&(e.isSelected=!0),t.D("ChangedSelection",t.selection)}}else if(!s.isSelected){let e=s;for(;null!==e&&!e.canSelect();)e=e.containingGroup;null!==e&&t.select(e)}}else i.left&&!(e._o?i.meta:i.control)&&!i.shift&&t.clearSelection()}standardMouseClick(t,e){void 0===t&&(t=null),void 0===e&&(e=t=>!t.layer?.isTemporary);const i=this.diagram,s=i.lastInput,n=i.findObjectAt(s.documentPoint,t,e);return s.targetObject=n,this.dF(n,s,i),s.handled}dF(t,e,i){if(e.handled=!1,null!==t&&!t.isEnabledObject())return;let s=0;e.left?s=1===e.clickCount?1:2===e.clickCount?2:1:e.right&&1===e.clickCount&&(s=3);let n="ObjectSingleClicked";if(null!==t){switch(s){case 1:n="ObjectSingleClicked";break;case 2:n="ObjectDoubleClicked";break;case 3:n="ObjectContextClicked";break}0!==s&&i.D(n,t)}else{switch(s){case 1:n="BackgroundSingleClicked";break;case 2:n="BackgroundDoubleClicked";break;case 3:n="BackgroundContextClicked";break}0!==s&&i.D(n)}if(null!==t)for(;null!==t;){let i=null;switch(s){case 1:i=t.click;break;case 2:i=t.doubleClick?t.doubleClick:t.click;break;case 3:i=t.contextClick;break}if(null!==i&&(i(e,t),e.handled))break;t=t.panel}else{let t=null;switch(s){case 1:t=i.click;break;case 2:t=i.doubleClick?i.doubleClick:i.click;break;case 3:t=i.contextClick;break}null!==t&&t(e)}}standardMouseOver(){const t=this.diagram,e=t.lastInput;if(!0===t.animationManager.pi)return;const i=t.skipsUndoManager;t.skipsUndoManager=!0;let s=t.viewportBounds.containsPoint(e.documentPoint)?t.findObjectAt(e.documentPoint,null,null):null;e.event&&("pointercancel"===e.event.type||"pointerout"===e.event.type)&&(s=null),e.targetObject=s;let n=!1;if(s!==t.gc){let i=t.gc;const o=i;for(t.gc=s,this.doCurrentObjectChanged(i,s),e.handled=!1;null!==i;){const t=i.mouseLeave;if(null!==t&&(s===i||null!==s&&s.isContainedBy(i)||(t(e,i,s),n=!0,e.handled)))break;i=i.panel}for(i=o,e.handled=!1;null!==s;){const t=s.mouseEnter;if(null!==t&&(i===s||null!==i&&i.isContainedBy(s)||(t(e,s,i),n=!0,e.handled)))break;s=s.panel}s=t.gc}if(null!==s){let i=s,o="";for(;null!==i&&(o=i.cursor,""===o);)i=i.panel;for(t.currentCursor=o,e.handled=!1,i=s;null!==i;){const t=i.mouseOver;if(null!==t&&(t(e,i),n=!0,e.handled))break;i=i.panel}}else{this.doUpdateCursor(null);const i=t.mouseOver;null!==i&&(i(e),n=!0)}n&&t.requestUpdate(),t.skipsUndoManager=i}doUpdateCursor(t){const e=this.diagram;e&&(e.currentCursor="")}doCurrentObjectChanged(t,e){}standardMouseWheel(){const t=this.diagram,e=t.lastInput;let i=e.delta;if(0===i||!t.documentBounds.isReal())return;const s=t.commandHandler,n=t.toolManager.mouseWheelBehavior;if(null!==s&&(2===n&&!e.shift||1===n&&e.control)){if(i>0?s.canIncreaseZoom():s.canDecreaseZoom()){const n=t.zoomPoint;t.zoomPoint=e.viewPoint,i>0?s.increaseZoom():s.decreaseZoom(),t.zoomPoint=n}e.bubbles=!1}else if(2===n&&e.shift||1===n&&!e.control){const s=t.position.copy(),n=e.event,o=n.deltaMode;let r=n.deltaX,a=n.deltaY,h="pixel";if(0===r&&0===a||e.shift)!e.shift&&t.allowVerticalScroll?(i=3*i*t.scrollVerticalLineChange,t.scroll(h,i>0?"up":"down",Math.abs(i))):e.shift&&t.allowHorizontalScroll&&(i=3*i*t.scrollHorizontalLineChange,t.scroll(h,i>0?"left":"right",Math.abs(i)));else{switch(o){case 0:h="pixel";break;case 1:h="line";break;case 2:h="page";break}if(0!==r&&t.allowHorizontalScroll){const e=t.scrollHorizontalLineChange;r*=e/16,t.scroll(h,r>0?"right":"left",Math.abs(r))}if(0!==a&&t.allowVerticalScroll){const e=t.scrollVerticalLineChange;a*=e/16,t.scroll(h,a>0?"down":"up",Math.abs(a))}}this.doWheelChange(t,s,e)}}doWheelChange(t,e,i){(!t.position.equals(e)||0!==i.event.wheelDeltaX)&&(i.bubbles=!1)}standardWaitAfter(t,i){void 0===i&&(i=this.diagram.lastInput),this.cancelWaitAfter();const s=this,n=i.clone(this.KC);this.fm=e.tr((()=>s.doWaitAfter(n)),t)}cancelWaitAfter(){-1!==this.fm&&e.Tg(this.fm),this.fm=-1}doWaitAfter(t){}findToolHandleAt(t,e){const i=this.diagram.findObjectAt(t,(t=>{for(;null!==t&&!(t.panel instanceof Pe);)t=t.panel;return t}));return null===i?null:i.part.category===e?i:null}isBeyondDragSize(t,e){const i=this.diagram;void 0===t&&(t=i.firstInput.viewPoint),void 0===e&&(e=i.lastInput.viewPoint);const s=i.toolManager.dragSize;let n=s.width,o=s.height;return i.firstInput.isTouchEvent&&(n+=6,o+=6),Math.abs(e.x-t.x)>n||Math.abs(e.y-t.y)>o}get name(){return this.Pt}set name(t){e.s(t,"string",B,"name"),this.Pt=t}get isEnabled(){return this.Oi}set isEnabled(t){e.s(t,"boolean",B,"isEnabled"),this.Oi=t}get isActive(){return this._k}set isActive(t){e.s(t,"boolean",B,"isActive"),this._k=t}get transactionResult(){return this.tP}set transactionResult(t){null!==t&&e.s(t,"string",B,"transactionResult"),this.tP=t}}var I=(t=>(t[t.Scroll=1]="Scroll",t[t.Zoom=2]="Zoom",t[t.None=3]="None",t))(I||{}),_=(t=>(t[t.Zoom=1]="Zoom",t[t.Cancel=2]="Cancel",t[t.None=3]="None",t))(_||{});class V extends B{GC;HC;jC;sP;nP;oP;rP;lP;hP;aP;dm;Vh;constructor(t){super(),this.name="ToolManager",this.GC=new h,this.HC=new h,this.jC=new h,this.sP=850,this.nP=850,this.oP=new v(2,2).$(),this.rP=5e3,this.lP=1,this.hP=1,this.aP=null,this.dm=null,this.Vh=-1,t&&Object.assign(this,t)}static WheelScroll=1;static WheelZoom=2;static WheelNone=3;static GestureZoom=1;static GestureCancel=2;static GestureNone=3;get mouseWheelBehavior(){return this.lP}set mouseWheelBehavior(t){this.lP=t}get gestureBehavior(){return this.hP}set gestureBehavior(t){this.hP=t}initializeStandardTools(){}updateAdornments(t){const e=this.currentToolTip;if(e instanceof Pe&&this.dm===t){const i=e.adornedObject;(null!==t?null!==i&&i.part===t:null===i)?this.showToolTip(e,i):this.hideToolTip()}}doMouseDown(){const t=this.diagram,e=t.lastInput;if(e.isTouchEvent&&2===this.gestureBehavior&&(e.bubbles=!1),e.isMultiTouch){if(this.cancelWaitAfter(),3===this.gestureBehavior)return void(e.bubbles=!0);if(2===this.gestureBehavior)return;if(t.currentTool.canStartMultiTouch())return void t.currentTool.standardPinchZoomStart()}t.undoManager;const i=this.mouseDownTools.length;for(let s=0;s<i;s++){const e=this.mouseDownTools.elt(s);if(e.diagram=this.diagram,e.canStart())return t.doFocus(),t.currentTool=e,void(t.currentTool===e&&(e.isActive||e.doActivate(),e.doMouseDown()))}1===t.lastInput.button&&(1===this.mouseWheelBehavior?this.mouseWheelBehavior=2:2===this.mouseWheelBehavior&&(this.mouseWheelBehavior=1)),this.doActivate(),this.standardWaitAfter(this.holdDelay,e)}doMouseMove(){const t=this.diagram,e=t.lastInput;if(e.isMultiTouch){if(3===this.gestureBehavior)return void(e.bubbles=!0);if(2===this.gestureBehavior)return;if(t.currentTool.canStartMultiTouch())return void t.currentTool.standardPinchZoomMove()}if(this.isActive){const e=this.mouseMoveTools.length;for(let i=0;i<e;i++){const e=this.mouseMoveTools.elt(i);if(e.diagram=this.diagram,e.canStart())return t.doFocus(),t.currentTool=e,void(t.currentTool===e&&(e.isActive||e.doActivate(),e.doMouseMove()))}}this.standardMouseActivity(t);const i=e.event;null!==i&&("pointermove"===i.type||!i.cancelable)&&(e.bubbles=!0)}standardMouseActivity(t){this.standardMouseOver(),this.isBeyondDragSize()&&this.standardWaitAfter(this.isActive?this.holdDelay:this.hoverDelay,t.lastInput)}doCurrentObjectChanged(t,e){const i=this.currentToolTip;null!==i&&(null!==e&&i instanceof Pe&&(e===i||e.isContainedBy(i))||this.hideToolTip())}doWaitAfter(t){const e=this.diagram;if(e.gF()&&(this.doMouseHover(),this.isActive||this.doToolTip(),t.isTouchEvent&&!e.lastInput.handled)){const i=t.copy();return i.button=2,e.lastInput=i,e.Ew=!0,void e.doMouseUp()}}doMouseHover(){const t=this.diagram,e=t.lastInput;null===e.targetObject&&(e.targetObject=t.findObjectAt(e.documentPoint,null,null));let i=e.targetObject;if(null!==i)for(e.handled=!1;null!==i;){const t=this.isActive?i.mouseHold:i.mouseHover;if(null!==t&&(t(e,i),e.handled))break;i=i.panel}else{const i=this.isActive?t.mouseHold:t.mouseHover;null!==i&&i(e)}}doToolTip(){const t=this.diagram,e=t.lastInput;null===e.targetObject&&(e.targetObject=t.findObjectAt(e.documentPoint,null,null));let i=e.targetObject;if(null!==i){const t=this.currentToolTip;if(t instanceof Pe&&(i===t||i.isContainedBy(t)))return;for(;null!==i;){const t=i.toolTip;if(null!==t)return void this.showToolTip(t,i);i=i.panel}this.hideToolTip()}else{const e=t.toolTip;null!==e?this.showToolTip(e,null):this.hideToolTip()}}showToolTip(t,i){const s=this.diagram;if(t!==this.currentToolTip&&this.hideToolTip(),t instanceof Pe){t.layerName="Tool",t.selectable=!1,t.scale=1/s.scale,t.category="ToolTip",t.hasPlaceholder()&&(t.placeholder.scale=s.scale);const e=t.diagram;null!==e&&e!==s&&e.remove(t),s.add(t),null!==i?t.adornedObject=i:t.data=s.model,t.ensureBounds(),this.positionToolTip(t,i)}else t instanceof tt&&t!==this.currentToolTip&&null!==t.show&&t.show(i,s,this);this.currentToolTip=t,-1!==this.Vh&&(e.Tg(this.Vh),this.Vh=-1);const n=this.toolTipDuration;if(n>0&&n!==1/0){const t=this;this.Vh=e.tr((()=>t.hideToolTip()),n)}}positionToolTip(t,e){if(t.hasPlaceholder())return;const i=t,s=this.diagram,n=s.lastInput.documentPoint.copy(),o=i.measuredBounds,r=s.viewportBounds;s.lastInput.isTouchEvent&&(n.x-=o.width),n.x+o.width>r.right&&(n.x-=o.width+5/s.scale),n.x<r.x&&(n.x=r.x),n.y+20/s.scale+o.height>r.bottom?n.y-=o.height+5/s.scale:n.y+=20/s.scale,n.y<r.y&&(n.y=r.y),i.position=n}hideToolTip(){-1!==this.Vh&&(e.Tg(this.Vh),this.Vh=-1);const t=this.diagram,i=this.currentToolTip;null!==i&&(i instanceof Pe?(t.remove(i),null!==this.dm&&this.dm.removeAdornment(i.category),i.data=null,i.adornedObject=null):i instanceof tt&&null!==i.hide&&i.hide(t,this),this.currentToolTip=null)}get currentToolTip(){return this.aP}set currentToolTip(t){this.aP=t,this.dm=null!==t&&t instanceof Pe?t.adornedPart:null}doMouseUp(){this.cancelWaitAfter();const t=this.diagram;if(this.isActive){const e=this.mouseUpTools.length;for(let i=0;i<e;i++){const e=this.mouseUpTools.elt(i);if(e.diagram=this.diagram,e.canStart())return t.doFocus(),t.currentTool=e,void(t.currentTool===e&&(e.isActive||e.doActivate(),e.doMouseUp()))}}t.doFocus(),this.doDeactivate()}doMouseWheel(){this.standardMouseWheel()}doKeyDown(){const t=this.diagram;null!==t.commandHandler&&t.commandHandler.doKeyDown()}doKeyUp(){const t=this.diagram;null!==t.commandHandler&&t.commandHandler.doKeyUp()}findTool(t){e.s(t,"string",V,"findTool:name");let i=this.mouseDownTools.length;for(let e=0;e<i;e++){const i=this.mouseDownTools.elt(e);if(i.name===t)return i}i=this.mouseMoveTools.length;for(let e=0;e<i;e++){const i=this.mouseMoveTools.elt(e);if(i.name===t)return i}i=this.mouseUpTools.length;for(let e=0;e<i;e++){const i=this.mouseUpTools.elt(e);if(i.name===t)return i}return null}replaceTool(t,i){e.s(t,"string",V,"replaceTool:name"),null!==i&&(i.diagram=this.diagram);let s=this.mouseDownTools.length;for(let e=0;e<s;e++){const s=this.mouseDownTools.elt(e);if(s.name===t)return null!==i?this.mouseDownTools.setElt(e,i):this.mouseDownTools.removeAt(e),s}s=this.mouseMoveTools.length;for(let e=0;e<s;e++){const s=this.mouseMoveTools.elt(e);if(s.name===t)return null!==i?this.mouseMoveTools.setElt(e,i):this.mouseMoveTools.removeAt(e),s}s=this.mouseUpTools.length;for(let e=0;e<s;e++){const s=this.mouseUpTools.elt(e);if(s.name===t)return null!==i?this.mouseUpTools.setElt(e,i):this.mouseUpTools.removeAt(e),s}return null}replaceStandardTool(t,e,i){this.Jt(t,e,i)}Jt(t,i,s){e.s(t,"string",V,"replaceStandardTool:name"),null!==i&&(i.name=t,i.diagram=this.diagram),this.findTool(t)?this.replaceTool(t,i):null!==i&&s.add(i)}get mouseDownTools(){return this.GC}get mouseMoveTools(){return this.HC}get mouseUpTools(){return this.jC}get hoverDelay(){return this.sP}set hoverDelay(t){e.s(t,"number",V,"hoverDelay"),this.sP=t}get holdDelay(){return this.nP}set holdDelay(t){e.s(t,"number",V,"holdDelay"),this.nP=t}get dragSize(){return this.oP}set dragSize(t){this.oP=t.P()}get toolTipDuration(){return this.rP}set toolTipDuration(t){e.s(t,"number",V,"toolTipDuration"),this.rP=t}get actionTool(){return this.findTool("Action")}set actionTool(t){this.Jt("Action",t,this.mouseDownTools)}get relinkingTool(){return this.findTool("Relinking")}set relinkingTool(t){this.Jt("Relinking",t,this.mouseDownTools)}get linkReshapingTool(){return this.findTool("LinkReshaping")}set linkReshapingTool(t){this.Jt("LinkReshaping",t,this.mouseDownTools)}get resizingTool(){return this.findTool("Resizing")}set resizingTool(t){this.Jt("Resizing",t,this.mouseDownTools)}get rotatingTool(){return this.findTool("Rotating")}set rotatingTool(t){this.Jt("Rotating",t,this.mouseDownTools)}get linkingTool(){return this.findTool("Linking")}set linkingTool(t){this.Jt("Linking",t,this.mouseMoveTools)}get draggingTool(){return this.findTool("Dragging")}set draggingTool(t){this.Jt("Dragging",t,this.mouseMoveTools)}get dragSelectingTool(){return this.findTool("DragSelecting")}set dragSelectingTool(t){this.Jt("DragSelecting",t,this.mouseMoveTools)}get panningTool(){return this.findTool("Panning")}set panningTool(t){this.Jt("Panning",t,this.mouseMoveTools)}get contextMenuTool(){return this.findTool("ContextMenu")}set contextMenuTool(t){this.Jt("ContextMenu",t,this.mouseUpTools)}get textEditingTool(){return this.findTool("TextEditing")}set textEditingTool(t){this.Jt("TextEditing",t,this.mouseUpTools)}get clickCreatingTool(){return this.findTool("ClickCreating")}set clickCreatingTool(t){this.Jt("ClickCreating",t,this.mouseUpTools)}get clickSelectingTool(){return this.findTool("ClickSelecting")}set clickSelectingTool(t){this.Jt("ClickSelecting",t,this.mouseUpTools)}}class z extends B{cP;fP;nn;uP;dP;gP;mP;mc;gm;pP;zh;ar;qC;yP;fu;uu;wP;xP;bP;kP;constructor(t){super(),this.name="Dragging",this.cP=!0,this.kP=!0,this.fP=!0,this.nn=null,this.uP=null,this.dP=null,this.gP=null,this.mP=!1,this.fu=!1,this.mc=new y(NaN,NaN),this.gm=new y,this.pP=!0,this.zh=100,this.ar=[],this.qC=(new u).u(),this.yP=new kt,this.uu=null,this.wP="copy",this.xP="",this.bP="no-drop",t&&Object.assign(this,t)}get isCopyEnabled(){return this.cP}set isCopyEnabled(t){e.s(t,"boolean",z,"isCopyEnabled"),this.cP=t}get copiesEffectiveCollection(){return this.fP}set copiesEffectiveCollection(t){e.s(t,"boolean",z,"copiesEffectiveCollection"),this.fP=t}get dragOptions(){return this.yP}set dragOptions(t){this.yP=t}get isGridSnapEnabled(){return this.dragOptions.isGridSnapEnabled}set isGridSnapEnabled(t){e.s(t,"boolean",z,"isGridSnapEnabled"),this.dragOptions.isGridSnapEnabled=t}get isComplexRoutingRealtime(){return this.pP}set isComplexRoutingRealtime(t){this.pP=t;const e=this.diagram.findRouter("AvoidsLinks");null!==e&&(e.isRealtime=t)}get isGridSnapRealtime(){return this.dragOptions.isGridSnapRealtime}set isGridSnapRealtime(t){e.s(t,"boolean",z,"isGridSnapRealtime"),this.dragOptions.isGridSnapRealtime=t}get gridSnapCellSize(){return this.dragOptions.gridSnapCellSize}set gridSnapCellSize(t){this.dragOptions.gridSnapCellSize.equals(t)||(t=t.P(),this.dragOptions.gridSnapCellSize=t)}get gridSnapCellSpot(){return this.dragOptions.gridSnapCellSpot}set gridSnapCellSpot(t){this.dragOptions.gridSnapCellSpot.equals(t)||(t=t.P(),this.dragOptions.gridSnapCellSpot=t)}get gridSnapOrigin(){return this.dragOptions.gridSnapOrigin}set gridSnapOrigin(t){this.dragOptions.gridSnapOrigin.equals(t)||(t=t.P(),this.dragOptions.gridSnapOrigin=t)}get dragsLink(){return this.dragOptions.dragsLink}set dragsLink(t){e.s(t,"boolean",z,"dragsLink"),this.dragOptions.dragsLink=t}get dragsTree(){return this.dragOptions.dragsTree}set dragsTree(t){e.s(t,"boolean",z,"dragsTree"),this.dragOptions.dragsTree=t}get copyCursor(){return this.wP}set copyCursor(t){this.wP=t}get moveCursor(){return this.xP}set moveCursor(t){this.xP=t}get nodropCursor(){return this.bP}set nodropCursor(t){this.bP=t}get currentPart(){return this.uP}set currentPart(t){this.uP=t}get copiedParts(){return this.gP}set copiedParts(t){this.gP=t}get draggedParts(){return this.dP}set draggedParts(t){this.dP=t}get draggingParts(){return null!==this.copiedParts?this.copiedParts.toKeySet():null!==this.draggedParts?this.draggedParts.toKeySet():this.qC}get draggedLink(){return this.diagram.draggedLink}set draggedLink(t){this.diagram.draggedLink=t}get isDragOutStarted(){return this.mP}set isDragOutStarted(t){this.mP=t}get startPoint(){return this.gm}set startPoint(t){this.gm.equals(t)||this.gm.a(t)}get delay(){return this.zh}set delay(t){e.s(t,"number",z,"delay"),this.zh=t}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;if(null===t||t.isReadOnly&&!t.allowDragOut||!t.allowMove&&!t.allowCopy&&!t.allowDragOut||!t.allowSelect)return!1;const e=t.lastInput;return!(!e.left||t.currentTool!==this&&(!this.isBeyondDragSize()||e.isTouchEvent&&e.timestamp-t.firstInput.timestamp<this.zh))&&null!==this.findDraggablePart()}findDraggablePart(){const t=this.diagram;let e=t.findPartAt(t.firstInput.documentPoint,!1);if(null===e)return null;for(;null!==e&&!e.canSelect();)e=e.containingGroup;return null!==e&&(e.canMove()||e.canCopy())?e:null}standardMouseSelect(){const t=this.diagram;if(!t.allowSelect)return;let i=t.findPartAt(t.firstInput.documentPoint,!1);if(null!==i){for(;null!==i&&!i.canSelect();)i=i.containingGroup;if(this.currentPart=i,null!==this.currentPart&&!this.currentPart.isSelected){t.D("ChangingSelection",t.selection);const i=t.lastInput;!(e._o?i.meta:i.control)&&!i.shift&&t.clearSelection(!0),this.currentPart.isSelected=!0,t.D("ChangedSelection",t.selection)}}}doActivate(){const t=this.diagram;this.uu=null,null===this.currentPart&&this.standardMouseSelect();const e=this.currentPart;if(null===e||!e.canMove()&&!e.canCopy())return;t.cacheGroupExternalLinks(!0),z.dt=null,this.isActive=!0,this.mc.set(t.position),this.PP(t.selection),this.ar.length=0,t.animationManager.stopAnimation();const i=this.computeEffectiveCollection(t.selection,this.dragOptions);this.draggedParts=i,this.kP=!!this.diagram.layout.isRealtime,this.diagram.layout.isRealtime=!1,t.du=!0,!0===t.getRenderingHint("temporaryPixelRatio")&&t.avgSpf>30&&t.Bw(),t.WC(this.draggedParts),t.gu=!0,this.startTransaction("Drag"),this.startPoint=t.firstInput.documentPoint,t.isMouseCaptured=!0,t.allowDragOut&&this.mF()}PP(t){if(!this.dragsLink)return;const e=this.diagram,i=e.model.mm(),s=t.first();i&&1===t.count&&s instanceof De&&this.mayDragLink(s)?(this.draggedLink=s,this.draggedLink.canRelinkFrom()&&this.draggedLink.canRelinkTo()&&this.draggedLink.clearAdornments(),this.nn=e.toolManager.findTool("Relinking"),null===this.nn&&(this.nn=new G,this.nn.diagram=e),this.nn.originalLink=this.draggedLink):(this.draggedLink=null,this.nn=null)}mayDragLink(t){const e=this.diagram;return null!==e&&e.allowRelink}computeEffectiveCollection(t,e){return this.diagram.commandHandler.computeEffectiveCollection(t,e)}Es(t){return void 0===t?new bt(y.wo):this.isGridSnapEnabled?new bt(new y(Math.round(1e3*t.x)/1e3,Math.round(1e3*t.y)/1e3)):new bt(t.copy())}doDeactivate(){this.isActive=!1;const t=this.diagram;this.diagram.layout.isRealtime=this.kP,t.gu=!1,t.xl=!0,t.cacheGroupExternalLinks(!1),t.stopAutoScroll(),this.SP(),t.MP(this.draggedParts),this.uu=null,this.currentPart=null,this.draggedParts=null,this.isDragOutStarted=!1,this.fu=!1,z.pF(),this.JC(),this.mc.i(NaN,NaN),null!==z.Xh&&(z.Xh.currentCursor=""),z.Xh=null,z.dt=null,this.bl(),t.isMouseCaptured=!1,t.currentCursor="",t.du=!1,this.stopTransaction(),t.NP(!0)}stopTransaction(){const t=this.diagram,e=super.stopTransaction();return e&&null!==t.undoManager.transactionToUndo&&t.undoManager.transactionToUndo.optimize(),e}SP(){const t=this.diagram,e=t.skipsUndoManager;t.skipsUndoManager=!0;const i=t.lastInput;this.$C(i,null),t.skipsUndoManager=e,this.ar.length=0}ZC(){this.bl(),this.CP();const t=this.diagram;this.mc.isReal()&&(t.position=this.mc),t.stopAutoScroll()}doCancel(){this.bl(),this.CP();const t=this.diagram;this.mc.isReal()&&(t.position=this.mc),this.stopTool()}doKeyDown(){const t=this.diagram;if(!this.isActive)return;const e=t.lastInput,i=t.previousInput;"Escape"===e.code?this.doCancel():(e.code!==i.code||e.modifiers!==i.modifiers)&&this.doMouseMove()}doKeyUp(){this.isActive&&this.doMouseMove()}yF(t,e){let i=1/0,s=1/0,n=-1/0,o=-1/0;const r=t.iterator;for(;r.next();){const t=r.value;if(!t.isVisible())continue;const e=t.location,a=e.x,h=e.y;isNaN(a)||isNaN(h)||(a<i&&(i=a),h<s&&(s=h),a>n&&(n=a),h>o&&(o=h))}return i===1/0?e.i(0,0,0,0):e.i(i,s,n-i,o-s),e}LP(t){if(null!==this.copiedParts)return;const e=this.diagram;if(t&&(e.isReadOnly||e.isModelReadOnly)||null===this.draggedParts)return;const i=e.undoManager;i.isEnabled&&i.isInTransaction?null!==i.currentTransaction&&i.currentTransaction.changes.count>0&&(e.undoManager.rollbackTransaction(),e.startTransaction("Drag")):this.CP(),e.skipsUndoManager=!t,e.partManager.addsToTemporaryLayer=!t,this.startPoint=e.firstInput.documentPoint;const s=this.copiesEffectiveCollection?this.draggedParts.toKeySet():e.selection,n=e.copyParts(s,e,!0),o=new m,r=this.draggedParts.iterator;for(;r.next();){const t=r.key;if(t.ke()&&t.canCopy()){const e=n.get(t);if(null===e)continue;e.location=t.location,e.ensureBounds(),o.set(e,this.Es(e.location))}}const a=n.iterator;for(;a.next();){const t=a.value;t instanceof De&&t.canCopy()&&o.set(t,this.Es())}if(this.copiedParts=o,this.PP(o.toKeySet()),null!==this.draggedLink){const t=this.draggedLink,e=t.routeBounds;t.cr(this.startPoint.x-(e.x+e.width/2),this.startPoint.y-(e.y+e.height/2))}this.doUpdateCursor(null)}bl(){const t=this.diagram;if(null!==this.copiedParts){if(t.removeParts(this.copiedParts.toKeySet(),!1),this.copiedParts=null,null!==this.draggedParts){const t=this.draggedParts.iterator;for(;t.next();)if(t.key instanceof De){const e=t.value;e.point=new y(0,0)}}this.doUpdateCursor(null)}t.skipsUndoManager=!1,t.partManager.addsToTemporaryLayer=!1,this.startPoint=t.firstInput.documentPoint}JC(){null!==this.draggedLink&&(this.dragsLink&&null!==this.nn&&(this.nn.stopDraggingMouseMove(),this.nn.originalLink=null),this.draggedLink=null,this.nn=null)}pc(t,e){if(null===t)return;const i=this.diagram,s=this.startPoint,n=y.l();n.a(i.lastInput.documentPoint),this.moveParts(t,n.subtract(s),e),y.e(n),!0===i.getRenderingHint("temporaryPixelRatio")&&null===i.kl&&i.avgSpf>30&&(i.Bw(),i.mu())}moveParts(t,e,i){void 0===i&&(i=!1);const s=this.diagram;null!==s&&s.AP(t,e,this.dragOptions,i)}CP(){if(null===this.draggedParts)return;const t=this.diagram;let e=this.draggedParts.iterator;for(;e.next();){const t=e.key;t.ke()&&(t.location=e.value.point)}for(e=this.draggedParts.iterator;e.next();){const t=e.key;if(t instanceof De&&t.suspendsRouting){const i=e.value.point;this.draggedParts.set(t,this.Es()),t.cr(-i.x,-i.y)}}t.maybeUpdate()}wF(t){if(null===t)return!0;const e=t.part;return!!(null===e||e instanceof Pe||e.layer?.isTemporary||this.draggedParts&&this.draggedParts.has(e)||this.copiedParts&&this.copiedParts.has(e))}TP(t){const e=this.diagram;this.dragsLink&&(null!==this.draggedLink&&(this.draggedLink.fromNode=null,this.draggedLink.toNode=null),this.QC(!1));const i=this.findDragOverObject(t),s=e.lastInput;s.targetObject=i,this.doUpdateCursor(i);const n=e.skipsUndoManager;let o=!1;try{if(e.skipsUndoManager=!0,o=this.$C(s,i),!this.isActive&&null===z.dt)return;const n=null!==i?i.part:null;if(null===n||e.handlesDragDropForTopLevelParts&&n.isTopLevel&&!(n instanceof _e)){const t=e.mouseDragOver;null!==t&&(t(s),o=!0)}if(!this.isActive&&null===z.dt||(this.doDragOver(t,i),!this.isActive&&null===z.dt))return}finally{e.skipsUndoManager=n,o&&e.maybeUpdate()}this.uu=i,!e.isReadOnly&&(e.allowMove||e.allowCopy)&&(e.allowHorizontalScroll||e.allowVerticalScroll)&&e.doAutoScroll(s.viewPoint)}findDragOverObject(t){return this.diagram.DP(t,null,(t=>!this.wF(t)))}doUpdateCursor(t){const e=this.diagram;(null===t||this.uu!==t)&&(!this.diagram.currentTool.isActive||this.mayCopy()?e.currentCursor=this.copyCursor:this.mayMove()?e.currentCursor=this.moveCursor:this.mayDragOut()&&(e.currentCursor=this.nodropCursor))}$C(t,e){let i=!1,s=this.ar.length;const n=s>0?this.ar[0]:null;if(e===n)return!1;t.handled=!1;for(let r=0;r<s;r++){const s=this.ar[r],n=s.mouseDragLeave;if(null!==n&&(n(t,s,e),i=!0,t.handled))break}if(this.ar.length=0,!this.isActive&&null===z.dt||null===e)return i;t.handled=!1;let o=e;for(;null!==o;)this.ar.push(o),o=this._C(o);s=this.ar.length;for(let r=0;r<s;r++){const e=this.ar[r],s=e.mouseDragEnter;if(null!==s&&(s(t,e,n),i=!0,t.handled))break}return i}SE(t,e){return null!==t&&!!(t===e||t.isContainedBy(e)||e instanceof _e&&!(t instanceof _e)&&e.handlesDragDropForMembers&&t.part?.isMemberOf(e))}_C(t){const e=t.panel;if(null!==e)return e;if(t instanceof ke&&!(t instanceof _e)){const e=t.containingGroup;if(null!==e&&e.handlesDragDropForMembers)return e}return null}tL(t,e){const i=this.diagram,s=this.nn;if(null===s)return null;const n=s.portGravity,o=i.findObjectsNear(t,n,(t=>s.findValidLinkablePort(t,e))),r=y.l();let a=1/0,h=null;for(const l=o.iterator;l.next();){const e=l.value;if(null===e.part)continue;const i=e.getDocumentPoint(w.Center,r),s=t.distanceSquaredPoint(i);s<a&&(h=e,a=s)}return y.e(r),h}QC(t){const e=this.draggedLink;if(null!==e){if(e.pointsCount<2)return;const i=this.diagram;if(i.isReadOnly)return;const s=this.nn;if(null===s)return;let n=null,o=null;null===e.fromNode&&(n=this.tL(e.getPoint(0),!1),null!==n&&(o=n.part));let r=null,a=null;null===e.toNode&&(r=this.tL(e.getPoint(e.pointsCount-1),!0),null!==r&&(a=r.part)),s.isValidLink(o,n,a,r)?t?(e.defaultFromPoint=e.getPoint(0),e.defaultToPoint=e.getPoint(e.pointsCount-1),e.suspendsRouting=!1,e.fromNode=o,null!==n&&(e.fromPortId=n.portId),e.toNode=a,null!==r&&(e.toPortId=r.portId),e.fromPort!==i.FP&&i.D("LinkRelinked",e,i.FP),e.toPort!==i.RP&&i.D("LinkRelinked",e,i.RP)):s.doDraggingMouseMove(o,n,a,r):s.doDraggingMouseMove(null,null,null,null)}}doDragOver(t,e){}iL(t){const e=this.diagram;this.dragsLink&&this.QC(!0),this.SP();const i=this.findDragOverObject(t),s=e.lastInput;if(s.targetObject=i,null!==i){s.handled=!1;let t=i;for(;null!==t;){const e=t.mouseDrop;if(null!==e&&(e(s,t),s.handled))break;this.xF(s,t),t=this._C(t)}}else{const t=e.mouseDrop;null!==t&&t(s)}if(!this.isActive&&null===z.dt)return;const n=this.copiedParts||this.draggedParts;if(null!==n){const t=n.iterator;for(;t.next();){const e=t.key;e instanceof Ce&&e.linksConnected.each((t=>t.suspendsRouting=!1))}}if(this.doDropOnto(t,i),!this.isActive&&null===z.dt)return;const o=x.l(),r=e.selection.iterator;for(;r.next();){const t=r.value;t instanceof Ce&&this.bF(e,t,o)}x.e(o)}xF(t,e){const i=this.diagram,s=e.part;if(i.handlesDragDropForTopLevelParts&&null!==s&&s.isTopLevel&&!(s instanceof _e)){const e=i.mouseDrop;null!==e&&e(t)}}bF(t,e,i){if(!e.canAvoid())return;let s=!1;i=e.getAvoidableRect(i),t.viewportBounds.containsRect(i)&&(s=!0);const n=this.copiedParts||this.draggedParts;if(null===n)return;const o=t.vP(i,(t=>t.part),(t=>t instanceof De),!0,(t=>t instanceof De),s);if(0===o.count)return;const r=o.iterator;for(;r.next();){const t=r.value;n.has(t)&&n.has(e)||!t.isMemberOf(e)&&t.isAvoiding&&t.invalidateRoute()}}doDropOnto(t,e){}doMouseMove(){if(!this.isActive)return;const t=this.diagram,e=t.lastInput;this.simulatedMouseMove(e.event,e.documentPoint,e.targetDiagram)||null!==this.currentPart&&null!==this.draggedParts&&(this.mayCopy()?(this.LP(!1),this.pc(this.copiedParts,!1)):this.mayMove()?(this.bl(),this.pc(this.draggedParts,!0)):this.mayDragOut()?(this.LP(!1),this.pc(this.copiedParts,!1)):this.bl(),this.TP(t.lastInput.documentPoint))}doMouseUp(){if(!this.isActive)return;const t=this.diagram,e=t.lastInput;if(this.simulatedMouseUp(e.event,e.documentPoint,e.targetDiagram))return;let i=!1;const s=this.mayCopy();if(s&&null!==this.copiedParts?(this.bl(),this.LP(!0),this.pc(this.copiedParts,!1),null!==this.copiedParts&&(t.D("ChangingSelection",t.selection),t.clearSelection(!0),this.copiedParts.iteratorKeys.each((t=>{t.isSelected=!0})))):(i=!0,this.bl(),this.mayMove()&&(this.pc(this.draggedParts,!0),this.TP(t.lastInput.documentPoint))),this.fu=!0,this.iL(t.lastInput.documentPoint),this.isActive){const e=s&&this.copiedParts,n=e?this.copiedParts?.toKeySet():this.draggedParts?this.draggedParts.toKeySet():null;this.copiedParts=null,i&&this.kF(),t.invalidateDocumentBounds(),t.MP(this.draggedParts),this.transactionResult=e?"Copy":"Move",t.D(e?"SelectionCopied":"SelectionMoved",n)}this.stopTool(),s&&t.D("ChangedSelection",t.selection)}simulatedMouseMove(t,e,i){if(null===z.dt)return!1;const s=z.dt.diagram;i instanceof vt||(i=null);const n=z.Xh;if(i!==n){if(null!==n&&n!==s){n.stopAutoScroll(),z.dt.isDragOutStarted=!1;const t=n.toolManager.findTool("Dragging");null!==t&&t.doSimulatedDragLeave()}if(z.Xh=i,null!==i&&i!==s){z.dt.ZC();const t=i.toolManager.findTool("Dragging");null!==t&&(t.eL(),t.doSimulatedDragEnter())}this.doUpdateCursor(null)}if(null===i||i===s||!i.allowDrop||i.isReadOnly||!i.allowInsert)return!1;const o=i.toolManager.findTool("Dragging");if(null!==o){let s=e;null!==t&&(void 0!==t.targetTouches&&(t.targetTouches.length>0?t=t.targetTouches[0]:t.changedTouches.length>0&&(t=t.changedTouches[0])),s=i.getMouse(t)),i.lastInput.documentPoint=s,i.lastInput.viewPoint=i.transformDocToView(s),i.lastInput.down=!1,i.lastInput.up=!1,o.doSimulatedDragOver()}return!0}simulatedMouseUp(t,e,i){if(null===z.dt)return!1;const s=z.Xh,n=z.dt.diagram;if(null===i)return z.dt.doCancel(),!0;if(i!==s){if(null!==s){const t=s.toolManager.findTool("Dragging");if(null!==s&&s!==n&&null!==t)return s.stopAutoScroll(),z.dt.isDragOutStarted=!1,t.doSimulatedDragLeave(),!1}z.Xh=i;const t=i.toolManager.findTool("Dragging");null!==t&&(z.dt.ZC(),t.eL(),t.doSimulatedDragEnter())}if(i!==this.diagram){let s=e;null!==t?(void 0!==t.targetTouches&&(t.targetTouches.length>0?t=t.targetTouches[0]:t.changedTouches.length>0&&(t=t.changedTouches[0])),s=i.getMouse(t)):null===s&&(s=new y),i.lastInput.documentPoint=s,i.lastInput.viewPoint=i.transformDocToView(s),i.lastInput.down=!1,i.lastInput.up=!0;const n=i.toolManager.findTool("Dragging");null!==n&&n.doSimulatedDrop();const o=z.dt;if(null!==o){const t=o.mayCopy();o.transactionResult=t?"Copy":"Move",o.stopTool()}return!0}return!1}kF(){if(null===this.draggedParts)return;const t=this.draggedParts.iterator;for(;t.next();){const e=t.key;if(e instanceof Ce){const t=e.containingGroup;null!==t&&t.hasPlaceholder()&&!this.draggedParts.has(t)&&t.placeholder.c()}}}mayCopy(){if(!this.isCopyEnabled)return!1;const t=this.diagram;if(t.isReadOnly||t.isModelReadOnly||!t.allowInsert||!t.allowCopy||!(e._o?t.lastInput.alt:t.lastInput.control))return!1;const i=t.selection.iterator;for(;i.next();)if(i.value.canCopy())return!0;return!(null===this.draggedLink||!this.dragsLink||!this.draggedLink.canCopy())}mayDragOut(){if(!this.isCopyEnabled)return!1;const t=this.diagram;if(!t.allowDragOut||!t.allowCopy||t.allowMove)return!1;const e=t.selection.iterator;for(;e.next();)if(e.value.canCopy())return!0;return!(null===this.draggedLink||!this.dragsLink||!this.draggedLink.canCopy())}mayMove(){const t=this.diagram;if(t.isReadOnly||!t.allowMove)return!1;const e=t.selection.iterator;for(;e.next();)if(e.value.canMove())return!0;return!(null===this.draggedLink||!this.dragsLink||!this.draggedLink.canMove())}eL(){z.Uw.has(this)||z.Uw.add(this)}static pF(){if(z.Uw.count>0){const t=z.Uw,e=t.length;for(let i=0;i<e;i++){const e=t.elt(i);e.JC(),e.bl(),e.SP(),e.diagram.stopAutoScroll()}t.clear()}}computeBorder(t,e,i){return this.fu||null===this.draggedParts||this.draggedParts.has(t)?null:i.a(e)}getDraggingSource(){return z.dt}mayDragIn(){const t=this.diagram;if(!t.allowDrop||t.isReadOnly||t.isModelReadOnly||!t.allowInsert)return!1;const e=z.dt;return!(null===e||e.diagram.model.dataFormat!==t.model.dataFormat)}doSimulatedDragEnter(){if(!this.mayDragIn())return;const t=this.diagram;t.animationManager.stopAnimation(),t.fr(),t.animationManager.stopAnimation();const e=z.dt;null!==e&&(this.diagram.du=!0,null===t.lastInput.event&&(t.lastInput.event=e.diagram.lastInput.event)),this.doUpdateCursor(null)}doSimulatedDragLeave(){const t=z.dt;null!==t&&t.doSimulatedDragOut(),this.diagram.du=!1,this.doCancel()}doSimulatedDragOver(){const t=this.diagram;t.animationManager.pu=!0;const e=z.dt;if(null!==e&&null!==e.draggedParts){if(!this.mayDragIn())return;this.sL(e.draggedParts.toKeySet(),!1,t.firstInput),this.pc(this.copiedParts,!1),this.TP(t.lastInput.documentPoint)}t.animationManager.pu=!1}doSimulatedDrop(){const t=this.diagram,e=z.dt;if(null!==e){const i=e.diagram;if(e.fu=!0,this.bl(),null===e.draggedParts||!this.mayDragIn())return;t.animationManager.pu=!0,t.D("ChangingSelection",t.selection),this.startTransaction("Drop"),this.sL(e.draggedParts.toKeySet(),!0,t.lastInput),this.pc(this.copiedParts,!1);const s=new u;null!==this.copiedParts&&(t.clearSelection(!0),this.copiedParts.iteratorKeys.each((t=>{t.isSelected=!0,s.add(t)}))),this.iL(t.lastInput.documentPoint),t.invalidateDocumentBounds(),null!==this.copiedParts&&(this.transactionResult="ExternalCopy"),this.copiedParts=null,t.doFocus(),t.du=!1,t.D("ExternalObjectsDropped",s,i),this.stopTransaction(),t.D("ChangedSelection",t.selection)}t.animationManager.pu=!1}sL(t,e,i){if(null!==this.copiedParts)return;const s=this.diagram;if(s.isReadOnly||s.isModelReadOnly)return;s.skipsUndoManager=!e,s.partManager.addsToTemporaryLayer=!e,this.startPoint=i.documentPoint;const n=s.copyParts(t,s,!0),o=x.l();this.yF(t,o);const r=o.x+o.width/2,a=o.y+o.height/2;x.e(o);const h=this.gm,l=new m,u=y.l(),c=t.iterator;for(;c.next();){const t=c.value;if(t instanceof De&&t.canCopy()){const e=n.get(t);if(null===e)continue;e.points=t.points,e.cr(h.x-r,h.y-a),e.suspendsRouting=!0,l.set(e,this.Es())}}const d=t.iterator;for(;d.next();){const t=d.value;if(t.ke()&&t.canCopy()){const e=n.get(t);if(null===e)continue;const i=t.location;u.i(h.x-(r-i.x),h.y-(a-i.y)),e.location=u,e.ensureBounds(),l.set(e,this.Es(u))}}if(y.e(u),this.copiedParts=l,this.PP(l.toKeySet()),null!==this.draggedLink){const t=this.draggedLink,e=t.routeBounds;t.cr(this.startPoint.x-(e.x+e.width/2),this.startPoint.y-(e.y+e.height/2))}this.doUpdateCursor(null)}mF(){this.isDragOutStarted=!0,this.fu=!1,z.dt=this,z.Xh=this.diagram,this.doSimulatedDragOut()}doSimulatedDragOut(){const t=this.diagram;this.mayCopy()||this.mayMove()?t.currentCursor="":t.currentCursor=this.nodropCursor,this.uu=null}computeMove(t,e,i,s){const n=this.diagram;return null!==n?n.computeMove(t,e,this.dragOptions,s):new y}static Uw=new h;static dt=null;static Xh=null}V.prototype.doCancel=function(){null!==z.dt&&z.dt.doCancel(),B.prototype.doCancel.call(this)};class j extends B{OP;IP;Pl;EP;BP;Yh;UP;Kh;VP;zP;XP;YP;KP;GP;nL;HP;Sl;jP;constructor(){super(),this.OP=100,this.IP=!1,this.Pl="pointer",this.EP=new De({layerName:"Tool"}).add(new he({isPanelMain:!0,stroke:"blue"}).theme("stroke","tempLink"),new he({toArrow:"Standard",fill:"blue",stroke:"blue"}).theme("fill","tempLink").theme("stroke","tempLink")).Et(),this.Yh=new he("Rectangle",{portId:"",fill:null,stroke:"magenta",strokeWidth:2,desiredSize:v.Ek}).theme("stroke","tempPort"),this.BP=new Ce({selectable:!1,layerName:"Tool"}).add(this.Yh).Et(),this.Kh=new he("Rectangle",{portId:"",fill:null,stroke:"magenta",strokeWidth:2,desiredSize:v.Ek}).theme("stroke","tempPort"),this.UP=new Ce({selectable:!1,layerName:"Tool"}).add(this.Kh).Et(),this.VP=null,this.zP=null,this.XP=null,this.YP=null,this.KP=null,this.GP=!0,this.nL=new m,this.HP=null,this.Sl=null,this.jP=null}doStop(){this.diagram.stopAutoScroll(),this.originalLink=null,this.originalFromNode=null,this.originalFromPort=null,this.originalToNode=null,this.originalToPort=null,this.validPortsCache.clear(),this.targetPort=null}get portGravity(){return this.OP}set portGravity(t){e.s(t,"number",j,"portGravity"),t>=0&&(this.OP=t)}get isUnconnectedLinkValid(){return this.IP}set isUnconnectedLinkValid(t){e.s(t,"boolean",j,"isUnconnectedLinkValid"),this.IP=t}get linkingCursor(){return this.Pl}set linkingCursor(t){this.Pl=t}get temporaryLink(){return this.EP}set temporaryLink(t){t.Et(),this.EP=t}get temporaryFromNode(){return this.BP}set temporaryFromNode(t){t.Et(),this.BP=t,t&&(this.Yh=t.port)}get temporaryFromPort(){return this.Yh}set temporaryFromPort(t){if(null!==this.Yh){const e=this.Yh.panel;if(null!==e){const i=e.C.indexOf(this.Yh);e.removeAt(i),e.insertAt(i,t)}}this.Yh=t}get temporaryToNode(){return this.UP}set temporaryToNode(t){t.Et(),this.UP=t,t&&(this.Kh=t.port)}get temporaryToPort(){return this.Kh}set temporaryToPort(t){if(null!==this.Kh){const e=this.Kh.panel;if(null!==e){const i=e.C.indexOf(this.Kh);e.removeAt(i),e.insertAt(i,t)}}this.Kh=t}get originalLink(){return this.VP}set originalLink(t){this.VP=t}get originalFromNode(){return this.zP}set originalFromNode(t){this.zP=t}get originalFromPort(){return this.XP}set originalFromPort(t){this.XP=t}get originalToNode(){return this.YP}set originalToNode(t){this.YP=t}get originalToPort(){return this.KP}set originalToPort(t){this.KP=t}get isForwards(){return this.GP}set isForwards(t){this.GP=t}get validPortsCache(){return this.nL}get targetPort(){return this.HP}set targetPort(t){this.HP=t}copyPortProperties(t,e,i,s,n){if(null===t||null===e||null===i||null===s)return;const o=e.getDocumentScale(),r=v.l();r.width=e.naturalBounds.width*o,r.height=e.naturalBounds.height*o,s.desiredSize=r,v.e(r),n?(s.toSpot=e.toSpot,s.toEndSegmentLength=e.toEndSegmentLength):(s.fromSpot=e.fromSpot,s.fromEndSegmentLength=e.fromEndSegmentLength),i.locationSpot=w.Center;const a=y.l();i.location=e.getDocumentPoint(w.Center,a),y.e(a),s.angle=e.getDocumentAngle(),null!==this.portTargeted&&this.portTargeted(t,e,i,s,n)}setNoTargetPortProperties(t,e,i){null!==e&&(e.desiredSize=v.Ek,e.fromSpot=w.None,e.toSpot=w.None),null!==t&&(t.location=this.diagram.lastInput.documentPoint),null!==this.portTargeted&&this.portTargeted(null,null,t,e,i)}doMouseDown(){this.isActive&&this.doMouseMove()}doMouseMove(){if(this.isActive){const t=this.diagram;if(this.targetPort=this.findTargetPort(this.isForwards),null!==this.targetPort&&this.targetPort.part instanceof Ce){const t=this.targetPort.part;this.isForwards?this.copyPortProperties(t,this.targetPort,this.temporaryToNode,this.temporaryToPort,!0):this.copyPortProperties(t,this.targetPort,this.temporaryFromNode,this.temporaryFromPort,!1)}else this.isForwards?this.setNoTargetPortProperties(this.temporaryToNode,this.temporaryToPort,!0):this.setNoTargetPortProperties(this.temporaryFromNode,this.temporaryFromPort,!1);(t.allowHorizontalScroll||t.allowVerticalScroll)&&t.doAutoScroll(t.lastInput.viewPoint)}}findValidLinkablePort(t,e){if(null===t)return null;const i=t.part;if(!(i instanceof Ce))return null;for(;null!==t;){const s=e?t.toLinkable:t.fromLinkable;if(!0===s&&(null!==t.portId||t instanceof Ce)&&(e?this.isValidTo(i,t):this.isValidFrom(i,t)))return t;if(!1===s)return null;t=t.panel}return null}findTargetPort(t){const e=this.diagram,i=e.lastInput.documentPoint;let s=this.portGravity;const n=e.findObjectsNear(i,s,(e=>this.findValidLinkablePort(e,t)),null,!0);let o=1/0,r=null;const a=n.iterator;for(;a.next();){const e=a.value,s=e.part;if(!(s instanceof Ce))continue;const n=e.getDocumentPoint(w.Center,y.l()),h=i.x-n.x,l=i.y-n.y;y.e(n);const u=h*h+l*l;if(u<o){const i=this.validPortsCache.get(e);null!==i?i&&(r=e,o=u):t&&this.isValidLink(this.originalFromNode,this.originalFromPort,s,e)||!t&&this.isValidLink(s,e,this.originalToNode,this.originalToPort)?(this.validPortsCache.set(e,!0),r=e,o=u):this.validPortsCache.set(e,!1)}}if(null!==r){const t=r.part;if(t instanceof Ce&&(null===t.layer||t.layer.allowLink))return r}return null}isValidFrom(t,e){if(null===t||null===e)return this.isUnconnectedLinkValid;if(this.diagram.currentTool===this&&(null!==t.layer&&!t.layer.allowLink||!0!==e.fromLinkable))return!1;const i=e.fromMaxLinks;if(i<1/0){if(null!==this.originalLink&&t===this.originalFromNode&&e===this.originalFromPort)return!0;let s=e.portId;if(null===s&&(s=""),t.findLinksOutOf(s).count>=i)return!1}return!0}isValidTo(t,e){if(null===t||null===e)return this.isUnconnectedLinkValid;if(this.diagram.currentTool===this&&(null!==t.layer&&!t.layer.allowLink||!0!==e.toLinkable))return!1;const i=e.toMaxLinks;if(i<1/0){if(null!==this.originalLink&&t===this.originalToNode&&e===this.originalToPort)return!0;let s=e.portId;if(null===s&&(s=""),t.findLinksInto(s).count>=i)return!1}return!0}isInSameNode(t,e){if(null===t||null===e)return!1;if(t===e)return!0;const i=t.part,s=e.part;return null!==i&&i===s}isLinked(t,e){if(null===t||null===e)return!1;const i=t.part;if(!(i instanceof Ce))return!1;let s=t.portId;null===s&&(s="");const n=e.part;if(!(n instanceof Ce))return!1;let o=e.portId;null===o&&(o="");const r=n.findLinksInto(o);for(;r.next();){const t=r.value;if(t.fromNode===i&&t.fromPortId===s)return!0}return!1}isValidLink(t,e,i,s){if(!this.isValidFrom(t,e)||!this.isValidTo(i,s)||null!==e&&null!==s&&((!e.fromLinkableSelfNode||!s.toLinkableSelfNode)&&this.isInSameNode(e,s)||(!e.fromLinkableDuplicates||!s.toLinkableDuplicates)&&this.isLinked(e,s))||null!==this.originalLink&&(null!==t&&this.isLabelDependentOnLink(t,this.originalLink)||null!==i&&this.isLabelDependentOnLink(i,this.originalLink))||null!==t&&null!==i&&(null===t.data&&null!==i.data||null!==t.data&&null===i.data)||!this.isValidCycle(t,i,this.originalLink))return!1;let n;return!(null!==t&&null!==e&&(n=t.linkValidation,null!==n&&!n(t,e,i,s,this.originalLink))||null!==i&&null!==s&&(n=i.linkValidation,null!==n&&!n(t,e,i,s,this.originalLink)))&&(n=this.linkValidation,null===n||n(t,e,i,s,this.originalLink))}isLabelDependentOnLink(t,e){if(null===t)return!1;const i=t.labeledLink;if(null===i)return!1;if(i===e)return!0;const s=new u;return s.add(t),this.qP(i,e,s)}qP(t,e,i){if(t===e)return!0;const s=t.fromNode;if(null!==s&&s.labeledLink&&(i.add(s),this.qP(s.labeledLink,e,i)))return!0;const n=t.toNode;return!(null===n||!n.labeledLink||(i.add(n),!this.qP(n.labeledLink,e,i)))}isValidCycle(t,e,i){if(void 0===i&&(i=null),null===t||null===e)return this.isUnconnectedLinkValid;const s=this.diagram;let n=1;if(s&&(n=s.model.pm()?s.isTreePathToChildren?5:6:s.validCycle),1===n)return!0;if(5===n){const s=i||this.temporaryLink;if(null!==s&&!s.isTreeLink)return!0;const n=e.linksConnected;for(;n.next();){const t=n.value;if(t!==i&&t.isTreeLink&&t.toNode===e)return!1}return!this.yu(t,e,i,!0)}if(6===n){const s=i||this.temporaryLink;if(null!==s&&!s.isTreeLink)return!0;const n=t.linksConnected;for(;n.next();){const e=n.value;if(e!==i&&e.isTreeLink&&e.fromNode===t)return!1}return!this.yu(t,e,i,!0)}return 2===n?!this.PF(t,e,i):3===n?!this.yu(t,e,i,!1):4!==n||!this.SF(t,e,i)}yu(t,e,i,s){if(t===e)return!0;if(null===t||null===e)return!1;const n=t.linksConnected;for(;n.next();){const o=n.value;if(o===i||s&&!o.isTreeLink||o.toNode!==t)continue;const r=o.fromNode;if(r!==t&&null!==r&&this.yu(r,e,i,s))return!0}return!1}PF(t,e,i){if(t===e)return!0;const s=new u;return s.add(e),this.oL(s,t,e,i)}oL(t,e,i,s){if(e===i)return!0;if(null===e||null===i||t.has(e))return!1;t.add(e);const n=e.linksConnected;for(;n.next();){const o=n.value;if(o===s||o.toNode!==e)continue;const r=o.fromNode;if(r!==e&&null!==r&&this.oL(t,r,i,s))return!0}return!1}SF(t,e,i){if(t===e)return!0;const s=new u;return s.add(e),this.rL(s,t,e,i)}rL(t,e,i,s){if(e===i)return!0;if(null===e||null===i||t.has(e))return!1;t.add(e);const n=e.linksConnected;for(;n.next();){const o=n.value;if(o===s)continue;const r=o.fromNode,a=o.toNode,h=r===e?a:r;if(h!==e&&null!==h&&this.rL(t,h,i,s))return!0}return!1}get linkValidation(){return this.Sl}set linkValidation(t){null!==t&&e.k(t,j,"linkValidation"),this.Sl=t}get portTargeted(){return this.jP}set portTargeted(t){null!==t&&e.k(t,j,"portTargeted"),this.jP=t}}var $=(t=>(t[t.Either=1]="Either",t[t.ForwardsOnly=2]="ForwardsOnly",t[t.BackwardsOnly=3]="BackwardsOnly",t))($||{});class X extends j{WP;JP;b;$P;constructor(t){super(),this.name="Linking",this.WP={},this.JP=null,this.b=1,this.$P=null,t&&Object.assign(this,t)}static Either=1;static ForwardsOnly=2;static BackwardsOnly=3;get archetypeLinkData(){return this.WP}set archetypeLinkData(t){null!==t&&e.ec(t,X,"archetypeLinkData"),this.WP=t}get archetypeLabelNodeData(){return this.JP}set archetypeLabelNodeData(t){null!==t&&e.ec(t,X,"archetypeLabelNodeData"),this.JP=t}get direction(){return this.b}set direction(t){this.b=t}get startObject(){return this.$P}set startObject(t){this.$P=t}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;return!(t.isReadOnly||t.isModelReadOnly||!t.allowLink||!t.model.Vw()||!t.lastInput.left||t.currentTool!==this&&!this.isBeyondDragSize())&&null!==this.findLinkablePort()}findLinkablePort(){const t=this.diagram;let e=this.startObject;if(null===e&&(e=t.findObjectAt(t.firstInput.documentPoint,null,null)),null===e)return null;const i=e.part;if(!(i instanceof Ce))return null;const s=this.direction;if(1===s||2===s){const t=this.findValidLinkablePort(e,!1);if(null!==t)return this.isForwards=!0,t;if(this.startObject===i){const t=i.port;if(this.findValidLinkablePort(t,!1))return this.isForwards=!0,t}}if(1===s||3===s){const t=this.findValidLinkablePort(e,!0);if(null!==t)return this.isForwards=!1,t;if(this.startObject===i){const t=i.port;if(this.findValidLinkablePort(t,!0))return this.isForwards=!1,t}}return null}doActivate(){const t=this.diagram,e=this.findLinkablePort();if(null!==e){if(this.startTransaction(this.name),t.isMouseCaptured=!0,t.currentCursor=this.linkingCursor,this.isForwards){null!==this.temporaryToNode&&(this.temporaryToNode.location=t.lastInput.documentPoint),this.originalFromPort=e;const i=this.originalFromPort.part;i instanceof Ce&&(this.originalFromNode=i),this.copyPortProperties(this.originalFromNode,this.originalFromPort,this.temporaryFromNode,this.temporaryFromPort,!1)}else{null!==this.temporaryFromNode&&(this.temporaryFromNode.location=t.lastInput.documentPoint),this.originalToPort=e;const i=this.originalToPort.part;i instanceof Ce&&(this.originalToNode=i),this.copyPortProperties(this.originalToNode,this.originalToPort,this.temporaryToNode,this.temporaryToPort,!0)}t.add(this.temporaryFromNode),this.temporaryFromNode&&this.temporaryFromNode.ensureBounds(),t.add(this.temporaryToNode),this.temporaryToNode&&this.temporaryToNode.ensureBounds(),null!==this.temporaryLink&&(null!==this.temporaryFromNode&&(this.temporaryLink.fromNode=this.temporaryFromNode),null!==this.temporaryToNode&&(this.temporaryLink.toNode=this.temporaryToNode),this.temporaryLink.isTreeLink=this.isNewTreeLink(),this.temporaryLink.invalidateRoute(),t.add(this.temporaryLink)),this.isActive=!0}else this.stopTool()}doDeactivate(){this.isActive=!1;const t=this.diagram;t.remove(this.temporaryLink),t.remove(this.temporaryFromNode),t.remove(this.temporaryToNode),t.isMouseCaptured=!1,t.currentCursor="",this.stopTransaction()}doStop(){super.doStop(),this.startObject=null}doMouseUp(){if(this.isActive){const t=this.diagram;this.transactionResult=null;let e=null,i=null,s=null,n=null,o=null;try{this.targetPort=this.findTargetPort(this.isForwards);const r=this.targetPort;if(null!==r){const t=r.part;t instanceof Ce&&(this.isForwards?(null!==this.originalFromNode&&(e=this.originalFromNode,i=this.originalFromPort),s=t,n=r):(e=t,i=r,null!==this.originalToNode&&(s=this.originalToNode,n=this.originalToPort)))}else this.isForwards?null!==this.originalFromNode&&this.isUnconnectedLinkValid&&(e=this.originalFromNode,i=this.originalFromPort):null!==this.originalToNode&&this.isUnconnectedLinkValid&&(s=this.originalToNode,n=this.originalToPort);null!==e||null!==s?(o=this.insertLink(e,i,s,n),null!==o?(null===r&&(this.isForwards?o.defaultToPoint=t.lastInput.documentPoint:o.defaultFromPoint=t.lastInput.documentPoint),t.allowSelect&&(t.D("ChangingSelection",t.selection),t.clearSelection(!0),o.isSelected=!0),this.transactionResult=this.name,t.D("LinkDrawn",o)):this.doNoLink(e,i,s,n)):this.isForwards?this.doNoLink(this.originalFromNode,this.originalFromPort,null,null):this.doNoLink(null,null,this.originalToNode,this.originalToPort)}finally{this.stopTool(),o&&t.allowSelect&&t.D("ChangedSelection",t.selection)}}}isNewTreeLink(){const t=this.archetypeLinkData;if(null===t)return!0;if(t instanceof De)return t.isTreeLink;const e=this.diagram;if(null===e)return!0;const i=e.partManager.getLinkCategoryForData(t),s=e.partManager.findLinkTemplateForCategory(i);return null===s||s.isTreeLink}insertLink(t,e,i,s){return this.diagram.partManager.insertLink(t,e,i,s)}doNoLink(t,e,i,s){}}class G extends j{lL=null;hL=null;ZP=null;QP=null;fs;_P;constructor(t){super(),this.name="Relinking",this.fromHandleArchetype=new he("Diamond",{desiredSize:v.nu,fill:"lightblue",stroke:"dodgerblue",cursor:this.linkingCursor,segmentIndex:0}).theme("fill","adornmentFill").theme("stroke","adornmentStroke"),this.toHandleArchetype=new he("Diamond",{desiredSize:v.nu,fill:"lightblue",stroke:"dodgerblue",cursor:this.linkingCursor,segmentIndex:-1}).theme("fill","adornmentFill").theme("stroke","adornmentStroke"),this.fs=null,this._P=new x,t&&Object.assign(this,t)}updateAdornments(t){if(null===t||!(t instanceof De))return;let e="RelinkFrom",i=null;if(t.isSelected&&!this.diagram.isReadOnly){const s=t.selectionObject;null!==s&&t.canRelinkFrom()&&t.actualBounds.isReal()&&t.isVisible()&&s.actualBounds.isReal()&&s.isVisibleObject()&&(i=t.findAdornment(e),null===i&&(i=this.makeAdornment(s,!1),t.addAdornment(e,i)))}if(null===i&&t.removeAdornment(e),e="RelinkTo",i=null,t.isSelected&&!this.diagram.isReadOnly){const s=t.selectionObject;null!==s&&t.canRelinkTo()&&t.actualBounds.isReal()&&t.isVisible()&&s.actualBounds.isReal()&&s.isVisibleObject()&&(i=t.findAdornment(e),null===i?(i=this.makeAdornment(s,!0),t.addAdornment(e,i)):i.c())}null===i&&t.removeAdornment(e)}makeAdornment(t,e){let i=e?this.QP:this.ZP;return i&&(i=i.copy(),i.adornedObject=t),i}get fromHandleArchetype(){return this.lL}set fromHandleArchetype(t){this.lL=t,this.ZP=null!==t?new Pe(ie.Link).add(t).Et():null}get toHandleArchetype(){return this.hL}set toHandleArchetype(t){this.hL=t,this.QP=null!==t?new Pe(ie.Link).add(t).Et():null}get handle(){return this.fs}set handle(t){null!==t&&(t.part instanceof Pe||e.o("new handle is not in an Adornment: "+t)),this.fs=t}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;if(t.isReadOnly||t.isModelReadOnly||!t.allowRelink||!t.model.Vw()||!t.lastInput.left)return!1;let e=this.findToolHandleAt(t.firstInput.documentPoint,"RelinkFrom");return null===e&&(e=this.findToolHandleAt(t.firstInput.documentPoint,"RelinkTo")),null!==e}doActivate(){const t=this.diagram;if(null===this.originalLink){let e=this.handle;if(null===e&&(e=this.findToolHandleAt(t.firstInput.documentPoint,"RelinkFrom"),null===e&&(e=this.findToolHandleAt(t.firstInput.documentPoint,"RelinkTo"))),null===e)return;const i=e.part;if(!(i instanceof Pe)||!(i.adornedPart instanceof De))return;this.handle=e,this.isForwards=null===i||"RelinkTo"===i.category,this.originalLink=i.adornedPart}const e=this.originalLink;null!==e&&(this.startTransaction(this.name),t.isMouseCaptured=!0,t.currentCursor=this.linkingCursor,this.originalFromPort=e.fromPort,this.originalFromNode=e.fromNode,this.originalToPort=e.toPort,this.originalToNode=e.toNode,this._P.set(e.actualBounds),e.pointsCount>0&&(null===e.fromNode&&(null!==this.temporaryFromPort&&(this.temporaryFromPort.desiredSize=v.sc),null!==this.temporaryFromNode&&(this.temporaryFromNode.location=e.getPoint(0))),null===e.toNode&&(null!==this.temporaryToPort&&(this.temporaryToPort.desiredSize=v.sc),null!==this.temporaryToNode&&(this.temporaryToNode.location=e.getPoint(e.pointsCount-1)))),this.copyPortProperties(this.originalFromNode,this.originalFromPort,this.temporaryFromNode,this.temporaryFromPort,!1),this.copyPortProperties(this.originalToNode,this.originalToPort,this.temporaryToNode,this.temporaryToPort,!0),t.add(this.temporaryFromNode),t.add(this.temporaryToNode),null!==this.temporaryLink&&(null!==this.temporaryFromNode&&(this.temporaryLink.fromNode=this.temporaryFromNode),null!==this.temporaryToNode&&(this.temporaryLink.toNode=this.temporaryToNode),this.copyLinkProperties(e,this.temporaryLink),this.temporaryLink.invalidateRoute(),t.add(this.temporaryLink)),this.isActive=!0)}copyLinkProperties(t,e){if(null===t||null===e)return;e.adjusting=t.adjusting,e.corner=t.corner;let i=t.curve;(11===i||10===i)&&(i=0),e.curve=i,e.curviness=t.curviness,e.isTreeLink=t.isTreeLink,e.points=t.points,e.routing=t.routing,e.smoothness=t.smoothness,e.fromSpot=t.fromSpot,e.fromEndSegmentLength=t.fromEndSegmentLength,e.fromShortLength=t.fromShortLength,e.toSpot=t.toSpot,e.toEndSegmentLength=t.toEndSegmentLength,e.toShortLength=t.toShortLength}doDeactivate(){this.isActive=!1;const t=this.diagram;t.remove(this.temporaryLink),t.remove(this.temporaryFromNode),t.remove(this.temporaryToNode),t.isMouseCaptured=!1,t.currentCursor="",this.stopTransaction()}doStop(){super.doStop(),this.handle=null}doMouseUp(){if(this.isActive){const t=this.diagram;this.transactionResult=null;let e=this.originalFromNode,i=this.originalFromPort,s=this.originalToNode,n=this.originalToPort,o=this.originalLink;try{if(this.targetPort=this.findTargetPort(this.isForwards),null!==this.targetPort){const t=this.targetPort.part;t instanceof Ce&&(this.isForwards?(s=t,n=this.targetPort):(e=t,i=this.targetPort))}else this.isUnconnectedLinkValid?this.isForwards?(s=null,n=null):(e=null,i=null):o=null;null!==o?(this.reconnectLink(o,this.isForwards?s:e,this.isForwards?n:i,this.isForwards),null===this.targetPort&&(this.isForwards?o.defaultToPoint=t.lastInput.documentPoint:o.defaultFromPoint=t.lastInput.documentPoint,o.invalidateRoute()),this.transactionResult=this.name,t.D("LinkRelinked",o,this.isForwards?this.originalToPort:this.originalFromPort)):null!==this.originalLink&&this.doNoRelink(this.originalLink,this.isForwards),null!==this.originalLink&&this.originalLink.invalidateOtherJumpOvers(this._P)}finally{this.stopTool()}}}reconnectLink(t,e,i,s){const n=null!==i&&null!==i.portId?i.portId:"";return s?(t.toNode=e,t.toPortId=n):(t.fromNode=e,t.fromPortId=n),!0}doNoRelink(t,e){}doDraggingMouseMove(t,e,i,s){null!==t?(this.copyPortProperties(t,e,this.temporaryFromNode,this.temporaryFromPort,!1),this.diagram.add(this.temporaryFromNode)):this.diagram.remove(this.temporaryFromNode),null!==i?(this.copyPortProperties(i,s,this.temporaryToNode,this.temporaryToPort,!0),this.diagram.add(this.temporaryToNode)):this.diagram.remove(this.temporaryToNode)}stopDraggingMouseMove(){this.diagram.remove(this.temporaryFromNode),this.diagram.remove(this.temporaryToNode)}}var Y=(t=>(t[t.None=0]="None",t[t.Horizontal=1]="Horizontal",t[t.Vertical=2]="Vertical",t[t.All=3]="All",t))(Y||{});class K extends B{ur;tS;iS;fs;zw;eS;ym;constructor(t){super(),this.name="LinkReshaping",this.ur=new he("Rectangle",{desiredSize:v.yC,fill:"lightblue",stroke:"dodgerblue"}).theme("fill","adornmentFill").theme("stroke","adornmentStroke"),this.tS=new he("Diamond",{desiredSize:v.nu,fill:"lightblue",stroke:"dodgerblue",cursor:"move"}).theme("fill","adornmentFill").theme("stroke","adornmentStroke"),this.iS=3,this.fs=null,this.zw=null,this.eS=new y,this.ym=new h,t&&Object.assign(this,t)}static None=0;static Horizontal=1;static Vertical=2;static All=3;getReshapingBehavior(t){return t?t.dr:0}setReshapingBehavior(t,e){t.dr=e}updateAdornments(t){if(null===t||!(t instanceof De))return;let e=null;if(t.isSelected&&!this.diagram.isReadOnly){const i=t.path;null!==i&&t.canReshape()&&t.actualBounds.isReal()&&t.isVisible()&&i.actualBounds.isReal()&&i.isVisibleObject()&&(e=t.findAdornment(this.name),(null===e||e.sS!==t.pointsCount||e.nS!==t.resegmentable)&&(e=this.makeAdornment(i),null!==e&&(e.sS=t.pointsCount,e.nS=t.resegmentable,t.addAdornment(this.name,e))))}null===e&&t.removeAdornment(this.name)}makeAdornment(t){const e=t.part,i=e.points,s=e.pointsCount,n=e.isOrthogonal;let o=null;if(null!==i&&s>1){o=new Pe,o.type=ie.Link;const i=e.firstPickIndex,s=e.lastPickIndex,r=n?1:0;if(e.resegmentable&&9!==e.computeCurve())for(let e=i+r;e<s-r;e++){const i=this.makeResegmentHandle(t,e);null!==i&&(i.segmentIndex=e,i.segmentFraction=.5,i.fromMaxLinks=999,o.add(i))}for(let a=i+1;a<s;a++){const r=this.makeHandle(t,a);if(null!==r){if(r.segmentIndex=a,a!==i)if(a===i+1&&n){const t=e.getPoint(i);let s=e.getPoint(i+1);S.f(t.x,s.x)&&S.f(t.y,s.y)?(s=e.getPoint(i-1),S.f(t.x,s.x)?(this.setReshapingBehavior(r,2),r.cursor="n-resize"):S.f(t.y,s.y)&&(this.setReshapingBehavior(r,1),r.cursor="w-resize")):S.f(t.x,s.x)?(this.setReshapingBehavior(r,2),r.cursor="n-resize"):S.f(t.y,s.y)&&(this.setReshapingBehavior(r,1),r.cursor="w-resize")}else if(a===s-1&&n){let t=e.getPoint(s-1);const i=e.getPoint(s);S.f(t.x,i.x)&&S.f(t.y,i.y)?(t=e.getPoint(s+1),S.f(t.x,i.x)?(this.setReshapingBehavior(r,2),r.cursor="n-resize"):S.f(t.y,i.y)&&(this.setReshapingBehavior(r,1),r.cursor="w-resize")):S.f(t.x,i.x)?(this.setReshapingBehavior(r,2),r.cursor="n-resize"):S.f(t.y,i.y)&&(this.setReshapingBehavior(r,1),r.cursor="w-resize")}else a===s||(this.setReshapingBehavior(r,3),r.cursor="move");o.add(r)}}o.adornedObject=t}return o}makeHandle(t,e){const i=this.handleArchetype;return null===i?null:i.copy().oS()}get handleArchetype(){return this.ur}set handleArchetype(t){this.ur=t}makeResegmentHandle(t,e){const i=this.midHandleArchetype;return null===i?null:i.copy().oS()}get midHandleArchetype(){return this.tS}set midHandleArchetype(t){this.tS=t}get handle(){return this.fs}set handle(t){null!==t&&(t.part instanceof Pe||e.o("new handle is not in an Adornment: "+t)),this.fs=t}get adornedLink(){return this.zw}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;return!(t.isReadOnly||!t.allowReshape||!t.lastInput.left)&&null!==this.findToolHandleAt(t.firstInput.documentPoint,this.name)}doActivate(){const t=this.diagram;if(null===this.handle&&(this.handle=this.findToolHandleAt(t.firstInput.documentPoint,this.name)),null===this.handle)return;const e=this.handle.part.adornedPart;if(e instanceof De){if(this.zw=e,t.isMouseCaptured=!0,this.startTransaction(this.name),e.resegmentable&&999===this.handle.fromMaxLinks){const i=e.points.copy(),s=this.getResegmentingPoint();if(i.insertAt(this.handle.segmentIndex+1,s),e.isOrthogonal&&i.insertAt(this.handle.segmentIndex+1,s),e.points=i,e.invalidateAdornments(),e.updateAdornments(),this.handle=this.findToolHandleAt(t.firstInput.documentPoint,this.name),null===this.handle)return void this.doDeactivate()}this.eS=e.getPoint(this.handle.segmentIndex),this.ym=e.points.copy(),this.isActive=!0}}doDeactivate(){this.stopTransaction(),this.handle=null,this.zw=null;const t=this.diagram;t.isMouseCaptured=!1,this.isActive=!1}stopTransaction(){const t=this.diagram,e=super.stopTransaction();return e&&null!==t.undoManager.transactionToUndo&&t.undoManager.transactionToUndo.optimize(),e}doCancel(){const t=this.adornedLink;null!==t&&(t.points=this.ym),this.stopTool()}getResegmentingPoint(){return null===this.handle?this.diagram.lastInput.documentPoint:this.handle.getDocumentPoint(w.Center)}doMouseMove(){const t=this.diagram;if(this.isActive){const e=this.computeReshape(t.lastInput.documentPoint);this.reshape(e)}}doMouseUp(){const t=this.diagram;if(this.isActive){const e=this.computeReshape(t.lastInput.documentPoint);this.reshape(e);const i=this.adornedLink;if(null!==i&&i.resegmentable&&null!==this.handle){const t=this.handle.segmentIndex,e=i.getPoint(t-1),s=i.getPoint(t),n=i.getPoint(t+1);if(i.isOrthogonal){if(t>i.firstPickIndex+1&&t<i.lastPickIndex-1){let o=i.getPoint(t-2);if(this.isWithinResegmentingDistance(e,s)&&(this.isInLineOrtho(o,e,s,n,!0)||this.isInLineOrtho(o,e,s,n,!1))){const r=i.points.copy();this.isInLineOrtho(o,e,s,n,!0)?(r.setElt(t-2,new y(o.x,(n.y+o.y)/2)),r.setElt(t+1,new y(n.x,(n.y+o.y)/2))):(r.setElt(t-2,new y((n.x+o.x)/2,o.y)),r.setElt(t+1,new y((n.x+o.x)/2,n.y))),r.removeAt(t),r.removeAt(t-1),i.points=r,i.invalidateAdornments()}else if(o=i.getPoint(t+2),this.isWithinResegmentingDistance(s,n)&&(this.isInLineOrtho(e,s,n,o,!0)||this.isInLineOrtho(e,s,n,o,!1))){const r=i.points.copy();this.isInLineOrtho(e,s,n,o,!0)?(r.setElt(t-1,new y(e.x,(e.y+o.y)/2)),r.setElt(t+2,new y(o.x,(e.y+o.y)/2))):(r.setElt(t-1,new y((e.x+o.x)/2,e.y)),r.setElt(t+2,new y((e.x+o.x)/2,o.y))),r.removeAt(t+1),r.removeAt(t),i.points=r,i.invalidateAdornments()}}}else{const o=y.l();if(S.ul(e.x,e.y,n.x,n.y,s.x,s.y,o)&&o.distanceSquaredPoint(s)<this.resegmentingDistance*this.resegmentingDistance){const e=i.points.copy();e.removeAt(t),i.points=e,i.invalidateAdornments()}y.e(o)}}t.invalidateDocumentBounds(),this.transactionResult=this.name,t.D("LinkReshaped",this.adornedLink,this.ym)}this.stopTool()}isWithinResegmentingDistance(t,e){return Math.abs(t.x-e.x)<this.resegmentingDistance&&Math.abs(t.y-e.y)<this.resegmentingDistance}isInLineOrtho(t,e,i,s,n){return n?Math.abs(t.y-e.y)<this.resegmentingDistance&&Math.abs(e.y-i.y)<this.resegmentingDistance&&Math.abs(i.y-s.y)<this.resegmentingDistance:Math.abs(t.x-e.x)<this.resegmentingDistance&&Math.abs(e.x-i.x)<this.resegmentingDistance&&Math.abs(i.x-s.x)<this.resegmentingDistance}get resegmentingDistance(){return this.iS}set resegmentingDistance(t){e.s(t,"number",K,"resegmentingDistance"),this.iS=t}reshape(t){const e=this.adornedLink;if(null===e)return;const i=this.handle;if(null===i)return;e.startRoute();let s=i.segmentIndex;const n=this.getReshapingBehavior(i);if(e.isOrthogonal)if(s===e.firstPickIndex+1){const i=e.firstPickIndex+1;2===n?(e.setPointAt(i,e.getPoint(i-1).x,t.y),e.setPointAt(i+1,e.getPoint(i+2).x,t.y)):1===n&&(e.setPointAt(i,t.x,e.getPoint(i-1).y),e.setPointAt(i+1,t.x,e.getPoint(i+2).y))}else if(s===e.lastPickIndex-1){const i=e.lastPickIndex-1;2===n?(e.setPointAt(i-1,e.getPoint(i-2).x,t.y),e.setPointAt(i,e.getPoint(i+1).x,t.y)):1===n&&(e.setPointAt(i-1,t.x,e.getPoint(i-2).y),e.setPointAt(i,t.x,e.getPoint(i+1).y))}else{let i=s;const n=e.getPoint(i),o=e.getPoint(i-1),r=e.getPoint(i+1);S.f(o.x,n.x)&&S.f(n.y,r.y)?(S.f(o.x,e.getPoint(i-2).x)&&!S.f(o.y,e.getPoint(i-2).y)?(e.insertPointAt(i,t.x,o.y),s++,i++):e.setPointAt(i-1,t.x,o.y),S.f(r.y,e.getPoint(i+2).y)&&!S.f(r.x,e.getPoint(i+2).x)?e.insertPointAt(i+1,r.x,t.y):e.setPointAt(i+1,r.x,t.y)):S.f(o.y,n.y)&&S.f(n.x,r.x)?(S.f(o.y,e.getPoint(i-2).y)&&!S.f(o.x,e.getPoint(i-2).x)?(e.insertPointAt(i,o.x,t.y),s++,i++):e.setPointAt(i-1,o.x,t.y),S.f(r.x,e.getPoint(i+2).x)&&!S.f(r.y,e.getPoint(i+2).y)?e.insertPointAt(i+1,t.x,r.y):e.setPointAt(i+1,t.x,r.y)):S.f(o.x,n.x)&&S.f(n.x,r.x)?(S.f(o.x,e.getPoint(i-2).x)&&!S.f(o.y,e.getPoint(i-2).y)?(e.insertPointAt(i,t.x,o.y),s++,i++):e.setPointAt(i-1,t.x,o.y),S.f(r.x,e.getPoint(i+2).x)&&!S.f(r.y,e.getPoint(i+2).y)?e.insertPointAt(i+1,t.x,r.y):e.setPointAt(i+1,t.x,r.y)):S.f(o.y,n.y)&&S.f(n.y,r.y)&&(S.f(o.y,e.getPoint(i-2).y)&&!S.f(o.x,e.getPoint(i-2).x)?(e.insertPointAt(i,o.x,t.y),s++,i++):e.setPointAt(i-1,o.x,t.y),S.f(r.y,e.getPoint(i+2).y)&&!S.f(r.x,e.getPoint(i+2).x)?e.insertPointAt(i+1,r.x,t.y):e.setPointAt(i+1,r.x,t.y)),e.setPointAt(s,t.x,t.y)}else{e.setPointAt(s,t.x,t.y);let i=e.fromNode,n=e.fromPort;if(null!==i){const t=i.findVisibleNode();null!==t&&t!==i&&(i=t,n=i.port)}if(1===s&&null!==n&&e.computeSpot(!0,n).isNoSpot()){const s=n.getDocumentPoint(w.Center,y.l()),o=e.getLinkPointFromPoint(i,n,s,t,!0,y.l());e.setPointAt(0,o.x,o.y),y.e(s),y.e(o)}let o=e.toNode,r=e.toPort;if(null!==o){const t=o.findVisibleNode();null!==t&&t!==o&&(o=t,r=o.port)}if(s===e.pointsCount-2&&null!==r&&e.computeSpot(!1,r).isNoSpot()){const i=r.getDocumentPoint(w.Center,y.l()),s=e.getLinkPointFromPoint(o,r,i,t,!1,y.l());e.setPointAt(e.pointsCount-1,s.x,s.y),y.e(i),y.e(s)}}e.commitRoute()}computeReshape(t){const e=this.adornedLink;if(null===e)return t;const i=this.handle;if(null===i)return t;const s=i.segmentIndex;switch(this.getReshapingBehavior(i)){case 3:return t;case 2:{const i=e.getPoint(s);return new y(i.x,t.y)}case 1:{const i=e.getPoint(s);return new y(t.x,i.y)}default:case 0:return e.getPoint(s)}}get originalPoint(){return this.eS}get originalPoints(){return this.ym}}class U extends B{gr;pr;ko;yc;rS;us;ur;fs;wm;lS;wc;Xw;Yw;Kw;constructor(t){super(),this.name="Resizing",this.gr=new v(1,1).u(),this.pr=new v(9999,9999).u(),this.ko=new v(NaN,NaN).u(),this.yc=!1,this.rS=!0,this.us=null,this.ur=new he("Rectangle",{alignmentFocus:w.Center,desiredSize:v.yC,fill:"lightblue",stroke:"dodgerblue",strokeWidth:1,cursor:"pointer"}).theme("fill","adornmentFill").theme("stroke","adornmentStroke"),this.fs=null,this.wm=new y,this.lS=new v,this.wc=new y,this.Xw=new v(0,0),this.Yw=new v(1/0,1/0),this.Kw=new v(1,1),t&&Object.assign(this,t)}updateAdornments(t){if(!(null===t||t instanceof De)){if(t.isSelected&&!this.diagram.isReadOnly){const e=t.resizeObject;let i=t.findAdornment(this.name);if(null!==e&&t.canResize()&&t.actualBounds.isReal()&&t.isVisible()&&e.actualBounds.isReal()&&e.isVisibleObject()&&((null===i||i.adornedObject!==e)&&(i=this.makeAdornment(e)),null!==i)){const s=e.getDocumentAngle();return t.Ml()&&this.updateResizeHandles(i,s),void t.addAdornment(this.name,i)}}t.removeAdornment(this.name)}}makeAdornment(t){let e=null;const i=t.part?.resizeAdornmentTemplate;if(i){if(e=i.copy(),null===e)return null}else{e=new Pe,e.type=ie.Spot,e.locationSpot=w.Center;const i=new Ve;i.isPanelMain=!0,e.add(i);let s=this.makeHandle(t,w.TopLeft);null!==s&&e.add(s),s=this.makeHandle(t,w.TopRight),null!==s&&e.add(s),s=this.makeHandle(t,w.BottomRight),null!==s&&e.add(s),s=this.makeHandle(t,w.BottomLeft),null!==s&&e.add(s),s=this.makeHandle(t,w.MiddleTop),null!==s&&e.add(s),s=this.makeHandle(t,w.MiddleRight),null!==s&&e.add(s),s=this.makeHandle(t,w.MiddleBottom),null!==s&&e.add(s),s=this.makeHandle(t,w.MiddleLeft),null!==s&&e.add(s)}return e.adornedObject=t,e}makeHandle(t,e){const i=this.handleArchetype;if(null===i)return null;const s=i.copy().oS();return s.alignment=e,s}updateResizeHandles(t,e){if(null!==t)if(!t.alignment.isDefault()&&("pointer"===t.cursor||t.cursor.indexOf("resize")>0))this.MF(t,e);else if(t instanceof ie){const i=t.elements;for(;i.next();){const t=i.value;this.updateResizeHandles(t,e)}}}MF(t,e){let i=t.alignment;i.isNoSpot()&&(i=w.Center);let s=e;if(i.x<=0)i.y<=0?s+=225:i.y>=1?s+=135:s+=180;else if(i.x>=1)i.y<=0?s+=315:i.y>=1&&(s+=45);else if(i.y<=0)s+=270;else{if(!(i.y>=1))return;s+=90}s<0?s+=360:s>=360&&(s-=360),t.cursor=s<22.5?"e-resize":s<67.5?"se-resize":s<112.5?"s-resize":s<157.5?"sw-resize":s<202.5?"w-resize":s<247.5?"nw-resize":s<292.5?"n-resize":s<337.5?"ne-resize":"e-resize"}get handleArchetype(){return this.ur}set handleArchetype(t){this.ur=t}get handle(){return this.fs}set handle(t){null!==t&&(t.part instanceof Pe||e.o("new handle is not in an Adornment: "+t)),this.fs=t}get adornedObject(){return this.us}set adornedObject(t){null!==t&&t.part instanceof Pe&&e.o("new handle must not be in an Adornment: "+t),this.us=t}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;return!(t.isReadOnly||!t.allowResize||!t.lastInput.left)&&null!==this.findToolHandleAt(t.firstInput.documentPoint,this.name)}doActivate(){const t=this.diagram;null===this.handle&&(this.handle=this.findToolHandleAt(t.firstInput.documentPoint,this.name)),null!==this.handle&&(this.adornedObject=this.handle.part.adornedObject,null!==this.adornedObject&&null!==this.adornedObject.part&&(t.isMouseCaptured=!0,t.animationManager.stopAnimation(),t.gu=!0,this.startTransaction(this.name),this.wm.set(this.adornedObject.getDocumentPoint(this.handle.alignment.opposite())),this.wc.set(this.adornedObject.part.location),this.lS.set(this.adornedObject.desiredSize),this.Kw=this.computeCellSize(),this.Xw=this.computeMinSize(),this.Yw=this.computeMaxSize(),this.isActive=!0))}doDeactivate(){const t=this.diagram;t.gu=!1,t.xl=!0,this.stopTransaction(),this.handle=null,this.us=null,t.isMouseCaptured=!1,this.isActive=!1}stopTransaction(){const t=this.diagram,e=super.stopTransaction();return e&&null!==t.undoManager.transactionToUndo&&t.undoManager.transactionToUndo.optimize(),e}doCancel(){null!==this.adornedObject&&null!==this.adornedObject.part&&(this.adornedObject.desiredSize=this.originalDesiredSize,this.adornedObject.part.location=this.originalLocation),this.stopTool()}doMouseMove(){const t=this.diagram;if(!this.isActive||null===this.adornedObject||null===this.handle)return;const e=this.Xw,i=this.Yw,s=this.Kw,n=t.lastInput.documentPoint,o=this.adornedObject.getLocalPoint(n,y.l()),r=this.computeReshape(),a=this.computeResize(o,this.handle.alignment,e,i,s,r);this.resize(a),t.maybeUpdate(),y.e(o)}doMouseUp(){const t=this.diagram;if(this.isActive&&null!==this.adornedObject&&null!==this.handle){const e=this.Xw,i=this.Yw,s=this.Kw,n=this.adornedObject.getLocalPoint(t.lastInput.documentPoint,y.l()),o=this.computeReshape(),r=this.computeResize(n,this.handle.alignment,e,i,s,o);this.resize(r),y.e(n),t.invalidateDocumentBounds(),this.transactionResult=this.name,t.D("PartResized",this.adornedObject,this.originalDesiredSize)}this.stopTool()}resize(t){const e=this.diagram,i=this.adornedObject;if(null===i)return;i.desiredSize=t.size;const s=i.part;if(null===s||null===this.handle)return;s.ensureBounds();const n=i.getDocumentPoint(this.handle.alignment.opposite());if(s instanceof _e){const t=new h;let i;t.add(s),!this.dragsMembers&&!s.hasPlaceholder()&&(i=new kt,i.dragsMembers=!1),e.moveParts(t,this.oppositePoint.copy().subtract(n),!0,i)}else s.location=s.location.copy().subtract(n).add(this.oppositePoint);e.maybeUpdate()}computeResize(t,e,i,s,n,o){if(null===this.adornedObject)return x.Fg;e.isNoSpot()&&(e=w.Center);const r=this.adornedObject.naturalBounds,a=r.x,h=r.y,l=r.x+r.width,u=r.y+r.height;let c=1;if(!o){let t=r.width,e=r.height;t<=0&&(t=1),e<=0&&(e=1),c=e/t}const d=y.l();S.Dg(t.x,t.y,a,h,n.width,n.height,d);const f=r.copy();return e.x<=0?e.y<=0?(f.x=Math.max(d.x,l-s.width),f.x=Math.min(f.x,l-i.width),f.width=Math.max(l-f.x,i.width),f.y=Math.max(d.y,u-s.height),f.y=Math.min(f.y,u-i.height),f.height=Math.max(u-f.y,i.height),o||(f.height/f.width>=1?(f.height=Math.max(Math.min(c*f.width,s.height),i.height),f.width=f.height/c):(f.width=Math.max(Math.min(f.height/c,s.width),i.width),f.height=c*f.width),f.x=l-f.width,f.y=u-f.height)):e.y>=1?(f.x=Math.max(d.x,l-s.width),f.x=Math.min(f.x,l-i.width),f.width=Math.max(l-f.x,i.width),f.height=Math.max(Math.min(d.y-h,s.height),i.height),o||(f.height/f.width>=1?(f.height=Math.max(Math.min(c*f.width,s.height),i.height),f.width=f.height/c):(f.width=Math.max(Math.min(f.height/c,s.width),i.width),f.height=c*f.width),f.x=l-f.width)):(f.x=Math.max(d.x,l-s.width),f.x=Math.min(f.x,l-i.width),f.width=l-f.x,o||(f.height=Math.max(Math.min(c*f.width,s.height),i.height),f.width=f.height/c,f.y=h+.5*(u-h-f.height))):e.x>=1?e.y<=0?(f.width=Math.max(Math.min(d.x-a,s.width),i.width),f.y=Math.max(d.y,u-s.height),f.y=Math.min(f.y,u-i.height),f.height=Math.max(u-f.y,i.height),o||(f.height/f.width>=1?(f.height=Math.max(Math.min(c*f.width,s.height),i.height),f.width=f.height/c):(f.width=Math.max(Math.min(f.height/c,s.width),i.width),f.height=c*f.width),f.y=u-f.height)):e.y>=1?(f.width=Math.max(Math.min(d.x-a,s.width),i.width),f.height=Math.max(Math.min(d.y-h,s.height),i.height),o||(f.height/f.width>=1?(f.height=Math.max(Math.min(c*f.width,s.height),i.height),f.width=f.height/c):(f.width=Math.max(Math.min(f.height/c,s.width),i.width),f.height=c*f.width))):(f.width=Math.max(Math.min(d.x-a,s.width),i.width),o||(f.height=Math.max(Math.min(c*f.width,s.height),i.height),f.width=f.height/c,f.y=h+.5*(u-h-f.height))):e.y<=0?(f.y=Math.max(d.y,u-s.height),f.y=Math.min(f.y,u-i.height),f.height=u-f.y,o||(f.width=Math.max(Math.min(f.height/c,s.width),i.width),f.height=c*f.width,f.x=a+.5*(l-a-f.width))):e.y>=1&&(f.height=Math.max(Math.min(d.y-h,s.height),i.height),o||(f.width=Math.max(Math.min(f.height/c,s.width),i.width),f.height=c*f.width,f.x=a+.5*(l-a-f.width))),y.e(d),f}computeReshape(){let t=0;return this.adornedObject instanceof he&&(t=this.adornedObject.hS()),!(6===t||this.diagram.lastInput.shift)}computeMinSize(){if(null===this.adornedObject)return v.sc;const t=this.adornedObject.minSize.copy(),e=this.minSize;return!isNaN(e.width)&&e.width>t.width&&(t.width=e.width),!isNaN(e.height)&&e.height>t.height&&(t.height=e.height),t}computeMaxSize(){if(null===this.adornedObject)return v.Bk;const t=this.adornedObject.maxSize.copy(),e=this.maxSize;return!isNaN(e.width)&&e.width<t.width&&(t.width=e.width),!isNaN(e.height)&&e.height<t.height&&(t.height=e.height),t}computeCellSize(){const t=new v(NaN,NaN),e=this.adornedObject?.part;if(e){const i=e.resizeCellSize;!isNaN(i.width)&&i.width>0&&(t.width=i.width),!isNaN(i.height)&&i.height>0&&(t.height=i.height)}let i=this.cellSize;isNaN(t.width)&&!isNaN(i.width)&&i.width>0&&(t.width=i.width),isNaN(t.height)&&!isNaN(i.height)&&i.height>0&&(t.height=i.height);const s=this.diagram;if((isNaN(t.width)||isNaN(t.height))&&s){const e=s.grid;null!==e&&e.visible&&this.isGridSnapEnabled&&(i=e.gridCellSize,isNaN(t.width)&&!isNaN(i.width)&&i.width>0&&(t.width=i.width),isNaN(t.height)&&!isNaN(i.height)&&i.height>0&&(t.height=i.height))}return(isNaN(t.width)||0===t.width||t.width===1/0)&&(t.width=1),(isNaN(t.height)||0===t.height||t.height===1/0)&&(t.height=1),t}get minSize(){return this.gr}set minSize(t){if(!this.gr.equals(t)){let e=t.width;isNaN(e)&&(e=0);let i=t.height;isNaN(i)&&(i=0),this.gr.i(e,i)}}get maxSize(){return this.pr}set maxSize(t){if(!this.pr.equals(t)){let e=t.width;isNaN(e)&&(e=1/0);let i=t.height;isNaN(i)&&(i=1/0),this.pr.i(e,i)}}get cellSize(){return this.ko}set cellSize(t){this.ko.equals(t)||this.ko.a(t)}get isGridSnapEnabled(){return this.yc}set isGridSnapEnabled(t){e.s(t,"boolean",U,"isGridSnapEnabled"),this.yc=t}get dragsMembers(){return this.rS}set dragsMembers(t){e.s(t,"boolean",U,"dragsMembers"),this.rS=t}get oppositePoint(){return this.wm}set oppositePoint(t){this.wm.equals(t)||this.wm.a(t)}get originalDesiredSize(){return this.lS}get originalLocation(){return this.wc}}class H extends B{aS;cS;us=null;ur=null;Gw=null;fs=null;fS;xm;wc;uS;dS;constructor(t){super(),this.name="Rotating",this.aS=45,this.cS=2,this.wc=new y,this.us=null,this.handleArchetype=new he("Ellipse",{desiredSize:v.nu,fill:"lightblue",stroke:"dodgerblue",strokeWidth:1,cursor:"pointer"}).theme("fill","adornmentFill").theme("stroke","adornmentStroke"),this.fs=null,this.fS=0,this.xm=new y(NaN,NaN),this.uS=0,this.dS=50,t&&Object.assign(this,t)}updateAdornments(t){if(null!==t){if(t.Nl()){const e=t.rotateObject;if(e===t||e===t.path||e.isPanelMain)return}if(t.isSelected&&!this.diagram.isReadOnly){const e=t.rotateObject;if(null!==e&&t.canRotate()&&t.actualBounds.isReal()&&t.isVisible()&&e.actualBounds.isReal()&&e.isVisibleObject()){let i=t.findAdornment(this.name);if((null===i||i.adornedObject!==e)&&(i=this.makeAdornment(e)),null!==i)return i.angle=e.getDocumentAngle(),i.hasPlaceholder()||(i.location=this.computeAdornmentLocation(e)),void t.addAdornment(this.name,i)}}t.removeAdornment(this.name)}}makeAdornment(t){let e=null;const i=t.part?.rotateAdornmentTemplate;return i?e=i.copy():null!==this.Gw&&(e=this.Gw.copy()),null===e?null:(e.adornedObject=t,e)}get handleArchetype(){return this.ur}set handleArchetype(t){this.ur=t,this.Gw=null!==t?new Pe(ie.Position,{locationSpot:w.Center}).add(t).Et():null}get handle(){return this.fs}set handle(t){null!==t&&(t.part instanceof Pe||e.o("new handle is not in an Adornment: "+t)),this.fs=t}get adornedObject(){return this.us}set adornedObject(t){null!==t&&t.part instanceof Pe&&e.o("new handle must not be in an Adornment: "+t),this.us=t}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;return!(t.isReadOnly||!t.allowRotate||!t.lastInput.left)&&null!==this.findToolHandleAt(t.firstInput.documentPoint,this.name)}doActivate(){const t=this.diagram;if(null===this.adornedObject){if(null===this.handle&&(this.handle=this.findToolHandleAt(t.firstInput.documentPoint,this.name)),null===this.handle)return;this.adornedObject=this.handle.part.adornedObject}null===this.adornedObject||null===this.adornedObject.part||(t.isMouseCaptured=!0,t.delaysLayout=!0,this.startTransaction(this.name),this.fS=this.adornedObject.angle,this.xm=this.computeRotationPoint(this.adornedObject),this.wc=this.adornedObject.part.location.copy(),this.isActive=!0)}computeRotationPoint(t){const e=t.part;if(null!==e){const i=e.locationObject;if(e.rotationSpot.isSpot())return t.getDocumentPoint(e.rotationSpot);if(t===e||t===i)return i.getDocumentPoint(e.locationSpot)}return t.getDocumentPoint(w.Center)}computeAdornmentLocation(t){let e=this.rotationPoint;e.isReal()||(e=this.computeRotationPoint(t));const i=t.getLocalPoint(e);let s=this.handleAngle;s<0?s+=360:s>=360&&(s-=360),s=Math.round(45*Math.round(s/45));const n=this.handleDistance;return 0===s?i.x=t.naturalBounds.width+n:45===s?(i.x=t.naturalBounds.width+n,i.y=t.naturalBounds.height+n):90===s?i.y=t.naturalBounds.height+n:135===s?(i.x=-n,i.y=t.naturalBounds.height+n):180===s?i.x=-n:225===s?(i.x=-n,i.y=-n):270===s?i.y=-n:315===s&&(i.x=t.naturalBounds.width+n,i.y=-n),t.getDocumentPoint(i)}doDeactivate(){const t=this.diagram;this.stopTransaction(),this.handle=null,this.us=null,this.xm=new y(NaN,NaN),t.isMouseCaptured=!1,this.isActive=!1}stopTransaction(){const t=this.diagram,e=super.stopTransaction();return e&&null!==t.undoManager.transactionToUndo&&t.undoManager.transactionToUndo.optimize(),e}doCancel(){const t=this.diagram;t.delaysLayout=!1,this.rotate(this.originalAngle),this.stopTool()}doMouseMove(){const t=this.diagram;if(this.isActive){const e=this.computeRotate(t.lastInput.documentPoint);this.rotate(e)}}doMouseUp(){const t=this.diagram;if(this.isActive){t.delaysLayout=!1;const e=this.computeRotate(t.lastInput.documentPoint);this.rotate(e),t.invalidateDocumentBounds(),this.transactionResult=this.name,t.D("PartRotated",this.adornedObject,this.originalAngle)}this.stopTool()}rotate(t){const e=this.adornedObject;if(null===e||null===e.part)return;e.angle=t;const i=e.part;i.ensureBounds();const s=i.locationObject,n=i.rotateObject;if(s===n||s.isContainedBy(n)){const e=this.wc.copy();i.location=e.subtract(this.rotationPoint).rotate(t-this.originalAngle).add(this.rotationPoint)}this.diagram.maybeUpdate()}computeRotate(t){let e=this.rotationPoint.directionPoint(t)-this.handleAngle;const i=this.adornedObject?.panel;i&&(e-=i.getDocumentAngle()),e>=360?e-=360:e<0&&(e+=360);const s=Math.min(Math.abs(this.snapAngleMultiple),180),n=Math.min(Math.abs(this.snapAngleEpsilon),s/2);return!this.diagram.lastInput.shift&&s>0&&n>0&&(e%s<n?e=Math.floor(e/s)*s:e%s>s-n&&(e=(Math.floor(e/s)+1)*s)),e>=360?e-=360:e<0&&(e+=360),e}get snapAngleMultiple(){return this.aS}set snapAngleMultiple(t){e.s(t,"number",H,"snapAngleMultiple"),this.aS=t}get snapAngleEpsilon(){return this.cS}set snapAngleEpsilon(t){e.s(t,"number",H,"snapAngleEpsilon"),this.cS=t}get originalAngle(){return this.fS}get rotationPoint(){return this.xm}set rotationPoint(t){this.xm=t.copy()}get handleAngle(){return this.uS}set handleAngle(t){e.s(t,"number",H,"handleAngle"),this.uS=t}get handleDistance(){return this.dS}set handleDistance(t){e.s(t,"number",H,"handleDistance"),this.dS=t}}class q extends B{constructor(t){super(),this.name="ClickSelecting",t&&Object.assign(this,t)}canStart(){return!(!this.isEnabled||this.isBeyondDragSize())}doMouseUp(){this.isActive&&(this.standardMouseSelect(),this.standardMouseClick()||this.diagram.lastInput.isTouchEvent&&this.diagram.toolManager.doToolTip()),this.stopTool()}}class W extends B{xc;constructor(t){super(),this.name="Action",this.xc=null,t&&Object.assign(this,t)}canStart(){if(!this.isEnabled)return!1;const t=this.diagram,e=t.lastInput,i=t.findObjectAt(e.documentPoint,(t=>{for(;null!==t.panel;){if(t.isActionable)return t;t=t.panel}return t}));return!(null===i||!i.isActionable)&&(this.xc=i,t.gc=t.findObjectAt(e.documentPoint,null,null),!0)}doMouseDown(){if(this.isActive){const t=this.diagram.lastInput,e=this.xc;if(null===e)return;t.targetObject=e,null!==e.actionDown&&e.actionDown(t,e)}else this.canStart()&&this.doActivate()}doMouseMove(){if(this.isActive){const t=this.diagram.lastInput,e=this.xc;if(null===e)return;t.targetObject=e,null!==e.actionMove&&e.actionMove(t,e)}}doMouseUp(){if(this.isActive){const t=this.diagram.lastInput,e=this.xc;if(null===e)return;t.targetObject=e,null!==e.actionUp&&e.actionUp(t,e),this.standardMouseClick((t=>{for(;null!==t.panel;){if(t.isActionable&&t===e)return t;t=t.panel}return t}),(t=>t===e))}this.stopTool()}doCancel(){const t=this.diagram.lastInput,e=this.xc;null!==e&&(t.targetObject=e,null!==e.actionCancel&&e.actionCancel(t,e),this.stopTool())}doStop(){this.xc=null}}class Z extends B{Cl;gS;yc;mS;constructor(t){super(),this.name="ClickCreating",this.Cl=null,this.gS=!0,this.yc=!1,this.mS=new y(0,0),t&&Object.assign(this,t)}canStart(){if(!this.isEnabled||null===this.archetypeNodeData)return!1;const t=this.diagram;if(t.isReadOnly||t.isModelReadOnly||!t.allowInsert||!t.lastInput.left||this.isBeyondDragSize())return!1;if(this.isDoubleClick){if(1===t.lastInput.clickCount&&(this.mS=t.lastInput.viewPoint.copy()),2!==t.lastInput.clickCount||this.isBeyondDragSize(this.mS))return!1}else if(1!==t.lastInput.clickCount)return!1;return!(t.currentTool!==this&&null!==t.findPartAt(t.lastInput.documentPoint,!0))}doMouseUp(){const t=this.diagram;this.isActive&&this.insertPart(t.lastInput.documentPoint),this.stopTool()}insertPart(t){const i=this.diagram,s=this.archetypeNodeData;if(null===s)return null;let n=null;try{if(i.D("ChangingSelection",i.selection),this.startTransaction(this.name),s instanceof ke)s.ke()&&(s.Et(),n=s.copy(),null!==n&&i.add(n));else if(null!==s){const t=i.model.copyNodeData(s);e.K(t)&&(i.model.addNodeData(t),n=i.findPartForData(t))}if(null!==n){const e=y.V(t.x,t.y);this.isGridSnapEnabled&&this.diagram.pS(n,t,e),n.location=e,i.allowSelect&&(i.clearSelection(!0),n.isSelected=!0),y.e(e)}i.invalidateDocumentBounds(),this.transactionResult=this.name,i.D("PartCreated",n)}finally{this.stopTransaction(),i.D("ChangedSelection",i.selection)}return n}get archetypeNodeData(){return this.Cl}set archetypeNodeData(t){null!==t&&e.ec(t,Z,"archetypeNodeData"),this.Cl=t}get isDoubleClick(){return this.gS}set isDoubleClick(t){e.s(t,"boolean",Z,"isDoubleClick"),this.gS=t}get isGridSnapEnabled(){return this.yc}set isGridSnapEnabled(t){e.s(t,"boolean",Z,"isGridSnapEnabled"),this.yc=t}}class J extends B{zh;yS;Ll;constructor(t){super(),this.name="DragSelecting",this.zh=175,this.yS=!1,this.Ll=new ke({layerName:"Tool",selectable:!1}).add(new he("Rectangle",{name:"SHAPE",fill:null,stroke:"magenta"}).theme("stroke","dragSelect")).Et(),t&&Object.assign(this,t)}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;if(!t.allowSelect)return!1;const e=t.lastInput;return!(!e.left||t.currentTool!==this&&(!this.isBeyondDragSize()||e.timestamp-t.firstInput.timestamp<this.delay||null!==t.findPartAt(e.documentPoint,!0)))}doActivate(){const t=this.diagram;this.isActive=!0,t.isMouseCaptured=!0,t.skipsUndoManager=!0,this.box&&t.add(this.box),this.doMouseMove()}doDeactivate(){const t=this.diagram;t.stopAutoScroll(),this.box&&t.remove(this.box),t.skipsUndoManager=!1,t.isMouseCaptured=!1,this.isActive=!1}doMouseMove(){const t=this.diagram;if(this.isActive&&null!==this.box){const e=this.computeBoxBounds();let i=this.box.findObject("SHAPE");null===i&&(i=this.box.findMainElement());const s=v.l().i(e.width,e.height);null!==i&&(i.desiredSize=s),this.box.bc(e.x,e.y,!1),v.e(s),(t.allowHorizontalScroll||t.allowVerticalScroll)&&t.doAutoScroll(t.lastInput.viewPoint)}}doMouseUp(){if(this.isActive){const t=this.diagram;this.box&&t.remove(this.box);try{t.currentCursor="wait",t.D("ChangingSelection",t.selection),this.selectInRect(this.computeBoxBounds()),t.D("ChangedSelection",t.selection)}finally{t.currentCursor=""}}this.stopTool()}computeBoxBounds(){const t=this.diagram;return new x(t.firstInput.documentPoint,t.lastInput.documentPoint)}selectInRect(t){const i=this.diagram,s=i.lastInput,n=i.findPartsIn(t,this.isPartialInclusion);if(e._o?s.meta:s.control)if(s.shift){const t=n.iterator;for(;t.next();){const e=t.value;e.isSelected&&(e.isSelected=!1)}}else{const t=n.iterator;for(;t.next();){const e=t.value;e.isSelected=!e.isSelected}}else if(s.shift){const t=n.iterator;for(;t.next();){const e=t.value;e.isSelected||(e.isSelected=!0)}}else{const t=new h,e=i.selection.iterator;for(;e.next();){const i=e.value;n.has(i)||t.add(i)}const s=t.iterator;for(;s.next();){const t=s.value;t.isSelected=!1}const o=n.iterator;for(;o.next();){const t=o.value;t.isSelected||(t.isSelected=!0)}}}get delay(){return this.zh}set delay(t){e.s(t,"number",J,"delay"),this.zh=t}get isPartialInclusion(){return this.yS}set isPartialInclusion(t){e.s(t,"boolean",J,"isPartialInclusion"),this.yS=t}get box(){return this.Ll}set box(t){null!==t&&t.Et(),this.Ll=t}}class Q extends B{Hw;aL;bo;wS;constructor(e){super(),this.name="Panning",this.Hw=new y,this.aL=new y,this.bo=!1;const i=this;this.wS=()=>{const e=i.diagram;null!==e&&e.Pi(t.document,"scroll",i.wS,!1),i.stopTool()},e&&Object.assign(this,e)}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;return!(!t.allowHorizontalScroll&&!t.allowVerticalScroll||!t.lastInput.left||t.currentTool!==this&&!this.isBeyondDragSize())}doActivate(){const e=this.diagram;this.bo?(e.lastInput.bubbles=!0,e.Bt(t.document,"scroll",this.wS,!1)):(e.currentCursor="move",e.isMouseCaptured=!0,this.Hw.a(e.position)),this.isActive=!0}doDeactivate(){const t=this.diagram;t.currentCursor="",t.isMouseCaptured=!1,this.isActive=!1}doCancel(){const t=this.diagram;t.position=this.Hw,t.isMouseCaptured=!1,this.stopTool()}doMouseMove(){this.cL()}doMouseUp(){this.cL(),this.stopTool()}cL(){const t=this.diagram;if(this.isActive&&t){if(this.bo)return void(t.lastInput.bubbles=!0);const e=t.position,i=t.firstInput.documentPoint,s=t.lastInput.documentPoint;let n=e.x+i.x-s.x,o=e.y+i.y-s.y;t.allowHorizontalScroll||(n=e.x),t.allowVerticalScroll||(o=e.y),t.position=this.aL.i(n,o)}}get bubbles(){return this.bo}set bubbles(t){e.s(t,"boolean",Q,"bubbles"),this.bo=t}get originalPosition(){return this.Hw}}class tt{jw;qw;xS;bS;constructor(t){this.jw=null,this.qw=null,this.xS=null,this.bS=null,t&&Object.assign(this,t)}get mainElement(){return this.xS}set mainElement(t){this.xS=t}get show(){return this.jw}set show(t){this.jw!==t&&(null!==t&&e.k(t,tt,"show"),this.jw=t)}get hide(){return this.qw}set hide(t){this.qw!==t&&(null!==t&&e.k(t,tt,"hide"),this.qw=t)}get valueFunction(){return this.bS}set valueFunction(t){this.bS=t}}class et{ri;Ww;kc;constructor(t,e,i){this.ri=t,this.Ww=e,this.kc=i}}class it extends B{kS;Jw;PS;SS;$w;Zw;bm;constructor(t){super(),this.name="ContextMenu",this.kS=null,this.Jw=null,this.PS=null,this.SS=new y,this.$w=null,this.bm=!1;const e=this;this.Zw=()=>e.stopTool(),t&&Object.assign(this,t)}NF(){const i=new tt;i.show=(t,e,i)=>i.showDefaultContextMenu(),i.hide=(t,e)=>e.hideDefaultContextMenu(),it.wu=i;const s=this;this.Zw=()=>s.stopTool();const n=e.hs("div"),o=e.hs("div");n.style.cssText="top: 0px;z-index:10002;position: fixed;display: none;text-align: center;left: 25%;width: 50%;background-color: #F5F5F5;padding: 16px;border: 16px solid #444;border-radius: 10px;margin-top: 10px",o.style.cssText="z-index:10001;position: fixed;display: none;top: 0;left: 0;width: 100%;height: 100%;background-color: black;opacity: 0.8;";const r=e.hs("style");t.document.getElementsByTagName("head")[0].appendChild(r),r.sheet.insertRule(".goCXul { list-style: none; }",0),r.sheet.insertRule(".goCXli {font:700 1.5em Helvetica, Arial, sans-serif;position: relative;min-width: 60px; }",0),r.sheet.insertRule(".goCXa {color: #444;display: inline-block;padding: 4px;text-decoration: none;margin: 2px;border: 1px solid gray;border-radius: 10px; }",0);const a=this.diagram;null!==a&&(a.Bt(n,"contextmenu",it.Gh,!1),a.Bt(n,"selectstart",it.Gh,!1),a.Bt(o,"contextmenu",it.Gh,!1)),n.className="goCXforeground",o.className="goCXbackground",t.document.body&&(t.document.body.appendChild(n),t.document.body.appendChild(o)),it.km=n,it.Pm=o,it.MS=!0}static wu=null;static MS=!1;static Pm;static km;static Gh(t){return t.preventDefault(),!1}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;return!(this.isBeyondDragSize()||!t.lastInput.right||t.lastInput.clickCount>1)&&!!(t.lastInput.isTouchEvent&&null!==this.defaultTouchContextMenu||null!==this.findObjectWithContextMenu())}doStart(){const t=this.diagram;this.SS.set(t.firstInput.documentPoint)}doStop(){this.hideContextMenu(),this.currentObject=null,this.bm=!1}findObjectWithContextMenu(t){void 0===t&&(t=null);const e=this.diagram,i=e.lastInput;let s=null;if(t instanceof vt||(s=t instanceof Tt?t:e.findObjectAt(i.documentPoint,null,(t=>!t.layer?.isTemporary))),null!==s){let t=s;for(;null!==t;){if(null!==t.contextMenu)return t;t=t.panel}if(e.lastInput.isTouchEvent&&this.defaultTouchContextMenu)return s.part}else if(null!==e.contextMenu)return e;return null}doActivate(){}doMouseDown(){if(super.doMouseDown(),this.isActive&&this.currentContextMenu instanceof Pe){const t=this.diagram.toolManager.findTool("Action");null!==t&&t.canStart()&&(t.doActivate(),t.doMouseDown(),t.doDeactivate())}this.diagram.toolManager.mouseDownTools.has(this)&&this.doContextClick()}doMouseUp(){if(this.isActive&&this.currentContextMenu instanceof Pe){const t=this.diagram.toolManager.findTool("Action");null!==t&&t.canStart()&&(t.doActivate(),t.doCancel(),t.doDeactivate())}this.doContextClick()}doContextClick(){const t=this.diagram;if(this.isActive){const e=this.currentContextMenu;if(null===e)return;let i=null;e instanceof tt||(i=t.findObjectAt(t.lastInput.documentPoint,null,null),null!==i&&i.isContainedBy(e)&&this.standardMouseClick(null,null)),this.maybeStopTool(i)}else this.canStart()&&(this.openMenu(!0),this.isActive||this.stopTool())}maybeStopTool(t){this.stopTool(),this.canStart()&&(this.diagram.currentTool=this,this.doMouseUp())}openMenu(t,e){if(void 0===e&&(e=null),this.bm)return;this.bm=!0,t&&this.standardMouseSelect();const i=this.standardMouseClick();if(this.bm=!1,!i){this.isActive=!0;const t=it.wu;if(null===e&&(e=this.findObjectWithContextMenu()),null!==e){const i=e.contextMenu;null!==i?(this.currentObject=e instanceof Tt?e:null,this.showContextMenu(i,this.currentObject)):null!==t&&this.showContextMenu(t,this.currentObject)}else null!==t&&this.showContextMenu(t,null);this.currentContextMenu instanceof Pe&&!this.currentContextMenu.visible&&this.stopTool()}}doMouseMove(){const t=this.diagram.toolManager.findTool("Action");null!==t&&t.doMouseMove(),this.isActive&&this.diagram.toolManager.doMouseMove()}showContextMenu(t,e){const i=this.diagram;if(t!==this.currentContextMenu&&this.hideContextMenu(),t instanceof Pe){const s=t;s.layerName="Tool",s.selectable=!1,s.scale=1/i.scale,s.category=this.name,s.hasPlaceholder()&&(s.placeholder.scale=i.scale);const n=s.diagram;null!==n&&n!==i&&n.remove(s),i.add(s),null!==e?s.adornedObject=e:s.data=i.model,s.ensureBounds(),this.positionContextMenu(s,e)}else t instanceof tt&&null!==t.show&&t.show(e,i,this);this.currentContextMenu=t}positionContextMenu(t,e){if(t.hasPlaceholder())return;const i=t,s=this.diagram,n=s.lastInput.documentPoint.copy(),o=i.measuredBounds,r=s.viewportBounds;s.lastInput.isTouchEvent&&(n.x-=o.width),n.x+o.width>r.right&&(n.x-=o.width+5/s.scale),n.x<r.x&&(n.x=r.x),n.y+o.height>r.bottom&&(n.y-=o.height+5/s.scale),n.y<r.y&&(n.y=r.y),i.position=n}hideContextMenu(){const t=this.diagram,e=this.currentContextMenu;null!==e&&(e instanceof Pe?(t.remove(e),null!==this.Jw&&this.Jw.removeAdornment(e.category),e.data=null,e.adornedObject=null):e instanceof tt&&(null!==e.hide?e.hide(t,this):null!==e.mainElement&&(e.mainElement.style.display="none")),this.currentContextMenu=null,this.standardMouseOver())}CF(){const t=this,e=new h;return e.add(new et("Copy",(t=>t.commandHandler.copySelection()),(t=>t.commandHandler.canCopySelection()))),e.add(new et("Cut",(t=>t.commandHandler.cutSelection()),(t=>t.commandHandler.canCutSelection()))),e.add(new et("Delete",(t=>t.commandHandler.deleteSelection()),(t=>t.commandHandler.canDeleteSelection()))),e.add(new et("Paste",(e=>e.commandHandler.pasteSelection(t.mouseDownPoint)),(e=>e.commandHandler.canPasteSelection(t.mouseDownPoint)))),e.add(new et("Select All",(t=>t.commandHandler.selectAll()),(t=>t.commandHandler.canSelectAll()))),e.add(new et("Undo",(t=>t.commandHandler.undo()),(t=>t.commandHandler.canUndo()))),e.add(new et("Redo",(t=>t.commandHandler.redo()),(t=>t.commandHandler.canRedo()))),e.add(new et("Scroll To Part",(t=>t.commandHandler.scrollToPart()),(t=>t.commandHandler.canScrollToPart()))),e.add(new et("Zoom To Fit",(t=>t.commandHandler.zoomToFit()),(t=>t.commandHandler.canZoomToFit()))),e.add(new et("Reset Zoom",(t=>t.commandHandler.resetZoom()),(t=>t.commandHandler.canResetZoom()))),e.add(new et("Group Selection",(t=>t.commandHandler.groupSelection()),(t=>t.commandHandler.canGroupSelection()))),e.add(new et("Ungroup Selection",(t=>t.commandHandler.ungroupSelection()),(t=>t.commandHandler.canUngroupSelection()))),e.add(new et("Edit Text",(t=>t.commandHandler.editTextBlock()),(t=>t.commandHandler.canEditTextBlock()))),e}showDefaultContextMenu(){const t=this.diagram;null===this.$w&&(this.$w=this.CF()),it.km.innerHTML="",it.Pm.addEventListener("pointerdown",this.Zw,!1);const i=this,s=e.hs("ul");s.className="goCXul",it.km.appendChild(s),s.innerHTML="";const n=this.$w.iterator;for(;n.next();){const o=n.value,r=o.Ww,a=o.kc;if(!e.it(r)||e.it(a)&&!a(t))continue;const h=e.hs("li");h.className="goCXli";const l=e.hs("a");l.className="goCXa",l.href="#",l.Ww=r,l.addEventListener("pointerdown",(function(e){return this.Ww(t),i.stopTool(),e.preventDefault(),!1}),!1),l.textContent=o.ri,h.appendChild(l),s.appendChild(h)}it.km.style.display="block",it.Pm.style.display="block"}hideDefaultContextMenu(){if(null===this.currentContextMenu||this.currentContextMenu!==it.wu)return;it.km.style.display="none",it.Pm.style.display="none";const t=this.diagram;null!==t&&t.Pi(it.Pm,"pointerdown",this.Zw,!1),this.currentContextMenu=null}get currentContextMenu(){return this.kS}set currentContextMenu(t){this.kS=t,this.Jw=t instanceof Pe?t.adornedPart:null}get defaultTouchContextMenu(){return!1===it.MS&&null===it.wu&&vt.isUsingDOM()&&this.NF(),it.wu}set defaultTouchContextMenu(t){null===t&&(it.MS=!0),it.wu=t}get currentObject(){return this.PS}set currentObject(t){this.PS=t}get mouseDownPoint(){return this.SS}}var st=(t=>(t[t.LostFocus=1]="LostFocus",t[t.MouseDown=2]="MouseDown",t[t.Tab=3]="Tab",t[t.Enter=4]="Enter",t))(st||{}),nt=(t=>(t[t.SingleClick=1]="SingleClick",t[t.SingleClickSelected=2]="SingleClickSelected",t[t.DoubleClick=3]="DoubleClick",t))(nt||{}),ot=(t=>(t[t.None=1]="None",t[t.Active=2]="Active",t[t.Editing=3]="Editing",t[t.Validating=4]="Validating",t[t.Invalid=5]="Invalid",t[t.Validated=6]="Validated",t))(ot||{});class rt extends B{Pe;NS;CS;Al;Kt;LS;AS;TS;Qw;DS;constructor(t){super(),this.name="TextEditing",this.Pe=new fe,this.NS=null,this.CS=2,this.Al=null,this.Kt=1,this.LS=1,this.AS=!0,this.TS=null,this.Qw=new tt,this.LF(this.Qw),t&&Object.assign(this,t)}static LostFocus=1;static MouseDown=2;static Tab=3;static Enter=4;static SingleClick=1;static SingleClickSelected=2;static DoubleClick=3;static StateNone=1;static StateActive=2;static StateEditing=3;static StateValidating=4;static StateInvalid=5;static StateValidated=6;LF(t){if(!vt.isUsingDOM())return;const i=e.hs("textarea");this.DS=i;const s=this;i.addEventListener("input",(function(t){if(null===s.textBlock)return;const e=s.measureTemporaryTextBlock(this.value),i=this.textScale;this.style.width=20+Math.max(s.textBlock.measuredBounds.width,e.measuredBounds.width)*i+"px",this.rows=Math.max(s.textBlock.lineCount,e.lineCount)}),!1),i.addEventListener("keydown",(function(t){if(t.isComposing||null===s.textBlock)return;const e=t.key;return"Enter"===e?(!1===s.textBlock.isMultiline&&t.preventDefault(),void s.acceptText(4)):"Tab"===e?(s.acceptText(3),void t.preventDefault()):void("Escape"===e&&(s.doCancel(),null!==s.diagram&&s.diagram.doFocus()))}),!1),i.addEventListener("focus",(function(t){s.AF(t)}),!1),i.addEventListener("blur",(function(t){s.TF(t)}),!1),t.valueFunction=()=>i.value,t.mainElement=i,t.show=(t,e,s)=>{if(!(t instanceof fe)||!e||!e.div||!(s instanceof rt))return;if(5===s.state)return i.style.border="3px solid red",void i.focus();const n=t.getDocumentPoint(w.Center),o=e.position,r=e.scale;let a=t.getDocumentScale()*r;a<s.minimumEditorScale&&(a=s.minimumEditorScale);const h=t.naturalBounds.width*a+6,l=t.naturalBounds.height*a+2,u=(n.x-o.x)*r,c=(n.y-o.y)*r,d=t.verticalAlignment,f=(t.lineHeight+t.spacingAbove+t.spacingBelow)*t.lineCount*a,g=.5*l-.5*f,p=d.y*l-d.y*f+d.offsetY-g-f/2;i.value=t.text,e.div.style.font=t.font;const m=1;i.style.position="absolute",i.style.zIndex="100",i.style.font="inherit",i.style.fontSize=100*a+"%",i.style.lineHeight="normal",i.style.width=h+"px",i.style.left=(u-h/2|0)-m+"px",i.style.top=(c+p|0)-m+"px",i.style.textAlign=t.textAlign,i.style.margin="0",i.style.padding=m+"px",i.style.border="0",i.style.outline="none",i.style.whiteSpace="pre-wrap",i.style.overflow="hidden",i.rows=t.lineCount,i.textScale=a,i.className="goTXarea",e.div.appendChild(i),i.focus(),s.selectsTextOnActivate&&(i.select(),i.setSelectionRange(0,9999))},t.hide=(t,e)=>{t.div&&t.div.removeChild(i)}}get textBlock(){return this.NS}set textBlock(t){this.NS=t}get currentTextEditor(){return this.TS}set currentTextEditor(t){this.TS=t}get defaultTextEditor(){return this.Qw}set defaultTextEditor(t){this.Qw=t}get starting(){return this.CS}set starting(t){this.CS=t}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;if(null===t||t.isReadOnly||rt.Pc&&rt.Pc!==this&&(rt.Pc.acceptText(2),rt.Pc&&rt.Pc!==this)||!t.lastInput.left||this.isBeyondDragSize())return!1;const e=t.lastInput.documentPoint,i=t.findObjectAt(e);if(null===i||!(i instanceof fe)||!i.editable||null===i.part||!i.part.canEdit())return!1;const s=i.part;return!(null===s||2===this.starting&&!s.isSelected||3===this.starting&&t.lastInput.clickCount<2)}doStart(){rt.Pc=this,null!==this.textBlock&&this.doActivate()}doActivate(){if(this.isActive)return;const t=this.diagram;if(null===t)return;let e=this.textBlock;if(null===e&&(e=t.findObjectAt(t.lastInput.documentPoint)),null===e||!(e instanceof fe)||(this.textBlock=e,null===e.part))return;t.animationManager.stopAnimation(),this.isActive=!0,this.Kt=2;let i=this.defaultTextEditor;null!==e.textEditor&&(i=e.textEditor),this.Pe=this.textBlock.copy();const s=new x(this.textBlock.getDocumentPoint(w.TopLeft),this.textBlock.getDocumentPoint(w.BottomRight));t.scrollToRect(s),null!==i&&null!==i.show&&i.show(e,t,this),this.currentTextEditor=i}doCancel(){this.stopTool()}doMouseUp(){this.canStart()&&this.doActivate()}doMouseDown(){this.isActive&&this.acceptText(2)}acceptText(t){switch(t){case 2:6===this.Kt?this.currentTextEditor instanceof HTMLElement&&this.currentTextEditor.focus():(2===this.Kt||5===this.Kt||3===this.Kt)&&(this.Kt=4,this.fL());break;case 1:case 4:case 3:if(4===t&&null!==this.textBlock&&!0===this.textBlock.isMultiline)return;(2===this.Kt||5===this.Kt||3===this.Kt)&&(this.Kt=4,this.fL());break}}fL(){const t=this.textBlock,e=this.diagram,i=this.currentTextEditor;if(null!==t&&null!==i){const s=t.text;let n="";if(null!==i.valueFunction&&(n=i.valueFunction()),!this.isValidText(t,s,n))return this.Kt=5,void this.doError(s,n);this.startTransaction(this.name),this.Kt=6,this.transactionResult=this.name,t.text=n,this.doSuccess(s,n),null!==e&&e.D("TextEdited",t,s),this.stopTransaction(),this.stopTool(),null!==e&&e.doFocus()}}doError(t,e){const i=this.textBlock;if(null===i)return;null!==i.errorFunction&&i.errorFunction(this,t,e);const s=this.currentTextEditor;null!==s&&null!==s.show&&s.show(i,this.diagram,this)}doSuccess(t,e){const i=this.textBlock;null!==i&&null!==i.textEdited&&i.textEdited(i,t,e)}doDeactivate(){const t=this.diagram;if(null!==t){if(this.Kt=1,null!==this.currentTextEditor){const e=this.currentTextEditor;null!==e&&null!==e.hide&&e.hide(t,this)}this.textBlock=null,this.isActive=!1}}doStop(){rt.Pc=null}AF(t){if(null===this.currentTextEditor||1===this.state)return;const i=this.DS;2===this.Kt&&(this.Kt=3),e.it(i.select)&&this.selectsTextOnActivate&&(i.select(),i.setSelectionRange(0,9999))}TF(t){if(null===this.currentTextEditor||1===this.state)return;const i=this.DS;e.it(i.focus)&&i.focus(),e.it(i.select)&&this.selectsTextOnActivate&&(i.select(),i.setSelectionRange(0,9999))}isValidText(t,e,i){const s=this.textValidation;if(null!==s&&!s(t,e,i))return!1;const n=t.textValidation;return!(null!==n&&!n(t,e,i))}get textValidation(){return this.Al}set textValidation(t){null!==t&&e.k(t,rt,"textValidation"),this.Al=t}get minimumEditorScale(){return this.LS}set minimumEditorScale(t){null!==t&&e.s(t,"number",rt,"minimumEditorScale"),this.LS=t}get selectsTextOnActivate(){return this.AS}set selectsTextOnActivate(t){null!==t&&e.s(t,"boolean",rt,"selectsTextOnActivate"),this.AS=t}get state(){return this.Kt}set state(t){this.Kt!==t&&(this.Kt=t)}measureTemporaryTextBlock(t){const e=this.Pe;return e.text=t,null!==this.textBlock&&e.ht(this.textBlock.Tl,1/0),e}static Pc=null}var at=(t=>(t[t.Default=1]="Default",t[t.AnimateLocations=2]="AnimateLocations",t[t.None=3]="None",t))(at||{});class ht{N;Si;Oi;yr;zn;Po;FS;RS;Sm;pi;Sc;on;Mm;Hh;_w;Nm;tx;Mc;pu;Cm;constructor(t){this.N=vt.um(),this.Si=!1,this.Sm=!1,this.pi=!1,this.Sc=!1,this.tx=!0,this.Mc=1,this.pu=!1,this.Oi=!0,this.yr=!0,this.Po=600,this.FS=!1,this.RS=!1,this.zn=new u,this.on=new lt,this.Mm=new lt,this.on.ds=this,this.Hh=new u,this._w=new u,this.Nm=new u,this.Cm=new u,t&&Object.assign(this,t)}So(t){this.N=t}ME(){return this.N}canStart(t){return!0}Dl(t){return!(!this.Oi||!this.canStart(t))&&(this.zn.add(t),this.defaultAnimation.isAnimating&&this.stopAnimation(),this.N.Mi(),this.pi=!0,!0)}getBundleAnimation(){return this.Mm}vS(){if(!this.Oi||(this.Mm.ce.count>0&&this.Mm.start(),!this.pi))return;const e=this.on,i=this.N,s=this.zn.has("Model");if(s&&(this.Sc=!0,1===this.Mc?(e.isViewportUnconstrained=!0,e.ce.clear(),e.add(i,"position",i.position.copy().offset(0,-200),i.position),e.add(i,"opacity",0,1)):3===this.Mc&&e.ce.clear(),2===this.Mc&&i.ix.equals(i.at)?this.tx=!0:this.tx=!1,i.D("InitialAnimationStarting",this)),s&&!this.yr||0===e.ce.count)return this.zn.clear(),this.pi=!1,e.ce.clear(),e.ex(i),this.Sc=!1,void i.S();this.zn.clear(),i.wr=!1;const n=e.ce.get(i);1!==i.autoScale&&null!==n&&(delete n.ei.scale,delete n.gs.scale);const o=this;t.requestAnimationFrame((()=>{!1===o.pi||e.Si||(i.getRenderingHint("temporaryPixelRatio")&&i.Bw(),i.OS(),o.pi=!1,e.start(),e.Si&&(o.xu(),i.invalidateDocumentBounds(),e.uL(0),i.fr(!0),o.bu(),i.D("AnimationStarting",o)))}))}IS(){return this.zn.has("Trigger")&&1===this.zn.count}dL(t,e,i,s){this.isTicking||this.IS()||t instanceof De&&(null!==t.fromNode||null!==t.toNode)||this.on.add(t,"position",e,i,s)}nx(t){return this.on.nx(t)}ES(t){return this.on.ES(t)}DF(e){const i=this.Hh,s=this;function n(){if(s.Nm.count>0&&(i.addAll(s.Nm),s.Nm.clear(),s.Si=!0),!1===s.Si||0===i.count)return;s._w.addAll(i);const e=s._w.iterator;for(;e.next();){const t=e.value;!1!==t.Si&&(t.FF()?t.gL(!1):t.Nc=!0)}s._w.clear(),!1!==s.Si?(s.xu(),s.N.fr(),s.bu(),t.requestAnimationFrame(n)):t.requestAnimationFrame(n)}this.Si?this.RF(e):(this.Si=!0,i.add(e),t.requestAnimationFrame((()=>n())))}RF(t){this.Nm.add(t)}vF(){const t=this.Hh.iterator;for(;t.next();)t.value.Nc=!1}xu(){if(this.Sm)return;const t=this.N;this.FS=t.skipsUndoManager,this.RS=t.fe,t.skipsUndoManager=!0,t.fe=!0,this.Sm=!0}bu(){const t=this.N;t.skipsUndoManager=this.FS,t.fe=this.RS,this.Sm=!1}stopAnimation(t){const e=this.on;if(!0===this.pi&&(this.pi=!1,this.Sc=!1,this.zn.clear(),e.OF()&&this.N.requestUpdate()),!this.Si)return e.ce.clear(),void e.ex(this.N);if(e.ku(!0),e.ex(null),!0===t){const t=this.Hh.toArray();for(let e=0;e<t.length;e++)t[e].ku(!0)}}ku(t){this.Hh.delete(t),0===this.Hh.count&&(this.Si=!1,this.N.requestUpdate()),t===this.defaultAnimation&&this.N.D("AnimationFinished",this)}Cc(t,e){this.pi&&(!this.zn.has("Expand Tree")&&!this.zn.has("Expand SubGraph")||(this.on.Cc(t,e),this.mL(t)))}Lc(t,e){this.pi&&(!this.zn.has("Collapse Tree")&&!this.zn.has("Collapse SubGraph")||(this.on.Lc(t,e),this.on.BS(e,"position",e.position,e.position),this.mL(t)))}pL(t,e){!this.pi||t.equals(e)||this.IS()||(this.N.Uh||(t=e.copy()),this.on.BS(this.N,"position",t,e))}yL(t,e){this.pi&&(this.IS()||this.on.add(this.N,"scale",t,e))}US(t,e){t.Se&&(t.xr=e,this.Cm.add(t))}mL(t){const e=t.findLinksConnected();for(;e.next();){const t=e.value;t.Se&&(t.xr=t.points.copy(),this.Cm.add(t))}}get isEnabled(){return this.Oi}set isEnabled(t){e.s(t,"boolean",ht,"isEnabled"),this.Oi=t,t&&this.Hh.each((t=>{!t.isAnimating&&t.runCount===1/0&&t.start()}))}get duration(){return this.Po}set duration(t){e.s(t,"number",ht,"duration"),t<1&&e.W(t,">= 1",ht,"duration"),this.Po=t}get isAnimating(){return this.Si}get isTicking(){return this.Sm}get isInitial(){return this.yr}set isInitial(t){e.s(t,"boolean",ht,"isInitial"),this.yr=t}get defaultAnimation(){return this.on}get activeAnimations(){return this.Hh}get initialAnimationStyle(){return this.Mc}set initialAnimationStyle(t){this.Mc=t}static lx=new m;static defineAnimationEffect(t,e){ht.lx.set(t,e)}static VS(t,e,i,s,n){null===t&&(t=[0,0,0,0]),null===e&&(e=[0,0,0,0]);let o=t[0],r=t[1];const a=t[2],h=t[3];let l=e[0],u=e[1];const c=e[2],d=e[3];0===a||100===a?(o=l,r=u):(0===c||100===c)&&(l=o,u=r),Math.abs(l-o)>180&&(l>o?o+=360:l+=360);const f=n(i,o,l-o,s)%360,g=n(i,r,u-r,s),p=n(i,a,c-a,s),m=n(i,h,d-h,s);return"hsla("+f+", "+g+"%, "+p+"%, "+m+")"}static{const t=ht.lx,e=(t,e,i,s,n,o)=>{t.position=new y(s(n,e.x,i.x-e.x,o),s(n,e.y,i.y-e.y,o))};t.set("position:diagram",e),t.set("position",e),t.set("position:part",((t,e,i,s,n,o)=>{n<o?t.bc(s(n,e.x,i.x-e.x,o),s(n,e.y,i.y-e.y,o),!1):t.position=new y(s(n,e.x,i.x-e.x,o),s(n,e.y,i.y-e.y,o))})),t.set("location",((t,e,i,s,n,o)=>{n<o?t.bc(s(n,e.x,i.x-e.x,o),s(n,e.y,i.y-e.y,o),!0):t.location=new y(s(n,e.x,i.x-e.x,o),s(n,e.y,i.y-e.y,o))})),t.set("position:placeholder",((t,e,i,s,n,o)=>{n<o?t.bc(s(n,e.x,i.x-e.x,o),s(n,e.y,i.y-e.y,o),!1):t.position=new y(s(n,e.x,i.x-e.x,o),s(n,e.y,i.y-e.y,o))})),t.set("position:nodeCollapse",((t,e,i,s,n,o)=>{const r=t.actualBounds,a=i.actualBounds,h=a.x+a.width/2-r.width/2,l=a.y+a.height/2-r.height/2;n<o?t.bc(s(n,e.x,h-e.x,o),s(n,e.y,l-e.y,o),!1):t.position=new y(s(n,e.x,h-e.x,o),s(n,e.y,l-e.y,o))})),t.set("desiredSize",((t,e,i,s,n,o)=>{t.desiredSize=new v(s(n,e.width,i.width-e.width,o),s(n,e.height,i.height-e.height,o))})),t.set("width",((t,e,i,s,n,o)=>{t.width=s(n,e,i-e,o)})),t.set("height",((t,e,i,s,n,o)=>{t.height=s(n,e,i-e,o)})),t.set("fill",((t,e,i,s,n,o)=>{t.fill=ht.VS(e,i,n,o,s)})),t.set("stroke",((t,e,i,s,n,o)=>{t.stroke=ht.VS(e,i,n,o,s)})),t.set("strokeWidth",((t,e,i,s,n,o)=>{t.strokeWidth=s(n,e,i-e,o)})),t.set("strokeDashOffset",((t,e,i,s,n,o)=>{t.strokeDashOffset=s(n,e,i-e,o)})),t.set("background",((t,e,i,s,n,o)=>{t.background=ht.VS(e,i,n,o,s)})),t.set("opacity",((t,e,i,s,n,o)=>{t.opacity=s(n,e,i-e,o)})),t.set("scale",((t,e,i,s,n,o)=>{t.scale=s(n,e,i-e,o)})),t.set("angle",((t,e,i,s,n,o)=>{t.angle=s(n,e,i-e,o)}))}static Default=1;static AnimateLocations=2;static None=3}class lt{hx;Lm;Si;Pu;Po;ms;wL;Ac;ce;ax;ei;Xn;Su;Tc;cx;fx;Nc;zS;ux;ds;N;XS;YS;KS;constructor(t){this.N=null,this.ds=null,this.zS=null,this.ux=null,this.XS=!1,this.Si=!1,this.Nc=!1,this.ei=0,this.Xn=0,this.hx=lt.EaseInOutQuad,this.Lm=lt.EaseInOutQuad,this.Su=!1,this.Tc=!1,this.cx=1,this.fx=0,this.Po=NaN,this.ms=NaN,this.YS=0,this.Pu=null,this.wL=y.wo,this.ce=new m,this.ax=new m,this.Ac=new u,this.KS=1,t&&Object.assign(this,t)}suspend(){this.Nc=!0}advanceTo(t,e){e&&(this.Nc=!1),this.Su&&t>=this.ms&&(this.Tc=!0,t-=this.ms),this.YS=t,this.gL(!0),this.ds.xu(),this.N.fr(),this.ds.bu(),this.N.redraw()}ex(t){if(this.ax.clear(),this.Tc=!1,this.fx=0,this.ms=NaN,this.Ac.count>0&&this.Ac.clear(),null!==t){const e=t.links;for(;e.next();)e.value.xr=null}}OF(){return this.ce.count>0}start(){if(0===this.ce.count)return this;if(this.Si)return this;let t=this.N;const e=this.ce.iterator;for(;e.next();){const i=e.key;null===t&&(i instanceof vt?t=i:i instanceof Tt&&(t=i.diagram))}if(null===t)return this;this.N=t,this.ds=t.animationManager;const i=this.ds;return!1===i.isEnabled||(this.ms=isNaN(this.Po)?i.duration:this.Po,this.Lm=this.hx,i.Sc&&1===i.Mc&&this===i.defaultAnimation&&(this.Lm=lt.EaseOutExpo,this.ms=isNaN(this.Po)?600===i.duration?900:i.duration:this.Po),this.KS=t.scrollMode,this.isViewportUnconstrained&&(t.jh=2),i.xu(),this.Ac.each((e=>{e.data=null,t.add(e)})),i.bu(),this.Si=!0,this.ei=+new Date,this.Xn=this.ei+this.ms,i.DF(this)),this}addTemporaryPart(t,e){return t.ke()?(this.Ac.add(t),this.N=e,this):this}add(t,e,i,s,n){if(null===this.N&&(t instanceof vt?this.N=t:t instanceof Tt&&null!==t.diagram&&(this.N=t.diagram)),t instanceof ke){if(!t.isAnimated)return this;"position"===e&&(e="position:part")}return this.BS(t,e,i,s,n),this}BS(t,e,i,s,n){const o=this.ce;let r,a,h;if(t instanceof vt&&"position"===e&&(e="position:diagram"),("fill"===e||"stroke"===e||"background"===e)&&(jt.Mo(i),jt.GS(),i=[jt.Ii.n0,jt.Ii.n1,jt.Ii.n2,jt.Ii.n3],jt.Mo(s),jt.GS(),s=[jt.Ii.n0,jt.Ii.n1,jt.Ii.n2,jt.Ii.n3]),o.has(t))r=o.get(t),a=r.ei,h=r.gs,void 0===a[e]&&(a[e]=this.Mu(i)),h[e]=this.Mu(s);else{if("position"===e&&i.equalsApprox(s))return;a={},h={},a[e]=this.Mu(i),h[e]=this.Mu(s),r=new ut(a,h,n),o.set(t,r)}const l=a[e];l instanceof y&&!l.isReal()&&l.a(this.wL),n&&0===e.indexOf("position:")&&t instanceof ke?r.gx.location=this.Mu(t.location):n&&(r.gx[e]=this.Mu(i))}Mu(t){return t instanceof y||t instanceof v?t.copy():t}IF(t){const e=this.ce;if(e.has(t)){const i=e.get(t);i.mx=!0}}nx(t){if(!this.Si)return!1;const e=this.ce.get(t);return null!==e&&e.mx}ES(t){if(!this.Si)return!1;const e=this.ce.get(t);return null!==e&&!!(e.ei.position||e.ei["position:part"]||e.ei.location)}FF(){if(this.Ac.count>0)return!0;const t=this.ce.iterator;for(;t.next();){const e=t.key;if(e instanceof Tt&&null!==e.diagram||e instanceof vt)return!0}return!1}gL(t){if(this.Nc&&!t)return;const e=this.ds;if(!1===this.Si)return;const i=+new Date;let s=i>this.Xn?this.ms:i-this.ei;t&&(s=this.YS,s<this.ms?(this.ei=+new Date-s,this.Xn=this.ei+this.ms):s=this.ms),e.xu(),this.uL(s),this.N.fr(!0),e.bu(),i>this.Xn&&(this.Su&&!this.Tc?(this.ei=+new Date,this.Xn=this.ei+this.ms,this.Tc=!0):this.ku(!1))}uL(t){const e=this.ms,i=this.ce.iterator,s=this.Tc;for(;i.next();){const n=i.key;if(n instanceof Tt&&null===n.diagram)continue;const o=i.value,r=s?o.gs:o.ei,a=s?o.ei:o.gs,h=ht.lx;for(const i in a)"position"===i&&(a["position:placeholder"]||a["position:nodeCollapse"])||null!==h.get(i)&&h.get(i)(n,r[i],a[i],this.Lm,t,e,this)}}stop(){return this.Si?(this.ku(!0),this):this}ku(t){if(null!==this.ux&&this.ux.EF(this.zS),!this.Si)return;const e=this.N,i=this.ds;i.Sc=!1,this.Si=!1,this.Nc=!1,i.xu();const s=this.ce,n=this.Ac.iterator;for(;n.next();)e.remove(n.value);const o=this.Su,r=s.iterator,a=ht.lx;for(;r.next();){const t=r.key,e=r.value,i=o?e.gs:e.ei,s=o?e.ei:e.gs,n=e.gx;for(const o in s)if(null!==a.get(o)){let r=o;e.yx&&("position:nodeCollapse"===r||"position:placeholder"===r)&&(r="position"),a.get(r)(t,i[o],void 0!==n[o]?n[o]:e.yx?i[o]:s[o],this.Lm,this.ms,this.ms,this)}e.yx&&void 0!==n.location&&t instanceof ke&&(t.location=n.location),e.mx&&t instanceof ke&&t.Ei(!1)}this.fx++;const h=!t&&this.cx>this.fx;if(!h&&(this===i.Mm||this===i.defaultAnimation)&&this.ce.clear(),e.wx.clear(),e.NP(!1),e.invalidateDocumentBounds(),e.S(),e.fr(!0),i.defaultAnimation===this){const t=i.Cm.iterator;for(;t.next();)t.value.BF();i.Cm.clear()}if(e.fr(!0),this.isViewportUnconstrained&&(e.scrollMode=this.KS),i.bu(),h)return this.Tc=!1,void this.start();this.ex(null),e.xL(),i.ku(this),this.Pu&&this.Pu(this),e.requestUpdate()}Cc(t,e){const i=e.actualBounds;let s=null;if(e instanceof _e&&(s=e.placeholder),null!==s&&s.visible){const e=s.getDocumentPoint(w.TopLeft),i=s.padding;e.x+=i.left,e.y+=i.top,this.add(t,"position",e,t.position,!1)}else this.add(t,"position",new y(i.x+i.width/2,i.y+i.height/2),t.position,!1);this.add(t,"scale",.01,t.scale,!1),t instanceof _e&&this.UF(t,e)}UF(t,e){const i=t.memberParts;for(;i.next();){const t=i.value;t instanceof Ce&&this.Cc(t,e)}}Lc(t,e){if(!t.isVisible())return;let i=null;if(e instanceof _e&&(i=e.placeholder),null!==i&&i.visible){const e=i.getDocumentPoint(w.TopLeft),s=i.padding;e.x+=s.left,e.y+=s.top,this.add(t,"position:placeholder",t.position,e,!0)}else this.add(t,"position:nodeCollapse",t.position,e,!0);this.add(t,"scale",t.scale,.01,!0),this.IF(t),t instanceof _e&&this.VF(t,e)}VF(t,e){const i=t.memberParts;for(;i.next();){const t=i.value;t instanceof Ce&&this.Lc(t,e)}}get duration(){return this.Po}set duration(t){e.s(t,"number",lt,"duration"),t<1&&e.W(t,">= 1",lt,"duration"),this.Po=t}get reversible(){return this.Su}set reversible(t){this.Su=t}get runCount(){return this.cx}set runCount(t){t>0?this.cx=t:e.o("Animation.runCount value must be a positive integer.")}get finished(){return this.Pu}set finished(t){this.Pu!==t&&(null!==t&&e.k(t,lt,"finished"),this.Pu=t)}get easing(){return this.hx}set easing(t){this.hx=t}get isViewportUnconstrained(){return this.XS}set isViewportUnconstrained(t){this.XS=t}get isAnimating(){return this.Si}getTemporaryState(t){let e=this.ax.get(t);return null===e&&(e={},this.ax.set(t,e)),e}static EaseLinear=(t,e,i,s)=>i*t/s+e;static EaseInOutQuad=(t,e,i,s)=>(t/=s/2,t<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e);static EaseInQuad=(t,e,i,s)=>i*(t/=s)*t+e;static EaseOutQuad=(t,e,i,s)=>-i*(t/=s)*(t-2)+e;static EaseInExpo=(t,e,i,s)=>0===t?e:i*Math.pow(2,10*(t/s-1))+e;static EaseOutExpo=(t,e,i,s)=>t===s?e+i:i*(1-Math.pow(2,-10*t/s))+e}class ut{ei;gs;gx;yx;mx;constructor(t,e,i){this.ei=t,this.gs=e,this.gx={},this.yx=i,this.mx=!1}}var ct=(t=>(t[t.Default=1]="Default",t[t.Immediate=2]="Immediate",t[t.Bundled=3]="Bundled",t))(ct||{});class dt{be;en;Nu;Dc;constructor(t,e,i){this.be=null,this.en=t,this.Nu=i||1,this.Dc=null,void 0!==e&&(this.Dc=e,void 0===i&&(this.Nu=2))}copy(){const t=new dt(this.en);t.Nu=this.Nu;const e=this.Dc;if(null!==e){const i={};void 0!==e.duration&&(i.duration=e.duration),void 0!==e.finished&&(i.finished=e.finished),void 0!==e.easing&&(i.easing=e.easing),t.Dc=i}return t}get propertyName(){return this.en}set propertyName(t){this.en=t}get animationSettings(){return this.Dc}set animationSettings(t){this.Dc=t}zF(t){const e=this.Dc;null!==e&&(e.duration&&(t.duration=e.duration),e.finished&&(t.finished=e.finished),e.easing&&(t.easing=e.easing))}get startCondition(){return this.Nu}set startCondition(t){this.Nu=t}static Default=1;static Immediate=2;static Bundled=3}class ft{N;Pt;$t;br;Fl;Rl;vl;Ol;Il;El;Bl;Ul;Vl;zl;Xl;Yl;kc;Kl;xx;Am;Cu;Ct;constructor(t){u.Gi(this),this.N=null,this.Ct=new h,this.Pt="",this.$t=1,this.br=!1,this.Fl=!0,this.Rl=!0,this.vl=!0,this.Ol=!0,this.Il=!0,this.El=!0,this.Bl=!0,this.Ul=!0,this.Vl=!0,this.zl=!0,this.Xl=!0,this.Yl=!0,this.kc=!0,this.Kl=!0,this.xx=!0,this.Am=!1,this.Cu=[],t&&Object.assign(this,t)}XF(){const t=this.Ct;for(let e=0;e<t.length;e++)t.r[e].HS(null);t.clear(),this.Cu.length=0}So(t){this.N=t}toString(t){void 0===t&&(t=0);const i='Layer "'+this.name+'"';if(t<=0)return i;let s=0,n=0,o=0,r=0,a=0;const h=this.Ct.iterator;for(;h.next();){const t=h.value;t instanceof _e?o++:t instanceof Ce?n++:t instanceof De?r++:t instanceof Pe?a++:s++}let l="";if(s>0&&(l+=s+" Parts "),n>0&&(l+=n+" Nodes "),o>0&&(l+=o+" Groups "),r>0&&(l+=r+" Links "),a>0&&(l+=a+" Adornments "),t>1){const t=this.Ct.iterator;for(;t.next();){const i=t.value;l+="\n    "+i.toString();const s=i.data;null!==s&&u.as(s)&&(l+=" #"+u.as(s)),i instanceof Ce?l+=" "+e.toString(s):i instanceof De&&(l+=" "+e.toString(i.fromNode)+" "+e.toString(i.toNode))}}return i+" "+this.Ct.count+": "+l}findObjectAt(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i=null),!1===this.Kl)return null;let s=!1;null!==this.diagram&&this.diagram.viewportBounds.containsPoint(t)&&(s=!0);const n=y.l(),o=this.Ct.r,r=o.length;for(let a=r;a--;){const r=o[a];if(!0===s&&!1===r.Ml()||!r.isVisible())continue;n.a(t),n.Oe(r.Bs);let h=r.bL(n,e,i);if(null!==h&&(null!==e&&(h=e(h)),null!==h&&(null===i||i(h))))return y.e(n),h}return y.e(n),null}findObjectsAt(t,e,i,s){if(void 0===e&&(e=null),void 0===i&&(i=null),!(s instanceof h)&&!(s instanceof u)&&(s=new u),!1===this.Kl)return s;let n=!1;null!==this.diagram&&this.diagram.viewportBounds.containsPoint(t)&&(n=!0);const o=y.l(),r=this.Ct.r,a=r.length;for(let h=a;h--;){const a=r[h];if(!0===n&&!1===a.Ml()||!a.isVisible())continue;o.a(t),o.Oe(a.Bs);let l=a;a.kL(o,e,i,s)&&(null!==e&&(l=e(l)),null!==l&&(null===i||i(l))&&s.add(l))}return y.e(o),s}findObjectsIn(t,e,i,s,n){if(void 0===e&&(e=null),void 0===i&&(i=null),void 0===s&&(s=!1),!(n instanceof h)&&!(n instanceof u)&&(n=new u),!1===this.Kl)return n;let o=!1;null!==this.diagram&&this.diagram.viewportBounds.containsRect(t)&&(o=!0);const r=this.Ct.r,a=r.length;for(let h=a;h--;){const a=r[h];if(!0===o&&!1===a.Ml()||!a.isVisible())continue;let l=a;a.Tm(t,e,i,s,n)&&(null!==e&&(l=e(l)),null!==l&&(null===i||i(l))&&n.add(l))}return n}vP(t,e,i,s,n,o,r){if(!1===this.Kl)return n;const a=this.Ct.r,h=a.length;for(let l=h;l--;){const h=a[l];if(!0===r&&!1===h.Ml()||!o(h)||!h.isVisible())continue;let u=h;h.Tm(t,e,i,s,n)&&(null!==e&&(u=e(u)),null!==u&&(null===i||i(u))&&n.add(u))}return n}findObjectsNear(t,e,i,s,n,o){if(void 0===i&&(i=null),void 0===s&&(s=null),void 0===n&&(n=!0),!1!==n&&!0!==n&&((n instanceof h||n instanceof u)&&(o=n),n=!0),!(o instanceof h)&&!(o instanceof u)&&(o=new u),!1===this.Kl)return o;let r=!1;null!==this.diagram&&this.diagram.viewportBounds.containsPoint(t)&&(r=!0);const a=y.l(),l=y.l(),c=this.Ct.r,d=c.length;for(let h=d;h--;){const u=c[h];if(!0===r&&!1===u.Ml()||!u.isVisible())continue;a.a(t),a.Oe(u.Bs),l.i(t.x+e,t.y),l.Oe(u.Bs);let d=u;u.PL(a,l,i,s,n,o)&&(null!==i&&(d=i(d)),null!==d&&(null===s||s(d))&&o.add(d))}return y.e(a),y.e(l),o}jS(){return this.Ct.r}ps(t,i){if(!this.visible)return;const s=this.Ct.r,n=s.length;if(0===n)return;const o=e.et(),r=e.et();for(let e=0;e<n;e++){const t=s[e];if(t.qS=e,t instanceof De){if(!1===t.Se)continue}else if(t instanceof Pe&&null!==t.adornedPart)continue;const n=t.actualBounds;t.isVisible()&&n.intersectsRectPlus(i,10)?(t.ps(!0),o.push(t)):(t.ps(!1),null!==t.adornments&&t.adornments.count>0&&r.push(t))}for(let e=0;e<o.length;e++){const t=o[e];t.WS();const i=t.adornments;for(;i.next();){const t=i.value;t.ht(1/0,1/0),t.Ut(),t.ps(!0)}}for(let e=0;e<r.length;e++)r[e].WS();e.J(o),e.J(r)}Lu(t){let e=1;return 1!==this.$t&&(e=t.globalAlpha,t.globalAlpha=e*this.$t),e}SL(t,e){for(let i=0;i<e;i++)t[i].Au()}Bi(t,e,i){if(!this.visible||0===this.$t||(void 0===i&&(i=!0),!i&&this.isTemporary))return;const s=this.Ct.r,n=s.length;if(0===n)return;t.br&&this.SL(s,n);const o=this.Lu(t),r=this.Cu;r.length=0;const a=e.scale,h=x.l();for(let l=0;l<n;l++){const i=s[l];this.Dm(t,i,e,r,a,h,!0)}x.e(h),t.br&&this.SL(s,n),t.globalAlpha=o}NE(t,e,i){if(!this.visible||0===this.$t)return;const s=this.Ct.r,n=s.length;if(0===n)return;const o=this.Lu(t),r=this.Cu;r.length=0;const a=e.scale,h=x.l();for(let l=0;l<n;l++){const n=s[l];i.has(n)||this.Dm(t,n,e,r,a,h,!0)}x.e(h),t.globalAlpha=o}YF(t,e,i,s){if(!this.visible||0===this.$t||!s&&this.isTemporary)return;const n=this.Ct.r,o=n.length;if(0===o)return;const r=this.Lu(t),a=this.Cu;a.length=0;const h=e.scale,l=x.l();for(let u=0;u<o;u++){const s=n[u];i.has(s)&&this.Dm(t,s,e,a,h,l,!1)}x.e(l),t.globalAlpha=r}KF(t,e,i,s,n){if(!this.visible||0===this.opacity)return;const o=this.diagram.grid.part;if(!s&&this.isTemporary){if(n&&o.layer===this){const e=this.Lu(t);o.Bi(t,i),t.globalAlpha=e}}else{const e=this.Lu(t),s=i.scale,r=x.l(),a=this.Ct.r,h=a.length;for(let l=0;l<h;l++){const e=a[l];!n&&e===o||this.Dm(t,e,i,null,s,r,!1)}x.e(r),t.globalAlpha=e}}CE(t,e,i){if(!this.visible||0===this.$t)return;const s=this.Lu(t),n=this.Cu;n.length=0;const o=e.scale,r=x.l(),a=this.Ct.r,h=a.length,l=i.length;for(let u=0;u<h;u++){const s=a[u],h=s.qh(s.actualBounds);this.GF(h,i,l,o)&&this.Dm(t,s,e,n,o,r,!0)}x.e(r),t.globalAlpha=s}Dm(t,e,i,s,n,o,r){if(r&&!e.Ml())return void t.removePartFromView(e);if(null!==s&&e instanceof De&&(e.isOrthogonal&&s.push(e),!1===e.Se))return void t.removePartFromView(e);let a=!1,h=e.containingGroup;for(;null!==h;)a?null!==h.si&&o.intersectRect(h.si):null!==h.si&&(a=!0,o.a(h.si)),h=h.containingGroup;const l=e.actualBounds;let u=!1;if(a&&e.isVisible()){if(!o.intersectsRect(l))return void t.removePartFromView(e);u=!o.containsRect(l)}u&&(t.save(),t instanceof Et?t.partClipRect=o.copy():(t.beginPath(),t.rect(o.x,o.y,o.width,o.height),t.clip())),l.width*n>i.Fm||l.height*n>i.Fm?e.Bi(t,i):this.HF(t,e,i),u&&(t.restore(),t.clearContextCache(!0))}HF(t,e,i){if(t instanceof Et)return void e.Bi(t,i);const s=e.actualBounds,n=e.naturalBounds;if(0===s.width||0===s.height||isNaN(s.x)||isNaN(s.y)||!e.isVisible())return;const o=e.T;if(null===e.background)return e.rn(t,"rgba(0,0,0,0.3)",!0,!1,n,s),void t.fillRect(s.x,s.y,s.width,s.height);if(t.transform(o.m11,o.m12,o.m21,o.m22,o.dx,o.dy),e.rn(t,e.background,!0,!1,n,s),t.fillRect(0,0,n.width/2,n.height/2),!o.Xk()){const e=1/(o.m11*o.m22-o.m12*o.m21);t.transform(o.m22*e,-o.m12*e,-o.m21*e,o.m11*e,e*(o.m21*o.dy-o.m22*o.dx),e*(o.m12*o.dx-o.m11*o.dy))}}GF(t,e,i,s){const n=2/s,o=4/s;for(let r=0;r<i;r++){const i=e[r];if(0!==i.width&&0!==i.height&&t.intersects(i.x-n,i.y-n,i.width+o,i.height+o))return!0}return!1}t(t,e,i,s,n){const o=this.diagram;null!==o&&o.raiseChangedEvent(2,t,this,e,i,s,n)}Wh(t,e,i){const s=this.Ct;if(e.HS(this),t>=s.count)t=s.count;else if(s.elt(t)===e)return-1;s.insertAt(t,e),e.Rm(i);const n=this.diagram;return null!==n&&(i?n.S():n.Wh(e)),this.bx(t,e),t}te(t,e,i){if(!i&&e.layer!==this&&null!==e.layer)return e.layer.te(t,e,i);const s=this.Ct;if(t<0||t>=s.length){if(t=s.indexOf(e),t<0)return-1}else if(s.elt(t)!==e&&(t=s.indexOf(e),t<0))return-1;e.vm(i),s.removeAt(t);const n=this.diagram;return null!==n&&(i?n.S():n.te(e)),e.HS(null),t}bx(t,e){t=this.jF(t,e),e instanceof _e&&this.qF(t,e),null!==e.svg&&e.svg.remove()}jF(t,e){const i=e.zOrder;if(isNaN(i))return t;const s=this.Ct,n=s.count;if(n<=1)return t;if(t<0&&(t=s.indexOf(e)),t<0)return-1;let o=t-1,r=NaN;for(;o>=0&&(r=s.elt(o).zOrder,isNaN(r));)o--;let a=t+1,h=NaN;for(;a<n&&(h=s.elt(a).zOrder,isNaN(h));)a++;if(!isNaN(r)&&r>i)for(;;){if(-1===o||r<=i)return o++,o===t?t:(s.removeAt(t),s.insertAt(o,e),o);for(r=NaN;--o>=0&&(r=s.elt(o).zOrder,isNaN(r)););}else if(!isNaN(h)&&h<i)for(;;){if(a===n||h>=i)return a--,a===t?t:(s.removeAt(t),s.insertAt(a,e),a);for(h=NaN;++a<n&&(h=s.elt(a).zOrder,isNaN(h)););}return t}qF(t,e){if(null===e||!isNaN(e.zOrder))return;this.WF(t,e);const i=e.containingGroup;null!==i&&this.bx(-1,i)}WF(t,e){if(0===e.memberParts.count)return;let i=-1;const s=this.Ct.r,n=s.length;for(let o=0;o<n;o++){const n=s[o];if(n===e&&(t=o,i>=0)||i<0&&n.containingGroup===e&&(i=o,t>=0))break}if(!(i<0)&&i<t){const s=this.Ct;s.removeAt(t),s.insertAt(i,e)}}get parts(){return this.Ct.iterator}get partsBackwards(){return this.Ct.iteratorBackwards}get diagram(){return this.N}get name(){return this.Pt}set name(t){e.s(t,"string",ft,"name");const i=this.Pt;if(i!==t){const s=this.diagram;if(null!==s){""===i&&e.o("Cannot rename default Layer to: "+t);const n=s.layers;for(;n.next();)n.value.name===t&&e.o("Layer.name is already present in this diagram: "+t)}this.Pt=t,this.t("name",i,t);const n=this.Ct.iterator;for(;n.next();){const t=n.value;t.layerName=this.Pt}}}get opacity(){return this.$t}set opacity(t){const i=this.$t;if(i!==t){e.s(t,"number",ft,"opacity"),(t<0||t>1)&&e.W(t,"0 <= value <= 1",ft,"opacity"),this.$t=t;const s=this.diagram;null!==s&&s.S(),this.t("opacity",i,t)}}get isViewportAligned(){return this.Am}set isViewportAligned(t){const e=this.Am;e!==t&&(this.Am=t,this.diagram&&(this.ML(),this.diagram.S()),this.t("isViewportAligned",e,t),t&&(this.isInDocumentBounds=!1))}ML(){if(!this.Am)return;const t=this.diagram,e=this.Ct.r,i=e.length,s=t.xt,n=t.bt;for(let o=0;o<i;o++){const i=e[o],r=i.naturalBounds.width,a=i.naturalBounds.height;let h=i.alignment;(h.isDefault()||!h.isSpot())&&(h=w.BottomRight);let l=i.alignmentFocus;l.isDefault()&&(l=new w(h.x,h.y));const u=h.x*s+h.offsetX-(l.x*r+l.offsetX),c=h.y*n+h.offsetY-(l.y*a+l.offsetY),d=y.V(u,c);t.JF(d),i.bc(d.x,d.y,!0),y.e(d),i.tt=1/t.scale}}get isTemporary(){return this.br}set isTemporary(t){const i=this.br;i!==t&&(e.s(t,"boolean",ft,"isTemporary"),this.br=t,this.t("isTemporary",i,t))}get visible(){return this.kc}set visible(t){const i=this.kc;if(i!==t){e.s(t,"boolean",ft,"visible"),this.kc=t;const s=this.Ct.iterator;for(;s.next();)s.value.Ei(t);const n=this.diagram;null!==n&&n.S(),this.t("visible",i,t)}}get pickable(){return this.Kl}set pickable(t){const i=this.Kl;i!==t&&(e.s(t,"boolean",ft,"pickable"),this.Kl=t,this.t("pickable",i,t))}get isInDocumentBounds(){return this.xx}set isInDocumentBounds(t){const e=this.xx;e!==t&&(this.xx=t,null!==this.diagram&&this.diagram.invalidateDocumentBounds(),this.t("isInDocumentBounds",e,t))}get allowCopy(){return this.Fl}set allowCopy(t){const i=this.Fl;i!==t&&(e.s(t,"boolean",ft,"allowCopy"),this.Fl=t,this.t("allowCopy",i,t))}get allowDelete(){return this.Rl}set allowDelete(t){const i=this.Rl;i!==t&&(e.s(t,"boolean",ft,"allowDelete"),this.Rl=t,this.t("allowDelete",i,t))}get allowTextEdit(){return this.vl}set allowTextEdit(t){const i=this.vl;i!==t&&(e.s(t,"boolean",ft,"allowTextEdit"),this.vl=t,this.t("allowTextEdit",i,t))}get allowGroup(){return this.Ol}set allowGroup(t){const i=this.Ol;i!==t&&(e.s(t,"boolean",ft,"allowGroup"),this.Ol=t,this.t("allowGroup",i,t))}get allowUngroup(){return this.Il}set allowUngroup(t){const i=this.Il;i!==t&&(e.s(t,"boolean",ft,"allowUngroup"),this.Il=t,this.t("allowUngroup",i,t))}get allowLink(){return this.El}set allowLink(t){const i=this.El;i!==t&&(e.s(t,"boolean",ft,"allowLink"),this.El=t,this.t("allowLink",i,t))}get allowRelink(){return this.Bl}set allowRelink(t){const i=this.Bl;i!==t&&(e.s(t,"boolean",ft,"allowRelink"),this.Bl=t,this.t("allowRelink",i,t))}get allowMove(){return this.Ul}set allowMove(t){const i=this.Ul;i!==t&&(e.s(t,"boolean",ft,"allowMove"),this.Ul=t,this.t("allowMove",i,t))}get allowReshape(){return this.Vl}set allowReshape(t){const i=this.Vl;i!==t&&(e.s(t,"boolean",ft,"allowReshape"),this.Vl=t,this.t("allowReshape",i,t))}get allowResize(){return this.zl}set allowResize(t){const i=this.zl;i!==t&&(e.s(t,"boolean",ft,"allowResize"),this.zl=t,this.t("allowResize",i,t))}get allowRotate(){return this.Xl}set allowRotate(t){const i=this.Xl;i!==t&&(e.s(t,"boolean",ft,"allowRotate"),this.Xl=t,this.t("allowRotate",i,t))}get allowSelect(){return this.Yl}set allowSelect(t){const i=this.Yl;i!==t&&(e.s(t,"boolean",ft,"allowSelect"),this.Yl=t,this.t("allowSelect",i,t))}}var gt=(t=>(t[t.None=1]="None",t[t.Uniform=2]="Uniform",t[t.UniformToFill=3]="UniformToFill",t))(gt||{}),pt=(t=>(t[t.All=1]="All",t[t.NotDirected=2]="NotDirected",t[t.NotDirectedFast=3]="NotDirectedFast",t[t.NotUndirected=4]="NotUndirected",t[t.DestinationTree=5]="DestinationTree",t[t.SourceTree=6]="SourceTree",t))(pt||{}),mt=(t=>(t[t.Document=1]="Document",t[t.Infinite=2]="Infinite",t))(mt||{}),yt=(t=>(t[t.TreeParent=1]="TreeParent",t[t.AllParents=2]="AllParents",t[t.AnyParents=3]="AnyParents",t))(yt||{});class vt{ds;Wt;JS;kx;kr;Tu;Px;Sx;Mx;Nx;Cx;Lx;Jh;jh;Ax;Tx;Dx;Gl;Fc;Pr;Om;Fx;Rx;Du;Yn;Sr;$h;No;Im;Rc;Em;vc;Fu;Mr;Kn;$S;ZS;vx;Ox;QS;Ix;_S;tM;iM;Ex;Bm;Nr;Cr;Lr;Ar;Tr;Dr;Bx;Fr;Ux;Rr;vr;Or;Ir;Vx;eM;Co;sM;zx;Xx;nM;ki;oM;rM;lM;Os;Lo;Oi;Yx;Fl;Rl;Kx;Gx;vl;Ol;Il;Hx;El;Bl;Ul;Vl;zl;Xl;Yl;jx;qx;hM;Ru;vu;Wx;Jx;$x;Zx;Um;Qx;_x;tb;Zt;aM;ib;cM;Ou;ln;Gn;ie;Hn;NL;Hl;fM;uM;Vm;eb;Iu;zm;sb;Er;jl;Zh;dM;gM;Xm;nb;ob;Ze;Eu;Ym;Bu;ql;Oc;Km;Br;Qh;mM;Gm;jt;T;Be;wr;Ui;ys;pM;Wl;Ur;xl;Vr;_h;Ic;yM;Uu;ta;Vu;Xt;Jl;at;tt;zu;xt;bt;ft;Ec;Ew;rb;ia;Bc;lb;hb;ab;$F;ZF;Vi;kl;Fm;Hm;wM;xM;CL;jm;QF;_F;tR;cb;iR;eR;sR;ea;LL;$l;sa;na;oa;ra;mu;Gh;Qt;St;Uc;iP;eP;gc;$t;static fb=null;static AL=new m;static bM;static kM=null;gu;ub;db;gb;pb;yb;qm;PM;Wm;Jm;$m;ix;SM;MM;Vc;constructor(e,i){if(vt.dw||(vt.Yk(),vt.dw=!0),u.Gi(this),vt.TL(this),this.jt=!0,this.St=null,this.xt=0,this.bt=0,this.ft=null,vt.isUsingDOM()){const e=this,i=()=>{e.Pi(t.document,"DOMContentLoaded",i,!1),e.setRTL()};null!==t.document.body?this.setRTL():e.Bt(t.document,"DOMContentLoaded",i,!1)}this.Ec=null,vt.NM("Model",He);const s=this;return this.oM=t=>s.partManager.doModelDataChanged(t),this.rM=t=>s.partManager.doModelChanged(t),this.lb=null,this.hb=null,this.DL(),this.model=ti.CM(),this.themeManager=new Vi,this.Co=!0,this.FL(),this.layout=new ze,this.Co=!1,this.QF=null,this._F=null,this.tR=null,this.cb=null,this.iR=null,this.eR=null,this.sR=null,this.ea=null,this.LL=null,this.$l=null,this.sa=null,this.na=null,this.oa=null,this.ra=null,this.mu=()=>{},this.Gh=null,this.Bu=!1,this.Uc=new xt(this),void 0!==e&&("string"==typeof e||t.Element&&e instanceof Element?this.LM(e):i=e),i&&this.setProperties(i),this.jt=!1,this.requestUpdate(),this}gF(){return null!==this.ft}get renderer(){return this.Oc}set renderer(e){if(this instanceof Pt)return;""===e&&(e="default");const i=e.toLowerCase(),s=this.Oc;if(i===s)return;this.Oc=i;let n=null;"default"===i||"canvas"===i?(n=this.ql.get("svg"),null!==n&&n.Tt.remove(),this.ft&&(this.Qt=this.ft.li),this.Qt.clearContextCache(!0)):"svg"===i?(this.ql.has("svg")?n=this.ql.get("svg"):(n=new Rt(this,t.document),this.addRenderer("svg",n)),null!==this.div&&this.div.appendChild(n.Tt),this.Qt=n.li,this.ft&&(this.ft.li.setTransform(this.Vi,0,0,this.Vi,0,0),this.ft.li.clearRect(0,0,this.xt,this.bt))):"debug"===i&&(this.ql.has("SVG")||(n=new Rt(this,t.document),this.addRenderer("SVG",n),n.Tt.style.backgroundColor="whitesmoke",null!==this.div&&this.div.after(n.Tt))),this.jt||this.redraw()}DL(){this.Vc=new h,this.setupRouters(),this.ds=new ht,this.ds.So(this),this.Wt=17,this.JS=!1,this.zu=!1,this.kx="default",this.Xt=new h,this.ql=new m,this.Oc="default",this.resetRenderingHints(),this.nR(),this.$t=1,this.at=new y(NaN,NaN).u(),this.ix=new y(NaN,NaN),this.tt=1,this.Gm=1,this.Px=new y(NaN,NaN).u(),this.Sx=NaN,this.Mx=1e-4,this.Nx=100,this.T=new k,this.Cx=new y(NaN,NaN).u(),this.Lx=new x(NaN,NaN,NaN,NaN).u(),this.Jh=new b(0,0,0,0).u(),this.jh=1,this.Ax=!1,this.Tx=null,this.Dx=null,this.Gl=1,this.Fc=w.Default,this.Pr=1,this.Om=w.Default,this.Fx=w.None,this.Rx=w.None,this.Be=!0,this.Du=!1,this.Yn=new Set,this.Sr=new u,this.$h=new u,this.No=!1,this.Jl=new m,this.Uu=!0,this.Im=250,this.Rc=-1,this.Em=new b(16,16,16,16).u(),this.wr=!1,this.vc=!1,this.Fu=!0,this.Km=new T,this.Km.diagram=this,this.Br=new T,this.Br.diagram=this,this.Qh=new T,this.Qh.diagram=this,this.Mr=null,this.Kn=null,this.Ew=!1,this.oR(),this.Vr=new u,this.vx=!0,this.Ox=1,this.QS=!1,this.Ix=1,this.Ex="auto",this.Bm="auto",this.Nr=null,this.Cr=null,this.Lr=null,this.Ar=null,this.Tr=null,this.Dr=null,this.Bx=null,this.Fr=null,this.Ux=!1,this.Rr=null,this.vr=null,this.Or=null,this.Ir=null,this.Vx=!1,this.rb={},this.ia=[null,null],this.Co=!1,this.sM=!1,this.zx=!1,this.Xx=!1,this.nM=!0,this.ys=!1,this.ta=!1,this.lM=!0,this.Os=-2,this.Wl=new m,this.Vu=new h,this.Lo=!1,this.Oi=!0,this.Yx=!0,this.Fl=!0,this.Rl=!0,this.Kx=!1,this.Gx=!0,this.vl=!0,this.Ol=!0,this.Il=!0,this.Hx=!0,this.El=!0,this.Bl=!0,this.Ul=!0,this.Vl=!0,this.zl=!0,this.Xl=!0,this.Yl=!0,this.jx=!0,this.qx=!0,this.hM=!1,this.Bc=!1,this.Ru=!0,this.vu=!0,this.Wx=!0,this.Jx=!0,this.$x=16,this.Zx=16,this.Um=!1,this.Qx=!1,this._x=0,this.tb=0,this.Zt=new b(5).u(),this.aM=(new u).u(),this.ib=999999999,this.cM=(new u).u(),this._h=!0,this.Ou=!0,this.Ic=!0,this.ln=!1,this.Gn=!1,this.Ur=!0,this.xl=!1,this.Hn=!1,this.NL=new u,this.yM=new u,this.Hl=null,this.fM=new v(8,8),this.uM=999,this.Vm=!1,this.iP=1,this.eP=0,this.Ui={scale:1,position:new y,bounds:new x,canvasSize:new v,newCanvasSize:new v,isScroll:!1},this.Ui.canvasSize=this.Ui.canvasSize,this.Ui.newCanvasSize=this.Ui.newCanvasSize,this.Ui.isScroll=!1,this.eb=new x(NaN,NaN,NaN,NaN).u(),this.Iu=new v(NaN,NaN).u(),this.zm=new x(NaN,NaN,NaN,NaN).u(),this.sb=!1,this.rR(),this.Ze=null,this.Eu=!1,this.gc=null,this.partManager=new He,this.toolManager=new V,this.toolManager.initializeStandardTools(),this.defaultTool=this.toolManager,this.currentTool=this.defaultTool,this.db=null,this.gb=new kt,this.pb=null,this.yb=null,this.ub=!1,this.gu=!1,this.commandHandler=new Ct,this.Jm=null,this.$m=y.Ok,this.SM=!1,this.Vi=1,this.kl=null,this.Fm=1,this.qm=0,this.PM=[0,0,0,0,0],this.Wm=0,this.Hm=1,this.wM=0,this.xM=new y,this.CL=500,this.Ym=new y,this.jm=!1}static RL=void 0!==t.document;static isUsingDOM(){return vt.RL}static useDOM(e){vt.RL=!!e&&void 0!==t.document}static Qe=new WeakMap;clear(){this.animationManager.stopAnimation(),this.model.clear(),vt.vL(),this.OL(!1),this.Vu.clear(),this.IL(),this.Hl=null,this.invalidateDocumentBounds(),this.ensureBounds(),this.S()}OL(t){this.animationManager.stopAnimation(!0),this.aM=(new u).u(),this.cM=(new u).u();const i=this.skipsUndoManager,s=null!==this.ki&&void 0!==this.ki;s&&(this.skipsUndoManager=!0);let n=null;null!==this.Ze&&(n=this.Ze.part,null!==n&&this.remove(n));const o=[],r=this.Xt.length;if(t){for(let t=0;t<r;t++){const e=this.Xt.r[t].parts;for(;e.next();){const t=e.value;t!==n&&null===t.data&&o.push(t)}}for(let t=0;t<o.length;t++){const e=o[t];this.remove(e)}}for(let e=0;e<r;e++)this.Xt.r[e].XF();return this.partManager.clear(),this.Yn.clear(),this.Sr.clear(),this.$h.clear(),this.Jl.clear(),this.Vr.clear(),this.gc=null,this.Vu.clear(),this.IL(),e.Rk=[],null!==n&&(this.add(n),this.partManager.parts.delete(n)),s&&(this.skipsUndoManager=i),o}static Zm=null;static wb="";static vL(){vt.Zm=null,vt.wb=""}static LE(){return null}reset(){this.clear(),this.jt=!0,this.DL(),this.themeManager=new Vi,this.Zl(),this.Co=!0,this.FL(),this.layout=new ze,this.Co=!1,this.model=ti.CM(),this.model.undoManager=new E,this.Bu=!1,this.jt=!1,this.S()}rR(){this.Er=new m,this.dM=(new Ce).add(new fe({stroke:"black",font:"10pt sans-serif"}).bind("text","",e.toString).theme("stroke","text").theme("font","normal")),this.Er.set("",this.dM),this.Er.set("Comment",(new Ce).add(new fe({stroke:"brown",font:"10pt sans-serif"}).bind("text","",e.toString).theme("stroke","comment").theme("font","normal"))),this.Er.set("LinkLabel",new Ce({selectable:!1,avoidable:!1}).add(new he("Ellipse",{fill:"black",stroke:null,desiredSize:new v(3,3).$()}).theme("fill","link"))),this.Zh=new m,this.pM=new _e(ie.Vertical,{selectionObjectName:"GROUPPANEL"}).add(new fe({stroke:"black",font:"bold 12pt sans-serif"}).bind("text","",e.toString).theme("stroke","text").theme("font","bold"),new ie(ie.Auto,{name:"GROUPPPANEL"}).add(new he({fill:"rgba(128,128,128,0.2)",stroke:"black",strokeWidth:1}).theme("fill","group").theme("stroke","outline").theme("strokeWidth","group"),new Ve({padding:5}).theme("padding","group"))),this.Zh.set("",this.pM),this.jl=new m,this.gM=(new De).add(new he({isPanelMain:!0,stroke:"black"}).theme("stroke","link"),new he({toArrow:"Standard",fill:"black",stroke:null,strokeWidth:0}).theme("toArrow").theme("fill","link")),this.jl.set("",this.gM),this.jl.set("Comment",(new De).add(new he({isPanelMain:!0,stroke:"brown"}).theme("stroke","comment"))),this.Xm=new Pe(ie.Auto).add(new he({fill:null,stroke:"dodgerblue",strokeWidth:3}).theme("stroke","selection").theme("strokeWidth","selection"),new Ve({margin:1.5}).theme("margin","selection","numbers",null,(t=>t?new b(t/2):1.5))),this.nb=this.Xm,this.ob=new Pe(ie.Link).add(new he({isPanelMain:!0,fill:null,stroke:"dodgerblue",strokeWidth:3}).theme("stroke","selection").theme("strokeWidth","selection"))}setRTL(i){let s=void 0===i?this.div:i;null===s&&(s=t.document.body);const n=e.hs("div");n.dir="rtl",n.style.cssText="font-size: 14px; width: 1px; height: 1px; position: absolute; top: -1000px; overflow: scroll;",n.textContent="A",s.appendChild(n);let o="reverse";n.scrollLeft>0?o="default":(n.scrollLeft=1,0===n.scrollLeft&&(o="negative")),s.removeChild(n),this.kx=o}setScrollWidth(i){let s=void 0===i?this.div:i;null===s&&(s=t.document.body);let n=0;if(vt.isUsingDOM()){let t=vt.kM,i=vt.bM;null===t&&(vt.kM=e.hs("p"),t=vt.kM,t.style.width="100%",t.style.height="200px",t.style.boxSizing="content-box",vt.bM=e.hs("div"),i=vt.bM,i.style.position="absolute",i.style.visibility="hidden",i.style.width="200px",i.style.height="150px",i.style.boxSizing="content-box",i.appendChild(t)),i.style.overflow="hidden",s.appendChild(i);const o=t.offsetWidth;i.style.overflow="scroll";let r=t.offsetWidth;o===r&&(r=i.clientWidth),s.removeChild(i),n=o-r,0===n&&!e._o&&(n=11)}this.Wt=n,this.JS=!0}oi(t){t in gt?this.autoScale=t:e.ir(this,t)}toString(t){void 0===t&&(t=0);let e="";this.div&&this.div.id&&(e=this.div.id);let i='Diagram "'+e+'"';if(t<=0)return i;const s=this.Xt.iterator;for(;s.next();){const e=s.value;i+="\n  "+e.toString(t-1)}return i}static TL(t){vt.fb=t}static um(){return vt.fb}static fromDiv(e){let i=e;if("string"==typeof e&&(i=t.document.getElementById(e)),i instanceof HTMLDivElement){const t=vt.Qe.get(i);if(t)return t}return null}get div(){return this.St}set div(e){if(this.St!==e){const i=this.St;if(null!==i){if(vt.Qe.delete(i),i.goDiagram=void 0,i.go=void 0,i.innerHTML="",null!==this.ft){const t=this.ft.Tt;this.Pi(t,"pointermove",this.sa,!1),this.Pi(t,"pointerdown",this.$l,!1),this.Pi(t,"pointerup",this.na,!1),this.Pi(t,"pointerout",this.oa,!1),this.Pi(t,"pointercancel",this.ra,!1),this.ft.dispose()}this.Ec&&(this.Ec.disconnect(),this.Ec=null);const e=this.toolManager;null!==e&&(e.mouseDownTools.each((t=>t.cancelWaitAfter())),e.mouseMoveTools.each((t=>t.cancelWaitAfter())),e.mouseUpTools.each((t=>t.cancelWaitAfter()))),e.cancelWaitAfter(),this.currentTool.doCancel(),this.ft=null,this.Pi(t,"resize",this.cb,!1),this.Pi(t,"wheel",this.ea,!0),vt.um()===this&&vt.TL(null)}else null===this.$l&&(this.Hn=!1);if(this.St=null,null!==e){const t=vt.Qe.get(e);t&&(t.div=null),this.LM(e),this.mu(),this.themeManager&&this.themeManager.lR()}else this.themeManager&&this.themeManager.hR()}}setupRouters(){this.Vc.push(new ji)}LM(i){const s=this;if(!vt.isUsingDOM())return;null==i&&e.o("Diagram setup requires an argument DIV."),null!==s.St&&e.o("Diagram has already completed setup."),"string"==typeof i?s.St=t.document.getElementById(i):i instanceof HTMLDivElement?s.St=i:e.o("No DIV or DIV id supplied: "+i),null===s.St&&e.o("Invalid DIV id; could not get element with id: "+i);const n=vt.Qe.get(s.St);if(n&&n!==this&&e.o("Invalid div id; div already has a Diagram associated with it."),!s.Ec&&t.ResizeObserver){const i=t.ResizeObserver,n=e.Fk((()=>s.requestUpdate()),250,!1);s.Ec=new i((()=>n())),s.Ec.observe(s.St)}"static"===t.getComputedStyle(s.St,null).position&&(s.St.style.position="relative");let o=5;const r="rgba(2"+o+"5, 255, 255, 0)";o--,s.St.style["-webkit-tap-highlight-color"]=r,s.St.innerHTML="",vt.Qe.set(s.St,s),s.St.goDiagram=s,s.St.go=t.go;const a=new Bt(s);void 0!==a.style&&(a.style.position="absolute",a.style.top="0px",a.style.left="0px","rtl"===t.getComputedStyle(s.St,null).getPropertyValue("direction")&&(s.zu=!0),a.style.zIndex="2",a.style.userSelect="none",a.style.MozUserSelect="none",a.style.touchAction="none",a.style.letterSpacing="normal !important",a.style.wordSpacing="normal !important",a.style.lang="unknown"),s.ft=a,s.Qt=a.li;const h=s.Qt;s.Vi=s.computePixelRatio(),s.viewSize.isReal()||(s.xt=s.St.clientWidth||1,s.bt=s.St.clientHeight||1),s.EL(s.xt,s.bt);const l=s;s.St.insertBefore(a.Tt,s.St.firstChild);const u=new Bt(null);if(u.width=1,u.height=1,s.$F=u,s.ZF=u.li,vt.isUsingDOM()){const t=e.hs("div"),i=e.hs("div");t.style.position="absolute",t.style.overflow="auto",t.style.width=s.xt+"px",t.style.height=s.bt+"px",t.style.zIndex="1",i.style.position="absolute",i.style.width="1px",i.style.height="1px",s.St.appendChild(t),t.appendChild(i),t.onscroll=vt.aR,t.addEventListener("pointerdown",vt.cR),t.N=s,t.fR=!0,t.uR=!0,s.lb=t,s.hb=i}s.mu=e.Fk((()=>{s.kl=null,s.S()}),300,!1),s.cb=e.Fk((()=>{s.OS()}),250,!1),s.Gh=t=>(t.preventDefault(),!1),s.ea=t=>{if(!l.isEnabled)return;const e=l.zc(t,!0);e.bubbles=!0;let i=0,s=0;e.delta=0,void 0!==t.deltaX?(0!==t.deltaX&&(i=t.deltaX>0?1:-1),0!==t.deltaY&&(s=t.deltaY>0?1:-1),e.delta=Math.abs(t.deltaX)>Math.abs(t.deltaY)?-i:-s):void 0!==t.wheelDeltaX?(0!==t.wheelDeltaX&&(i=t.wheelDeltaX>0?-1:1),0!==t.wheelDeltaY&&(s=t.wheelDeltaY>0?-1:1),e.delta=Math.abs(t.wheelDeltaX)>Math.abs(t.wheelDeltaY)?-i:-s):void 0!==t.wheelDelta&&0!==t.wheelDelta&&(e.delta=t.wheelDelta>0?1:-1),l.doMouseWheel(),l.la(e,t)},s.LL=t=>{if(!l.isEnabled)return;s.Bc=!1,l.zc(t,!0);const e=l.currentTool;e.cancelWaitAfter(),e.standardMouseOver()},s.$l=t=>{if(!l.isEnabled)return;s.Bc=!0;const e=l.rb;void 0===e[t.pointerId]&&(e[t.pointerId]=t);const i=l.ia;let n=!1;if(null===i[0]||i[0].pointerId!==t.pointerId&&i[0].pointerType===t.pointerType)if(null!==i[1]&&i[1].pointerId===t.pointerId)i[1]=t,n=!0;else if(null===i[0])i[0]=t;else{if(null!==i[1])return void t.preventDefault();i[1]=t,n=!0}else i[0]=t;const o="touch"===t.pointerType||"pen"===t.pointerType;o&&(l.Ew=!1,l.jm=!0);const r=l.dR(t,t,n),a=l.xM,h=o?25:10;t.timeStamp-l.wM<l.CL&&!(Math.abs(a.x-t.screenX)>h||Math.abs(a.y-t.screenY)>h)?l.Hm++:l.Hm=1,r.clickCount=l.Hm,l.wM=t.timeStamp,l.xM.setTo(t.screenX,t.screenY),l.doMouseDown(),1!==t.button?l.la(r,t):t.preventDefault()},s.sa=t=>{if(!l.isEnabled)return;s.Bc=!0;const e=l.ia;if(null===e[0]||e[0].pointerId!==t.pointerId&&e[0].pointerType===t.pointerType){if(null!==e[1]&&e[1].pointerId===t.pointerId)return void(e[1]=t);if(null!==e[0])return;e[0]=t}else e[0]=t;if(e[0].pointerId!==t.pointerId)return;const i=l.gR(t,t,null!==e[1]);l.doMouseMove(),l.la(i,t)},s.na=e=>{if(!l.isEnabled)return;s.Bc=!0;const i="touch"===e.pointerType||"pen"===e.pointerType,n=l.rb;if(i&&l.Ew)return delete n[e.pointerId],void e.preventDefault();const o=l.ia;if(null===o[0]||o[0].pointerId!==e.pointerId&&o[0].pointerType===e.pointerType)return null!==o[1]&&o[1].pointerId===e.pointerId?void(o[1]=null):void 0;o[0]=null;const r=l.AM(e,!1,!0,!1,!0,!1);let a=t.document.elementFromPoint(e.clientX,e.clientY)||null;null!==a&&void 0!==a.shadowRoot&&null!==a.shadowRoot&&(a=a.shadowRoot.elementFromPoint(e.clientX,e.clientY)),null!==a&&a.N instanceof vt&&a.N!==l&&a.N.Qm(e,r),null===a&&(a=e.target),l.Qm(e,r),r.clickCount=l.Hm,r.targetDiagram=l.xb(e,a),r.targetObject=null,l.doMouseUp(),l.la(r,e),i&&(l.jm=!1)},s.oa=t=>{if(!l.isEnabled)return;s.Bc=!1;const e=l.rb;e[t.pointerId]&&delete e[t.pointerId];const i=l.ia;if(null!==i[0]&&i[0].pointerId===t.pointerId&&(i[0]=null),null!==i[1]&&i[1].pointerId===t.pointerId&&(i[1]=null),"touch"===t.pointerType||"pen"===t.pointerType)return;const n=l.currentTool;n.cancelWaitAfter(),n.standardMouseOver()},s.ra=t=>{const e=l.ia;null!==e[0]&&e[0].pointerId===t.pointerId?(e[0]=null,l.jm=!1):null!==e[1]&&e[1].pointerId===t.pointerId&&(e[1]=null)};const c=h;if(s.ab=c.E[e.Ts("7eba17a4ca3b1a8346")][e.Ts("78a118b7")](c.E,vt.Xu,o,o),h.clearContextCache(!0),s.mR(),"svg"===this.Oc){const t=this.ql.get("svg");this.St&&this.St.appendChild(t.Tt),this.Qt=t.li}}addEventListener(t,e,i,s){t.addEventListener(e,i,{capture:s,passive:!1})}Bt(t,e,i,s){t.addEventListener(e,i,{capture:s,passive:!1})}removeEventListener(t,e,i,s){t.removeEventListener(e,i,{capture:s})}Pi(t,e,i,s){t.removeEventListener(e,i,{capture:s})}mR(){const e=this;let i=this.ft.Tt;i instanceof HTMLCanvasElement||(i=e.div),this.Bt(i,"pointerdown",e.$l,!1),this.Bt(i,"pointermove",e.sa,!1),this.Bt(i,"pointerup",e.na,!1),this.Bt(i,"pointerout",e.oa,!1),this.Bt(i,"pointercancel",e.ra,!1),this.Bt(i,"pointerenter",e.pR,!1),this.Bt(i,"pointerleave",e.yR,!1),this.Bt(i,"wheel",e.ea,!1),this.Bt(i,"keydown",e.wR,!1),this.Bt(i,"keyup",e.xR,!1),this.Bt(i,"blur",e.bR,!1),this.Bt(i,"focus",e.kR,!1),this.Bt(i,"selectstart",(t=>(t.preventDefault(),!1)),!1),this.Bt(i,"contextmenu",(t=>(t.preventDefault(),!1)),!1),this.Bt(t,"resize",e.cb,!1)}Bw(){this.qm>30&&(this.kl=1)}NP(t){null!==this.kl&&(this.kl=null,t&&this.mu(),this.qm=0,this.PM=[0,0,0,0,0],this.Wm=0)}computePixelRatio(){return null!==this.kl?this.kl:t.devicePixelRatio||1}get avgSpf(){return this.qm}doMouseDown(){this.currentTool.doMouseDown()}doMouseMove(){this.currentTool.doMouseMove()}doMouseUp(){this.currentTool.doMouseUp()}doMouseWheel(){this.currentTool.doMouseWheel()}doKeyDown(){this.currentTool.doKeyDown()}doKeyUp(){this.currentTool.doKeyUp()}doFocus(){this.focus()}focus(){if(this.ft)if(this.scrollsPageOnFocus)this.ft.focus();else{const e=t.scrollX,i=t.scrollY;this.ft.focus(),t.scrollTo(e,i)}}kR(t){const e=vt.Qe.get(this);e&&e.D("GainedFocus")}bR(t){const e=vt.Qe.get(this);e&&e.D("LostFocus")}OS(){if(null===this.ft)return;const t=this.St;if(null===t||0===t.clientWidth||0===t.clientHeight)return;this.JS||this.setScrollWidth();const e=this.Gn?this.Wt:0,i=this.ln?this.Wt:0,s=this.Vi;if(this.Vi=this.computePixelRatio(),this.Vi!==s&&(this.Du=!0,this.requestUpdate()),t.clientWidth!==this.xt+e||t.clientHeight!==this.bt+i){this.ha(),this.Be=!0;const t=this.layout;null!==t&&t.isViewportSized&&1===this.autoScale&&(this.vc=!0,t.invalidateLayout()),this.ys||this.requestUpdate()}}FL(){let t=0,e=new ft;e.name="Grid",e.allowSelect=!1,e.pickable=!1,e.isTemporary=!0,e.isInDocumentBounds=!1,this.zr(e,t++),e=new ft,e.name="ViewportBackground",e.isViewportAligned=!0,e.isTemporary=!0,e.isInDocumentBounds=!1,this.zr(e,t++),e=new ft,e.name="Background",this.zr(e,t++),e=new ft,e.name="",this.zr(e,t++),e=new ft,e.name="Foreground",this.zr(e,t++),e=new ft,e.name="ViewportForeground",e.isViewportAligned=!0,e.isTemporary=!0,e.isInDocumentBounds=!1,this.zr(e,t++),e=new ft,e.name="Adornment",e.isTemporary=!0,e.isInDocumentBounds=!1,this.zr(e,t++),e=new ft,e.name="Tool",e.isTemporary=!0,e.isInDocumentBounds=!0,this.zr(e,t++)}BL(){const t=new ie(ie.Grid,{name:"GRID"}).add(new he("LineH",{stroke:"lightgray",strokeWidth:.5,interval:1}).theme("stroke","gridMinor"),new he("LineV",{stroke:"lightgray",strokeWidth:.5,interval:1}).theme("stroke","gridMinor"),new he("LineH",{stroke:"gray",strokeWidth:.5,interval:5}).theme("stroke","gridMajor"),new he("LineV",{stroke:"gray",strokeWidth:.5,interval:5}).theme("stroke","gridMajor"),new he("LineH",{stroke:"gray",strokeWidth:1,interval:10}).theme("stroke","gridMajor"),new he("LineV",{stroke:"gray",strokeWidth:1,interval:10}).theme("stroke","gridMajor")),e=new ke({layerName:"Grid",zOrder:0,isInDocumentBounds:!1,isAnimated:!1,pickable:!1,locationObjectName:"GRID"}).add(t);return this.add(e),this.partManager.parts.delete(e),t.visible=!1,t}static aR(){const t=vt.Qe.get(this.parentElement||this);if(t){if(t.Qx)return void(t.Qx=!1);if(!t.isEnabled)return void t.UL();t.diagramScroll(this)}}static cR(t){this.N.isEnabled?(this.N._x=t.target.scrollTop,this.N.tb=t.target.scrollLeft):this.N.updateScroll()}diagramScroll(t){if(null===this.ft)return;const e=this.lb,i=this.hb;this.Um=!0;let s=this.documentBounds,n=this.viewportBounds;const o=this.Jh;let r=s.x-o.left,a=s.y-o.top;const h=s.width+o.left+o.right,l=s.height+o.top+o.bottom;let u=s.right+o.right,c=s.bottom+o.bottom,d=n.x,f=n.y;const g=n.width,p=n.height;let m=n.right,v=n.bottom;const x=this.scale;let b,w=t.scrollLeft;if(this.zu)switch(this.kx){case"negative":w=w+t.scrollWidth-t.clientWidth;break;case"reverse":w=t.scrollWidth-w-t.clientWidth;break}const k=w;if(g<h||p<l)return b=y.V(this.position.x,this.position.y),this.allowHorizontalScroll&&this.tb!==k&&(b.x=k/x+r,this.tb=k),this.allowVerticalScroll&&this._x!==t.scrollTop&&(b.y=t.scrollTop/x+a,this._x=t.scrollTop),this.position=b,y.e(b),this.Um=!1,void(this.Ou=!1);if(b=y.l(),t.fR&&this.allowHorizontalScroll&&(r<d&&(this.position=b.i(k+r,this.position.y)),u>m)){const t=e.scrollWidth-this.xt;this.position=b.i(-t+k-this.xt/x+u,this.position.y)}if(t.uR&&this.allowVerticalScroll&&(a<f&&(this.position=b.i(this.position.x,t.scrollTop+a)),c>v)){const i=e.scrollHeight-this.bt;this.position=b.i(this.position.x,-i+t.scrollTop-this.bt/x+c)}y.e(b),this.Ql(),this.Um=!1,this.Ou=!1,s=this.documentBounds,n=this.viewportBounds,u=s.right,m=n.right,c=s.bottom,v=n.bottom,r=s.x,d=n.x,a=s.y,f=n.y,g>=h&&r>=d&&u<=m&&(i.style.width="1px"),p>=l&&a>=f&&c<=v&&(i.style.height="1px")}computeBounds(t){return void 0===t&&(t=new x),this.Mi(),this.VL(t)}VL(t){if(this.fixedBounds.isReal())return t.a(this.fixedBounds),t.addMargin(this.Zt),t;let e=!0;const i=this.Xt.r,s=i.length;for(let n=0;n<s;n++){const s=i[n];if(!s.visible||!s.isInDocumentBounds)continue;const o=s.Ct.r,r=o.length;for(let i=0;i<r;i++){const s=o[i];if(!s.isInDocumentBounds||!s.isVisible())continue;const n=s.actualBounds;n.isReal()&&(e?(e=!1,t.a(n)):t.unionRect(n))}}return e&&t.i(0,0,0,0),t.addMargin(this.Zt),t}computePartsBounds(t,e){void 0===e&&(e=!1);let i=null;if(Array.isArray(t))for(let s=0;s<t.length;s++){const n=t[s];!e&&n instanceof De||(n.ensureBounds(),null===i?i=n.actualBounds.copy():i.unionRect(n.actualBounds))}else{const s=t.iterator;for(;s.next();){const t=s.value;!e&&t instanceof De||(t.ensureBounds(),null===i?i=t.actualBounds.copy():i.unionRect(t.actualBounds))}}return null===i?new x(NaN,NaN,0,0):i}Us(t){if(!t&&!this.Hn||this.jt||null===this.ft||!this.documentBounds.isReal())return;if(this.jt=!0,t){const t=this.initialPosition;if(t.isReal())return this.jt=!1,void(this.position=t);let e=this.initialDocumentSpot,i=this.initialViewportSpot;e.isNoSpot()&&(e=w.TopLeft),i.isNoSpot()&&(i=w.TopLeft);const s=y.l();s.setRectSpot(this.documentBounds,e);const n=this.viewportBounds,o=x.V(0,0,n.width,n.height),r=y.l();r.setRectSpot(o,i),r.i(s.x-r.x,s.y-r.y),this.jt=!1,this.position=r,x.e(o),y.e(r)}let e=this.Gl;t&&1!==this.Pr&&(e=this.Pr);const i=1!==e?this.Yu(e):this.scale,s=this.at.x,n=this.at.y,o=this.xt/i,r=this.bt/i;let a=this.Fc;const h=this.Om;if(t&&!a.isSpot()&&(h.isSpot()||h.isDefault())){const t=this.initialDocumentSpot.isSpot()&&this.initialViewportSpot.isSpot();a=h.isDefault()&&!t?w.Center:h}this.TM(this.documentBounds,o,r,a,t);const l=this.scale;this.scale=i,this.jt=!1;const u=this.viewportBounds;u.equalsApproxTo(s,n,o,r)||this.onViewportBoundsChanged(new x(s,n,o,r),u,l,!1)}Yu(t){const e=this.Gm;if(null===this.ft)return e;if(1===t)return this.scale;this.ensureBounds();const i=this.documentBounds;if(!i.isReal())return e;const s=i.width,n=i.height,o=this.xt+(this.Gn?this.Wt:0),r=this.bt+(this.ln?this.Wt:0);let a=o/s,h=r/n;const l=this.Jh,u=l.left+l.right!==0,c=l.top+l.bottom!==0;(u||c)&&(h===a?(h=(r-this.Wt)/n,a=(o-this.Wt)/s):h>a?h=(r-this.Wt)/n:a=(o-this.Wt)/s);let d=0;return 2===t?d=Math.min(h,a):3===t&&(d=h>a?(r-this.Wt)/n:(o-this.Wt)/s),d>e&&(d=e),d<this.minScale&&(d=this.minScale),d>this.maxScale&&(d=this.maxScale),d}zoomToFit(){const t=this.jh;this.jh=1,this.scale=this.Yu(2),this.alignDocument(w.Center,w.Center),1!==t&&(this.Us(!1),this.TM(this.documentBounds,this.xt/this.tt,this.bt/this.tt,this.Fc,!1)),this.jh=t}zoomToRect(t,e){void 0===e&&(e=2);const i=t.width,s=t.height;if(0===i||0===s||isNaN(i)&&isNaN(s))return;let n=1;if(2===e||3===e)if(isNaN(i))n=this.viewportBounds.height*this.scale/s;else if(isNaN(s))n=this.viewportBounds.width*this.scale/i;else{const t=this.xt,o=this.bt;n=3===e?o/s>t/i?(o-(this.ln?this.Wt:0))/s:(t-(this.Gn?this.Wt:0))/i:Math.min(o/s,t/i)}this.scale=n,this.position=new y(t.x,t.y)}get PR(){return this.jt}set PR(t){this.jt=t}alignDocument(t,e){this.ensureBounds();const i=this.documentBounds,s=this.viewportBounds;this.position=new y(i.x+(t.x*i.width+t.offsetX)-(e.x*s.width-e.offsetX),i.y+(t.y*i.height+t.offsetY)-(e.y*s.height-e.offsetY))}focusObject(t){if(t instanceof Tt){this.Jm=t;const e=y.l();this.$m=this.transformDocToView(t.getDocumentPoint(w.TopLeft,e)),y.e(e)}else this.Jm=null,this.$m=y.Ok}TM(t,e,i,s,n){const o=y.V(this.at.x,this.at.y);let r=o.x,a=o.y;if(null!==this.Jm){let t=y.l();t=this.Jm.getDocumentPoint(w.TopLeft,t),r=t.x-this.$m.x/this.scale,a=t.y-this.$m.y/this.scale,s=w.None,y.e(t)}if(n||1===this.scrollMode){s.isSpot()&&(e>t.width&&(r=t.x+(s.x*t.width+s.offsetX)-(s.x*e-s.offsetX)),i>t.height&&(a=t.y+(s.y*t.height+s.offsetY)-(s.y*i-s.offsetY)));const n=this.Jh,o=e-t.width;if(e<t.width+n.left+n.right){let i=r+e/2;i=Math.min(i,t.right+Math.max(o,n.right)-e/2),i=Math.max(i,t.left-Math.max(o,n.left)+e/2),r=i-e/2}else r>t.left?r=t.left:r<t.right-e&&(r=t.right-e);const h=i-t.height;if(i<t.height+n.top+n.bottom){let e=a+i/2;e=Math.min(e,t.bottom+Math.max(h,n.bottom)-i/2),e=Math.max(e,t.top-Math.max(h,n.top)+i/2),a=e-i/2}else a>t.top?a=t.top:a<t.bottom-i&&(a=t.bottom-i)}if(o.x=isFinite(r)?r:-this.Zt.left,o.y=isFinite(a)?a:-this.Zt.top,null!==this.positionComputation){const t=this.positionComputation(this,o);o.x=t.x,o.y=t.y}this.ds.pL(this.at,o),this.at.i(o.x,o.y),this.bb(),this.Zl(),this.SR(),y.e(o)}findPartAt(t,e){if(void 0===e&&(e=!0),e){const e=this.DP(t,(t=>t.part),(t=>t.canSelect()));if(e instanceof ke)return e}else{const e=this.DP(t,(t=>t.part));if(e instanceof ke)return e}return null}findObjectAt(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null),this.Mi();const s=this.Xt.iteratorBackwards;for(;s.next();){const n=s.value;if(!n.visible)continue;const o=n.findObjectAt(t,e,i);if(null!==o)return o}return null}DP(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null),this.Mi();const s=this.Xt.iteratorBackwards;for(;s.next();){const n=s.value;if(!n.visible||n.isTemporary)continue;const o=n.findObjectAt(t,e,i);if(null!==o)return o}return null}findPartsAt(t,e,i){return void 0===e&&(e=!0),this.MR(t,(t=>t.part),e?t=>t instanceof ke&&t.canSelect():null,i)}MR(t,e,i,s){void 0===e&&(e=null),void 0===i&&(i=null),!(s instanceof h)&&!(s instanceof u)&&(s=new u),this.Mi();const n=this.Xt.iteratorBackwards;for(;n.next();){const o=n.value;!o.visible||o.isTemporary||o.findObjectsAt(t,e,i,s)}return s}findObjectsAt(t,e,i,s){void 0===e&&(e=null),void 0===i&&(i=null),!(s instanceof h)&&!(s instanceof u)&&(s=new u),this.Mi();const n=this.Xt.iteratorBackwards;for(;n.next();){const o=n.value;o.visible&&o.findObjectsAt(t,e,i,s)}return s}findPartsIn(t,e,i,s){return void 0===e&&(e=!1),void 0===i&&(i=!0),this.NR(t,null,(t=>t instanceof ke&&(!i||t.canSelect())),e,s)}findObjectsIn(t,e,i,s,n){void 0===e&&(e=null),void 0===i&&(i=null),void 0===s&&(s=!1),!(n instanceof h)&&!(n instanceof u)&&(n=new u),this.Mi();const o=this.Xt.iteratorBackwards;for(;o.next();){const r=o.value;r.visible&&r.findObjectsIn(t,e,i,s,n)}return n}vP(t,e,i,s,n,o){const r=new u;this.Mi();const a=this.Xt.iteratorBackwards;for(;a.next();){const h=a.value;h.visible&&h.vP(t,e,i,s,r,n,o)}return r}NR(t,e,i,s,n){void 0===e&&(e=null),void 0===i&&(i=null),void 0===s&&(s=!1),!(n instanceof h)&&!(n instanceof u)&&(n=new u),this.Mi();const o=this.Xt.iteratorBackwards;for(;o.next();){const r=o.value;!r.visible||r.isTemporary||r.findObjectsIn(t,e,i,s,n)}return n}findPartsNear(t,e,i,s,n){return void 0===i&&(i=!0),void 0===s&&(s=!0),this.CR(t,e,null,(t=>t instanceof ke&&(!s||t.canSelect())),i,n)}findObjectsNear(t,e,i,s,n,o){void 0===i&&(i=null),void 0===s&&(s=null),void 0===n&&(n=!0),!1!==n&&!0!==n&&((n instanceof h||n instanceof u)&&(o=n),n=!0),!(o instanceof h)&&!(o instanceof u)&&(o=new u),this.Mi();const r=this.Xt.iteratorBackwards;for(;r.next();){const a=r.value;a.visible&&a.findObjectsNear(t,e,i,s,n,o)}return o}CR(t,e,i,s,n,o){void 0===i&&(i=null),void 0===s&&(s=null),void 0===n&&(n=!0),!1!==n&&!0!==n&&((n instanceof h||n instanceof u)&&(o=n),n=!0),!(o instanceof h)&&!(o instanceof u)&&(o=new u),this.Mi();const r=this.Xt.iteratorBackwards;for(;r.next();){const a=r.value;!a.visible||a.isTemporary||a.findObjectsNear(t,e,i,s,n,o)}return o}acceptEvent(t){return this.zc(t,t instanceof MouseEvent)}zc(t,i){const s=this.Br;this.Br=this.Qh,this.Qh=s,s.diagram=this,s.event=t,i?this.Qm(t,s):(s.viewPoint=this.Br.viewPoint,s.documentPoint=this.Br.documentPoint);let n=0;const o=t;return o.ctrlKey&&(n+=1),o.altKey&&(n+=2),o.shiftKey&&(n+=4),o.metaKey&&(n+=8),s.modifiers=n,s.button=o.button,void 0!==o.buttons&&(s.buttons=o.buttons),e._o&&0===o.button&&o.ctrlKey&&(s.button=2),s.down=!1,s.up=!1,s.clickCount=1,s.delta=0,s.handled=!1,s.bubbles=!1,s.timestamp=t.timeStamp,s.isMultiTouch=!1,s.targetDiagram=this.xb(t,t.target),s.targetObject=null,s}xb(t,i){if(null===i)return null;const s=vt.Qe.get(i);if(s)return s;let n=t.path;if(!n&&e.it(t.composedPath)&&(n=t.composedPath()),n&&n[0]){const t=vt.Qe.get(n[0]);if(t)return t}return null}dR(t,e,i){const s=this.AM(t,!0,!1,!1,!0,i);return this.Qm(e,s),s.targetDiagram=this.xb(t,t.target),s.targetObject=null,i||s.clone(this.Km),s}gR(e,i,s){const n=this.AM(e,!1,!1,!1,!1,s);let o=t.document.elementFromPoint(i.clientX,i.clientY)||null;null!==o&&void 0!==o.shadowRoot&&null!==o.shadowRoot&&(o=o.shadowRoot.elementFromPoint(i.clientX,i.clientY));let r=this,a=e;if(o){const t=this.xb(e,o);t&&(a=i,r=t)}return n.targetDiagram=r,this.Qm(a,n),n.targetObject=null,n}AM(t,i,s,n,o,r){const a=this.Br;this.Br=this.Qh,this.Qh=a,a.diagram=this,a.clickCount=1,a.delta=0;let h=0;return t.ctrlKey&&(h+=1),t.altKey&&(h+=2),t.shiftKey&&(h+=4),t.metaKey&&(h+=8),a.modifiers=h,a.event=t,a.timestamp=t.timeStamp,a.button=s?this.firstInput.button:t.button,a.buttons=t.buttons,e._o&&0===t.button&&t.ctrlKey&&(a.button=2),a.down=i,a.up=s,a.handled=n,a.bubbles=o,a.isMultiTouch=r,a}la(t,e){return!!t.bubbles||(void 0!==e.stopPropagation&&e.stopPropagation(),!1!==e.cancelable&&e.preventDefault(),e.cancelBubble=!0,!1)}wR(t){const e=vt.Qe.get(this);if(!e||!e.isEnabled)return!1;const i=e.zc(t,!1);return i.key=t.key,i.code=t.code,i.down=!0,e.doKeyDown(),e.la(i,t)}xR(t){const e=vt.Qe.get(this);if(!e||!e.isEnabled)return!1;const i=e.zc(t,!1);return i.key=t.key,i.code=t.code,i.up=!0,e.doKeyUp(),e.la(i,t)}pR(t){const e=vt.Qe.get(this);if(!e||!e.isEnabled)return!1;const i=e.zc(t,!0);return null!==e.mouseEnter&&e.mouseEnter(i),e.currentTool.standardMouseOver(),e.la(i,t)}yR(t){const e=vt.Qe.get(this);if(!e||!e.isEnabled)return!1;const i=e.zc(t,!0);return null!==e.mouseLeave&&e.mouseLeave(i),e.la(i,t)}getMouse(t){const e=this.ft;if(null===e)return new y(0,0);const i=e.getBoundingClientRect(),s=(t.clientX-i.left)*(this.xt/i.width),n=(t.clientY-i.top)*(this.bt/i.height);return new y(s,n).Oe(this.T)}Qm(t,e){const i=this.ft;let s=0,n=0;if(null!==i){const e=i.getBoundingClientRect();s=(t.clientX-e.left)*(this.xt/e.width),n=(t.clientY-e.top)*(this.bt/e.height)}e.viewPoint.i(s,n);const o=y.V(s,n);this.T.$e(o),e.documentPoint.a(o),y.e(o)}UC(t,e,i){let s;if(null===this.ia[0])return;s=this.ia[e];const n=this.ft;if(null!==n){const t=n.getBoundingClientRect();i.i((s.clientX-t.left)*(this.xt/t.width),(s.clientY-t.top)*(this.bt/t.height))}}invalidateDocumentBounds(){this._h||(this._h=!0,this.requestUpdate(!1))}LR(){this.ys||this.Mi(),this.ensureBounds()}redraw(){this.jt||this.ys||(this.S(),this.maybeUpdate())}isUpdateRequested(){return this.wr}delayInitialization(t){void 0===t&&(t=null);const i=this.animationManager,s=i.isEnabled;i.stopAnimation(),i.isEnabled=!1,this.fr(),this.Hn=!1,this.ix=new y(NaN,NaN),i.isEnabled=s,this.ys=!0;const n=this;null!==t&&e.tr((()=>{n.ys=!1,i.Dl("Model"),t(n)}),1)}requestUpdate(e){if(void 0===e&&(e=!1),!0===this.wr||this.jt||!1===e&&this.ys)return;this.wr=!0;const i=this;t.requestAnimationFrame((()=>{i.wr&&i.maybeUpdate()}))}maybeUpdate(){this.Fu&&!this.wr||(this.Fu&&(this.Fu=!1),this.fr())}DM(t,e){!this.Ou||this.jt||this.animationManager.defaultAnimation.isAnimating||this.UL()||(t&&this.Mi(),e&&this.Us(!1))}fr(t){if(this.ys||(this.wr=!1,null===this.St&&!this.Iu.isReal()))return;this.ys=!0;const e=this.animationManager,i=this.Vu;if(!e.isAnimating&&0!==i.length){const t=i.r,e=t.length;for(let i=0;i<e;i++){const e=t[i];e.ue(!1),e.c()}i.clear()}const s=this.yM;s.count>0&&(s.each((t=>t.FM())),s.clear());let n=!1,o=!1;e.defaultAnimation.isAnimating&&(o=!0,n=this.skipsUndoManager,this.skipsUndoManager=!0),e.pi||this.OS(),t||this.DM(!1,!0);const r=!this.undoManager.isUndoingRedoing&&(this.xl||0!==this.Vc.count&&0!==this.Sr.size),a=!this.Hn||this.Ur;this.Mi(!0);let h=!1;(a||r)&&(this.Hn?this.RM(!this.vc,r):(this.startTransaction("Initial Layout"),!1===e.isEnabled&&e.stopAnimation(),this.RM(!1,r)),h=a),this.vc=!1,this.xl=!1,this.Mi(),null!==this.Ze&&(this.Ze.visible&&!this.Eu&&(this._l(),this.Eu=!0),!this.Ze.visible&&this.Eu&&(this.Eu=!1)),this.zx||this.LR(),t||this.DM(!0,!1);let l=!1;if(h){const e=x.l();e.a(this.viewportBounds),this.Hn||(this.Hn=!0,l=!0,this.skipsUndoManager||(this.undoManager.Ow=!0),this.undoManager.Iw=!0,this.AR()),this.TR(),this.Mi(!1),t||this.DM(!0,!0),x.e(e)}else if(e.Sc&&e.tx){if(1!==this.Pr)this.scale=this.Yu(this.Pr);else if(1!==this.Gl)this.scale=this.Yu(this.Gl);else{const t=this.initialScale;isFinite(t)&&t>0&&(this.scale=t)}this.Us(!0)}h&&l&&this.commitTransaction("Initial Layout"),t||this.Bi(this.Qt),o&&(this.skipsUndoManager=n),this.ys=!1}get Uh(){return this.Hn}AR(){if(1!==this.Pr)this.scale=this.Yu(this.Pr);else if(1!==this.Gl)this.scale=this.Yu(this.Gl);else{const t=this.initialScale;isFinite(t)&&t>0&&(this.scale=t)}this.Us(!0);const t=this.Xt.r;this.ps(t,t.length,this,this.viewportBounds),this.D("InitialLayoutCompleted"),this.ix.a(this.at),this._l()}TR(){this.D("LayoutCompleted")}_m(t){this.Yn.add(t)}addInvalidRoute(t){this.No?this.$h.add(t):this.Sr.add(t)}Mi(t){if(0!==this.Yn.size&&(this.ys||!this.animationManager.isTicking)){if(this.ys||(this.xl=!0),t)return void this.zL(this.Yn);for(let t=0;t<23&&0!==this.Yn.size;t++){const t=new Set(this.Yn);this.Yn.clear(),this.FM(t,this.Yn)}this.nodes.each((t=>{t instanceof _e&&t.XL(!1)}))}}zL(t,e){for(const i of t)!i.ke()||i instanceof _e||(i.Xr()?(i.ht(1/0,1/0),i.Ut()):e&&e.add(i));for(const i of t)if(i instanceof _e){if(!i.isVisible())continue;this.kb(i)}}FM(t,e){this.zL(t,e);for(const i of t){if(!(i instanceof De))continue;const t=i;t.isVisible()&&(t.Xr()?(t.ht(1/0,1/0),t.Ut()):e.add(t))}for(const i of t)i instanceof Pe&&i.isVisible()&&(i.Xr()?(i.ht(1/0,1/0),i.Ut()):e.add(i))}t0(t){const e=t instanceof vt,i=e?t.links:t.memberParts,s=this.Yn;if(e)this.Mi(!0);else{for(;i.next();){const t=i.value;s.has(t)&&(!t.ke()||t instanceof _e||t.Xr()&&(t.ht(1/0,1/0),t.Ut()))}for(i.reset();i.next();){const t=i.value;if(s.has(t)&&t instanceof _e){if(!t.isVisible())continue;this.kb(t)}}i.reset()}for(;i.next();){const t=i.value;t instanceof De&&s.has(t)&&t.isVisible()&&t.Xr()&&(t.ht(1/0,1/0),t.Ut())}}kb(t){const i=e.et(),s=e.et(),n=t.memberParts;for(;n.next();){const e=n.value;e.isVisible()&&(e instanceof _e?(e.Ao()||e._e()||e.th())&&this.kb(e):e instanceof De?e.fromNode===t||e.toNode===t?s.push(e):i.push(e):(e.ht(1/0,1/0),e.Ut()))}let o=i.length;for(let e=0;e<o;e++){const t=i[e];t.ht(1/0,1/0),t.Ut()}e.J(i),t.ht(1/0,1/0),t.Ut(),o=s.length;for(let e=0;e<o;e++){const t=s[e];t.ht(1/0,1/0),t.Ut()}e.J(s)}ps(t,e,i,s){if(this.Ic||this.animationManager.isAnimating){for(let n=0;n<e;n++)t[n].ps(i,s);this.Mi()}}Bi(t){null!==this.St&&(null===this.ft&&e.o("No canvas specified"),"svg"===this.Oc?this.DR(t):this.FR(t))}FR(t){const e=this.animationManager;if(e.pi||e.isAnimating&&!e.isTicking)return;const i=new Date;if(this.i0(),this.St&&"0"===this.St.style.opacity)return;const s=t!==this.Qt,n=this.Xt.r,o=n.length,r=this;if(this.ps(n,o,r,r.viewportBounds),s)t.clearContextCache(!0),this.Ql();else if(!this.Be&&!e.isAnimating)return;const a=this.T,h=this.Vi;t.setTransform(h,0,0,h,0,0),t.clearRect(0,0,this.xt,this.bt),1!==this.$t&&(t.globalAlpha=this.$t),this.vM(t);for(let f=0;f<o;f++)t.setTransform(h,0,0,h,0,0),t.transform(a.m11,a.m12,a.m21,a.m22,a.dx,a.dy),t.commitTransform(),n[f].Bi(t,r);let l=!1;this.Uc?this.Uc.Xu(this)&&(l=this.ab()):l=!0,l&&(k.prototype.$e=k.prototype.xw),s?(this.Qt.clearContextCache(!0),this.Ql()):(this.Ic=!1,this.Be=!1);const u=+new Date-+i,c=!1,d=this.PM;if(c||null===this.kl){d[this.Wm]=u,this.Wm=(this.Wm+1)%d.length;let t=0;for(let e=0;e<d.length;e++)t+=d[e];this.qm=t/d.length}if(1!==this.$t&&(t.globalAlpha=1),c){t.setTransform(1,0,0,1,0,0);for(let e=0;e<d.length;e++)t.fillText(d[e].toString(),20,150+20*e)}}DR(t){if(null===this.St)return;const e=this.animationManager;if(e.pi||e.isAnimating&&!e.isTicking)return;this.i0();const i=this.xt,s=this.bt;t.surface.resize(i,s,i,s);const n=this.Xt.r,o=n.length,r=this;if(this.ps(n,o,r,r.viewportBounds),!this.Be&&!e.isAnimating)return;const a=this.T;t.lastDrawnPart=null,t.setDiagramPosScale(a.m11,a.m12,a.m21,a.m22,a.dx,a.dy),1!==this.$t&&(t.globalAlpha=this.$t),this.vM(t);const h=this.Vi;this.ft.li.setTransform(h,0,0,h,0,0),this.ft.li.clearRect(0,0,this.xt,this.bt);for(let u=0;u<o;u++)n[u].Bi(t,r);let l=!1;this.Uc?this.Uc.Xu(this)&&(l=this.ab()):l=!0,l&&(k.prototype.$e=k.prototype.xw),this.Ic=!1,this.Be=!1}Pb(t,i,s,n,o,r,a,h,l){if(null===this.St)return;null===this.ft&&e.o("No canvas specified"),void 0===r&&(r=null),void 0===a&&(a=null),void 0===h&&(h=!1),void 0===l&&(l=!1),this.i0(),this.Qt.clearContextCache(!0),this.Ql(),this.ta=!0;const c=this.tt;this.tt=n;const d=this,f=this.Xt.r,g=f.length;try{const e=new x(o.x,o.y,s.width/n,s.height/n),c=e.copy();c.addMargin(i),this._l(c),this.Mi(),this.ps(f,g,d,e),t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,s.width,s.height),null!==a&&""!==a&&(t.fillStyle=a,t.fillBackground(0,0,s.width,s.height));const p=this.Vi;t.scale(p,p);const m=k.l();m.Ri(),m.Fs(i.left,i.top),m.tt(n),(0!==o.x||0!==o.y)&&m.Fs(-o.x,-o.y),t.setTransform(m.m11,m.m12,m.m21,m.m22,m.dx,m.dy),t.commitTransform(),t instanceof Et&&t.setDiagramPosScale(m.m11,m.m12,m.m21,m.m22,m.dx,m.dy),k.e(m),this.vM(t),t.globalAlpha=this.$t;const y=this.findLayer("Grid");if(r){const e=new u,i=r.iterator;for(i.reset();i.next();){const t=i.value;t instanceof ke&&(!l&&t.layer===y||(t.Au(),e.add(t)))}for(let s=0;s<g;s++)f[s].YF(t,d,e,h);e.each((t=>t.Au()))}else for(let i=0;i<g;i++){const e=f[i];e===y?l&&e.Bi(t,d,!0):e.Bi(t,d,h)}this.ta=!1,this.Uc&&this.Uc.Xu(this)&&this.ab()}finally{this.tt=c,this.Qt.clearContextCache(!0),this.Ql(),this.ps(f,g,d,d.viewportBounds),this._l(),this.Qt instanceof Et&&(this.Qt.diagramGroup.replaceChildren(),this.redraw())}}getRenderingHint(t){return this.kr[t]}setRenderingHint(t,e){"minDrawingLength"===t&&(this.Fm=e),this.kr[t]=e,this.redraw()}resetRenderingHints(){this.kr=new s,this.kr.drawShadows=!0,this.kr.textGreeking=!0,this.kr.viewportOptimizations=!e._o,this.kr.temporaryPixelRatio=!0,this.kr.pictureRatioOptimization=!0,this.kr.minDrawingLength=1,this.Fm=1}vM(t){const e=this.kr;if(null===e)return;if(void 0!==e.imageSmoothingEnabled){const i=!!e.imageSmoothingEnabled;t.setImageSmoothingEnabled(i)}const i=e.defaultFont;null!=i&&(t.font=i)}getInputOption(t){return this.Tu[t]}setInputOption(t,e){this.Tu[t]=e}nR(){this.Tu=new s,this.Tu.extraTouchArea=10,this.Tu.extraTouchThreshold=10,this.Tu.hasGestureZoom=!0}set(t){return Object.assign(this,t),this}attach(t){return this.setProperties(t)}setProperties(t){return vt.e0(this,t),this}static e0(t,i){const s=t instanceof ie,n=t instanceof vt;for(const o in i){""===o&&e.o("Setting properties requires non-empty property names");let r=t,a=o;if(s||n){const i=o.indexOf(".");if(i>0){const n=o.substring(0,i);s?r=t.findObject(n):(r=t[n],null==r&&(r=t.toolManager[n])),e.K(r)?a=o.substring(i+1):e.o("Unable to find object named: "+n+" in "+t.toString()+" when trying to set property: "+o)}}if("_"!==a[0]&&!e.uw(r,a)){if(n&&"ModelChanged"===a){t.addModelChangedListener(i[a]);continue}if(n&&"Changed"===a){t.addChangedListener(i[a]);continue}if(n&&e.uw(t.toolManager,a))r=t.toolManager;else{if(n&&t.YL(a)){t.addDiagramListener(a,i[a]);continue}if(t instanceof ti&&"Changed"===a){t.addChangedListener(i[a]);continue}e.o('Trying to set undefined property "'+a+'" on object: '+r.toString())}}const h=i[o];r[a]=h,"_"===a[0]&&r instanceof Tt&&r.addCopyProperty(a)}}xL(){if(0!==this.Jl.count&&!(this.undoManager.transactionLevel>1)){for(;this.Jl.count>0;){const t=this.Jl;this.Jl=new m;const e=t.iterator;for(;e.next();){const t=e.key;t.invalidateOtherJumpOvers(e.value),t.ee()}}this.S()}}S(t){if(void 0===t)this.Be=!0,this.requestUpdate();else{const e=this.viewportBounds;t.isReal()&&e.intersectsRect(t)&&(this.Be=!0,this.requestUpdate())}this.D("InvalidateDraw")}invalidateViewport(t,e){!0!==this.Be&&(this.Be=!0,"svg"!==this.Oc&&!0===this.getRenderingHint("temporaryPixelRatio")?(this.Bw(),this.maybeUpdate(),this.NP(!0)):this.maybeUpdate())}ha(){this.Ou=!0}Ql(){this.Ic=!0}i0(){!1!==this.Du&&(this.Du=!1,this.EL(this.xt,this.bt))}EL(t,e){this.Zl();const i=this.Vi,s=t*i,n=e*i;this.ft.resize(s,n,t,e)&&(this.Be=!0,this.Qt.clearContextCache(!0))}UL(){const t=this.ft;if(null===t||this.Iu.isReal())return!0;const e=this.xt,i=this.bt,s=this.St;let n=!1,o=this.Gn?this.Wt:0,r=this.ln?this.Wt:0,a=s.clientWidth||e+o,h=s.clientHeight||i+r;const l=this.viewportBounds,u=l.x,c=l.y,d=l.width,f=l.height;if((a!==e+o||h!==i+r)&&(this.Gn=!1,this.ln=!1,o=0,r=0,this.xt=a,this.bt=h,this.Du=!0,n=!0,this.Zl()),!this.Hn||!this.viewportBounds.isReal())return!0;const g=this.lb,p=this.hb;if(this.Ou=!1,!n&&!this.Gn&&!this.ln&&!this.Ru&&!this.vu)return!0;const m=this.documentBounds;let v=0,b=0,w=0,k=0;const S=l.width,P=l.height,M=this.Jh;this.contentAlignment.isSpot()?(m.width>S&&(v=M.left,b=M.right),m.height>P&&(w=M.top,k=M.bottom)):(v=M.left,b=M.right,w=M.top,k=M.bottom);const C=m.width+v+b,A=m.height+w+k,N=this.scale,L=N;let T=C>a/N,D=A>h/N;if(!n&&!this.Gn&&!this.ln&&!T&&!D)return!0;const O=m.x-v,F=l.x,R=m.right+b;let E=l.right+o;const B=m.y-w,I=l.y,_=m.bottom+k;let V=l.bottom+r,z="1px",j="1px";if(1===this.scrollMode&&(T||D)){if(T&&this.hasHorizontalScrollbar&&this.allowHorizontalScroll){let t=1;O+1<F&&(t=Math.max((F-O)*N+this.xt,t)),R>E+1&&(t=Math.max((R-E)*N+this.xt,t)),S+o+1<C&&(t=Math.max((C-S)*N+this.xt,t)),z=t.toString()+"px"}if(D&&this.hasVerticalScrollbar&&this.allowVerticalScroll){let t=1;B+1<I&&(t=Math.max((I-B)*N+this.bt,t)),_>V+1&&(t=Math.max((_-V)*N+this.bt,t)),P+r+1<A&&(t=Math.max((A-P)*N+this.bt,t)),j=t.toString()+"px"}}let $="1px"!==z,X="1px"!==j;if((!$||!X)&&($||X)){if(T=!(C<S+o),D=!(A<P+r),X&&(E-=this.Wt),$&&(V-=this.Wt),T&&this.hasHorizontalScrollbar&&this.allowHorizontalScroll){let t=1;O+1<F&&(t=Math.max((F-O)*N+this.xt,t)),R>E+1&&(t=Math.max((R-E)*N+this.xt,t)),S+1<C&&(t=Math.max((C-S)*N+this.xt,t)),z=t.toString()+"px"}$="1px"!==z;let t=this.bt;if($!==this.ln&&(t=$?this.bt-this.Wt:this.bt+this.Wt),D&&this.hasVerticalScrollbar&&this.allowVerticalScroll){let e=1;B+1<I&&(e=Math.max((I-B)*N+t,e)),_>V+1&&(e=Math.max((_-V)*N+t,e)),P+1<A&&(e=Math.max((A-P)*N+t,e)),j=e.toString()+"px"}X="1px"!==j}if(this.Um&&$===this.ln&&X===this.Gn)return(e!==this.xt||i!==this.bt)&&this.maybeUpdate(),!1;if($!==this.ln&&(this.bt="1px"===z?this.bt+this.Wt:Math.max(this.bt-this.Wt,1),n=!0),this.ln=$,p.style.width=z,X!==this.Gn&&(this.xt="1px"===j?this.xt+this.Wt:Math.max(this.xt-this.Wt,1),n=!0,this.zu)){const e=y.l();X?(t.style.left=this.Wt+"px",this.position=e.i(this.at.x+this.Wt/this.scale,this.at.y)):(t.style.left="0px",this.position=e.i(this.at.x-this.Wt/this.scale,this.at.y)),y.e(e)}n&&this.Zl(),this.Gn=X,p.style.height=j,this.Qx=!0,n&&(this.Du=!0);let G=g.scrollLeft;if(this.hasHorizontalScrollbar&&this.allowHorizontalScroll&&(S+1<C?G=(this.position.x-O)*N:O+1<F?G=g.scrollWidth-g.clientWidth:R>E+1&&(G=this.position.x*N)),this.zu)switch(this.kx){case"negative":G=-(g.scrollWidth-G-g.clientWidth);break;case"reverse":G=g.scrollWidth-G-g.clientWidth;break}if(g.scrollLeft=G,this.hasVerticalScrollbar&&this.allowVerticalScroll&&(P+1<A?g.scrollTop=(this.position.y-B)*N:B+1<I?g.scrollTop=g.scrollHeight-g.clientHeight:_>V+1&&(g.scrollTop=this.position.y*N)),a=this.xt,h=this.bt,g.style.width=a+(this.Gn?this.Wt:0)+"px",g.style.height=h+(this.ln?this.Wt:0)+"px",e!==a||i!==h||this.animationManager.pi){const t=x.V(u,c,d,f);return this.onViewportBoundsChanged(t,this.viewportBounds,L,n),x.e(t),!1}return!0}add(t){const i=t.diagram;if(i===this)return;null!==i&&e.o("Cannot add part "+t.toString()+" to "+this.toString()+". It is already a part of "+i.toString());let s=this.findLayer(t.layerName);if(null===s&&(s=this.findLayer("")),null===s&&e.o('Cannot add a Part when unable find a Layer named "'+t.layerName+'" and there is no default Layer'),t.layer===s)return;const n=s.Wh(99999999,t,t.diagram===this);n>=0&&this.raiseChangedEvent(3,"parts",s,null,t,null,n),s.isTemporary||this.invalidateDocumentBounds(),t.invalidateLayout(1);const o=t.layerChanged;null!==o&&o(t,null,s)}Wh(t){this.partManager.Wh(t);const e=this;t.Yr((t=>e.KL(t))),t.data||t.To(),t.hasPlaceholder()&&t.c(),null!==t.data&&t.Yr((t=>e.partManager.OM(t,null))),(!0===t._e()||!0===t.th())&&this._m(t),t.GL(!0,this),t.HL()?(t.actualBounds.isReal()&&this.S(t.qh(t.actualBounds)),this.invalidateDocumentBounds()):t.isVisible()&&t.actualBounds.isReal()&&this.S(t.qh(t.actualBounds)),this.requestUpdate()}te(t){t.clearAdornments(),this.partManager.te(t);const e=this;null!==t.data&&t.Yr((t=>e.partManager.IM(t,e))),this.Yn.delete(t),t instanceof De&&this.Sr.delete(t),t.HL()?(t.actualBounds.isReal()&&this.S(t.qh(t.actualBounds)),this.invalidateDocumentBounds()):t.isVisible()&&t.actualBounds.isReal()&&this.S(t.qh(t.actualBounds)),this.requestUpdate()}remove(t){this.EM(t,!0)}EM(t,e){const i=t.layer;if(null===i||i.diagram!==this)return;t.isSelected=!1,t.isHighlighted=!1,t.invalidateLayout(2),e&&t.Xc();const s=i.te(-1,t,!1);s>=0&&this.raiseChangedEvent(4,"parts",i,t,null,s,null);const n=t.layerChanged;null!==n&&n(t,i,null)}removeParts(t,e){if(void 0===e&&(e=!1),Array.isArray(t)){const i=t.length;for(let s=0;s<i;s++){const i=t[s];e&&!i.canDelete()||this.remove(i)}}else{const i=new u;i.addAll(t);const s=i.iterator;for(;s.next();){const t=s.value;e&&!t.canDelete()||this.remove(t)}}}copyParts(t,e,i){void 0===i&&(i=!1);let s=null;const n=e||this,o=n.model;let r=!1,a=!1;try{o.pm()&&(r=o.copiesParentKeyOfNodeData,o.copiesParentKeyOfNodeData=n.commandHandler.copiesParentKey),(o.mm()||o.Sb())&&(a=o.copiesGroupKeyOfNodeData,o.copiesGroupKeyOfNodeData=n.commandHandler.copiesGroupKey),s=this.partManager.copyParts(t,e,i)}finally{o.pm()&&(o.copiesParentKeyOfNodeData=r),(o.mm()||o.Sb())&&(o.copiesGroupKeyOfNodeData=a)}return s}moveParts(t,e,i,s){if(void 0===i&&(i=!1),void 0===s&&(s=this.s0()),null===this.toolManager)return;const n=new m;if(null!==t)if(Array.isArray(t))for(let o=0;o<t.length;o++)this.Kr(n,t[o],i,s);else{const e=t.iterator;for(;e.next();)this.Kr(n,e.value,i,s)}else{let t=this.parts;for(;t.next();){const e=t.value;this.Kr(n,e,i,s)}for(t=this.nodes;t.next();){const e=t.value;this.Kr(n,e,i,s)}for(t=this.links;t.next();){const e=t.value;this.Kr(n,e,i,s)}}this.AP(n,e,s,i)}Kr(t,e,i,s,n){if(!t.has(e)&&(void 0===n&&(n=!1),!i||n||e.canMove()||e.canCopy()))if(void 0===s&&(s=this.s0()),e instanceof Ce){if(t.set(e,this.Es(s,e,e.location)),e instanceof _e&&(e.hasPlaceholder()||s.dragsMembers)){const n=e.memberParts;for(;n.next();){const e=n.value;this.Kr(t,e,i,s,s.groupsAlwaysMove)}}const n=e.linksConnected;for(;n.next();){const e=n.value;if(t.has(e))continue;const o=e.fromNode,r=e.toNode;null!==o&&t.has(o)&&null!==r&&t.has(r)&&this.Kr(t,e,i,s)}if(s.dragsTree){const n=e.findTreeChildrenNodes();for(;n.next();){const e=n.value;this.Kr(t,e,i,s)}}}else if(e instanceof De){t.set(e,this.Es(s,e));const n=e.labelNodes;for(;n.next();){const e=n.value;this.Kr(t,e,i,s)}}else e instanceof Pe||t.set(e,this.Es(s,e,e.location))}AP(t,i,s,n){if(null===t||0===t.count)return;const o=y.l(),r=y.l();r.a(i),isNaN(r.x)&&(r.x=0),isNaN(r.y)&&(r.y=0);const a=this.ub;a||this.WC(t);const h=e.et(),l=e.et(),u=t.iterator;let c=y.l();for(;u.next();){const e=u.key,i=u.value;if(e.ke()){const a=this.jL(e,t);if(null!==a)h.push(new wt(e,i,a));else if(!n||e.canMove()){const t=i.point;o.a(t),this.computeMove(e,o.add(r),s,c),e.location=c,void 0===i.shifted&&(i.shifted=new y),i.shifted.a(c.subtract(t))}}else u.key instanceof De&&l.push(new g(u.key,u.value))}y.e(c);const d=h.length;for(let e=0;e<d;e++){const t=h[e],i=t.qL.point;o.a(i),void 0===t.Mb.shifted&&(t.Mb.shifted=new y),t.Me.location=o.add(t.Mb.shifted)}const f=y.l(),p=y.l(),m=l.length;for(let e=0;e<m;e++){const i=l[e],n=i.key;if(n instanceof De)if(n.suspendsRouting){n.xr=null;const e=n.fromNode,a=n.toNode;if(null!==this.draggedLink&&s.dragsLink){const e=i.value.point;if(null===n.dragComputation){t.set(n,this.Es(s,n,r));const i=r.x-e.x,o=r.y-e.y;n.cr(i,o)}else{const i=y.V(0,0),o=n.getPoint(0);o&&o.isReal()&&i.a(o),c=y.l().a(i).add(r);let a=c;s.isGridSnapEnabled&&(s.isGridSnapRealtime||this.lastInput.up)&&(a=y.l(),this.pS(n,c,a,s)),c.a(n.dragComputation(n,c,a)).subtract(i),t.set(n,this.Es(s,n,c));const h=c.x-e.x,l=c.y-e.y;n.cr(h,l),y.e(i),y.e(c),a!==c&&y.e(a)}}else{if(null!==e){f.a(e.location);const i=t.get(e);null!==i&&f.subtract(i.point)}if(null!==a){p.a(a.location);const e=t.get(a);null!==e&&p.subtract(e.point)}if(null!==e&&null!==a)if(f.equalsApprox(p)){const e=i.value.point,r=o;r.a(f),r.subtract(e),t.set(n,this.Es(s,n,f)),n.cr(r.x,r.y)}else n.suspendsRouting=!1,n.invalidateRoute();else{const o=i.value.point;let h;h=null!==e?f:null!==a?p:r,t.set(n,this.Es(s,n,h));const l=h.x-o.x,u=h.y-o.y;n.cr(l,u)}}}else if(null===n.fromNode||null===n.toNode){const e=i.value.point;t.set(n,this.Es(s,n,r));const o=r.x-e.x,a=r.y-e.y;n.cr(o,a)}}y.e(o),y.e(r),y.e(f),y.e(p),e.J(h),e.J(l),a||(this.Mi(),this.MP(t))}computeMove(t,e,i,s){if(void 0===s&&(s=new y),s.a(e),null===t)return s;let n=e;const o=i.isGridSnapEnabled;o&&(i.isGridSnapRealtime||this.lastInput.up)&&(n=y.l(),this.pS(t,e,n,i));const r=null!==t.dragComputation?t.dragComputation(t,e,n):n,a=t.minLocation;let h=a.x;isNaN(h)&&(h=o?Math.round(1e3*t.location.x)/1e3:t.location.x);let l=a.y;isNaN(l)&&(l=o?Math.round(1e3*t.location.y)/1e3:t.location.y);const u=t.maxLocation;let c=u.x;isNaN(c)&&(c=o?Math.round(1e3*t.location.x)/1e3:t.location.x);let d=u.y;return isNaN(d)&&(d=o?Math.round(1e3*t.location.y)/1e3:t.location.y),s.i(Math.max(h,Math.min(r.x,c)),Math.max(l,Math.min(r.y,d))),n!==e&&y.e(n),s}s0(){const t=this.toolManager.findTool("Dragging");return t instanceof z?t.dragOptions:this.gb}pS(t,e,i,s){if(void 0===s&&(s=this.s0()),i.a(e),null===t)return i;const n=this.grid,o=s.gridSnapCellSize;let r=o.width,a=o.height;const h=s.gridSnapOrigin;let l=h.x,u=h.y;const c=s.gridSnapCellSpot;if(null!==n){const t=n.gridCellSize;isNaN(r)&&(r=t.width),isNaN(a)&&(a=t.height);const e=n.gridOrigin;isNaN(l)&&(l=e.x),isNaN(u)&&(u=e.y)}const d=y.V(0,0);return d.setSpot(0,0,r,a,c),S.Dg(e.x,e.y,l+d.x,u+d.y,r,a,i),y.e(d),i}WC(t){if(null===t)return;this.ub=!0;const e=t.iterator;for(;e.next();){const t=e.key;t instanceof De&&(t.suspendsRouting=!0)}}MP(t){if(null===t)return;const e=t.iterator;for(;e.next();){const t=e.key;t instanceof De&&(t.suspendsRouting=!1,t.WL()&&t.invalidateRoute())}this.ub=!1}get draggedLink(){return this.db}set draggedLink(t){this.db!==t&&(this.db=t,null!==t&&(this.pb=t.fromPort,this.yb=t.toPort))}get FP(){return this.pb}set FP(t){this.pb=t}get RP(){return this.yb}set RP(t){this.yb=t}jL(t,e){const i=t.containingGroup;if(null!==i){let t=this.jL(i,e);if(null!==t||(t=e.get(i),null!==t))return t}return null}Es(t,e,i){if(void 0===i)return new bt(y.wo);let s=t.isGridSnapEnabled;return!t.groupsSnapMembers&&null!==e.containingGroup&&(s=!1),new bt(s?new y(Math.round(1e3*i.x)/1e3,Math.round(1e3*i.y)/1e3):i.copy())}BM(t,i){if(null!==t.diagram&&t.diagram!==this&&e.o("Cannot share a Layer with another Diagram: "+t+" of "+t.diagram),null===i?null!==t.diagram&&e.o("Cannot add an existing Layer to this Diagram again: "+t):(i.diagram!==this&&e.o("Existing Layer must be in this Diagram: "+i+" not in "+i.diagram),t===i&&e.o("Cannot move a Layer before or after itself: "+t)),t.diagram===this)return;const s=t.name,n=this.Xt,o=n.count;for(let r=0;r<o;r++)n.elt(r).name===s&&e.o("Cannot add Layer with the name '"+s+"'; a Layer with the same name is already present in this Diagram.")}addLayer(t){this.BM(t,null),t.So(this);const e=this.Xt;let i=e.count-1;if(!t.isTemporary)for(;i>=0&&e.elt(i).isTemporary;)i--;return e.insertAt(i+1,t),null!==this.ki&&this.raiseChangedEvent(3,"layers",this,null,t,null,i+1),this.S(),this.invalidateDocumentBounds(),this}addLayerBefore(t,e){this.BM(t,e),t.So(this);const i=this.Xt,s=i.indexOf(t);s>=0&&(i.delete(t),null!==this.ki&&this.raiseChangedEvent(4,"layers",this,t,null,s,null));const n=i.count;let o;for(o=0;o<n;o++)if(i.elt(o)===e){i.insertAt(o,t);break}return null!==this.ki&&this.raiseChangedEvent(3,"layers",this,null,t,null,o),this.S(),s<0&&this.invalidateDocumentBounds(),this}addLayerAfter(t,e){this.BM(t,e),t.So(this);const i=this.Xt,s=i.indexOf(t);s>=0&&(i.delete(t),null!==this.ki&&this.raiseChangedEvent(4,"layers",this,t,null,s,null));const n=i.count;let o;for(o=0;o<n;o++)if(i.elt(o)===e){i.insertAt(o+1,t);break}return null!==this.ki&&this.raiseChangedEvent(3,"layers",this,null,t,null,o+1),this.S(),s<0&&this.invalidateDocumentBounds(),this}zr(t,e){t.So(this),this.Xt.insertAt(e,t)}JL(t){this.Xt.removeAt(t)}removeLayer(t){if(t.diagram!==this&&e.o("Cannot remove a Layer from another Diagram: "+t+" of "+t.diagram),""===t.name)return;const i=this.Xt,s=i.indexOf(t);if(i.delete(t)){const e=t.Ct.copy().iterator;for(;e.next();){const i=e.value,s=i.layerName;s!==t.name?i.layerName=s:i.layerName=""}null!==this.ki&&this.raiseChangedEvent(4,"layers",this,t,null,s,null),this.S(),this.invalidateDocumentBounds()}}findLayer(t){const e=this.layers;for(;e.next();){const i=e.value;if(i.name===t)return i}return null}findRouter(t){for(const e of this.Vc)if(e.name===t)return e;return null}addModelChangedListener(t){return e.k(t,vt,"addModelChangedListener:listener"),null===this.Kn&&(this.Kn=new h),this.Kn.add(t),this.model.addChangedListener(t),this}removeModelChangedListener(t){e.k(t,vt,"removeModelChangedListener:listener"),null!==this.Kn&&(this.Kn.delete(t),0===this.Kn.count&&(this.Kn=null)),this.model.removeChangedListener(t)}addChangedListener(t){return e.k(t,vt,"addChangedListener:listener"),null===this.Mr&&(this.Mr=new h),this.Mr.add(t),this}removeChangedListener(t){e.k(t,vt,"removeChangedListener:listener"),null!==this.Mr&&(this.Mr.delete(t),0===this.Mr.count&&(this.Mr=null))}UM(t){if(!this.skipsUndoManager&&!this.model.skipsUndoManager&&this.model.undoManager.handleChanged(t),1!==t.change&&(this.isModified=!0),null!==this.Mr){const e=this.Mr,i=e.length;for(let s=0;s<i;s++)e.elt(s)(t)}}raiseChangedEvent(t,e,i,s,n,o,r){void 0===o&&(o=null),void 0===r&&(r=null);const a=new F;a.diagram=this,a.change=t,a.propertyName=e,a.object=i,a.oldValue=s,a.oldParam=o,a.newValue=n,a.newParam=r,this.UM(a)}raiseChanged(t,e,i,s,n){this.raiseChangedEvent(2,t,this,e,i,s,n)}t(t,e,i,s,n){this.raiseChangedEvent(2,t,this,e,i,s,n)}get animationManager(){return this.ds}get undoManager(){return this.ki.undoManager}get skipsUndoManager(){return this.Co}set skipsUndoManager(t){e.s(t,"boolean",vt,"skipsUndoManager"),this.Co=t,this.ki.skipsUndoManager=t}get delaysLayout(){return this.Xx}set delaysLayout(t){this.Xx=t}VC(t,i){if(null===t||t.diagram!==this)return;const s=this.fe;try{this.fe=!0;const s=t.change;if(2===s){const e=t.object,s=t.propertyName,n=t.getValue(i);if(t.diagram.model.Z(e,s,n),e instanceof Tt){const t=e.part;null!==t&&t.invalidateAdornments()}this.isModified=!0}else if(3===s){const s=t.object,n=t.newParam,o=t.newValue;if(s instanceof ie)if("number"==typeof n&&o instanceof Tt){i?s.te(n):s.insertAt(n,o);const t=s.part;null!==t&&t.invalidateAdornments()}else"number"==typeof n&&o instanceof ae&&(o.isRow?s.$L(n,i?void 0:o):s.ZL(n,i?void 0:o));else if(s instanceof ft){const e=!0===t.oldParam;"number"==typeof n&&o instanceof ke&&(i?(e||(o.isSelected=!1,o.isHighlighted=!1,o.invalidateAdornments()),s.te(e?n:-1,o,e)):s.Wh(n,o,e))}else s instanceof vt?"number"==typeof n&&o instanceof ft&&(i?this.JL(n):this.zr(o,n)):e.o("unknown ChangeType.Insert object: "+t.toString());this.isModified=!0}else if(4===s){const s=t.object,n=t.oldParam,o=t.oldValue;if(s instanceof ie)"number"==typeof n&&o instanceof Tt?i?s.insertAt(n,o):s.te(n):"number"==typeof n&&o instanceof ae&&(o.isRow?s.$L(n,i?o:void 0):s.ZL(n,i?o:void 0));else if(s instanceof ft){const e=!0===t.newParam;"number"==typeof n&&o instanceof ke&&(i?s.Ct.indexOf(o)<0&&s.Wh(n,o,e):(e||(o.isSelected=!1,o.isHighlighted=!1,o.invalidateAdornments()),s.te(e?n:-1,o,e)))}else s instanceof vt?"number"==typeof n&&o instanceof ft&&(i?this.zr(o,n):this.JL(n)):e.o("unknown ChangeType.Remove object: "+t.toString());this.isModified=!0}else 1===s||e.o("unknown ChangedEvent: "+t.toString())}finally{this.fe=s}}startTransaction(t){return this.undoManager.startTransaction(t)}commitTransaction(t){return this.undoManager.commitTransaction(t)}rollbackTransaction(){return this.undoManager.rollbackTransaction()}commit(t,e){let i=e;void 0===i&&(i="");const s=this.skipsUndoManager;null===i&&(this.skipsUndoManager=!0,i=""),this.undoManager.startTransaction(i);let n=!1;try{t(this),n=!0}finally{n?this.undoManager.commitTransaction(i):this.undoManager.rollbackTransaction(),this.skipsUndoManager=s}}updateAllTargetBindings(t){this.partManager.updateAllTargetBindings(t)}updateAllThemeBindings(){if(this.partManager.updateAllThemeBindings(),null!==this.Ze){const t=this.Ze.part;null!==t&&t.To()}}setDivBackground(t){this.div&&(this.div.style.backgroundColor=t)}updateAllRelationshipsFromData(){this.partManager.updateAllRelationshipsFromData()}bb(){const t=this.T,e=this.tt,i=this.at;t.Ri(),1!==e&&t.tt(e),(0!==i.x||0!==i.y)&&t.Fs(-i.x,-i.y)}QL(t,e){const i=this.animationManager;if(this.jt||this.ys)return this.tt=e,this.Zl(),this.S(),this.ha(),i.yL(t,this.tt),void this.bb();if(null===this.ft)return this.tt=e,void this.bb();this.jt=!0;const s=this.viewportBounds.copy(),n=this.xt,o=this.bt;let r=this.zoomPoint.x,a=this.zoomPoint.y;const h=this.contentAlignment;isNaN(r)&&(h.isSide()?h.includesSide(w.LeftSide)?r=0:h.includesSide(w.RightSide)&&(r=n-1):r=h.isSpot()?h.x*(n-1):n/2),isNaN(a)&&(h.isSide()?h.includesSide(w.TopSide)?a=0:h.includesSide(w.BottomSide)&&(a=o-1):a=h.isSpot()?h.y*(o-1):o/2),null!==this.scaleComputation&&!this.animationManager.defaultAnimation.isAnimating&&(e=this.scaleComputation(this,e)),e<this.minScale&&(e=this.minScale),e>this.maxScale&&(e=this.maxScale);const l=y.V(this.at.x+r/t-r/e,this.at.y+a/t-a/e);this.position=l,y.e(l),this.tt=e,this.Zl(),this.jt=!1,this.onViewportBoundsChanged(s,this.viewportBounds,t,!1),this.Us(!1),i.yL(t,this.tt),this.S()}SR(){const t=this.Xt.r;for(let e=0;e<t.length;e++)t[e].ML()}onViewportBoundsChanged(t,e,i,s){if(t.equals(e))return;void 0===s&&(s=!1),s||this.ha(),this.Ql();const n=this.layout;null!==n&&n.isViewportSized&&1===this.autoScale&&(t.width!==e.width||t.height!==e.height)&&n.invalidateLayout();const o=this.currentTool;!0===this.Bc&&o instanceof V&&!this.animationManager.isTicking&&(this.lastInput.documentPoint=this.transformViewToDoc(this.lastInput.viewPoint),o.standardMouseActivity(this)),this.jt||this.invalidateViewport(t,e),this._l(),this.Ui.scale=i,this.Ui.position.x=t.x,this.Ui.position.y=t.y,this.Ui.bounds.a(t),this.Ui.canvasSize.width=Math.round(t.width*i),this.Ui.canvasSize.height=Math.round(t.height*i),this.Ui.newCanvasSize.width=this.xt,this.Ui.newCanvasSize.height=this.bt,this.Ui.isScroll=s,this.D("ViewportBoundsChanged",this.Ui,t),this.isVirtualized&&this.links.each((t=>{t.isAvoiding&&t.actualBounds.intersectsRect(e)&&t.invalidateRoute()}))}_l(t){const e=this.Ze;if(null===e||!e.visible||null===e.part||null===e.layer)return;const i=void 0!==t?t:this.eb;if(!i.isReal())return;const s=i.width,n=i.height;if(e.scale=1,e.angle=0,e.layer.isViewportAligned)e.width=s*this.scale,e.height=n*this.scale,e.part.alignment=w.TopLeft;else{null===e.yi&&(e.yi=new ne);const t=e.yi.Yc;if(!t.isReal())return;e.width=s+2*t.width,e.height=n+2*t.height;const o=y.l();S.Dg(i.x,i.y,0,0,t.width,t.height,o),o.offset(-t.width,-t.height),e.part.location=o,y.e(o)}}clearSelection(t){void 0===t&&(t=!1);const e=this.selection;if(0===e.count)return;t||this.D("ChangingSelection",e);const i=e.toArray(),s=i.length;for(let n=0;n<s;n++){const t=i[n];t.isSelected=!1}e.Nt(),e.clear(),e.u(),t||this.D("ChangedSelection",e)}select(t){null!==t&&t.diagram===this&&(!t.isSelected||this.selection.count>1)&&(this.D("ChangingSelection",this.selection),this.clearSelection(!0),t.isSelected=!0,this.D("ChangedSelection",this.selection))}selectCollection(t){if(this.D("ChangingSelection",this.selection),this.clearSelection(!0),Array.isArray(t)){const i=t.length;for(let s=0;s<i;s++){const i=t[s];i instanceof ke||e.o("Diagram.selectCollection given something that is not a Part: "+i),i.isSelected=!0}}else{const i=t.iterator;for(;i.next();){const t=i.value;t instanceof ke||e.o("Diagram.selectCollection given something that is not a Part: "+t),t.isSelected=!0}}this.D("ChangedSelection",this.selection)}clearHighlighteds(){const t=this.highlighteds;if(t.count>0){const e=t.toArray(),i=e.length;for(let t=0;t<i;t++){const i=e[t];i.isHighlighted=!1}t.Nt(),t.clear(),t.u()}}highlight(t){null!==t&&t.diagram===this&&(!t.isHighlighted||this.highlighteds.count>1)&&(this.clearHighlighteds(),t.isHighlighted=!0)}highlightCollection(t){const i=(new u).addAll(t),s=this.highlighteds.copy().removeAll(i).iterator;for(;s.next();){const t=s.value;t.isHighlighted=!1}const n=i.iterator;for(;n.next();){const t=n.value;t instanceof ke||e.o("Diagram.highlightCollection given something that is not a Part: "+t),t.isHighlighted=!0}}scroll(t,i,s){void 0===s&&(s=1);const n="up"===i||"down"===i;let o=0;const r=y.l();if("pixel"===t)o=s;else if("line"===t)o=s*(n?this.scrollVerticalLineChange:this.scrollHorizontalLineChange);else if("page"===t){let t=n?this.viewportBounds.height:this.viewportBounds.width;if(t*=this.scale,0!==t){const e=Math.max(t-(n?this.scrollVerticalLineChange:this.scrollHorizontalLineChange),0);o=s*e}}else{if("document"===t){const t=this.documentBounds,e=this.viewportBounds;return"up"===i?this.position=r.i(e.x,t.y):"left"===i?this.position=r.i(t.x,e.y):"down"===i?this.position=r.i(e.x,t.bottom-e.height):"right"===i&&(this.position=r.i(t.right-e.width,e.y)),void y.e(r)}e.o("scrolling unit must be 'pixel', 'line', 'page', or 'document', not: "+t)}o/=this.scale;const a=this.position;"up"===i?this.position=r.i(a.x,a.y-o):"down"===i?this.position=r.i(a.x,a.y+o):"left"===i?this.position=r.i(a.x-o,a.y):"right"===i?this.position=r.i(a.x+o,a.y):e.o("scrolling direction must be 'up', 'down', 'left', or 'right', not: "+i),y.e(r)}scrollToRect(t){const e=this.viewportBounds;if(e.containsRect(t))return;const i=t.center;i.x-=e.width/2,i.y-=e.height/2,this.position=i}centerRect(t){const e=this.viewportBounds,i=t.center;i.x-=e.width/2,i.y-=e.height/2,this.position=i}transformDocToView(t){return t.copy().T(this.T)}transformViewToDoc(t){return t.copy().Oe(this.T)}JF(t){return t.Oe(this.T)}static None=1;static Uniform=2;static UniformToFill=3;static CycleAll=1;static CycleNotDirected=2;static CycleNotDirectedFast=3;static CycleNotUndirected=4;static CycleDestinationTree=5;static CycleSourceTree=6;static DocumentScroll=1;static InfiniteScroll=2;static TreeParentCollapsed=1;static AllParentsCollapsed=2;static AnyParentsCollapsed=3;get opacity(){return this.$t}set opacity(t){const i=this.$t;i!==t&&(e.s(t,"number",vt,"opacity"),(t<0||t>1)&&e.W(t,"0 <= value <= 1",vt,"opacity"),this.$t=t,this.t("opacity",i,t),this.S())}get validCycle(){return this.Ix}set validCycle(t){const e=this.Ix;e!==t&&(this.Ix=t,this.t("validCycle",e,t))}get layers(){return this.Xt.iterator}get isModelReadOnly(){const t=this.ki;return null!==t&&t.isReadOnly}set isModelReadOnly(t){const e=this.ki;null!==e&&(e.isReadOnly=t)}get isReadOnly(){return this.Lo}set isReadOnly(t){const i=this.Lo;i!==t&&(e.s(t,"boolean",vt,"isReadOnly"),this.Lo=t,this.t("isReadOnly",i,t))}get isEnabled(){return this.Oi}set isEnabled(t){const i=this.Oi;i!==t&&(e.s(t,"boolean",vt,"isEnabled"),this.Oi=t,this.t("isEnabled",i,t))}get allowClipboard(){return this.Yx}set allowClipboard(t){const i=this.Yx;i!==t&&(e.s(t,"boolean",vt,"allowClipboard"),this.Yx=t,this.t("allowClipboard",i,t))}get allowCopy(){return this.Fl}set allowCopy(t){const i=this.Fl;i!==t&&(e.s(t,"boolean",vt,"allowCopy"),this.Fl=t,this.t("allowCopy",i,t))}get allowDelete(){return this.Rl}set allowDelete(t){const i=this.Rl;i!==t&&(e.s(t,"boolean",vt,"allowDelete"),this.Rl=t,this.t("allowDelete",i,t))}get allowDragOut(){return this.Kx}set allowDragOut(t){const i=this.Kx;i!==t&&(e.s(t,"boolean",vt,"allowDragOut"),this.Kx=t,this.t("allowDragOut",i,t))}get allowDrop(){return this.Gx}set allowDrop(t){const i=this.Gx;i!==t&&(e.s(t,"boolean",vt,"allowDrop"),this.Gx=t,this.t("allowDrop",i,t))}get allowTextEdit(){return this.vl}set allowTextEdit(t){const i=this.vl;i!==t&&(e.s(t,"boolean",vt,"allowTextEdit"),this.vl=t,this.t("allowTextEdit",i,t))}get allowGroup(){return this.Ol}set allowGroup(t){const i=this.Ol;i!==t&&(e.s(t,"boolean",vt,"allowGroup"),this.Ol=t,this.t("allowGroup",i,t))}get allowUngroup(){return this.Il}set allowUngroup(t){const i=this.Il;i!==t&&(e.s(t,"boolean",vt,"allowUngroup"),this.Il=t,this.t("allowUngroup",i,t))}get allowInsert(){return this.Hx}set allowInsert(t){const i=this.Hx;i!==t&&(e.s(t,"boolean",vt,"allowInsert"),this.Hx=t,this.t("allowInsert",i,t))}get allowLink(){return this.El}set allowLink(t){const i=this.El;i!==t&&(e.s(t,"boolean",vt,"allowLink"),this.El=t,this.t("allowLink",i,t))}get allowRelink(){return this.Bl}set allowRelink(t){const i=this.Bl;i!==t&&(e.s(t,"boolean",vt,"allowRelink"),this.Bl=t,this.t("allowRelink",i,t))}get allowMove(){return this.Ul}set allowMove(t){const i=this.Ul;i!==t&&(e.s(t,"boolean",vt,"allowMove"),this.Ul=t,this.t("allowMove",i,t))}get allowReshape(){return this.Vl}set allowReshape(t){const i=this.Vl;i!==t&&(e.s(t,"boolean",vt,"allowReshape"),this.Vl=t,this.t("allowReshape",i,t))}get allowResize(){return this.zl}set allowResize(t){const i=this.zl;i!==t&&(e.s(t,"boolean",vt,"allowResize"),this.zl=t,this.t("allowResize",i,t))}get allowRotate(){return this.Xl}set allowRotate(t){const i=this.Xl;i!==t&&(e.s(t,"boolean",vt,"allowRotate"),this.Xl=t,this.t("allowRotate",i,t))}get allowSelect(){return this.Yl}set allowSelect(t){const i=this.Yl;i!==t&&(e.s(t,"boolean",vt,"allowSelect"),this.Yl=t,this.t("allowSelect",i,t))}get allowUndo(){return this.jx}set allowUndo(t){const i=this.jx;i!==t&&(e.s(t,"boolean",vt,"allowUndo"),this.jx=t,this.t("allowUndo",i,t))}get allowZoom(){return this.qx}set allowZoom(t){const i=this.qx;i!==t&&(e.s(t,"boolean",vt,"allowZoom"),this.qx=t,this.t("allowZoom",i,t))}get hasVerticalScrollbar(){return this.vu}set hasVerticalScrollbar(t){const i=this.vu;i!==t&&(e.s(t,"boolean",vt,"hasVerticalScrollbar"),this.vu=t,this.ha(),this.S(),this.t("hasVerticalScrollbar",i,t),this.Us(!1))}get hasHorizontalScrollbar(){return this.Ru}set hasHorizontalScrollbar(t){const i=this.Ru;i!==t&&(e.s(t,"boolean",vt,"hasHorizontalScrollbar"),this.Ru=t,this.ha(),this.S(),this.t("hasHorizontalScrollbar",i,t),this.Us(!1))}get allowHorizontalScroll(){return this.Wx}set allowHorizontalScroll(t){const i=this.Wx;i!==t&&(e.s(t,"boolean",vt,"allowHorizontalScroll"),this.Wx=t,this.t("allowHorizontalScroll",i,t),this.Us(!1))}get allowVerticalScroll(){return this.Jx}set allowVerticalScroll(t){const i=this.Jx;i!==t&&(e.s(t,"boolean",vt,"allowVerticalScroll"),this.Jx=t,this.t("allowVerticalScroll",i,t),this.Us(!1))}get scrollHorizontalLineChange(){return this.$x}set scrollHorizontalLineChange(t){const i=this.$x;i!==t&&(e.s(t,"number",vt,"scrollHorizontalLineChange"),t<0&&e.W(t,">= 0",vt,"scrollHorizontalLineChange"),this.$x=t,this.t("scrollHorizontalLineChange",i,t))}get scrollVerticalLineChange(){return this.Zx}set scrollVerticalLineChange(t){const i=this.Zx;i!==t&&(e.s(t,"number",vt,"scrollVerticalLineChange"),t<0&&e.W(t,">= 0",vt,"scrollVerticalLineChange"),this.Zx=t,this.t("scrollVerticalLineChange",i,t))}get lastInput(){return this.Qh}set lastInput(t){this.Qh=t}get previousInput(){return this.Br}set previousInput(t){this.Br=t}get firstInput(){return this.Km}set firstInput(t){this.Km=t}get currentCursor(){return this.Ex}set currentCursor(t){if(""===t&&(t=this.Bm),this.Ex!==t){e.s(t,"string",vt,"currentCursor");const i=this.ft,s=this.St;if(null===i||null===s)return;this.Ex=t;const n=i.style.cursor;i.style.cursor=t,s.style.cursor=t,i.style.cursor===n&&(i.style.cursor="-webkit-"+t,s.style.cursor="-webkit-"+t,i.style.cursor===n&&(i.style.cursor="-moz-"+t,s.style.cursor="-moz-"+t,i.style.cursor===n&&(i.style.cursor=t,s.style.cursor=t)))}}get defaultCursor(){return this.Bm}set defaultCursor(t){""===t&&(t="auto");const i=this.Bm;i!==t&&(e.s(t,"string",vt,"defaultCursor"),this.Bm=t,this.t("defaultCursor",i,t))}get click(){return this.Nr}set click(t){const i=this.Nr;i!==t&&(null!==t&&e.k(t,vt,"click"),this.Nr=t,this.t("click",i,t))}get doubleClick(){return this.Cr}set doubleClick(t){const i=this.Cr;i!==t&&(null!==t&&e.k(t,vt,"doubleClick"),this.Cr=t,this.t("doubleClick",i,t))}get contextClick(){return this.Lr}set contextClick(t){const i=this.Lr;i!==t&&(null!==t&&e.k(t,vt,"contextClick"),this.Lr=t,this.t("contextClick",i,t))}get mouseOver(){return this.Ar}set mouseOver(t){const i=this.Ar;i!==t&&(null!==t&&e.k(t,vt,"mouseOver"),this.Ar=t,this.t("mouseOver",i,t))}get mouseHover(){return this.Tr}set mouseHover(t){const i=this.Tr;i!==t&&(null!==t&&e.k(t,vt,"mouseHover"),this.Tr=t,this.t("mouseHover",i,t))}get mouseHold(){return this.Dr}set mouseHold(t){const i=this.Dr;i!==t&&(null!==t&&e.k(t,vt,"mouseHold"),this.Dr=t,this.t("mouseHold",i,t))}get mouseDragOver(){return this.Bx}set mouseDragOver(t){const i=this.Bx;i!==t&&(null!==t&&e.k(t,vt,"mouseDragOver"),this.Bx=t,this.t("mouseDragOver",i,t))}get mouseDrop(){return this.Fr}set mouseDrop(t){const e=this.Fr;e!==t&&(this.Fr=t,this.t("mouseDrop",e,t))}get handlesDragDropForTopLevelParts(){return this.Ux}set handlesDragDropForTopLevelParts(t){const i=this.Ux;i!==t&&(e.s(t,"boolean",vt,"handlesDragDropForTopLevelParts"),this.Ux=t,this.t("handlesDragDropForTopLevelParts",i,t))}get mouseEnter(){return this.Rr}set mouseEnter(t){const i=this.Rr;i!==t&&(null!==t&&e.k(t,vt,"mouseEnter"),this.Rr=t,this.t("mouseEnter",i,t))}get mouseLeave(){return this.vr}set mouseLeave(t){const i=this.vr;i!==t&&(null!==t&&e.k(t,vt,"mouseLeave"),this.vr=t,this.t("mouseLeave",i,t))}get toolTip(){return this.Or}set toolTip(t){const e=this.Or;e!==t&&(this.Or=t,this.t("toolTip",e,t))}get contextMenu(){return this.Ir}set contextMenu(t){const e=this.Ir;e!==t&&(this.Ir=t,this.t("contextMenu",e,t))}get commandHandler(){return this.eM}set commandHandler(t){const e=this.eM;e!==t&&(e&&e.doStop(),this.eM=t,t.So(this),t.doStart())}get toolManager(){return this._S}set toolManager(t){this._S!==t&&(this._S=t,t.diagram=this)}get defaultTool(){return this.tM}set defaultTool(t){const e=this.tM;e!==t&&(this.tM=t,t.diagram=this,this.currentTool===e&&(this.currentTool=t))}get currentTool(){return this.iM}set currentTool(t){const e=this.iM;e&&(e.isActive&&e.doDeactivate(),e.cancelWaitAfter(),e.doStop()),null===t&&(t=this.defaultTool),null!==t&&(this.iM=t,t.diagram=this,t.doStart())}get selection(){return this.aM}get maxSelectionCount(){return this.ib}set maxSelectionCount(t){const i=this.ib;if(i!==t)if(e.s(t,"number",vt,"maxSelectionCount"),t>=0&&!isNaN(t)){if(this.ib=t,this.t("maxSelectionCount",i,t),!this.undoManager.isUndoingRedoing){const e=this.selection.count-t;if(e>0){this.D("ChangingSelection",this.selection);const t=this.selection.toArray();for(let i=0;i<e;i++)t[i].isSelected=!1;this.D("ChangedSelection",this.selection)}}}else e.W(t,">= 0",vt,"maxSelectionCount")}get nodeSelectionAdornmentTemplate(){return this.Xm}set nodeSelectionAdornmentTemplate(t){const e=this.Xm;e!==t&&(this.Xm=t.Et(),this.t("nodeSelectionAdornmentTemplate",e,t))}get groupSelectionAdornmentTemplate(){return this.nb}set groupSelectionAdornmentTemplate(t){const e=this.nb;e!==t&&(this.nb=t.Et(),this.t("groupSelectionAdornmentTemplate",e,t))}get linkSelectionAdornmentTemplate(){return this.ob}set linkSelectionAdornmentTemplate(t){const e=this.ob;e!==t&&(this.ob=t.Et(),this.t("linkSelectionAdornmentTemplate",e,t))}get highlighteds(){return this.cM}get isModified(){const t=this.undoManager;return t.isEnabled?null!==t.currentTransaction||this.Bu&&this.Os!==t.historyIndex:this.Bu}set isModified(t){if(this.Bu!==t){e.s(t,"boolean",vt,"isModified"),this.Bu=t;const i=this.undoManager;!t&&i.isEnabled&&(this.Os=i.historyIndex),t||this._L()}}_L(){const t=this.isModified;this.lM!==t&&(this.lM=t,this.D("Modified"))}get model(){return this.ki}set model(t){const i=this.ki;if(i!==t){this.currentTool.doCancel(),i&&i.undoManager!==t.undoManager&&i.undoManager.isInTransaction&&e.o("Do not replace a Diagram.model while a transaction is in progress."),this.animationManager.stopAnimation(!0);const s=this.OL(!0);this.Hn=!1,this.Fu=!0,this.Os=-2,this.wr=!1;const n=this.jt;this.jt=!0,this.animationManager.Dl("Model"),i&&(null!==this.Kn&&this.Kn.each((t=>i.removeChangedListener(t))),i.removeChangedListener(this.rM)),this.ki=t,this.partManager=this.RR(this.ki.type),this.initializePartManager(this.partManager);for(let t=0;t<s.length;t++)this.add(s[t]);t.addChangedListener(this.oM),this.partManager.VM(),t.removeChangedListener(this.oM),t.addChangedListener(this.rM),null!==this.Kn&&this.Kn.each((e=>t.addChangedListener(e))),this.jt=n,this.invalidateDocumentBounds(),this.jt||this.S(),i&&t.undoManager.copyProperties(i.undoManager)}}get themeManager(){return this.MM}set themeManager(t){const e=this.MM;e!==t&&(e&&e.removeDiagram(this),this.MM=t,null!==t&&t.addDiagram(this))}initializePartManager(t){}static NM(t,e){vt.AL.set(t,e)}static get licenseKey(){return vt.zM.last()}static set licenseKey(t){vt.zM.add(t.replace(/\s/g,""))}static get version(){return vt.vR}static zM=new h;static vR="3.0.21";RR(t){const e=vt.AL.get(t);return null!==e?new e:new He}get X(){return this.nM}set X(t){this.nM=t}get wx(){return this.NL}OR(t){if(t.model!==this.model)return;const i=t.change,s=t.propertyName;if(1!==i||"S"!==s[0]){if(this.X){this.X=!1;try{if(""===t.modelChange&&1===i){("FinishedUndo"===s||"FinishedRedo"===s)&&(this.D("ChangedSelection",this.selection),this.Mi());const i=this.animationManager;"RolledBackTransaction"===s&&i.stopAnimation(),this.xL(),this.vc=!0,this.maybeUpdate(),(0===this.undoManager.transactionLevel||1===this.undoManager.transactionLevel)&&i.vS(),"CommittedTransaction"===s&&this.undoManager.isJustDiscarded&&(this.Os=Math.min(this.Os,this.undoManager.historyIndex-1)),("CommittedTransaction"===s||"RolledBackTransaction"===s)&&this.undoManager.Iw&&e.tr((()=>{this.isModified=!1}),1);const n=t.isTransactionFinished;if(n&&(this._L(),this.wx.clear(),this.animationManager.vF()),!this.Vx&&n&&this.lastInput.targetDiagram){this.Vx=!0;const t=this;e.tr((()=>{t.currentTool.standardMouseOver(),t.Vx=!1}),10)}}}finally{this.X=!0}}}else if("StartingFirstTransaction"===s){const t=this,e=this.toolManager;e.mouseDownTools.each((e=>e.diagram=t)),e.mouseMoveTools.each((e=>e.diagram=t)),e.mouseUpTools.each((e=>e.diagram=t)),this.routers.each((e=>e.diagram=t)),!this.ys&&!this.Hn&&(this.vc=!0,this.Fu&&(this.wr=!0))}else if("StartingUndo"===s||"StartingRedo"===s){const t=this.animationManager;this.skipsUndoManager||(t.defaultAnimation.isAnimating&&t.stopAnimation(),t.getBundleAnimation().isAnimating&&t.getBundleAnimation().stop()),this.D("ChangingSelection",this.selection)}else if("StartedTransaction"===s){const t=this.animationManager;t.defaultAnimation.isAnimating&&!this.skipsUndoManager&&t.stopAnimation()}}get fe(){return this.sM}set fe(t){this.sM=t}get du(){return this.zx}set du(t){this.zx=t}KL(t){const e=t.C.r;for(const i of e)i instanceof ye&&this.XM(i)}XM(t){const e=t.element;if(null===e||!(e instanceof HTMLImageElement)||(e.ts instanceof u&&e.ts.add(this),t.IR(),!e.o0))return;const i=e.getAttribute("src")||"",s=this.Wl.get(i);if(null===s){ye.tA(t,e);const s=[];s.push(t),this.Wl.set(i,s)}else{for(let e=0;e<s.length;e++)if(s[e]===t)return;s.push(t)}}ER(t){const e=t.C.r,i=e.length;for(let s=0;s<i;s++)this.YM(e[s])}YM(t){if(!(t instanceof ye))return;const e=t.element;if(null===e||!(e instanceof HTMLImageElement)||!e.o0)return;const i=e.getAttribute("src")||"",s=this.Wl.get(i);if(null!==s)for(let n=0;n<s.length;n++)if(s[n]===t)return s.splice(n,1),void(0===s.length&&(this.Wl.delete(i),ye.BR(e),e.ts instanceof u&&e.ts.delete(this),ye.clearCache(i)))}IL(){ye.clearCache(),this.Wl.clear()}rebuildParts(){this.partManager.rebuildParts()}Lc(t,e){this.ds.Lc(t,e)}Cc(t,e){this.ds.Cc(t,e)}findPartForKey(t){return this.partManager.findPartForKey(t)}findNodeForKey(t){return this.partManager.findNodeForKey(t)}findLinkForKey(t){return this.partManager.findLinkForKey(t)}findPartForData(t){return this.partManager.findPartForData(t)}findNodeForData(t){return this.partManager.findNodeForData(t)}findLinkForData(t){return this.partManager.findLinkForData(t)}findNodesByExample(...t){return this.partManager.findNodesByExample(...t)}findLinksByExample(...t){return this.partManager.findLinksByExample(...t)}get nodeTemplate(){return this.Er.get("")}set nodeTemplate(t){const e=this.Er.get("");e!==t&&(this.Er.set("",t),this.t("nodeTemplate",e,t),this.undoManager.isUndoingRedoing||this.rebuildParts())}get nodeTemplateMap(){return this.Er}set nodeTemplateMap(t){const e=this.Er;e!==t&&(this.Er=t,this.t("nodeTemplateMap",e,t),this.undoManager.isUndoingRedoing||this.rebuildParts())}get groupTemplate(){return this.Zh.get("")}set groupTemplate(t){const e=this.Zh.get("");e!==t&&(this.Zh.set("",t),this.t("groupTemplate",e,t),this.undoManager.isUndoingRedoing||this.rebuildParts())}get groupTemplateMap(){return this.Zh}set groupTemplateMap(t){const e=this.Zh;e!==t&&(this.Zh=t,this.t("groupTemplateMap",e,t),this.undoManager.isUndoingRedoing||this.rebuildParts())}get linkTemplate(){return this.jl.get("")}set linkTemplate(t){const e=this.jl.get("");e!==t&&(this.jl.set("",t),this.t("linkTemplate",e,t),this.undoManager.isUndoingRedoing||this.rebuildParts())}get linkTemplateMap(){return this.jl}set linkTemplateMap(t){const e=this.jl;e!==t&&(this.jl=t,this.t("linkTemplateMap",e,t),this.undoManager.isUndoingRedoing||this.rebuildParts())}get isMouseCaptured(){return this.hM}set isMouseCaptured(e){const i=this.ft;if(null===i)return;const s=i.Tt;s instanceof SVGElement||(e?(this.lastInput.bubbles=!1,this.Pi(s,"pointermove",this.sa,!1),this.Pi(s,"pointerdown",this.$l,!1),this.Pi(s,"pointerup",this.na,!1),this.Pi(s,"pointerout",this.oa,!1),this.Pi(s,"pointercancel",this.ra,!1),this.Bt(t,"pointermove",this.sa,!0),this.Bt(t,"pointerdown",this.$l,!0),this.Bt(t,"pointerup",this.na,!0),this.Bt(t,"pointerout",this.oa,!0),this.Bt(t,"pointercancel",this.ra,!0),this.Pi(s,"wheel",this.ea,!1),this.Bt(t,"wheel",this.ea,!0),this.Bt(t,"selectstart",this.Gh,!1)):(this.Pi(t,"pointermove",this.sa,!0),this.Pi(t,"pointerdown",this.$l,!0),this.Pi(t,"pointerup",this.na,!0),this.Pi(t,"pointerout",this.oa,!0),this.Pi(t,"pointercancel",this.ra,!0),this.Bt(s,"pointermove",this.sa,!1),this.Bt(s,"pointerdown",this.$l,!1),this.Bt(s,"pointerup",this.na,!1),this.Bt(s,"pointerout",this.oa,!1),this.Bt(s,"pointercancel",this.ra,!1),this.Pi(t,"wheel",this.ea,!0),this.Pi(t,"selectstart",this.Gh,!1),this.Bt(s,"wheel",this.ea,!1)),this.hM=e)}get position(){return this.at}set position(t){if(this.at.equals(t))return;const e=y.l().a(this.at),i=this.viewportBounds.copy();if(this.at.a(t),this.animationManager.pL(e,this.at),this.jt||null===this.ft&&!this.Iu.isReal())this.Zl(),this.bb();else{this.jt=!0;const t=this.scale,e=this.xt/t,i=this.bt/t;this.TM(this.zm,e,i,this.Fc,!1),this.jt=!1}if(!this.jt){const t=this.viewportBounds;this.onViewportBoundsChanged(i,t,this.tt,!1)}y.e(e)}get initialPosition(){return this.Px}set initialPosition(t){this.Px.equals(t)||(this.Px=t.P())}get initialScale(){return this.Sx}set initialScale(t){this.Sx!==t&&(e.s(t,"number",vt,"initialScale"),this.Sx=t)}get grid(){return null===this.Ze&&(this.Ze=this.BL()),this.Ze}set grid(t){let i=this.Ze;if(i!==t){null===i&&(this.Ze=this.BL(),i=this.Ze),t.type!==ie.Grid&&e.o("Diagram.grid must be a Panel of type Panel.Grid");const s=i.panel;null!==s&&s.remove(i),this.Ze=t,t.name="GRID",null!==s&&s.add(t),this.Eu=!1,this.S(),this.t("grid",i,t)}}get viewportBounds(){return this.eb}Zl(){const t=this.eb,e=this.at,i=this.tt;t.i(e.x,e.y,Math.max(this.xt,0)/i,Math.max(this.bt,0)/i),this.Ql()}get viewSize(){return this.Iu}set viewSize(t){const e=this.viewSize;if(!e.equals(t)){t=t.P(),this.Iu=t;let i=0,s=0;t.isReal()?(i=t.width,s=t.height):null!==this.St&&(i=this.St.clientWidth||1,s=this.St.clientHeight||1),this.xt=i,this.bt=s,this.Zl(),this.invalidateDocumentBounds(),this.t("viewSize",e,t),this.S()}}get fixedBounds(){return this.Lx}set fixedBounds(t){const i=this.Lx;i.equals(t)||((t.width===-1/0||t.height===1/0||t.height===-1/0)&&e.o("fixedBounds width/height must not be Infinity"),t=t.P(),this.Lx=t,this.invalidateDocumentBounds(),this.t("fixedBounds",i,t))}get scrollMargin(){return this.Jh}set scrollMargin(t){"number"==typeof t&&(t=new b(t));const e=this.Jh;e.equals(t)||(t=t.P(),this.Jh=t,this.t("scrollMargin",e,t),this.mu())}get scrollMode(){return this.jh}set scrollMode(t){const e=this.jh;e!==t&&(this.jh=t,1===t&&this.Us(!1),this.t("scrollMode",e,t),this.ha(),this.S())}get scrollsPageOnFocus(){return this.Ax}set scrollsPageOnFocus(t){const i=this.Ax;i!==t&&(e.s(t,"boolean",vt,"scrollsPageOnFocus"),this.Ax=t,this.t("scrollsPageOnFocus",i,t))}get positionComputation(){return this.Tx}set positionComputation(t){const i=this.Tx;i!==t&&(null!==t&&e.k(t,vt,"positionComputation"),this.Tx=t,this.Us(!1),this.t("positionComputation",i,t))}get scaleComputation(){return this.Dx}set scaleComputation(t){const i=this.Dx;i!==t&&(null!==t&&e.k(t,vt,"scaleComputation"),this.Dx=t,this.QL(this.scale,this.scale),this.t("scaleComputation",i,t))}get documentBounds(){return this.zm}iA(t){this._h=!1;let e=this.zm;e.equals(t)||(e=e.copy(),this.zm.a(t),this.Us(!1),this.D("DocumentBoundsChanged",void 0,e),this.ha(),this.S())}ensureBounds(){if(this._h){const t=x.l();this.iA(this.computeBounds(t)),x.e(t)}}get isVirtualized(){return this.sb}set isVirtualized(t){const i=this.sb;i!==t&&(e.s(t,"boolean",vt,"isVirtualized"),this.sb=t,this.t("isVirtualized",i,t))}get scale(){return this.tt}set scale(t){const e=this.tt;e!==t&&this.QL(e,t)}get defaultScale(){return this.Gm}set defaultScale(t){this.Gm=t}get autoScale(){return this.Gl}set autoScale(t){const e=this.Gl;e!==t&&(this.Gl=t,this.t("autoScale",e,t),1!==t&&this.Us(!1))}get initialAutoScale(){return this.Pr}set initialAutoScale(t){const e=this.Pr;e!==t&&(this.Pr=t,this.t("initialAutoScale",e,t))}get initialViewportSpot(){return this.Rx}set initialViewportSpot(t){const i=this.Rx;i!==t&&(t.isSpot()||e.o("initialViewportSpot must be a specific Spot: "+t),this.Rx=t,this.t("initialViewportSpot",i,t))}get initialDocumentSpot(){return this.Fx}set initialDocumentSpot(t){const i=this.Fx;i!==t&&(t.isSpot()||e.o("initialViewportSpot must be a specific Spot: "+t),this.Fx=t,this.t("initialDocumentSpot",i,t))}get minScale(){return this.Mx}set minScale(t){const i=this.Mx;i!==t&&(t>0?(this.Mx=t,this.t("minScale",i,t),t>this.scale&&(this.scale=t)):e.W(t,"> 0",vt,"minScale"))}get maxScale(){return this.Nx}set maxScale(t){const i=this.Nx;i!==t&&(t>0?(this.Nx=t,this.t("maxScale",i,t),t<this.scale&&(this.scale=t)):e.W(t,"> 0",vt,"maxScale"))}get zoomPoint(){return this.Cx}set zoomPoint(t){this.Cx.equals(t)||(t=t.P(),this.Cx=t)}get contentAlignment(){return this.Fc}set contentAlignment(t){const e=this.Fc;e.equals(t)||(t=t.P(),this.Fc=t,this.t("contentAlignment",e,t),this.Us(!1))}get initialContentAlignment(){return this.Om}set initialContentAlignment(t){const e=this.Om;e.equals(t)||(t=t.P(),this.Om=t,this.t("initialContentAlignment",e,t))}get padding(){return this.Zt}set padding(t){"number"==typeof t&&(t=new b(t));const e=this.Zt;e.equals(t)||(t=t.P(),this.Zt=t,this.invalidateDocumentBounds(),this.t("padding",e,t))}get partManager(){return this.mM}set partManager(t){const i=this.mM;i!==t&&(null!==t.diagram&&e.o("Cannot share PartManagers between Diagrams: "+t.toString()),i&&i.So(null),this.mM=t,t.So(this))}get nodes(){return this.partManager.nodes.iterator}get links(){return this.partManager.links.iterator}get parts(){return this.partManager.parts.iterator}findTopLevelNodesAndLinks(){const t=new u,e=this.nodes;for(;e.next();){const i=e.value;i.isTopLevel&&t.add(i)}const i=this.links;for(;i.next();){const e=i.value;e.isTopLevel&&t.add(e)}return t.iterator}findTopLevelGroups(){return this.Vr.iterator}get routers(){return this.Vc}doLinkRouting(t){this.No=!0;const e=this.Vc.r;for(let i=0;i<e.length;i++)e[i].canRoute(t)&&e[i].routeLinks(this.Sr,t);this.No=!1}get layout(){return this.ie}set layout(t){const e=this.ie;e!==t&&(this.ie=t,t.diagram=this,t.group=null,this.Ur=!0,this.t("layout",e,t),this.requestUpdate())}layoutDiagram(t){this.Mi(),t&&this.Nb(!0),this.ys?this.RM(!1,this.xl||0!==this.Vc.count&&0!==this.Yn.size):(this.vc=!0,this.fr())}Nb(t){const e=this.Vr.iterator;for(;e.next();)this.eA(e.value,t);this.layout&&(t?this.layout.isValidLayout=!1:this.layout.invalidateLayout())}eA(t,e){if(null===t)return;const i=t.aa.iterator;for(;i.next();){const t=i.value;this.eA(t,e)}null!==t.layout&&(e?t.layout.isValidLayout=!1:t.layout.invalidateLayout())}RM(t,e){if(this.Xx)return;const i=this.X;this.X=!0;const s="Layout",n=this.undoManager.transactionLevel,o=this.layout,r=this.animationManager;try{0===n&&(this.undoManager.yl=!0,this.startTransaction(s)),n<=1&&!r.defaultAnimation.isAnimating&&!r.pi&&(t||r.Dl(s)),this.Ur=!1;let i=this.Vr.iterator;for(;i.next();)this.sA(i.value,t,n,e);let a=!1;if(o.isValidLayout||(!t||o.isRealtime||null===o.isRealtime||0===n?(o.doLayout(this),this.t0(this),a=!0,o.isValidLayout=!0):this.Ur=!0),a||this.t0(this),this.doLinkRouting(this),this.Sr.clear(),0!==this.$h.size){for(let t=0;t<23&&0!==this.$h.size;t++){for(i=this.Vr.iterator;i.next();)this.nA(i.value);const t=this.Sr;this.Sr=this.$h,this.$h=t,this.t0(this),this.doLinkRouting(this)}this.Sr.clear(),this.$h.clear()}}finally{const t=this.undoManager.yl;0===n&&(this.commitTransaction(s),this.undoManager.yl=!1),t&&(0===n||1===n)&&r.vS(),this.Ur&&(this.Ur=!o.isValidLayout),this.X=i}}sA(t,e,i,s){const n=t.aa.iterator;for(;n.next();)this.sA(n.value,e,i,s);const o=t.layout;null===o||o.isValidLayout?s&&this.doLinkRouting(t):!e||o.isRealtime||0===i?(t.ca=!t.location.isReal(),o.doLayout(t),t.invalidateLayout(32),this.kb(t),this.t0(t),this.doLinkRouting(t),o.isValidLayout=!0):(this.doLinkRouting(t),this.Ur=!0)}nA(t){const e=t.aa.iterator;for(;e.next();)this.nA(e.value);this.t0(t),this.doLinkRouting(t)}get isTreePathToChildren(){return this.vx}set isTreePathToChildren(t){const i=this.vx;if(i!==t&&(e.s(t,"boolean",vt,"isTreePathToChildren"),this.vx=t,this.t("isTreePathToChildren",i,t),!this.undoManager.isUndoingRedoing)){const t=this.nodes;for(;t.next();)t.value.r0()}}findTreeRoots(){const t=new h,e=this.nodes;for(;e.next();){const i=e.value;i.isTopLevel&&null===i.findTreeParentLink()&&t.add(i)}return t.iterator}get treeCollapsePolicy(){return this.Ox}set treeCollapsePolicy(t){const i=this.Ox;i!==t&&(1!==t&&2!==t&&3!==t&&e.o("Unknown Diagram.treeCollapsePolicy: "+t),this.Ox=t,this.t("treeCollapsePolicy",i,t))}get isCollapsingExpanding(){return this.QS}set isCollapsingExpanding(t){this.QS=t}oR(){const t=new m,e=new m;function i(i){const s=i.toLowerCase(),n=new h;t.set(i,n),t.set(s,n),e.set(i,i),e.set(s,i)}i("InitialAnimationStarting"),i("AnimationStarting"),i("AnimationFinished"),i("BackgroundSingleClicked"),i("BackgroundDoubleClicked"),i("BackgroundContextClicked"),i("ClipboardChanged"),i("ClipboardPasted"),i("DocumentBoundsChanged"),i("ExternalObjectsDropped"),i("GainedFocus"),i("InitialLayoutCompleted"),i("LayoutCompleted"),i("LinkDrawn"),i("LinkRelinked"),i("LinkReshaped"),i("LostFocus"),i("Modified"),i("ObjectSingleClicked"),i("ObjectDoubleClicked"),i("ObjectContextClicked"),i("PartCreated"),i("PartResized"),i("PartRotated"),i("SelectionMoved"),i("SelectionCopied"),i("SelectionDeleting"),i("SelectionDeleted"),i("SelectionGrouped"),i("SelectionUngrouped"),i("ChangingSelection"),i("ChangedSelection"),i("SubGraphCollapsed"),i("SubGraphExpanded"),i("TextEdited"),i("ThemeChanged"),i("TreeCollapsed"),i("TreeExpanded"),i("ViewportBoundsChanged"),i("InvalidateDraw"),this.$S=t,this.ZS=e}YL(t){const e=this.ZS.get(t);return null!==e?e:this.ZS.get(t.toLowerCase())}KM(t){let i=this.$S.get(t);if(null!==i)return i;const s=t.toLowerCase();if(i=this.$S.get(s),null!==i)return i;e.o("Unknown DiagramEvent name: "+t)}addDiagramListener(t,i){e.s(t,"string",vt,"addDiagramListener:name"),e.k(i,vt,"addDiagramListener:listener");const s=this.KM(t);return null!==s&&s.add(i),this}removeDiagramListener(t,i){e.s(t,"string",vt,"removeDiagramListener:name"),e.k(i,vt,"addDiagramListener:listener");const s=this.KM(t);null!==s&&s.delete(i)}raiseDiagramEvent(t,e,i){this.D(t,e,i)}D(t,e,i){const s=this.KM(t),n=new D;n.diagram=this;const o=this.YL(t);null!==o&&(n.name=o),void 0!==e&&(n.subject=e),void 0!==i&&(n.parameter=i);const r=s.length;if(1===r)s.elt(0)(n);else if(0!==r){const t=s.toArray();for(let e=0;e<r;e++){const i=t[e];i(n)}}}isUnoccupied(t,e){return this.getPositions(!1,null,e||null).isUnoccupied(t.x,t.y,t.width,t.height)}computeOccupiedArea(t){return this.isVirtualized?this.viewportBounds.copy():this._h?this.VL(t):t.a(this.documentBounds)}getPositions(t,e,i){let s=this.Hl;null===s&&(this.Hl=s=new Fe(this.avoidanceCellSize));let n=e;if(s.Do||s.fa!==n||s.GM!==i){if(s.HM=Math.max(s.Kc+1,Math.floor(this.avoidanceLimit/this.avoidanceCellSize.width)),s.jM=Math.max(s.Kc+1,Math.floor(this.avoidanceLimit/this.avoidanceCellSize.height)),null!==n&&(n=this.oA(n)),null===n){const t=x.l();this.computeOccupiedArea(t),t.inflate(100,100),s.Cb(t);const e=this.nodes;for(;e.next();){const s=e.value,n=s.layer;null===n||!n.visible||n.isTemporary||this.qM(s,i,t)}x.e(t)}else{if(n.memberParts.count>0){const t=this.computePartsBounds(n.memberParts,!1);t.inflate(20,20),s.Cb(t)}const t=x.l(),e=n.memberParts;for(;e.next();){const s=e.value;s instanceof Ce&&this.qM(s,i,t)}x.e(t)}s.fa=n,s.GM=i,s.Do=!1}else t&&s.rA();return s}get avoidanceCellSize(){return this.fM}set avoidanceCellSize(t){this.Hl=null,this.fM=new v(Math.max(1,t.width),Math.max(1,t.height))}get avoidanceLimit(){return this.uM}set avoidanceLimit(t){this.uM=Math.max(1,t)}oA(t){return t.canAvoid()?t:null!==t.containingGroup?this.oA(t.containingGroup):null}qM(t,e,i){if(t===e||!t.isVisible())return;const s=t.canAvoid();if(s){const e=t.getAvoidableRect(i);this.Hl.UR(e.x,e.y,e.width,e.height)}if(t instanceof _e&&(!s||t.avoidableMembers)){const s=t.memberParts;for(;s.next();){const t=s.value;t instanceof Ce&&this.qM(t,e,i)}}}WM(t){null!==this.Hl&&!this.Hl.Do&&(void 0===t||t.canAvoid())&&(this.Hl.Do=!0)}get autoScrollInterval(){return this.Im}set autoScrollInterval(t){const e=this.Im;e!==t&&(this.Im=t,this.t("autoScrollInterval",e,t))}get autoScrollRegion(){return this.Em}set autoScrollRegion(t){"number"==typeof t&&(t=new b(t));const e=this.Em;e.equals(t)||(t=t.P(),this.Em=t,this.invalidateDocumentBounds(),this.t("autoScrollRegion",e,t))}doAutoScroll(t){this.Ym.a(t),this.computeAutoScrollPosition(this.Ym).equalsApprox(this.position)?this.stopAutoScroll():this.lA()}lA(){if(-1!==this.Rc)return;const t=this.Im,i=this;this.Rc=e.tr((()=>{if(-1===i.Rc||(i.stopAutoScroll(),null===i.lastInput.event))return;const t=i.computeAutoScrollPosition(i.Ym);if(t.equalsApprox(i.position))return;i.position=t,i.lastInput.documentPoint=i.transformViewToDoc(i.Ym),i.doMouseMove(),i._h=!0;const e=x.l();i.computeBounds(e),e.unionRect(i.documentBounds),i.iA(e),x.e(e),i.Be=!0,i.maybeUpdate(),i.lA()}),t)}stopAutoScroll(){-1!==this.Rc&&(e.Tg(this.Rc),this.Rc=-1)}computeAutoScrollPosition(t){let e=this.position;const i=this.Em;if(i.top<=0&&i.left<=0&&i.right<=0&&i.bottom<=0)return e;const s=this.viewportBounds,n=this.scale,o=x.V(0,0,s.width*n,s.height*n),r=y.V(0,0);if(t.x>=o.x&&t.x<o.x+i.left&&this.allowHorizontalScroll){let e=Math.max(this.scrollHorizontalLineChange,1);e|=0,r.x-=e,t.x<o.x+i.left/2&&(r.x-=e),t.x<o.x+i.left/4&&(r.x-=4*e)}else if(t.x<=o.x+o.width&&t.x>o.x+o.width-i.right&&this.allowHorizontalScroll){let e=Math.max(this.scrollHorizontalLineChange,1);e|=0,r.x+=e,t.x>o.x+o.width-i.right/2&&(r.x+=e),t.x>o.x+o.width-i.right/4&&(r.x+=4*e)}if(t.y>=o.y&&t.y<o.y+i.top&&this.allowVerticalScroll){let e=Math.max(this.scrollVerticalLineChange,1);e|=0,r.y-=e,t.y<o.y+i.top/2&&(r.y-=e),t.y<o.y+i.top/4&&(r.y-=4*e)}else if(t.y<=o.y+o.height&&t.y>o.y+o.height-i.bottom&&this.allowVerticalScroll){let e=Math.max(this.scrollVerticalLineChange,1);e|=0,r.y+=e,t.y>o.y+o.height-i.bottom/2&&(r.y+=e),t.y>o.y+o.height-i.bottom/4&&(r.y+=4*e)}return r.equalsApprox(y.wo)||(e=new y(e.x+r.x/n,e.y+r.y/n)),x.e(o),y.e(r),e}makeSvg(i){this.ql.has("SVG")||this.addRenderer("SVG",new Rt(this,t.document));const s=new Rt(this,t.document,!0);void 0===i&&(i={});const n=this;function o(t,i){const o=n.hA(t,"SVG",s),r=null!==o?o.svg:null;return e.it(i)?(i(r),null):r}return this.aA(o,i)}makeSVG(t){return this.makeSvg(t)}addRenderer(t,e){this.ql.set(t,e)}removeRenderer(t){this.ql.delete(t)}cacheGroupExternalLinks(t){this.SM=t,t||this.nodes.each((t=>{t instanceof _e&&(t.l0=null)}))}aA(i,s){const n=s.callback;let o=!0;const r=this.Wl.iterator;for(;r.next();)if(!r.value[0].hn){o=!1;break}if(!e.it(n)||o)return i(s,n,this);const a=this;function h(){const e=+new Date;for(o=!0,r.reset();r.next();)if(!r.value[0].hn){o=!1;break}o||e-u>l?i(s,n,a):t.requestAnimationFrame(h)}const l=s.callbackTimeout||300,u=+new Date;return t.requestAnimationFrame((()=>h())),null}makeImage(t){return vt.isUsingDOM()?(void 0===t&&(t={}),t.returnType="Image",this.makeImageData(t)):null}makeImageData(t){return void 0===t&&(t={}),this.aA(this.VR,t)}static img="image";VR(t,i,s){const n=s.hA(t,"canvas",null);if(null===n)return null;const o=n.E.canvas;let r=null;if(null!==o){let s=t.returnType;switch(s=void 0===s?"string":s.toLowerCase(),s){case vt.img+"data":r=n.getImageData(0,0,o.width,o.height);break;case vt.img:const s=(t.document||document).createElement("img");s.src=o.toDataURL(t.type,t.details),r=s;break;case"blob":{const s=o;return e.it(i)||(r="",e.o('Error: Diagram.makeImageData called with "returnType: toBlob", but no required "callback" function property defined.')),e.it(s.toBlob)?(s.toBlob(i,t.type,t.details),"toBlob"):(i(null),null)}case"string":default:r=o.toDataURL(t.type,t.details)}}return e.it(i)?(i(r),null):r}static zR=!1;hA(t,i,s){if(this.animationManager.stopAnimation(),this.maybeUpdate(),null===this.ft)return null;e.K(t)||e.o("properties argument must be an Object.");let n=!1,o=t.size||null,r=t.scale||null;void 0!==t.scale&&isNaN(t.scale)&&(r="NaN");let a=t.maxSize;void 0===t.maxSize&&(n=!0,a="SVG"===i?new v(1/0,1/0):new v(2e3,2e3));const l=t.position||null;let u=t.parts||null;Array.isArray(u)&&(u=new h(u));let c=void 0===t.padding?1:t.padding;const d=t.background||null;let f=t.omitTemporary;void 0===f&&(f=!0);const g=t.document||document,p=t.elementFinished||null;let m=t.showTemporary;void 0===m&&(m=!f);let w=t.showGrid;void 0===w&&(w=m),null!==o&&isNaN(o.width)&&isNaN(o.height)&&(o=null),"number"==typeof c?c=new b(c):c instanceof b||e.o("MakeImage padding must be a Margin or a number."),c.left=Math.max(c.left,0),c.right=Math.max(c.right,0),c.top=Math.max(c.top,0),c.bottom=Math.max(c.bottom,0),this.Qt.clearContextCache(!0);const k=new Bt(null,g,void 0,!0),S=k.li;if(!(o||r||u||l))return k.width=this.xt+Math.ceil(c.left+c.right),k.height=this.bt+Math.ceil(c.top+c.bottom),"SVG"===i?null===s?null:(s.resize(k.width,k.height,k.width,k.height),s.ua=g,s.Ku=p,this.Pb(s.li,c,new v(k.width,k.height),this.tt,this.at,u,d,m,w),s.li):(this.Uu=!1,this.Pb(S,c,new v(k.width,k.height),this.tt,this.at,u,d,m,w),this.Uu=!0,k.li);const P=this.Gm,M=this.documentBounds.copy();if(M.subtractMargin(this.Zt),m){const t=this.Xt.r,e=t.length;for(let i=0;i<e;i++){const e=t[i];if(!e.visible||!e.isTemporary)continue;const s=e.Ct.r,n=s.length;for(let t=0;t<n;t++){const e=s[t];if(!e.isInDocumentBounds||!e.isVisible())continue;const i=e.actualBounds;i.isReal()&&M.unionRect(i)}}}let C=new y(M.x,M.y);if(null!==u){const t=new x(0,0,0,0);let e=!0;const i=u.iterator;for(i.reset();i.next();){const s=i.value;if(!(s instanceof ke))continue;const n=s.layer;if(null!==n&&!n.visible||null!==n&&!m&&n.isTemporary||!s.isVisible())continue;const o=s.actualBounds;o.isReal()&&(e?(e=!1,t.a(o)):t.unionRect(o))}M.width=t.width,M.height=t.height,C.x=t.x,C.y=t.y}null!==l&&l.isReal()&&(C=l,r||(r=P));let A=0,N=0;null!==c&&(A=c.left+c.right,N=c.top+c.bottom);let L=0,T=0;null!==o&&(L=o.width,T=o.height,isFinite(L)&&(L=Math.max(0,L-A)),isFinite(T)&&(T=Math.max(0,T-N)));let D=0,O=0;if(null!==o&&null!==r?("NaN"===r&&(r=P),o.isReal()?(D=L,O=T):isNaN(T)?(D=L,O=M.height*r):(D=M.width*r,O=T)):null!==o?o.isReal()?(r=Math.min(L/M.width,T/M.height),D=L,O=T):isNaN(T)?(r=L/M.width,D=L,O=M.height*r):(r=T/M.height,D=M.width*r,O=T):null!==r?"NaN"===r&&a.isReal()?(r=Math.min((a.width-A)/M.width,(a.height-N)/M.height),r>P?(r=P,D=M.width,O=M.height):(D=a.width,O=a.height)):(D=M.width*r,O=M.height*r):(r=P,D=M.width,O=M.height),null!==c?(D+=A,O+=N):c=new b(0),null!==a){let t=a.width,e=a.height;"SVG"!==i&&n&&vt.zR,isNaN(t)&&(t=2e3),isNaN(e)&&(e=2e3),isFinite(t)&&(D=Math.min(D,t)),isFinite(e)&&(O=Math.min(O,e))}return k.width=Math.ceil(D),k.height=Math.ceil(O),"SVG"===i?null===s?null:(s.resize(k.width,k.height,k.width,k.height),s.ua=g,s.Ku=p,this.Pb(s.li,c,new v(Math.ceil(D),Math.ceil(O)),r,C,u,d,m,w),s.li):(this.Uu=!1,this.Pb(S,c,new v(Math.ceil(D),Math.ceil(O)),r,C,u,d,m,w),this.Uu=!0,k.li)}static Xu=null;static cA="5da73c80a36555d4038e4972187c3cae51fd22";static dw=!1;static Yk=()=>{if(void 0===vt.cA[5]&&(k.prototype.$e=k.prototype.xw),!vt.isUsingDOM())return;const t=e.hs("canvas"),i=t.getContext("2d"),s=e.Ts("7ca11abfd022028846");i[s]=e.Ts("398c3597c01238");const n="7ca11abfd7330390",o=[vt.cA,e.dw+"4ae6247590da4bb21c324ba3a84e385776",k.Yk+"fb236cdfda5de14c134ba1a95a2d4c7cc6f93c1387",S.za],r=10,a=0;for(let h=1;h<5;h++)i[e.Ts(n)](e.Ts(o[h-1]),r,15*h+a);i[s]=e.Ts("39f046ebb36e4b");for(let h=1;h<5;h++)i[e.Ts(n)](e.Ts(o[h-1]),r,15*h+a);(4!==o.length||"5"!==o[0][0]||"7"!==o[3][0])&&(k.prototype.$e=k.prototype.xw),vt.Xu=t}}class xt{fA;uA;JM;Ne;constructor(t){if(this.fA=null,this.uA="63ad05bbe23a1786468a4c741b6d2",this.JM="@onz",this.uA===this._tk)return this.JM=!0,void(this.Ne=this.JM);this.Ne=null}XR(i,s){let n="f";const o=t[e.Ts("76a715b2f73f148a")][e.Ts("72ba13b5")]||"",r=e.Ts;if(this.Ne=!0,!vt.isUsingDOM())return;let a=vt[r("76a115b6ed251eaf4692")];if(!a){const t=o[r("76ad18b4f73e")];for(let i=o[r("73a612b6fb191d")](r("35e7"))+2;i<t;i++)n+=o[i];const e=n[r("73a612b6fb191d")](r("7da71ca0ad381e90"));return void(this.Ne=!(e>=0&&e<n[r("73a612b6fb191d")](r("35"))))}const h=vt.zM.iterator;for(;h.next();){a=h.value;const i=r(a).split(r("39e9"));if(i.length<6)return;const l=r(i[1]).split(".");if("7da71ca0"!==i[4])return;const u=r(e[r("6cae19")]).split(".");if(!(l[0]>u[0]||l[0]===u[0]&&l[1]>=u[1]))continue;const c="73a612b6fb191d",d=t[r("74a900bae4370f8b51")][r("6fbb13a1c2311e8a57")].toLowerCase(),f=d[r(c)](r("3aad1ab6e022098b4dc4")),g=r(i[2]);if(f>-1){const t=d[r(c)](g.toLowerCase()+"/");if(this.Ne=!(t>-1&&t<f),!this.Ne)return}const p=o[r("76ad18b4f73e")];for(let t=o[r(c)](r("35e7"))+2;t<p;t++)n+=o[t];let m=n[r(c)](g);if(m<0&&g!==r("7da71ca0ad381e90")&&(m=n[r(c)](r("76a715b2ef3e149757"))),m<0&&(m=n[r(c)](r("76a715b2ef3e149757"))),m<0&&(m=n[r(c)](r("2bfa41fdb3784bca12"))),m<0&&(m=o[r(c)](r("7baa19a6f76c1988428554"))),m<0&&(m=o[r(c)](r("7ea902b2b9221e9c57c45767196566"))),this.Ne=!(m>=0&&m<n[r(c)](r("35"))||-1===n[r(c)](r("35"))),!this.Ne||o[r(c)](r("7fb002b6ed25128b4da25b2e"))&&(this.Ne=!(o[r(c)](g)>-1),!this.Ne))return;const y=t[e.Ts("76a715b2f73f148a")][e.Ts("69ad17a1e03e")],v=y[r(c)](r("7fb002b6ed25128b4da25b2e"));if(v>-1&&(this.Ne=!(y[r(c)](g)>v),!this.Ne))return;const x=g;if("#"!==x[0])continue;const b=e.hs("div");let w=i[0].replace(/[A-Za-z]/g,"");for(;w.length<4;)w+="9";const k=w;w=w.substring(w.length-4);let S="";const P=["gsh","gsf"],M=["Header","Background","Display","Feedback"];if(S+=P[parseInt(w.substring(0,1),10)%2],S+=M[parseInt(w.substring(0,1),10)%4],b[r("79a417a0f0181a8946")]=S,t.document[r("78a712aa")]){t.document[r("78a712aa")][r("7bb806b6ed32388c4a875b")](b);const e=t.getComputedStyle(b).getPropertyValue(r("78a704b7e62456904c9b12701b6532a8")),i=t.getComputedStyle(b).getPropertyValue(r("75b817b0ea2202"));if(t.document[r("78a712aa")][r("68ad1bbcf533388c4a875b")](b),!e)continue;const s=t[r("77a902b0eb1b1e804a8a")],n="0."+parseInt(k,10)%100;if(i===n||-1!==e.indexOf(parseInt(x[1]+x[2],16))&&-1!==e.indexOf(parseInt(x[3]+x[4],16)))return void(this.Ne=!1);if(s&&s(r("32ae19a1e0331fc94084537c067a67fa59f1386b89d006")).matches){S="."+S;for(let t=0;t<document.styleSheets.length;t++){const e=document.styleSheets[t].rules||document.styleSheets[t].cssRules;for(const t in e)if(S===e[t].selectorText)return void(this.Ne=!1)}}}else this.Ne=null,s&&(this.Ne=!1)}}Xu(t){return t.Qt.setTransform(t.Vi,0,0,t.Vi,0,0),t.Qt.commitTransform(),null===this.Ne&&this.XR(t,!0),0<this.Ne&&this!==this.fA}}class bt{$M;ZM;constructor(t){this.$M=void 0===t?new y:t,this.ZM=new y}get point(){return this.$M}set point(t){this.$M=t}get shifted(){return this.ZM}set shifted(t){this.ZM=t}}class wt{Me;qL;Mb;constructor(t,e,i){this.Me=t,this.qL=e,this.Mb=i}}class kt{isGridSnapEnabled;isGridSnapRealtime;gridSnapCellSize;gridSnapCellSpot;gridSnapOrigin;dragsLink;dragsTree;groupsSnapMembers;groupsAlwaysMove;dragsMembers;constructor(t){this.Ri(),t&&Object.assign(this,t)}Ri(){this.isGridSnapEnabled=!1,this.isGridSnapRealtime=!0,this.gridSnapCellSize=new v(NaN,NaN).u(),this.gridSnapCellSpot=w.TopLeft,this.gridSnapOrigin=new y(NaN,NaN).u(),this.dragsLink=!1,this.dragsTree=!1,this.groupsSnapMembers=!1,this.groupsAlwaysMove=!0,this.dragsMembers=!0}}class St extends vt{constructor(i,s){let n;return void 0===i||"string"==typeof i||t.Element&&i instanceof Element?n=i:e.K(i)&&(s=i),super(n),this.dA(),s&&this.setProperties(s),this}dA(){this.allowDragOut=!0,this.allowMove=!1,this.isReadOnly=!0,this.contentAlignment=w.TopCenter,this.layout=new Ue}setupRouters(){}reset(){super.reset(),this.dA()}}class Pt extends vt{Lb;Ab;Tb;Db;h0;Gc;Ll;QM;_M;Fb;t2;constructor(i,s){let n;return void 0===i||"string"==typeof i||t.Element&&i instanceof Element?n=i:e.K(i)&&(s=i),super(n),this.animationManager.isEnabled=!1,this.jt=!0,this.Lb=null,this.Ru=!1,this.vu=!1,this.Ab=!0,this.Tb=!0,this.Db=0,this.h0=!1,this.Gc=null,this.setRenderingHint("drawShadows",!1),this.Ll=new ke({selectable:!0,selectionAdorned:!1,selectionObjectName:"BOXSHAPE",locationObjectName:"BOXSHAPE",resizeObjectName:"BOXSHAPE",cursor:"move"}).add(new he({name:"BOXSHAPE",fill:"transparent",stroke:"magenta",strokeWidth:2}).theme("stroke","overviewBox")).Et(),this.allowCopy=!1,this.allowDelete=!1,this.allowDrop=!1,this.allowSelect=!0,this.autoScrollRegion=new b(0,0,0,0),this.at.i(0,0),this.toolManager.Jt("Dragging",new Mt,this.toolManager.mouseMoveTools),this.click=()=>{const t=this.observed;if(null===t)return;const e=t.viewportBounds,i=this.lastInput.documentPoint;t.position=new y(i.x-e.width/2,i.y-e.height/2)},this.QM=t=>{this.invalidateDocumentBounds(),this.a0()},this._M=t=>{null!==this.observed&&(this.invalidateDocumentBounds(),this.S())},this.Fb=t=>{this.updateDelay<1?this.S():this.h0||(this.h0=!0,e.tr((()=>this.redraw()),this.updateDelay))},this.t2=t=>{null!==this.observed&&this.a0()},this.autoScale=2,this.jt=!1,s&&Object.assign(this,s),this}setupRouters(){}computePixelRatio(){return 1}redraw(){this.h0&&this.updateDelay>=1&&(this.h0=!1,this.YR()),super.redraw()}Bi(){if(null===this.St&&e.o("No div specified"),null===this.ft&&e.o("No canvas specified"),this.ft instanceof Rt||(this.box.WS(),!this.Be))return;const t=this.observed;if(null===t||t.animationManager.defaultAnimation.isAnimating||!t.Uh)return;this.i0();const i=this.ft,s=this.Qt;if(s.clearContextCache(!0),s.setTransform(1,0,0,1,0,0),s.clearRect(0,0,i.width,i.height),this.updateDelay<1)this.gA();else if(null!==this.Gc){s.drawImage(this.Gc.Tt,0,0);const t=this.T;s.scale(this.Vi,this.Vi),s.transform(t.m11,t.m12,t.m21,t.m22,t.dx,t.dy),s.commitTransform()}const n=this.Xt.r,o=n.length;for(let e=0;e<o;e++)n[e].Bi(s,this);this.Ic=!1,this.Be=!1}YR(){const t=this.ft,e=this.Qt;if(null!==t&&null!==e){if(this.i0(),null===this.Gc){const e=new Bt(null);e.width=t.width,e.height=t.height,this.Gc=e}try{this.ft=this.Gc,this.Qt=this.ft.li,this.Qt.clearContextCache(!0),this.Qt.setTransform(1,0,0,1,0,0),this.Qt.clearRect(0,0,this.ft.width,this.ft.height),this.gA()}finally{this.ft=t,this.Qt=e}}}gA(){const t=this.observed;if(null===t)return;const e=this.drawsTemporaryLayers,i=this.drawsGrid&&e,s=t.grid;if(i&&null!==s&&s.visible&&!isNaN(s.width)&&!isNaN(s.height)){const e=x.l().a(this.viewportBounds).unionRect(t.viewportBounds);t._l(e),x.e(e),t.Mi()}const n=this.T,o=this.Qt;o.scale(this.Vi,this.Vi),o.transform(n.m11,n.m12,n.m21,n.m22,n.dx,n.dy),o.commitTransform();const r=this.viewportBounds,a=t.Xt.r,h=a.length,l=this.Xt.r;this.ps(l,l.length,this,this.viewportBounds);for(let u=0;u<h;u++)a[u].KF(o,r,this,e,i)}get observed(){return this.Lb}set observed(t){const i=this.Lb;if(t instanceof Pt&&e.o("Overview.observed Diagram may not be an Overview itself: "+t),i!==t){if(null!==i&&this.KR(i),this.Lb=t,null!==t&&this.GR(t),this.invalidateDocumentBounds(),null===t){this.Gc=null;const t=this.ft,e=this.Qt;t&&e&&(e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height))}else this.Fb(null),this.a0(),this.S();this.t("observed",i,t)}}get box(){return this.Ll}set box(t){const e=this.Ll;e!==t&&(t.Et(),this.Ll=t,this.remove(e),this.add(this.Ll),this.a0(),this.t("box",e,t))}get drawsTemporaryLayers(){return this.Ab}set drawsTemporaryLayers(t){this.Ab!==t&&(this.Ab=t,this.redraw())}get drawsGrid(){return this.Tb}set drawsGrid(t){this.Tb!==t&&(this.Tb=t,this.redraw())}get updateDelay(){return this.Db}set updateDelay(t){t<0&&(t=0),this.Db!==t&&(this.Db=t)}GR(t){null!==t&&(t.addDiagramListener("ViewportBoundsChanged",this.QM),t.addDiagramListener("DocumentBoundsChanged",this._M),t.addDiagramListener("InvalidateDraw",this.Fb),t.addDiagramListener("AnimationFinished",this.t2),this.add(this.box))}KR(t){null!==t&&(this.remove(this.box),t.removeDiagramListener("ViewportBoundsChanged",this.QM),t.removeDiagramListener("DocumentBoundsChanged",this._M),t.removeDiagramListener("InvalidateDraw",this.Fb),t.removeDiagramListener("AnimationFinished",this.t2))}a0(){const t=this.box,e=this.observed;if(null===e)return;this.Be=!0;const i=e.viewportBounds,s=t.selectionObject,n=v.l();n.i(i.width,i.height),s.desiredSize=n,v.e(n);const o=2/this.scale;s instanceof he&&(s.strokeWidth=o),t.location=new y(i.x-o/2,i.y-o/2),t.isSelected=!0}computeBounds(){const t=this.observed;if(null===t)return x.Fg;const e=t.documentBounds.copy();return e.unionRect(t.viewportBounds),e}invalidateViewport(t,e){!0!==this.Be&&(this.Be=!0,this.requestUpdate())}onViewportBoundsChanged(t,e,i,s){this.jt||(this.Ql(),this.S(),this.ha(),this.invalidateDocumentBounds(),this.a0(),this.Ui.scale=i,this.Ui.position.x=t.x,this.Ui.position.y=t.y,this.Ui.bounds.a(t),this.Ui.isScroll=s,this.D("ViewportBoundsChanged",this.Ui,t))}}class Mt extends z{ih;constructor(){super(),this.ih=null}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;if(null===t||!t.allowMove||!t.allowSelect)return!1;const e=t.observed;if(null===e)return!1;const i=t.lastInput;if(!i.left||t.currentTool!==this&&(!this.isBeyondDragSize()||i.isTouchEvent&&i.timestamp-t.firstInput.timestamp<this.delay))return!1;if(null===this.findDraggablePart()){const i=e.viewportBounds;this.ih=new y(i.width/2,i.height/2);const s=t.firstInput.documentPoint;e.position=new y(s.x-this.ih.x,s.y-this.ih.y)}return!0}doActivate(){this.ih=null,super.doActivate()}doUpdateCursor(t){const e=this.diagram,i=e.box;null!==i&&i.cursor&&(e.currentCursor=i.cursor)}moveParts(t,e,i){void 0===i&&(i=!1);const s=this.diagram,n=s.observed;if(null===n)return;const o=s.box;if(null===o)return;if(null===this.ih){const t=s.firstInput.documentPoint,e=o.location;this.ih=new y(t.x-e.x,t.y-e.y)}const r=s.lastInput.documentPoint;n.position=new y(r.x-this.ih.x,r.y-this.ih.y)}}class Ct{N;i2;e2;s2;o2;l2;h2;a2;c2;eh;f2;Rb;vb;Ob;Ib;u2;Fo;d2;constructor(t){u.Gi(this),this.N=vt.um(),this.i2=!0,this.e2=!0,this.s2=!0,this.o2=!1,this.l2=!1,this.h2=!1,this.a2=!1,this.c2=null,this.eh=null,this.f2=1.05,this.Rb=NaN,this.vb=null,this.Ob=NaN,this.Ib=x.Fg,this.u2=!1,this.Fo=null,this.d2=200,t&&Object.assign(this,t)}toString(){return"CommandHandler"}get diagram(){return this.N}So(t){this.N=t}doStart(){}doStop(){}doKeyDown(){const t=this.diagram,i=t.lastInput,s=e._o?i.meta:i.control,n=i.shift,o=i.alt,r=i.commandKey;!s||"Insert"!==r&&"c"!==r?s&&"x"===r||n&&"Delete"===r?this.canCutSelection()&&this.cutSelection():s&&"v"===r||n&&"Insert"===r?this.canPasteSelection()&&this.pasteSelection():s&&"y"===r||s&&n&&"z"===r||o&&n&&"Backspace"===r?this.canRedo()&&this.redo():s&&"z"===r||o&&"Backspace"===r?this.canUndo()&&this.undo():"Delete"===r||"Backspace"===r?this.canDeleteSelection()&&this.deleteSelection():s&&"a"===r?this.canSelectAll()&&this.selectAll():"Escape"===r?this.canStopCommand()&&this.stopCommand():"ArrowUp"===r?t.allowVerticalScroll&&(s?t.scroll("pixel","up"):t.scroll("line","up")):"ArrowDown"===r?t.allowVerticalScroll&&(s?t.scroll("pixel","down"):t.scroll("line","down")):"ArrowLeft"===r?t.allowHorizontalScroll&&(s?t.scroll("pixel","left"):t.scroll("line","left")):"ArrowRight"===r?t.allowHorizontalScroll&&(s?t.scroll("pixel","right"):t.scroll("line","right")):"PageUp"===r?n&&t.allowHorizontalScroll?t.scroll("page","left"):t.allowVerticalScroll&&t.scroll("page","up"):"PageDown"===r?n&&t.allowHorizontalScroll?t.scroll("page","right"):t.allowVerticalScroll&&t.scroll("page","down"):"Home"===r?s&&t.allowVerticalScroll?t.scroll("document","up"):!s&&t.allowHorizontalScroll&&t.scroll("document","left"):"End"===r?s&&t.allowVerticalScroll?t.scroll("document","down"):!s&&t.allowHorizontalScroll&&t.scroll("document","right"):"Space"===r?this.canScrollToPart()&&this.scrollToPart():"Minus"===r||"NumpadSubtract"===r?this.canDecreaseZoom()&&this.decreaseZoom():"Equal"===r||"NumpadAdd"===r?this.canIncreaseZoom()&&this.increaseZoom():s&&"Digit0"===r?this.canResetZoom()&&this.resetZoom():n&&"z"===r?this.canZoomToFit()&&this.zoomToFit():s&&!n&&"g"===r?this.canGroupSelection()&&this.groupSelection():s&&n&&"g"===r?this.canUngroupSelection()&&this.ungroupSelection():"F2"===r?this.canEditTextBlock()&&this.editTextBlock():"ContextMenu"===r||n&&"F10"===r||s&&n&&"Backslash"===r?this.canShowContextMenu()&&this.showContextMenu():i.bubbles=!0:this.canCopySelection()&&this.copySelection()}doKeyUp(){const t=this.diagram.lastInput;t.bubbles=!0}stopCommand(){const t=this.diagram,e=t.currentTool;e instanceof V&&t.allowSelect&&t.clearSelection(),null!==e&&e.doCancel()}canStopCommand(){return!0}selectAll(){const t=this.diagram;t.S();try{t.currentCursor="wait",t.D("ChangingSelection",t.selection);const e=t.parts;for(;e.next();){const t=e.value;t.canSelect()&&!t.layer.isTemporary&&(t.isSelected=!0)}const i=t.nodes;for(;i.next();){const t=i.value;t.canSelect()&&!t.layer.isTemporary&&(t.isSelected=!0)}const s=t.links;for(;s.next();){const t=s.value;t.canSelect()&&!t.layer.isTemporary&&(t.isSelected=!0)}}finally{t.D("ChangedSelection",t.selection),t.currentCursor=""}}canSelectAll(){return this.diagram.allowSelect}deleteSelection(){const t=this.diagram;try{t.currentCursor="wait",t.D("ChangingSelection",t.selection),t.startTransaction("Delete"),t.D("SelectionDeleting",t.selection);const e=new u,i=t.selection.iterator;for(;i.next();){const t=i.value;ke.nh(e,t,!0,this.deletesTree?1/0:0,!!this.deletesConnectedLinks&&null,(t=>t.canDelete()))}t.removeParts(e,!0),t.D("SelectionDeleted",e)}finally{t.commitTransaction("Delete"),t.D("ChangedSelection",t.selection),t.currentCursor=""}}canDeleteSelection(){const t=this.diagram;return!(t.isReadOnly||t.isModelReadOnly||!t.allowDelete||0===t.selection.count)}copySelection(){const t=this.diagram;try{const e=new u,i=t.selection.iterator;for(;i.next();){const t=i.value;ke.nh(e,t,!0,this.copiesTree?1/0:0,this.copiesConnectedLinks,(t=>t.canCopy()))}this.copyToClipboard(e)}finally{}}canCopySelection(){const t=this.diagram;return!(!t.allowCopy||!t.allowClipboard||0===t.selection.count)}cutSelection(){this.copySelection(),this.deleteSelection()}canCutSelection(){const t=this.diagram;return!(t.isReadOnly||t.isModelReadOnly||!t.allowCopy||!t.allowDelete||!t.allowClipboard||0===t.selection.count)}copyToClipboard(t){const e=this.diagram;let i=null;if(null===t)vt.vL();else{let s=null;try{s=e.copyParts(t,null,!0)}finally{i=new h,null!==s&&i.addAll(s.iteratorValues),vt.Zm=i,vt.wb=e.model.dataFormat}}e.D("ClipboardChanged",i)}pasteFromClipboard(){const t=new u,e=vt.Zm;if(null===e)return t;const i=this.diagram;if(vt.wb!==i.model.dataFormat)return t;let s=null;try{s=i.copyParts(e,i,!1)}finally{if(null!==s){const e=s.iterator;for(;e.next();){const i=e.value,s=e.key;i.location.isReal()||(s.location.isReal()?i.location=s.location:!i.position.isReal()&&s.position.isReal()&&(i.position=s.position)),t.add(i)}}}return t}pasteSelection(t){void 0===t&&(t=null);const e=this.diagram;try{e.currentCursor="wait",e.D("ChangingSelection",e.selection),e.startTransaction("Paste");const i=this.pasteFromClipboard();i.count>0&&e.clearSelection(!0);const s=i.iterator;for(;s.next();){const t=s.value;t.isSelected=!0}if(null!==t){const i=e.computePartsBounds(e.selection);if(i.isReal()){const s=this.computeEffectiveCollection(e.selection,e.gb);e.AP(s,new y(t.x-i.centerX,t.y-i.centerY),e.gb,!1)}}e.D("ClipboardPasted",i)}finally{e.commitTransaction("Paste"),e.D("ChangedSelection",e.selection),e.currentCursor=""}}canPasteSelection(t){const e=this.diagram;return!(e.isReadOnly||e.isModelReadOnly||!e.allowInsert||!e.allowClipboard||null===vt.Zm||0===vt.Zm.count||vt.wb!==e.model.dataFormat)}undo(){this.diagram.undoManager.undo()}canUndo(){const t=this.diagram;return!t.isReadOnly&&!t.isModelReadOnly&&(t.allowUndo&&t.undoManager.canUndo())}redo(){this.diagram.undoManager.redo()}canRedo(){const t=this.diagram;return!t.isReadOnly&&!t.isModelReadOnly&&(t.allowUndo&&t.undoManager.canRedo())}decreaseZoom(t){void 0===t&&(t=1/this.zoomFactor);const e=this.diagram;if(1!==e.autoScale)return;const i=e.scale*t;i<e.minScale||i>e.maxScale||(e.scale=i)}canDecreaseZoom(t){void 0===t&&(t=1/this.zoomFactor);const e=this.diagram;if(1!==e.autoScale)return!1;const i=e.scale*t;return!(i<e.minScale||i>e.maxScale)&&e.allowZoom}increaseZoom(t){void 0===t&&(t=this.zoomFactor);const e=this.diagram;if(1!==e.autoScale)return;const i=e.scale*t;i<e.minScale||i>e.maxScale||(e.scale=i)}canIncreaseZoom(t){void 0===t&&(t=this.zoomFactor);const e=this.diagram;if(1!==e.autoScale)return!1;const i=e.scale*t;return!(i<e.minScale||i>e.maxScale)&&e.allowZoom}resetZoom(t){void 0===t&&(t=this.defaultScale);const e=this.diagram;t<e.minScale||t>e.maxScale||(e.scale=t)}canResetZoom(t){void 0===t&&(t=this.defaultScale);const e=this.diagram;return!(t<e.minScale||t>e.maxScale)&&e.allowZoom}zoomToFit(){const t=this.diagram,e=t.animationManager;e.stopAnimation(),t.redraw();const i=t.position,s=t.scale;e.Dl("Zoom To Fit"),this.isZoomToFitRestoreEnabled&&s===this.Ob&&!isNaN(this.Rb)&&null!==this.vb&&t.documentBounds.equals(this.Ib)?(t.scale=this.Rb,t.position=this.vb,this.Ob=NaN,this.Ib=x.Fg):(this.Rb=s,this.vb=i.copy(),t.zoomToFit(),this.Ob=t.scale,this.Ib=t.documentBounds.copy()),e.vS()}canZoomToFit(){return this.diagram.allowZoom}scrollToPart(t){void 0===t&&(t=null);const i=this.diagram;if(i.ensureBounds(),null===t){try{null!==this.Fo&&(this.Fo.next()?t=this.Fo.value:this.Fo=null)}catch{this.Fo=null}null===t&&(i.highlighteds.count>0?this.Fo=i.highlighteds.iterator:i.selection.count>0&&(this.Fo=i.selection.iterator),null!==this.Fo&&this.Fo.next()&&(t=this.Fo.value))}if(null!==t){const s=i.animationManager;s.Dl("Scroll To Part");const n=this.scrollToPartPause;if(n>0){const o=this.Hc(t,[t]);if(1===o.length)i.startTransaction(),i.centerRect(t.actualBounds),i.commitTransaction("Scroll To Part");else{const t=()=>{i.startTransaction();let t=o.pop();for(;o.length>0&&t instanceof Ce&&t.isTreeExpanded&&(!(t instanceof _e)||t.isSubGraphExpanded);)t=o.pop();o.length>0?(t instanceof ke&&i.scrollToRect(t.actualBounds),t instanceof Ce&&!t.isTreeExpanded&&(t.isTreeExpanded=!0),t instanceof _e&&!t.isSubGraphExpanded&&(t.isSubGraphExpanded=!0)):(t instanceof ke&&i.centerRect(t.actualBounds),i.removeDiagramListener("LayoutCompleted",r)),i.commitTransaction("Scroll To Part")},r=()=>{e.tr(t,(s.isEnabled?s.duration:0)+n)};i.addDiagramListener("LayoutCompleted",r),t()}}else{const e=i.position.copy();i.centerRect(t.actualBounds),e.equalsApprox(i.position)&&s.stopAnimation()}}}Hc(t,e){if(t.isVisible())return e;if(t instanceof Pe){const i=t.adornedPart;null!==i&&this.Hc(i,e)}else if(t instanceof De){const i=t.fromNode;null!==i&&this.Hc(i,e);const s=t.toNode;null!==s&&this.Hc(s,e)}else{if(t instanceof Ce){const i=t.labeledLink;null!==i&&this.Hc(i,e);const s=t.findTreeParentNode();null!==s&&(!s.isTreeExpanded&&!s.wasTreeExpanded&&e.push(s),this.Hc(s,e))}const i=t.containingGroup;null!==i&&(!i.isSubGraphExpanded&&!i.wasSubGraphExpanded&&e.push(i),this.Hc(i,e))}return e}canScrollToPart(t){if(void 0===t&&(t=null),null!==t&&!(t instanceof ke))return!1;const e=this.diagram;return(0!==e.selection.count||0!==e.highlighteds.count)&&(e.allowHorizontalScroll&&e.allowVerticalScroll)}collapseTree(t){void 0===t&&(t=null);const e=this.diagram,i="Collapse Tree";try{e.startTransaction(i),e.animationManager.Dl(i);const s=new h;if(null!==t&&t.isTreeExpanded)t.collapseTree(),s.add(t);else if(null===t){const t=e.selection.iterator;for(;t.next();){const e=t.value;e instanceof Ce&&e.isTreeExpanded&&(e.collapseTree(),s.add(e))}}e.D("TreeCollapsed",s)}finally{e.commitTransaction(i)}}canCollapseTree(t){void 0===t&&(t=null);const e=this.diagram;if(e.isReadOnly)return!1;if(null!==t){if(!(t instanceof Ce)||!t.isTreeExpanded)return!1;if(t.findTreeChildrenLinks().count>0)return!0}else{const t=e.selection.iterator;for(;t.next();){const e=t.value;if(e instanceof Ce){if(!e.isTreeExpanded)continue;if(e.findTreeChildrenLinks().count>0)return!0}}}return!1}expandTree(t){void 0===t&&(t=null);const e=this.diagram,i="Expand Tree";try{e.startTransaction(i),e.animationManager.Dl(i);const s=new h;if(null===t||t.isTreeExpanded){if(null===t){const t=e.selection.iterator;for(;t.next();){const e=t.value;e instanceof Ce&&(e.isTreeExpanded||(e.expandTree(),s.add(e)))}}}else t.expandTree(),s.add(t);e.D("TreeExpanded",s)}finally{e.commitTransaction(i)}}canExpandTree(t){void 0===t&&(t=null);const e=this.diagram;if(e.isReadOnly)return!1;if(null!==t){if(!(t instanceof Ce)||t.isTreeExpanded)return!1;if(t.findTreeChildrenLinks().count>0)return!0}else{const t=e.selection.iterator;for(;t.next();){const e=t.value;if(e instanceof Ce){if(e.isTreeExpanded)continue;if(e.findTreeChildrenLinks().count>0)return!0}}}return!1}groupSelection(){const t=this.diagram,i=t.model;if(!i.jc())return;const s=this.archetypeGroupData;if(null===s)return;let n=null;try{t.currentCursor="wait",t.D("ChangingSelection",t.selection),t.startTransaction("Group");const o=new h,r=t.selection.iterator;for(;r.next();){const t=r.value;t.ke()&&t.canGroup()&&o.add(t)}const a=new h,l=o.iterator;for(;l.next();){const t=l.value;let e=!1;const i=o.iterator;for(;i.next();){const s=i.value;if(t.isMemberOf(s)){e=!0;break}}e||a.add(t)}const u=a.first();if(null!==u){let o=u.containingGroup;if(null!==o)for(;null!==o;){let t=!1;const e=a.iterator;for(;e.next();)if(!e.value.isMemberOf(o)){t=!0;break}if(!t)break;o=o.containingGroup}if(s instanceof _e)s.Et(),n=s.copy(),null!==n&&t.add(n);else if(i.isGroupForData(s)){const o=i.copyNodeData(s);e.K(o)&&(i.addNodeData(o),n=t.findNodeForData(o))}if(null!==n){null!==o&&this.isValidMember(o,n)&&(n.containingGroup=o);const e=a.iterator;for(;e.next();){const t=e.value;this.isValidMember(n,t)&&(t.containingGroup=n)}t.clearSelection(!0),n.isSelected=!0}}t.D("SelectionGrouped",n)}finally{t.commitTransaction("Group"),t.D("ChangedSelection",t.selection),t.currentCursor=""}}canGroupSelection(){const t=this.diagram;if(t.isReadOnly||t.isModelReadOnly||!t.allowInsert||!t.allowGroup||!t.model.jc()||null===this.archetypeGroupData)return!1;const e=t.selection.iterator;for(;e.next();){const t=e.value;if(t.ke()&&t.canGroup())return!0}return!1}g2(t){const i=e.et();if(Array.isArray(t))t.forEach((t=>{t instanceof De||t instanceof ke&&i.push(t)}));else{const e=t.iterator;for(;e.next();){const t=e.value;t instanceof De||t instanceof ke&&i.push(t)}}const s=new u,n=i.length;for(let e=0;e<n;e++){const t=i[e];let o=!0;for(let e=0;e<n;e++)if(t.isMemberOf(i[e])){o=!1;break}o&&s.add(t)}return e.J(i),s}isValidMember(t,e){if(null===e||t===e||e instanceof De)return!1;let i;return(null===t||!(t===e||t.isMemberOf(e)||(i=t.memberValidation,null!==i&&!i(t,e))||null===t.data&&null!==e.data||null!==t.data&&null===e.data))&&(i=this.memberValidation,null===i||i(t,e))}ungroupSelection(t){void 0===t&&(t=null);const e=this.diagram,i=e.model;if(i.jc())try{e.currentCursor="wait",e.D("ChangingSelection",e.selection),e.startTransaction("Ungroup");const s=new h;if(null!==t)s.add(t);else{const t=e.selection.iterator;for(;t.next();){const e=t.value;e instanceof _e&&e.canUngroup()&&s.add(e)}}const n=new h;if(s.count>0){e.clearSelection(!0);const t=s.iterator;for(;t.next();){const s=t.value;s.expandSubGraph();const o=s.containingGroup,r=null!==o&&null!==o.data?i.getKeyForNodeData(o.data):void 0;n.addAll(s.memberParts);const a=n.iterator;for(;a.next();){const t=a.value;if(t.isSelected=!0,t instanceof De)continue;const e=t.data;null!==e?i.setGroupForData(e,r):t.containingGroup=o}e.remove(s)}}e.D("SelectionUngrouped",s,n)}finally{e.commitTransaction("Ungroup"),e.D("ChangedSelection",e.selection),e.currentCursor=""}}canUngroupSelection(t){void 0===t&&(t=null);const e=this.diagram;if(e.isReadOnly||e.isModelReadOnly||!e.allowDelete||!e.allowUngroup||!e.model.jc())return!1;if(null!==t){if(!(t instanceof _e))return!1;if(t.canUngroup())return!0}else{const t=e.selection.iterator;for(;t.next();){const e=t.value;if(e instanceof _e&&e.canUngroup())return!0}}return!1}addTopLevelParts(t,e){const i=this.g2(t);let s=!0;const n=i.iterator;for(;n.next();){const t=n.value;null!==t.containingGroup&&(!e||this.isValidMember(null,t)?t.containingGroup=null:s=!1)}return s}collapseSubGraph(t){void 0===t&&(t=null);const e=this.diagram,i="Collapse SubGraph";try{e.startTransaction(i),e.animationManager.Dl(i);const s=new h;if(null!==t&&t.isSubGraphExpanded)t.collapseSubGraph(),s.add(t);else if(null===t){const t=e.selection.iterator;for(;t.next();){const e=t.value;e instanceof _e&&e.isSubGraphExpanded&&(e.collapseSubGraph(),s.add(e))}}e.D("SubGraphCollapsed",s)}finally{e.commitTransaction(i)}}canCollapseSubGraph(t){void 0===t&&(t=null);const e=this.diagram;if(e.isReadOnly)return!1;if(null!==t)return!(!(t instanceof _e)||!t.isSubGraphExpanded);{const t=e.selection.iterator;for(;t.next();){const e=t.value;if(e instanceof _e&&e.isSubGraphExpanded)return!0}}return!1}expandSubGraph(t){void 0===t&&(t=null);const e=this.diagram,i="Expand SubGraph",s=new h;try{if(e.startTransaction(i),e.animationManager.Dl(i),null===t||t.isSubGraphExpanded){if(null===t){const t=e.selection.iterator;for(;t.next();){const e=t.value;e instanceof _e&&(e.isSubGraphExpanded||(e.expandSubGraph(),s.add(e)))}}}else t.expandSubGraph(),s.add(t);e.D("SubGraphExpanded",s)}finally{for(const t of s)this.mA(e,t);t&&this.mA(e,t),e.commitTransaction(i)}}mA(t,e){for(const i of e.memberParts)i instanceof Ce&&t.Cc(i,e)}canExpandSubGraph(t){void 0===t&&(t=null);const e=this.diagram;if(e.isReadOnly)return!1;if(null!==t)return!(!(t instanceof _e)||t.isSubGraphExpanded);{const t=e.selection.iterator;for(;t.next();){const e=t.value;if(e instanceof _e&&!e.isSubGraphExpanded)return!0}}return!1}editTextBlock(t){void 0===t&&(t=null);const e=this.diagram,i=e.toolManager.findTool("TextEditing");if(null!==i){if(null===t){let i=null;const s=e.selection.iterator;for(;s.next();){const t=s.value;if(t.canEdit()){i=t;break}}if(null===i)return;t=i.findInVisualTree((t=>t instanceof fe&&t.editable))}null!==t&&(e.currentTool=null,i.textBlock=t,e.currentTool=i)}}canEditTextBlock(t){void 0===t&&(t=null);const e=this.diagram;if(e.isReadOnly||e.isModelReadOnly||!e.allowTextEdit||null===e.toolManager.findTool("TextEditing"))return!1;if(null!==t){if(!(t instanceof fe))return!1;const e=t.part;if(null!==e&&e.canEdit())return!0}else{const i=e.selection.iterator;for(;i.next();){const e=i.value;if(e.canEdit()&&(t=e.findInVisualTree((t=>t instanceof fe&&t.editable)),null!==t))return!0}}return!1}showContextMenu(t){const e=this.diagram,i=e.toolManager.findTool("ContextMenu");if(null===i)return;void 0===t&&(t=null),null===t&&(t=e.selection.count>0?e.selection.first():e);const s=i.findObjectWithContextMenu(t);if(null!==s){const t=e.lastInput;let n=null;if(s instanceof Tt)n=s.getDocumentPoint(w.Center);else if(!e.viewportBounds.containsPoint(t.documentPoint)){const t=e.viewportBounds;n=new y(t.x+t.width/2,t.y+t.height/2)}if(null!==n){const t=new T;t.diagram=e,t.viewPoint=e.transformDocToView(n),t.documentPoint=n,t.button=2,t.up=!0,e.lastInput=t}e.currentTool=i,i.openMenu(!1,s)}}canShowContextMenu(t){const e=this.diagram,i=e.toolManager.findTool("ContextMenu");return!(null===i||(void 0===t&&(t=null),null===t&&(t=e.selection.count>0?e.selection.first():e),null===i.findObjectWithContextMenu(t)))}get copiesClipboardData(){return this.i2}set copiesClipboardData(t){e.s(t,"boolean",Ct,"copiesClipboardData"),this.i2=t}get copiesConnectedLinks(){return this.e2}set copiesConnectedLinks(t){e.s(t,"boolean",Ct,"copiesConnectedLinks"),this.e2=t}get deletesConnectedLinks(){return this.s2}set deletesConnectedLinks(t){e.s(t,"boolean",Ct,"deletesConnectedLinks"),this.s2=t}get copiesTree(){return this.o2}set copiesTree(t){e.s(t,"boolean",Ct,"copiesTree"),this.o2=t}get deletesTree(){return this.l2}set deletesTree(t){e.s(t,"boolean",Ct,"deletesTree"),this.l2=t}get copiesParentKey(){return this.h2}set copiesParentKey(t){e.s(t,"boolean",Ct,"copiesParentKey"),this.h2=t}get copiesGroupKey(){return this.a2}set copiesGroupKey(t){e.s(t,"boolean",Ct,"copiesGroupKey"),this.a2=t}get archetypeGroupData(){return this.c2}set archetypeGroupData(t){null!==t&&e.ec(t,Ct,"archetypeGroupData");this.diagram;this.c2=t}get memberValidation(){return this.eh}set memberValidation(t){null!==t&&e.k(t,Ct,"memberValidation"),this.eh=t}get defaultScale(){return this.diagram.defaultScale}set defaultScale(t){this.diagram.defaultScale=t}get zoomFactor(){return this.f2}set zoomFactor(t){t>1||e.o("zoomFactor must be larger than 1.0, not: "+t),this.f2=t}get isZoomToFitRestoreEnabled(){return this.u2}set isZoomToFitRestoreEnabled(t){e.s(t,"boolean",Ct,"isZoomToFitRestoreEnabled"),this.u2=t}get scrollToPartPause(){return this.d2}set scrollToPartPause(t){this.d2=t}computeEffectiveCollection(t,e){const i=this.diagram,s=i.toolManager.findTool("Dragging"),n=i.currentTool===s;void 0===e&&(e=i.s0());const o=new m;if(null===t)return o;let r=t.iterator;for(;r.next();){const t=r.value;i.Kr(o,t,n,e)}if(null!==i.draggedLink&&e.dragsLink)return o;for(r=t.iterator;r.next();){const t=r.value;if(t instanceof De){const e=t.fromNode;if(null===e||o.has(e)){const e=t.toNode;null!==e&&!o.has(e)&&o.delete(t)}else o.delete(t)}}return o}}var At=(t=>(t[t.None=0]="None",t[t.Default=1]="Default",t[t.Vertical=4]="Vertical",t[t.Horizontal=5]="Horizontal",t[t.Fill=2]="Fill",t))(At||{}),Nt=(t=>(t[t.None=0]="None",t[t.Along=21]="Along",t[t.Plus90=22]="Plus90",t[t.Minus90=23]="Minus90",t[t.Opposite=24]="Opposite",t[t.Upright=25]="Upright",t[t.Plus90Upright=26]="Plus90Upright",t[t.Minus90Upright=27]="Minus90Upright",t[t.Upright45=28]="Upright45",t))(Nt||{}),Lt=(t=>(t[t.None=0]="None",t[t.Vertical=1]="Vertical",t[t.Horizontal=2]="Horizontal",t[t.Both=3]="Both",t))(Lt||{});class Tt{n;c0;f0;Gr;p;oh;ct;at;se;$t;u0;Vs;Lt;is;Hr;lh;wi;da;tt;Yt;jr;Ni;zi;Gu;hi;Hu;Ot;si;qr;Eb;hh;ju;constructor(){u.Gi(this),this.n=30723,this.$t=1,this.u0="",this.Vs=null,this.Lt=null,this.at=new y(NaN,NaN).u(),this.is=v.pw,this.Hr=new k,this.lh=new k,this.wi=null,this.da=1,this.tt=1,this.Yt=0,this.jr=b.Rg,this.se=new x(NaN,NaN,NaN,NaN).u(),this.Ni=new x(NaN,NaN,NaN,NaN).u(),this.zi=new x(0,0,NaN,NaN).u(),this.Gu=null,this.c0=null,this.ct=null,this.hi=w.Default,this.Hu=w.Default,this.f0=0,this.Gr=0,this.Ot=null,this.p=null,this.oh=null,this.si=null,this.Eb=null,this.hh=null,this.qr=null,this.ju=null}cloneProtected(t){t.n=-32769&this.n|6144,t.$t=this.$t,t.u0=this.u0,t.Lt=this.Lt,t.at.a(this.at),t.is=this.is.P(),null!==this.wi?t.wi=this.wi.copy():t.wi=null,t.tt=this.tt,t.Yt=this.Yt,t.jr=this.jr.P(),t.se.a(this.se),t.Ni.a(this.Ni),t.zi.a(this.zi),t.c0=this.c0,null!==this.ct&&(t.ct=this.ct.copy()),t.hi=this.hi.P(),t.Hu=this.Hu.P(),t.f0=this.f0,t.Gr=this.Gr,null!==this.Ot&&(t.Ot=this.Ot.copy()),null!==this.p&&(this.p.fi?t.p=this.p:t.p=this.p.copy()),null!==this.oh&&(t.oh=this.oh.slice()),null!==this.si&&(t.si=this.si.copy())}addCopyProperty(t){let e=this.oh;if(Array.isArray(e)){for(let i=0;i<e.length;i++)if(e[i]===t)return}else e=[],this.oh=e;e.push(t)}Ro(t){t.Gu=null,t.qr=null,t.c()}clone(){const t=new this.constructor;if(this.cloneProtected(t),null!==this.oh)for(let e=0;e<this.oh.length;e++){const i=this.oh[e];t[i]=this[i]}return t}copy(){return this.clone()}oS(){const t=this.Ci;if(null!==t){this.Ci=null;for(const e of t)e.qu()&&(e.isToData?this.themeData(e.targetProperty,e.sourceProperty,e.themeSource,e.converter,e.themeConverter):e.isToObject?this.themeObject(e.targetProperty,e.sourceProperty,e.themeSource,e.converter,e.themeConverter,e.sourceName):e.isToModel?this.themeModel(e.targetProperty,e.sourceProperty,e.themeSource,e.converter,e.themeConverter):this.theme(e.targetProperty,e.sourceProperty,e.themeSource,e.converter,e.themeConverter))}return this}oi(t){t in Nt?this.segmentOrientation=t:t in At?this.stretch=t:e.ir(this,t)}toString(){return e.Dn(this.constructor)+"#"+u.as(this)}static None=0;static Default=1;static Fill=2;static Vertical;static Horizontal;static Uniform=6;static UniformToFill=7;static FlipVertical=1;static FlipHorizontal=2;static FlipBoth=3;ah(){null!==this.p&&(this.p.fi=!0)}Gt(){return null===this.p?this.p=new Dt:this.p.fi&&(this.p=this.p.copy()),this.p}Ue(){if(null===this.ct){const t=new Be;t.ga=w.None,t.ma=w.None,t.pa=10,t.ya=10,t.wa=0,t.xa=0,this.ct=t}return this.ct}raiseChangedEvent(t,e,i,s,n,o,r){const a=this.part;if(null!==a){a.qc(t,e,i,s,n,o,r),i===this&&2===t&&this.Wc()&&this.ba(a,e);const h=this.diagram;if(null!==this.ws&&null!==h&&h.Uh&&!h.undoManager.isUndoingRedoing&&!h.animationManager.pu){const t=this.ws.get(e);if(null!==t&&h.animationManager.isEnabled&&!h.animationManager.isTicking){null===this.ju&&(this.ju=new m);let i=0===h.undoManager.transactionLevel;if(2===t.startCondition?i=!0:3===t.startCondition&&(i=!1),i){const i=new lt;t.zF(i);const o=this.ju.get(t);null!==o&&o.stop(),this.ju.set(t,i),i.ux=this,i.zS=t,i.add(this,e,s,n),i.start()}else h.animationManager.getBundleAnimation().add(this,e,s,n)}}if(this instanceof ie&&i===a&&a.m2()&&null!==a.data){const t=this.C.r,i=t.length;for(let s=0;s<i;s++){const i=t[s];i instanceof ie&&i.Yr((t=>{null!==t.data&&t.m2()&&t.updateTargetBindings(e)}))}}}}EF(t){this.ju.delete(t)}To(){if(null!==this.diagram&&null===this.findBindingPanel()&&null!==this.Ci){const t=this.diagram.model,e=this.Ci.iterator;for(;e.next();){const i=e.value;if(!i.isToTheme)continue;let s=null;const n=i.sourceName;i.isToObject&&(s=this.pA(n));let o=this;const r=i.targetId;-1!==r&&(o=this.d0(r),null===o)||("/"===n?s=o.part:"."===n?s=o:".."===n&&(s=o.panel),i.updateTarget(o,s,void 0,t))}}}ba(t,e){const i=this.findBindingPanel();if(null!==i){const s=t.diagram,n=this.Ci.iterator;for(;n.next();){const t=n.value;let o=null;if(t.isToObject){if(o=t.yA(i,this),null===o)continue;t.updateSource(this,o,e,null)}else if(t.isToModel)null!==s&&!s.fe&&t.updateSource(this,s.model.modelData,e,i);else if(!t.isToTheme){const n=i.data;if(null===n)continue;null!==s&&!s.fe&&t.updateSource(this,n,e,i)}if(o===this){const n=t.targetId,r=i.d0(n);null!==r&&t.updateTarget(r,o,e,s?.model)}}}}d0(t){return this.jn===t?this:null}pA(t){let e;return e=""===t||"/"===t||"."===t||".."===t?this:this.part.findObject(t),e}get jn(){return null!==this.p?this.p.jn:-1}set jn(t){this.jn!==t&&(null===this.p&&(this.p=new Dt),this.p.jn=t)}get Ci(){return null!==this.p?this.p.Ci:null}set Ci(t){this.Ci!==t&&(null===this.p&&(this.p=new Dt),this.p.Ci=t)}get qn(){return null!==this.p?this.p.qn:null}set qn(t){this.qn!==t&&(null===this.p&&(this.p=new Dt),this.p.qn=t)}raiseChanged(t,e,i){this.raiseChangedEvent(2,t,this,e,i)}t(t,e,i){this.raiseChangedEvent(2,t,this,e,i)}Wn(t,e,i,s){const n=this.se;if(n.i(t,e,i,s),1!==this.tt||0!==this.Yt){null===this.wi&&(this.wi=new k);const o=this.wi;o.Ri(),this.g0(o,t,e,i,s),o.vg(n)}}wA(t,e,i){return!1!==this.pickable&&(i.nc(this.T),e?this.intersectsRect(t,i):this.containedInRect(t,i))}xA(t,e,i){if(!1===this.pickable)return!1;const s=this.naturalBounds,n=t.distanceSquaredPoint(e);return i?y.distanceLineSegmentSquared(t.x,t.y,0,0,0,s.height)<=n||y.distanceLineSegmentSquared(t.x,t.y,0,s.height,s.width,s.height)<=n||y.distanceLineSegmentSquared(t.x,t.y,s.width,s.height,s.width,0)<=n||y.distanceLineSegmentSquared(t.x,t.y,s.width,0,0,0)<=n:t.distanceSquared(0,0)<=n&&t.distanceSquared(0,s.height)<=n&&t.distanceSquared(s.width,0)<=n&&t.distanceSquared(s.width,s.height)<=n}an(){return!0}containsPoint(t){const e=y.l();e.a(t),this.T.gt(e);const i=this.actualBounds;if(!i.isReal())return y.e(e),!1;const s=this.diagram;if(null!==s&&s.jm){const t=s.getInputOption("extraTouchThreshold"),n=s.getInputOption("extraTouchArea"),o=n/2,r=this.naturalBounds,a=this.getDocumentScale()*s.scale,h=1/a;if(r.width*a<t&&r.height*a<t){const t=x.contains(i.x-o*h,i.y-o*h,i.width+n*h,i.height+n*h,e.x,e.y);return y.e(e),t}}let n=!1;return(this instanceof Pe||this instanceof he?x.contains(i.x-5,i.y-5,i.width+10,i.height+10,e.x,e.y):i.containsPoint(e))&&(n=!(this.si&&!this.si.containsPoint(e))&&(!(null===this.Lt||!this.zi.containsPoint(t))||this.ch(t))),y.e(e),n}ch(t){const e=this.naturalBounds;return x.contains(0,0,e.width,e.height,t.x,t.y)}containsRect(t){if(0===this.angle)return this.actualBounds.containsRect(t);const e=this.naturalBounds,i=x.V(0,0,e.width,e.height),s=this.T;let n=!1;const o=y.V(t.x,t.y);return i.containsPoint(s.$e(o))&&(o.i(t.x,t.bottom),i.containsPoint(s.$e(o))&&(o.i(t.right,t.bottom),i.containsPoint(s.$e(o))&&(o.i(t.right,t.y),i.containsPoint(s.$e(o))&&(n=!0)))),y.e(o),x.e(i),n}containedInRect(t,e){if(void 0===e)return t.containsRect(this.actualBounds);const i=this.naturalBounds,s=e;let n=!1;const o=y.V(0,0);return t.containsPoint(s.gt(o))&&(o.i(0,i.height),t.containsPoint(s.gt(o))&&(o.i(i.width,i.height),t.containsPoint(s.gt(o))&&(o.i(i.width,0),t.containsPoint(s.gt(o))&&(n=!0)))),y.e(o),n}intersectsRect(t,e){if(void 0===e&&(e=this.T,0===this.angle))return t.intersectsRect(this.actualBounds);const i=this.naturalBounds,s=e,n=y.V(0,0),o=y.V(0,i.height),r=y.V(i.width,i.height),a=y.V(i.width,0);let h=!1;if(t.containsPoint(s.gt(n))||t.containsPoint(s.gt(o))||t.containsPoint(s.gt(r))||t.containsPoint(s.gt(a)))h=!0;else{const e=x.V(0,0,i.width,i.height),l=y.V(t.x,t.y);e.containsPoint(s.$e(l))?h=!0:(l.i(t.x,t.bottom),e.containsPoint(s.$e(l))?h=!0:(l.i(t.right,t.bottom),e.containsPoint(s.$e(l))?h=!0:(l.i(t.right,t.y),e.containsPoint(s.$e(l))&&(h=!0)))),y.e(l),x.e(e),h||(S.Pw(t,n,o)||S.Pw(t,o,r)||S.Pw(t,r,a)||S.Pw(t,a,n))&&(h=!0)}return y.e(n),y.e(o),y.e(r),y.e(a),h}getDocumentPoint(t,e){if(void 0===e&&(e=new y),t instanceof w){const i=t,s=this.naturalBounds;return e.i(i.x*s.width+i.offsetX,i.y*s.height+i.offsetY),this.Bs.gt(e),e}return e.set(t),this.Bs.gt(e),e}getDocumentBounds(t){void 0===t&&(t=new x);const e=this.naturalBounds,i=this.Bs,s=y.V(0,0).T(i);return t.i(s.x,s.y,0,0),s.i(e.width,0).T(i),t.unionNoCheck(s.x,s.y,0,0),s.i(e.width,e.height).T(i),t.unionNoCheck(s.x,s.y,0,0),s.i(0,e.height).T(i),t.unionNoCheck(s.x,s.y,0,0),y.e(s),t}getDocumentAngle(){return this.Bs.$D()}getDocumentScale(){if(!1===this.m0())return this.da;const t=this.tt;return null!==this.panel?t*this.panel.getDocumentScale():t}getLocalPoint(t,e){return void 0===e&&(e=new y),e.a(t),this.Bs.$e(e),e}getNearestIntersectionPoint(t,e,i){return this.Jc(t.x,t.y,e.x,e.y,i)}Jc(t,e,i,s,n){const o=this.T,r=1/(o.m11*o.m22-o.m12*o.m21),a=o.m22*r,h=-o.m12*r,l=-o.m21*r,u=o.m11*r,c=r*(o.m21*o.dy-o.m22*o.dx),d=r*(o.m12*o.dx-o.m11*o.dy),f=t*a+e*l+c,g=t*h+e*u+d,p=i*a+s*l+c,m=i*h+s*u+d;n.i(0,0);const y=this.naturalBounds,v=S.dl(0,0,y.width,y.height,f,g,p,m,n);return n.T(o),v}ht(t,i,s,n){if(!1===this.Ao())return;const o=this.jr,r=o.right+o.left,a=o.top+o.bottom;t=Math.max(t-r,0),i=Math.max(i-a,0),s=s||0,n=n||0,s=Math.max(s-r,0),n=Math.max(n-a,0);const h=this.angle;let l=0;const u=this.desiredSize,c=this.p0();90===h||270===h?(t=isFinite(u.height)?u.height+c:t,i=isFinite(u.width)?u.width+c:i):(t=isFinite(u.width)?u.width+c:t,i=isFinite(u.height)?u.height+c:i);let d=s||0,f=n||0;const g=this instanceof ie;switch(this.zs(!0)){case 0:d=0,f=0,g&&(t=1/0,i=1/0);break;case 2:isFinite(t)&&t>s&&(d=t),isFinite(i)&&i>n&&(f=i);break;case 5:isFinite(t)&&t>s&&(d=t),f=0,g&&(i=1/0);break;case 4:isFinite(i)&&i>n&&(f=i),d=0,g&&(t=1/0);break}const p=this.maxSize,m=this.minSize;d>p.width&&m.width<p.width&&(d=p.width),f>p.height&&m.height<p.height&&(f=p.height),s=Math.max(d,m.width),n=Math.max(f,m.height),p.width<s&&(s=Math.min(m.width,s)),p.height<n&&(n=Math.min(m.height,n)),t=Math.min(p.width,t),i=Math.min(p.height,i),t=Math.max(s,t),i=Math.max(n,i),(90===h||270===h)&&(l=t,t=i,i=l,l=s,s=n,n=l),this.se.Nt(),this.Wu(t,i,s,n),this.se.u(),this.se.isReal()||e.o("Non-real measuredBounds has been set. Object "+this+", measuredBounds: "+this.se.toString()),this.ue(!1)}Wu(t,e,i,s){}Xs(){return!1}Ut(t,i,s,n,o){this.$c();const r=x.l();r.a(this.Ni),this.Ni.Nt(),!1===this._e()?this.Ni.i(t,i,s,n):this.fh(t,i,s,n),this.Ni.u(),this.si=void 0===o?null:o;let a=!1;if(void 0!==o)a=!0;else{let e=this.panel;if(null!==e&&e.Wr()&&(e=e.panel),null!==e){const s=e.zi,n=this.measuredBounds,o=i+n.height,r=t+n.width;if(a=!(0<=t+.05&&r<=s.width+.05&&0<=i+.05&&o<=s.height+.05),this instanceof fe){const t=this.naturalBounds;(this.y0>t.height||this.ui>t.width)&&(a=!0)}}}a?this.n|=256:this.n&=-257,this.Ni.isReal()||e.o("Non-real actualBounds has been set. Object "+this+", actualBounds: "+this.Ni.toString()),this.Ju(r,this.Ni),this.Jn(!1),x.e(r)}fh(t,e,i,s){}commonArrange(t,e,i,s){if(this.Ni.i(t,e,i,s),this.desiredSize.isReal())return;const n=this.se,o=this.jr,r=o.right+o.left,a=o.top+o.bottom,h=n.width+r,l=n.height+a;i+=r,s+=a;let u=this.zs(!0);switch(h===i&&l===s&&(u=0),u){case 0:(h>i||l>s)&&(this.ue(!0),this.ht(h>i?i:h,l>s?s:l,0,0));break;case 2:this.ue(!0),this.ht(i,s,0,0);break;case 5:this.ue(!0),this.ht(i,l,0,0);break;case 4:this.ue(!0),this.ht(h,s,0,0);break}}Ju(t,e){const i=this.part;null!==i&&null!==i.diagram&&((i.selectionObject===this||i.resizeObject===this||i.rotateObject===this)&&i.p2(!0),this.S(),!t.equalsApproxClose(e)&&(i.uh(),this.w0(i)))}w0(t){null!==this.portId&&(t.p2(!0),t instanceof Ce&&t.bA(this))}get shadowVisible(){return null!==this.p?this.p.x0:null}set shadowVisible(t){const e=this.shadowVisible;e!==t&&(this.Gt().x0=t,this.Ve(!0),this.S(),this.t("shadowVisible",e,t))}HR(t,e){const i=this.naturalBounds,s=this.lh,n=s.m11,o=s.m21,r=s.dx,a=s.m12,h=s.m22,l=s.dy;let u=0,c=0,d=u,f=c;u=d*n+f*o+r,c=d*a+f*h+l;let g=u,p=c,m=0,y=0;d=i.width+e,f=0,u=d*n+f*o+r,c=d*a+f*h+l;let v=Math.min(g,u),x=Math.min(p,c);m=Math.max(g+m,u)-v,y=Math.max(p+y,c)-x,g=v,p=x,d=i.width+e,f=i.height+e,u=d*n+f*o+r,c=d*a+f*h+l,v=Math.min(g,u),x=Math.min(p,c),m=Math.max(g+m,u)-v,y=Math.max(p+y,c)-x,g=v,p=x,d=0,f=i.height+e,u=d*n+f*o+r,c=d*a+f*h+l,v=Math.min(g,u),x=Math.min(p,c),m=Math.max(g+m,u)-v,y=Math.max(p+y,c)-x,g=v,p=x;const b=t.viewportBounds,w=b.x,k=b.y,S=b.width,P=b.height;return g>S+w||w>m+g||p>P+k||k>y+p}Bi(t,e){if(this.jR(t,e)||!this.visible)return;const i=this.opacity;if(0===i)return;let s=1;1!==i&&(s=t.globalAlpha,t.globalAlpha=s*i);let n="";""!==this.filter&&(n=t.filter,t.filter=this.filter);const o=this.T,r=this.panel;!0===this.m0()&&this.Bb();const a=this.part;let h=!1,l=0;if(a&&e.getRenderingHint("drawShadows")&&(h=a.isShadowed,h)){const t=a.shadowOffset;l=Math.max(t.y,t.x)*e.scale*e.Vi}const u=this instanceof ie&&this.Wr(),c=this.Ni;if(u&&(this.kA(h,t,!1,r),this.qR(t,e),this.PA(h,t,!1,r),this.SA(h,t,!1)),u||!u&&(0===c.width||0===c.height||isNaN(c.x)||isNaN(c.y)))return 1!==i&&(t.globalAlpha=s),void(""!==this.filter&&(t.filter=n));const d=this.Xs();if(!e.ta&&d&&this.HR(e,l))return 1!==i&&(t.globalAlpha=s),void(""!==this.filter&&(t.filter=n));let f=0!==(256&this.n);if(t.clipInsteadOfFill&&(f=!1),this instanceof fe&&(t.font=this.font),f){const e=r.an()?r.naturalBounds:r.actualBounds;let o=Math.max(c.x,e.x),a=Math.max(c.y,e.y),h=Math.min(c.right,e.right)-o,l=Math.min(c.bottom,e.bottom)-a;const u=this.si;if(null!==u&&(o=u.x,a=u.y,h=u.width,l=u.height),o>c.width+c.x||c.x>e.width+e.x)return 1!==i&&(t.globalAlpha=s),void(""!==this.filter&&(t.filter=n));t.save(),t.beginPath(),t.rect(o,a,h,l),t.clip()}if(d){if(!a.isVisible())return 1!==i&&(t.globalAlpha=s),void(""!==this.filter&&(t.filter=n));if(h){const i=a.shadowOffset;t.shadowsSet(i.x*e.scale*this.scale*e.Vi,i.y*e.scale*this.scale*e.Vi,a.shadowBlur),t.shadowsOn(),t.shadowColor=a.shadowColor}}const g=this.naturalBounds;if(t.transform(o.m11,o.m12,o.m21,o.m22,o.dx,o.dy),this.kA(h,t,d,r),null!==this.Lt&&(t.commitTransform(),this.Ub(t,g,c)),this.PA(h,t,d,r),this.dh(t,e),this.SA(h,t,d),f&&(t.restore(),t.clearContextCache(this instanceof ie)),!o.Xk()){const e=1/(o.m11*o.m22-o.m12*o.m21);t.transform(o.m22*e,-o.m12*e,-o.m21*e,o.m11*e,e*(o.m21*o.dy-o.m22*o.dx),e*(o.m12*o.dx-o.m11*o.dy))}1!==i&&(t.globalAlpha=s),""!==this.filter&&(t.filter=n)}kA(t,e,i,s){t&&!0===this.shadowVisible?e.shadowsOn():t&&!1===this.shadowVisible&&e.shadowsOff(),t&&this.Vb(s)&&null===this.shadowVisible&&e.shadowsOff()}PA(t,e,i,s){t&&(null!==this.Lt||this.Vb(s))?(this.zb(!0),null===this.shadowVisible&&e.shadowsOff()):this.zb(!1)}SA(t,e,i){t&&!0===this.w2()&&e.shadowsOn(),i&&t&&e.shadowsOff()}WR(t,e,i){const s=this.part;let n=!1;s&&t.getRenderingHint("drawShadows")&&(n=s.isShadowed),e.clipInsteadOfFill&&(n=!1),this.Xs()&&n&&e.shadowsOn(),n&&!0===this.shadowVisible?e.shadowsOn():n&&!1===this.shadowVisible&&e.shadowsOff();const o=this.panel;if(n&&this.Vb(o)&&null===this.shadowVisible&&e.shadowsOff(),e.Jr){const s=t.computePixelRatio(),n=`drop-shadow(${e.shadowOffsetX/s}px ${e.shadowOffsetY/s}px ${e.shadowBlur/s/2}px ${e.shadowColor})`;null!==this.background&&i.Lt.setAttributeNS(null,"filter",n)}return n&&(null!==this.Lt||this.Vb(o))?(this.zb(!0),null===this.shadowVisible&&e.shadowsOff()):this.zb(!1),n}JR(t,e,i,s){if(i.Jr){const s=e.computePixelRatio(),n=`drop-shadow(${i.shadowOffsetX/s}px ${i.shadowOffsetY/s}px ${i.shadowBlur/s/2}px ${i.shadowColor})`;this.b2(t,n)}s&&!0===this.w2()&&i.shadowsOn(),this.Xs()&&i.shadowsOff()}Vb(t){return null!==t&&(t.Wr()&&(t=t.panel),t.w2()||(t.type===ie.Auto||t.type===ie.Spot)&&t.findMainElement()!==this)}b2(t,e){}Ub(t,e,i){const s=this.p0(),n=e.x,o=e.y,r=e.width+s,a=e.height+s;this.rn(t,this.Lt,!0,!1,e,i),this.Lt instanceof jt&&3===this.Lt.type?(t.beginPath(),t.rect(n-s/2,o-s/2,r,a),t.fillContext(this.Lt,!1,null)):t.fillRect(n-s/2,o-s/2,r,a)}MA(t,e){let i=t.$R(this);const s=null!==t.hh?t.hh:t.svg;if(-1!==i)if(0===i)if(s.Lt)s.Lt.after(e);else if(t.type===ie.Table){const t=s.getElementsByClassName("gojs-ts"),i=0!==t.length?t[0]:null;null!==i&&i.after(e)}else s.prepend(e);else{for(;0!==i&&!t.elt(i-1).isVisibleObject();)i--;if(0===i)s.prepend(e);else{const n=t.elt(i-1).svg;null!==n?n.after(e):s.appendChild(e)}}}jR(t,e){if(!(t instanceof Et))return!1;if(!this.visible||0===this.opacity)return null!==this.svg&&null!==this.svg.parentNode&&this.svg.remove(),!0;const i=this.Ni;if(this.Xs()&&(!this.isVisible()||0===i.width||0===i.height||isNaN(i.x)||isNaN(i.y)))return null!==this.svg&&null!==this.svg.parentNode&&this.svg.remove(),!0;const s=this.panel,n=this.$u(t);if(this.Zc(t,e,n))return this.NA(this.svg),null!==this.svg.parentElement?(this.Xs()&&(t.lastDrawnPart=this.svg),!0):(this.Xs()?(null!==t.lastDrawnPart?t.lastDrawnPart.after(this.svg):t.diagramGroup.prepend(this.svg),t.lastDrawnPart=this.svg):s&&this.MA(s,this.svg),!0);if(this.Ve(!1),this.Xs()&&this.isShadowed){const i=this.shadowOffset;t.shadowsSet(i.x*e.scale*this.scale*e.Vi,i.y*e.scale*this.scale*e.Vi,this.shadowBlur),t.shadowsOn(),t.shadowColor=this.shadowColor}this instanceof fe&&(t.font=this.font),t.currentElement=null;const o=this.T,r=this instanceof ie,a=this instanceof ie&&this.Wr(),h=this.svg;if(!0===this.m0()&&this.Bb(),t.setCurrentTransform(1,0,0,1,0,0),t.outerGroup=!1,n)if(t.outerGroup=!0,r&&a)t.newGroup(1,0,0,1,0,0),this.svg=t.lastCreatedElement;else if(r&&this.isClipping){const e=this.findMainElement();let i=0,s=0;null!==e&&(i=e.actualBounds.x,s=e.actualBounds.y),t.newGroup(o.m11,o.m12,o.m21,o.m22,o.dx+i,o.dy+s),this.svg=t.lastCreatedElement,null!==e&&t.createOrUpdateClipGroup(this,e.actualBounds),t.currentElement=t.lastCreatedElement}else r?(t.newGroup(o.m11,o.m12,o.m21,o.m22,o.dx,o.dy),this.svg=t.lastCreatedElement):t.newGroup(1,0,0,1,0,0);const l=this.naturalBounds;r||t.setCurrentTransform(o.m11,o.m12,o.m21,o.m22,o.dx,o.dy),null!==this.background&&(r?(a&&t.setCurrentTransform(o.m11,o.m12,o.m21,o.m22,o.dx,o.dy),this.Ub(t,l,i),a&&t.setCurrentTransform(1,0,0,1,0,0)):(t.setCurrentTransform(o.m11,o.m12,o.m21,o.m22,o.dx,o.dy),this.Ub(t,l,i)),t.currentElement.Lt=t.lastCreatedElement,t.currentElement.prepend(t.lastCreatedElement));const u=this.WR(e,t,t.currentElement);this.dh(t,e),r&&t.endGroup(),t.outerGroup&&t.endGroup();const c=t.surface.Ku,d=r?this.svg:t.currentElement;if(null!==h&&d!==h&&h.parentNode===this.panel.svg){const e=this.svg.getAttribute("filter");return null!==e&&d.setAttribute("filter",e),h.replaceWith(d),this.svg=d,null!==d&&this.b0(t,s,i,d),!0}if(this.svg=d,null!==c&&null===d&&t.dummyGroup(),null===d)return!0;this.b0(t,s,i,d),this.JR(d,e,t,u);const f=this.Xs()?this.opacity*t.globalAlpha:this.opacity;if(1!==f&&d.setAttributeNS(null,"opacity",f.toString()),""!==this.filter&&d.setAttributeNS(null,"filter",this.filter),this.Xs()){if(null!==h&&d!==h&&h.parentNode===t.diagramGroup){const t=h.getAttribute("filter");null!==t&&d.setAttribute("filter",t),h.replaceWith(d)}else t.lastDrawnPart?t.lastDrawnPart.after(d):t.diagramGroup.prepend(d);t.lastDrawnPart=d}else null!==s&&this.MA(s,d);return null!==c&&c(this,d),this.NA(d),!0}NA(t){const i=this,s=t.dataset;i instanceof Tt&&(null!==i.portId&&(s.portId=i.portId),i instanceof ie&&(isNaN(i.itemIndex)||(s.itemIndex=i.itemIndex.toString()),i instanceof ke&&(s.className=e.Dn(i),void 0!==i.key&&(s.key=i.key.toString()),null!==i.containingGroup&&(s.group=i.containingGroup.key.toString()),i instanceof De&&(null!==i.fromNode&&void 0!==i.fromNode.key&&(s.fromKey=i.fromNode.key.toString()),""!==i.fromPortId&&(s.fromPortId=i.fromPortId),null!==i.toNode&&void 0!==i.toNode.key&&(s.toKey=i.toNode.key.toString()),""!==i.toPortId&&(s.toPortId=i.toPortId)))))}b0(t,e,i,s){let n=0!==(256&this.n);if(t.clipInsteadOfFill&&(n=!1),!n)return void s.removeAttributeNS(null,"clip-path");const o=e.an()?e.naturalBounds:e.actualBounds;let r=Math.max(i.x,o.x),a=Math.max(i.y,o.y),h=Math.min(i.right,o.right)-r,l=Math.min(i.bottom,o.bottom)-a;const u=this.si;null!==u&&(r=u.x,a=u.y,h=u.width,l=u.height);const c=new x(r,a,Math.max(h,0),Math.max(l,0));this instanceof ie&&this.T.copy().ww().vg(c),s.setAttributeNS(null,"clip-path",`path('      M ${c.x},${c.y}       L ${c.width+c.x} ${c.y}       L ${c.width+c.x} ${c.height+c.y}       L ${c.x} ${c.height+c.y} z') view-box`)}ZR(){if(null===this.svg)return;const t=this.svg.innerHTML.match(/url\(#((CLIP|GRAD).+?)\)/g),e=this.svg.ownerDocument;if(null!==t)for(const i of t){const t=e.getElementById(i.split("#")[1].slice(0,-1));null!==t&&t.remove()}this.svg.remove()}qR(t,e){const i=this.Ni,s=this.zi,n=this.Lt;null!==n&&t.commitTransform(),null!==n&&(this.rn(t,n,!0,!1,s,i),n instanceof jt&&3===n.type?(t.beginPath(),t.rect(i.x,i.y,i.width,i.height),t.fillContext(n,!1,null)):t.fillRect(i.x,i.y,i.width,i.height)),this.dh(t,e)}dh(t,e){}Qc(){this.Ve(!0)}Zc(t,e,i){const s=this.svg;if(this.QR()){if(this.Qc(),this.Ve(!1),null===s)return!1;const e=s.getAttribute("clip-path");if(null!==e&&e.includes("url")){const i=t.svg.getElementById(e.split("#")[1].slice(0,-1));null!==i&&i.remove()}return s.getAttribute("filter")&&s.removeAttribute("filter"),!1}if(null===s)return!1;if(!this.visible)return s.remove(),!1;if("g"!==s.nodeName&&i||"g"===s.nodeName&&!i)return!1;const n=this.T,o="matrix("+n.m11+", "+n.m12+", "+n.m21+", "+n.m22+", "+n.dx+", "+n.dy+")",r=this instanceof ie,a=!!r&&this.Wr();if(!r||!a)if(this instanceof ye){const e=this.Xb;t.setCurrentTransform(n.m11,n.m12,n.m21,n.m22,n.dx,n.dy),null!==e&&t.amendImageTransform(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]),i?s.lastElementChild.setAttributeNS(null,"transform",t.getCurrentTransform()):s.setAttributeNS(null,"transform",t.getCurrentTransform())}else if(i&&!r)if(this instanceof he){const t=s.getElementsByTagName("path");for(let e=0;e<t.length;e++)t[e].setAttributeNS(null,"transform",o)}else if(this instanceof fe){const t=s.getElementsByTagName("text"),e="string"==typeof this.stroke?this.stroke:null;for(let i=0;i<t.length;i++)t[i].setAttributeNS(null,"transform",o),e&&t[i].setAttributeNS(null,"fill",e)}else(s.lastElementChild||s).setAttributeNS(null,"transform",o);else if(r&&this.isClipping&&this.hh){const t=this.findMainElement(),e=null!==t?t.actualBounds.x:0,i=null!==t?t.actualBounds.y:0;this.hh.setAttributeNS(null,"transform","matrix(1,0,0,1,"+-e+", "+-i+")"),s.setAttributeNS(null,"transform","matrix("+n.m11+", "+n.m12+", "+n.m21+", "+n.m22+", "+(n.dx+e)+", "+(n.dy+i)+")")}else s.setAttributeNS(null,"transform",o);const h=this.Xs()?this.opacity*t.globalAlpha:this.opacity;1===h?s.removeAttribute("opacity"):s.setAttributeNS(null,"opacity",h.toString()),t.setCurrentTransform(1,0,0,1,0,0);const l=this.hh?this.hh:this.Eb;if(null!==this.background||void 0!==l.Lt){const e=l.Lt;if(null===this.background)t.removeOldGradient(this,l.Lt,"fill"),l.Lt.remove(),l.Lt=void 0;else{if((a||i&&!(this instanceof ie))&&t.setCurrentTransform(n.m11,n.m12,n.m21,n.m22,n.dx,n.dy),this.Ub(t,this.naturalBounds,this.actualBounds),l.Lt){t.removeOldGradient(this,l.Lt,"fill");const e=l.Lt.getAttribute("filter");null!==e&&t.lastCreatedElement.setAttribute("filter",e),l.Lt.replaceWith(t.lastCreatedElement)}else l.prepend(t.lastCreatedElement);l.Lt=t.lastCreatedElement}e&&t.removeOldGradient(this,e,"fill")}return this.b0(t,this.panel,this.actualBounds,s),!0}$u(t){if(null!==this.background)return!0;let e=0!==(256&this.n);return t.clipInsteadOfFill&&(e=!1),!!e}static AE(t,e,i,s,n,o,r){let a=.001;const h=o.length;t.moveTo(e,i);let l=s-e;const u=n-i;0===l&&(l=.001);const c=u/l;let d=Math.sqrt(l*l+u*u),f=0,g=!0;a=o[f%h];let p=0!==r;for(;d>=.1;){if(p){for(a=o[f++%h],a-=r;a<0;)a+=o[f++%h],g=!g;p=!1}else a=o[f++%h];a>d&&(a=d);let s=Math.sqrt(a*a/(1+c*c));l<0&&(s=-s),e+=s,i+=c*s,g?t.lineTo(e,i):t.moveTo(e,i),d-=a,g=!g}}rn(t,i,s,n,o,r){let a,h=1,l=1;if("string"==typeof i)return void(s?t.fillStyle=i:t.strokeStyle=i);if(1===i.type)return void(s?t.fillStyle=i.color:t.strokeStyle=i.color);const u=this.p0();h=o.width,l=o.height,n?(h=r.width,l=r.height):s||(h+=u,l+=u);const c=t instanceof It;if(c&&i.cn&&(4===i.type||i._c===h&&i.Yb===l))a=i.cn;else{let o=0,d=0,f=0,g=0,p=0,m=0,y=0,v=0;if(n?(y=r.x,v=r.y):s||(y-=u/2,v-=u/2),o=i.start.x*h+i.start.offsetX+y,d=i.start.y*l+i.start.offsetY+v,f=i.end.x*h+i.end.offsetX+y,g=i.end.y*l+i.end.offsetY+v,2===i.type)a=t.createLinearGradient(o,d,f,g);else if(3===i.type)m=isNaN(i.endRadius)?Math.max(h,l)/2:i.endRadius,isNaN(i.startRadius)?(p=0,m=Math.max(h,l)/2):p=i.startRadius,a=t.createRadialGradient(o,d,p,f,g,m);else if(4===i.type)try{a=t.createPattern(i.pattern,"repeat")}catch{a=null}else e.Zi(i.type,"Brush type");if(4!==i.type){const t=i.colorStops;if(null!==t){const e=t.iterator;for(;e.next();)a.addColorStop(e.key,e.value)}}if(c&&(i.cn=a,null!==a&&(i._c=h,i.Yb=l),null===a&&4===i.type&&-1!==i._c)){i._c=-1;const t=this.diagram;null!==t&&-1===i._c&&e.tr((()=>{t.redraw()}),600)}}s?t.fillStyle=a:t.strokeStyle=a}isContainedBy(t){return t instanceof ie&&this._R(this,t)}_R(t,e){if(t===e||null===e)return!1;let i=t.panel;for(;null!==i;){if(i===e)return!0;i=i.panel}return!1}isVisibleObject(){if(!this.visible)return!1;const t=this.panel;return null===t||t.isVisibleObject()}isEnabledObject(){let t=this instanceof ie?this:this.panel;for(;null!==t&&t.isEnabled;)t=t.panel;return null===t}get enabledChanged(){return null!==this.p?this.p.k0:null}set enabledChanged(t){const i=this.enabledChanged;i!==t&&(null!==t&&e.k(t,Tt,"enabledChanged"),this.Gt().k0=t,this.t("enabledChanged",i,t))}Bb(){if(!0===this.Kb()){const t=this.Hr;if(t.Ri(),!this.Ni.isReal()||!this.se.isReal())return void this.Zu(!1);if(t.Fs(this.Ni.x-this.se.x,this.Ni.y-this.se.y),1!==this.scale||0!==this.angle){const e=this.naturalBounds;this.g0(t,e.x,e.y,e.width,e.height)}this.Zu(!1),this.ka(!0)}if(!0===this.m0()){const t=this.panel;if(null===t)this.lh.set(this.Hr),this.da=this.scale;else if(null!==t.Bs){const e=this.lh;e.Ri(),t.an()?e.nc(t.lh):null!==t.panel&&e.nc(t.panel.lh),e.nc(this.Hr),this.da=this.scale*t.da}this.ka(!1)}}g0(t,e,i,s,n){if(1!==this.tt&&t.tt(this.tt),0===this.Yt)return;const o=y.l();o.setSpot(e,i,s,n,w.Center),t.cs(this.Yt,o.x,o.y),y.e(o)}c(t){if(this.Ao())return;void 0===t&&(t=!1),this.ue(!0),this.Jn(!0);const e=this.panel;null!==e&&!t&&e.c()}tf(){this.Ao()||(this.ue(!0),this.Jn(!0))}ef(t){if(this._e())return;const e=this.panel;!t&&null!==e&&e.c(),this.Jn(!0)}$c(){!1===this.Kb()&&(this.Zu(!0),this.ka(!0))}k2(){this.ka(!0)}S(){const t=this.part;null!==t&&t.S()}zs(t){const e=this.stretch,i=this.panel;if(null===i)return this.vo(1===e?0:e,t);if(i.type===ie.Table)return this.P0(i.getRowDefinition(this.row),i.getColumnDefinition(this.column),t);if(i.type===ie.Auto&&i.findMainElement()===this)return this.vo(2,t);if(1===e){if(i.type===ie.Spot&&i.findMainElement()===this)return this.vo(2,t);const e=i.defaultStretch;return 1===e?this.vo(0,t):this.vo(e,t)}return this.vo(e,t)}P0(t,e,i){const s=this.stretch;if(1!==s)return this.vo(s,i);let n=null,o=null;switch(t.stretch){case 1:case 5:break;case 4:o=!0;break;case 2:o=!0;break}switch(e.stretch){case 1:case 4:break;case 5:n=!0;break;case 2:n=!0;break}const r=this.panel.defaultStretch;return null===n&&(n=5===r||2===r),null===o&&(o=4===r||2===r),!0===n&&!0===o?this.vo(2,i):!0===n?this.vo(5,i):!0===o?this.vo(4,i):this.vo(0,i)}vo(t,e){if(e)return t;if(0===t)return 0;const i=this.desiredSize;if(i.isReal())return 0;const s=!isNaN(i.width),n=!isNaN(i.height),o=this.angle;if(s)if(90!==o&&270!==o){if(5===t)return 0;if(2===t)return 4}else{if(4===t)return 0;if(2===t)return 5}if(n)if(90!==o&&270!==o){if(4===t)return 0;if(2===t)return 5}else{if(5===t)return 0;if(2===t)return 4}return t}get segmentOrientation(){return null!==this.Ot?this.Ot.S0:0}set segmentOrientation(t){const e=this.segmentOrientation;e!==t&&(null===this.Ot&&(this.Ot=new Ie),this.Ot.S0=t,this.c(),this.t("segmentOrientation",e,t),0===t&&(this.angle=0))}tv(){this.segmentOrientation=21}get segmentIndex(){return null!==this.Ot?this.Ot.M0:-1/0}set segmentIndex(t){t=Math.round(t);const e=this.segmentIndex;e!==t&&(null===this.Ot&&(this.Ot=new Ie),this.Ot.M0=t,this.c(),this.t("segmentIndex",e,t))}get segmentFraction(){return null!==this.Ot?this.Ot.N0:0}set segmentFraction(t){t<0?t=0:t>1&&(t=1);const e=this.segmentFraction;e!==t&&(null===this.Ot&&(this.Ot=new Ie),this.Ot.N0=t,this.c(),this.t("segmentFraction",e,t))}get segmentOffset(){return null!==this.Ot?this.Ot.C0:y.wo}set segmentOffset(t){const e=this.segmentOffset;e.equals(t)||(t=t.P(),null===this.Ot&&(this.Ot=new Ie),this.Ot.C0=t,this.c(),this.t("segmentOffset",e,t))}get stretch(){return null!==this.p?this.p.$n:1}set stretch(t){const e=this.stretch;e!==t&&(this.Gt().$n=t,this.c(),this.t("stretch",e,t))}get name(){return null!==this.p?this.p.Pt:""}set name(t){const e=this.name;e!==t&&(this.Gt().Pt=t,null!==this.part&&this.part.L0(),this.t("name",e,t))}get opacity(){return this.$t}set opacity(t){t<0?t=0:t>1&&(t=1);const e=this.opacity;if(e!==t){this.$t=t,this.t("opacity",e,t);const i=this.diagram,s=this.part;null!==i&&null!==s&&i.S(s.qh(s.actualBounds))}}get filter(){return this.u0}set filter(t){const e=this.filter;if(e!==t){this.u0=t,this.Ve(!0),this.t("filter",e,t);const i=this.diagram,s=this.part;null!==i&&null!==s&&i.S(s.qh(s.actualBounds))}}get visible(){return 0!==(1&this.n)}set visible(t){const e=0!==(1&this.n);if(e!==t){this.n=1^this.n,this.Qc(),this.t("visible",e,t);const i=this.panel;null!==i?i.c():this.Xs()&&this.Ei(t),this.S(),this.CA()}}get pickable(){return 0!==(2&this.n)}set pickable(t){const e=0!==(2&this.n);e!==t&&(this.n=2^this.n,this.t("pickable",e,t))}get fromLinkableDuplicates(){return 0!==(4&this.n)}set fromLinkableDuplicates(t){const e=0!==(4&this.n);e!==t&&(this.n=4^this.n,this.t("fromLinkableDuplicates",e,t))}get fromLinkableSelfNode(){return 0!==(8&this.n)}set fromLinkableSelfNode(t){const e=0!==(8&this.n);e!==t&&(this.n=8^this.n,this.t("fromLinkableSelfNode",e,t))}get toLinkableDuplicates(){return 0!==(16&this.n)}set toLinkableDuplicates(t){const e=0!==(16&this.n);e!==t&&(this.n=16^this.n,this.t("toLinkableDuplicates",e,t))}get toLinkableSelfNode(){return 0!==(32&this.n)}set toLinkableSelfNode(t){const e=0!==(32&this.n);e!==t&&(this.n=32^this.n,this.t("toLinkableSelfNode",e,t))}get isPanelMain(){return 0!==(64&this.n)}set isPanelMain(t){const e=0!==(64&this.n);e!==t&&(this.n=64^this.n,this.c(),this.t("isPanelMain",e,t))}get isActionable(){return 0!==(128&this.n)}set isActionable(t){const e=0!==(128&this.n);e!==t&&(this.n=128^this.n,this.t("isActionable",e,t))}get background(){return this.Lt}set background(t){const e=this.background;e!==t&&(null!==t&&jt.Qu(t,"GraphObject.background"),t instanceof jt&&t.u(),this.Lt=t,this.S(),this.t("background",e,t))}w2(){return 0!==(512&this.n)}zb(t){t?this.n|=512:this.n&=-513}Wc(){return 0!==(1024&this.n)}P2(t){t?this.n|=1024:this.n&=-1025}Kb(){return 0!==(2048&this.n)}Zu(t){t?this.n|=2048:this.n&=-2049}m0(){return 0!==(4096&this.n)}ka(t){t?this.n|=4096:this.n&=-4097}Ao(){return 0!==(8192&this.n)}ue(t){t?this.n|=8192:this.n&=-8193}_e(){return 0!==(16384&this.n)}Jn(t){t?this.n|=16384:this.n&=-16385}QR(){return 0!==(32768&this.n)}Ve(t){t?this.n|=32768:this.n&=-32769}get part(){if(this.Xs())return this;if(null!==this.qr)return this.qr;let t=this;for(t=t.panel;t;){if(t instanceof ke)return this.qr=t,t;t=t.panel}return null}get svg(){return this.Eb}set svg(t){this.Eb=t}Au(){this.svg=null}get panel(){return this.Vs}Pa(t){this.Vs=t,null!==this.svg&&this.svg.remove()}get layer(){const t=this.part;return null!==t?t.layer:null}get diagram(){const t=this.part;return null!==t?t.diagram:null}get position(){return this.at}set position(t){const e=t.x,i=t.y,s=this.position,n=s.x,o=s.y;(n===e||isNaN(n)&&isNaN(e))&&(o===i||isNaN(o)&&isNaN(i))?this.M2():(t=t.copy(),this.S2(t,n,o)&&this.t("position",new y(n,o),t.copy()))}M2(){}S2(t,e,i){return this.at=t,this.ef(),!0}bc(t,e,i){this.at.x===t&&this.at.y===e||(this.at.i(t,e),this.$c())}get actualBounds(){return this.Ni}get scale(){return this.tt}set scale(t){const i=this.scale;i!==t&&(t<=0&&e.o("GraphObject.scale for "+this+" must be greater than zero, not: "+t),this.tt=t,this.c(),this.t("scale",i,t))}get angle(){return this.Yt}set angle(t){const e=this.angle;if(e!==t){if(t%=360,t<0&&(t+=360),e===t)return;this.Yt=t,this.CA(),this.c(),this.t("angle",e,t)}}get desiredSize(){return this.is}set desiredSize(t){const e=t.width,i=t.height,s=this.desiredSize,n=s.width,o=s.height;if((n!==e&&(!isNaN(n)||!isNaN(e))||o!==i&&(!isNaN(o)||!isNaN(i)))&&(t=t.P(),this.is=t,this.c(),this instanceof he&&this.ee(),this.t("desiredSize",s,t),this.Wc())){const t=this.part;null!==t&&(this.ba(t,"width"),this.ba(t,"height"))}}get width(){return this.is.width}set width(t){const e=this.is.width;if(e!==t&&(!isNaN(e)||!isNaN(t))){const e=this.is,i=new v(t,this.is.height).u();if(this.is=i,this.c(),this instanceof he&&this.ee(),this.t("desiredSize",e,i),this.Wc()){const t=this.part;null!==t&&this.ba(t,"width")}}}get height(){return this.is.height}set height(t){const e=this.is.height;if(e!==t&&(!isNaN(e)||!isNaN(t))){const e=this.is,i=new v(this.is.width,t).u();if(this.is=i,this.c(),this instanceof he&&this.ee(),this.t("desiredSize",e,i),this.Wc()){const t=this.part;null!==t&&this.ba(t,"height")}}}get minSize(){return null!==this.p?this.p.gr:v.sc}set minSize(t){const e=this.minSize;e.equals(t)||(t=t.copy(),isNaN(t.width)&&(t.width=0),isNaN(t.height)&&(t.height=0),t.u(),this.Gt().gr=t,this.c(),this.t("minSize",e,t))}get maxSize(){return null!==this.p?this.p.pr:v.Bk}set maxSize(t){const e=this.maxSize;e.equals(t)||(t=t.copy(),isNaN(t.width)&&(t.width=1/0),isNaN(t.height)&&(t.height=1/0),t.u(),this.Gt().pr=t,this.c(),this.t("maxSize",e,t))}get measuredBounds(){return this.se}get naturalBounds(){return this.zi}p0(){return 0}get margin(){return this.jr}set margin(t){"number"==typeof t&&(t=new b(t));const e=this.jr;e.equals(t)||(t=t.P(),this.jr=t,this.c(),this.t("margin",e,t))}get T(){return!0===this.Kb()&&this.Bb(),this.Hr}get Bs(){return!0===this.m0()&&this.Bb(),this.lh}trigger(t,e,i){let s=null;return s="string"==typeof t?new dt(t,e,i):t,s.be=this,null===this.ws&&(this.ws=new m),this.ws.set(s.propertyName,s),this}get ws(){return null!==this.p?this.p.ws:null}set ws(t){this.ws!==t&&(this.Gt().ws=t)}get dr(){return null!==this.p?this.p.dr:0}set dr(t){this.dr!==t&&(this.Gt().dr=t)}get alignment(){return this.hi}set alignment(t){const i=this.alignment;i.equals(t)||(t.isNoSpot()&&!t.isDefault()&&e.o("GraphObject.alignment for "+this+" must be a real Spot or Spot.Default, not: "+t),t=t.P(),this.hi=t,this.ef(),this.t("alignment",i,t))}get column(){return this.Gr}set column(t){t=Math.round(t);const i=this.column;i!==t&&(t<0&&e.W(t,">= 0",Tt,"column"),this.Gr=t,this.c(),this.t("column",i,t),null!==this.svg&&this.svg.remove())}get columnSpan(){return null!==this.p?this.p.A0:1}set columnSpan(t){t=Math.round(t);const i=this.columnSpan;i!==t&&(t<1&&e.W(t,">= 1",Tt,"columnSpan"),this.Gt().A0=t,this.c(),this.t("columnSpan",i,t))}get row(){return this.f0}set row(t){t=Math.round(t);const i=this.row;i!==t&&(t<0&&e.W(t,">= 0",Tt,"row"),this.f0=t,this.c(),this.t("row",i,t),null!==this.svg&&this.svg.remove())}get rowSpan(){return null!==this.p?this.p.T0:1}set rowSpan(t){t=Math.round(t);const i=this.rowSpan;i!==t&&(t<1&&e.W(t,">= 1",Tt,"rowSpan"),this.Gt().T0=t,this.c(),this.t("rowSpan",i,t))}get spanAllocation(){return null!==this.p?this.p.D0:null}set spanAllocation(t){const i=this.spanAllocation;i!==t&&(null!==t&&e.k(t,Tt,"spanAllocation"),this.Gt().D0=t,this.c(),this.t("spanAllocation",i,t))}get alignmentFocus(){return this.Hu}set alignmentFocus(t){const e=this.alignmentFocus;e.equals(t)||(t=t.P(),this.Hu=t,this.c(),this.t("alignmentFocus",e,t))}get portId(){return this.c0}set portId(t){const i=this.portId;if(i!==t){const s=this.part;null!==s&&!(s instanceof Ce)&&e.o("Cannot set portID on a Link: "+t);const n=s;null!==i&&null!==n&&n.N2(this),this.c0=t,null!==t&&null!==n&&(n.fn=!0,n.LA(this)),this.t("portId",i,t)}}Sa(){const t=this.part;if(t instanceof Ce&&(null!==this.portId||this===t.port)){const e=t.diagram;null!==e&&!e.undoManager.isUndoingRedoing&&t.bA(this)}}CA(){const t=this.diagram;null===t||t.undoManager.isUndoingRedoing||(this instanceof ie?this instanceof Ce?this.invalidateConnectedLinks():this.walkVisualTreeFrom(this,(t=>{t.Sa()})):this.Sa())}get toSpot(){return null!==this.ct?this.ct.ma:w.None}set toSpot(t){const e=this.toSpot;e.equals(t)||(t=t.P(),this.Ue().ma=t,this.t("toSpot",e,t),this.Sa())}get toEndSegmentLength(){return null!==this.ct?this.ct.ya:10}set toEndSegmentLength(t){const i=this.toEndSegmentLength;i!==t&&(t<0&&e.W(t,">= 0",Tt,"toEndSegmentLength"),this.Ue().ya=t,this.t("toEndSegmentLength",i,t),this.Sa())}get toShortLength(){return null!==this.ct?this.ct.xa:0}set toShortLength(t){const e=this.toShortLength;e!==t&&(this.Ue().xa=t,this.t("toShortLength",e,t),this.Sa())}get toLinkable(){return null!==this.ct?this.ct.F0:null}set toLinkable(t){const e=this.toLinkable;e!==t&&(this.Ue().F0=t,this.t("toLinkable",e,t))}get toMaxLinks(){return null!==this.ct?this.ct.R0:1/0}set toMaxLinks(t){const i=this.toMaxLinks;i!==t&&(t<0&&e.W(t,">= 0",Tt,"toMaxLinks"),this.Ue().R0=t,this.t("toMaxLinks",i,t))}get fromSpot(){return null!==this.ct?this.ct.ga:w.None}set fromSpot(t){const e=this.fromSpot;e.equals(t)||(t=t.P(),this.Ue().ga=t,this.t("fromSpot",e,t),this.Sa())}get fromEndSegmentLength(){return null!==this.ct?this.ct.pa:10}set fromEndSegmentLength(t){const i=this.fromEndSegmentLength;i!==t&&(t<0&&e.W(t,">= 0",Tt,"fromEndSegmentLength"),this.Ue().pa=t,this.t("fromEndSegmentLength",i,t),this.Sa())}get fromShortLength(){return null!==this.ct?this.ct.wa:0}set fromShortLength(t){const e=this.fromShortLength;e!==t&&(this.Ue().wa=t,this.t("fromShortLength",e,t),this.Sa())}get fromLinkable(){return null!==this.ct?this.ct.v0:null}set fromLinkable(t){const e=this.fromLinkable;e!==t&&(this.Ue().v0=t,this.t("fromLinkable",e,t))}get fromMaxLinks(){return null!==this.ct?this.ct.O0:1/0}set fromMaxLinks(t){const i=this.fromMaxLinks;i!==t&&(t<0&&e.W(t,">= 0",Tt,"fromMaxLinks"),this.Ue().O0=t,this.t("fromMaxLinks",i,t))}get cursor(){return null!==this.p?this.p.Pl:""}set cursor(t){const i=this.cursor;i!==t&&(e.s(t,"string",Tt,"cursor"),this.Gt().Pl=t,this.t("cursor",i,t))}get click(){return null!==this.p?this.p.Nr:null}set click(t){const i=this.click;i!==t&&(null!==t&&e.k(t,Tt,"click"),this.Gt().Nr=t,this.t("click",i,t))}get doubleClick(){return null!==this.p?this.p.Cr:null}set doubleClick(t){const i=this.doubleClick;i!==t&&(null!==t&&e.k(t,Tt,"doubleClick"),this.Gt().Cr=t,this.t("doubleClick",i,t))}get contextClick(){return null!==this.p?this.p.Lr:null}set contextClick(t){const i=this.contextClick;i!==t&&(null!==t&&e.k(t,Tt,"contextClick"),this.Gt().Lr=t,this.t("contextClick",i,t))}get mouseEnter(){return null!==this.p?this.p.Rr:null}set mouseEnter(t){const i=this.mouseEnter;i!==t&&(null!==t&&e.k(t,Tt,"mouseEnter"),this.Gt().Rr=t,this.t("mouseEnter",i,t))}get mouseLeave(){return null!==this.p?this.p.vr:null}set mouseLeave(t){const i=this.mouseLeave;i!==t&&(null!==t&&e.k(t,Tt,"mouseLeave"),this.Gt().vr=t,this.t("mouseLeave",i,t))}get mouseOver(){return null!==this.p?this.p.Ar:null}set mouseOver(t){const i=this.mouseOver;i!==t&&(null!==t&&e.k(t,Tt,"mouseOver"),this.Gt().Ar=t,this.t("mouseOver",i,t))}get mouseHover(){return null!==this.p?this.p.Tr:null}set mouseHover(t){const i=this.mouseHover;i!==t&&(null!==t&&e.k(t,Tt,"mouseHover"),this.Gt().Tr=t,this.t("mouseHover",i,t))}get mouseHold(){return null!==this.p?this.p.Dr:null}set mouseHold(t){const i=this.mouseHold;i!==t&&(null!==t&&e.k(t,Tt,"mouseHold"),this.Gt().Dr=t,this.t("mouseHold",i,t))}get mouseDragEnter(){return null!==this.p?this.p.I0:null}set mouseDragEnter(t){const i=this.mouseDragEnter;i!==t&&(null!==t&&e.k(t,Tt,"mouseDragEnter"),this.Gt().I0=t,this.t("mouseDragEnter",i,t))}get mouseDragLeave(){return null!==this.p?this.p.E0:null}set mouseDragLeave(t){const i=this.mouseDragLeave;i!==t&&(null!==t&&e.k(t,Tt,"mouseDragLeave"),this.Gt().E0=t,this.t("mouseDragLeave",i,t))}get mouseDrop(){return null!==this.p?this.p.Fr:null}set mouseDrop(t){const i=this.mouseDrop;i!==t&&(null!==t&&e.k(t,Tt,"mouseDrop"),this.Gt().Fr=t,this.t("mouseDrop",i,t))}get actionDown(){return null!==this.p?this.p.B0:null}set actionDown(t){const i=this.actionDown;i!==t&&(null!==t&&e.k(t,Tt,"actionDown"),this.Gt().B0=t,this.t("actionDown",i,t))}get actionMove(){return null!==this.p?this.p.U0:null}set actionMove(t){const i=this.actionMove;i!==t&&(null!==t&&e.k(t,Tt,"actionMove"),this.Gt().U0=t,this.t("actionMove",i,t))}get actionUp(){return null!==this.p?this.p.V0:null}set actionUp(t){const i=this.actionUp;i!==t&&(null!==t&&e.k(t,Tt,"actionUp"),this.Gt().V0=t,this.t("actionUp",i,t))}get actionCancel(){return null!==this.p?this.p.z0:null}set actionCancel(t){const i=this.actionCancel;i!==t&&(null!==t&&e.k(t,Tt,"actionCancel"),this.Gt().z0=t,this.t("actionCancel",i,t))}get toolTip(){return null!==this.p?this.p.Or:null}set toolTip(t){const e=this.toolTip;e!==t&&(this.Gt().Or=t,this.t("toolTip",e,t))}get contextMenu(){return null!==this.p?this.p.Ir:null}set contextMenu(t){const e=this.contextMenu;e!==t&&(this.Gt().Ir=t,this.t("contextMenu",e,t))}findBindingPanel(){let t=this instanceof ie?this:this.panel;for(;null!==t;){if(t.C2())return t;t=t.panel}return null}bind(t,e,i,s){return this.sf(t,e,i,s),this}bindTwoWay(t,e,i,s){return this.sf(t,e,i,s).makeTwoWay(),this}bindModel(t,e,i,s){return this.sf(t,e,i,s).ofModel(),this}bindObject(t,e,i,s,n){return this.sf(t,e,i,s).ofObject(n),this}theme(t,e,i,s,n){return this.gh(t,e,i,s,n),this}themeData(t,e,i,s,n){return this.gh(t,e,i,s,n).ofData(),this}themeObject(t,e,i,s,n,o){return this.gh(t,e,i,s,n).ofObject(o),this}themeModel(t,e,i,s,n){return this.gh(t,e,i,s,n).ofModel(),this}sf(t,e,i,s){let n=null;return n="string"==typeof t?new Je(t,e,i,s):t,this.X0(n),n}gh(t,e,i,s,n){let o=null;return o="string"==typeof t?new Qe(t,e,i,s,n):t,this.X0(o),o}X0(t){t.be=this;const i=this.findBindingPanel();null!==i&&i.AA()&&e.o("Cannot add a Binding to a template that has already been copied: "+t),null===this.Ci&&(this.Ci=new h),this.Ci.add(t)}set(t){return Object.assign(this,t),this}attach(t){return Tt.L2(this,t),this}apply(t){return t(this),this}setProperties(t){return vt.e0(this,t),this}static make(i,...s){let n=arguments,o=null,r=null;if(e.it(i))r=i;else if("string"==typeof i){const s=Tt.Gb.get(i);e.it(s)?(n=Array.prototype.slice.call(n),o=s(n),e.K(o)||e.o('GraphObject.make invoked object builder "'+i+'", but it did not return an Object')):r=t.go[i]}null===o&&((null==r||!r.constructor)&&e.o("GraphObject.make requires a class function or GoJS class name or name of an object builder, not: "+i),o=new r);let a=1;if(o instanceof vt&&n.length>1){const t=o,e=n[1];("string"==typeof e||e instanceof HTMLDivElement)&&(t.LM(e),a++)}for(let t=a;t<n.length;t++){const i=n[t];void 0===i?e.o("Undefined value at argument "+t+" for object being constructed by GraphObject.make: "+o):Tt.L2(o,i)}return o}static L2(t,i){if("number"==typeof i)Tt.iv(t,i);else if("string"==typeof i)Tt.ev(t,i);else if(i instanceof Tt)t instanceof ie||e.o("A GraphObject can only be added to a Panel, not to: "+t),t.add(i);else if(i instanceof ae){let s;i.isRow&&e.it(t.getRowDefinition)?s=t.getRowDefinition(i.index):!i.isRow&&e.it(t.getColumnDefinition)&&(s=t.getColumnDefinition(i.index)),s instanceof ae?s.Hb(i):e.o("A RowColumnDefinition can only be added to an object that implements getRowDefinition/getColumnDefinition, not to: "+t)}else if(i instanceof $t){const e=t;e.type=i}else if(i instanceof Je)t instanceof Tt||t instanceof ae?t.bind(i):e.o("A Binding can only be applied to a GraphObject or RowColumnDefinition, not to: "+t);else if(i instanceof dt)t instanceof Tt?t.trigger(i):e.o("An AnimationTrigger can only be applied to a GraphObject, not to: "+t);else if(i instanceof A)t instanceof C&&4===t.type?t.figures.add(i):e.o("A PathFigure can only be added to a Path Geometry, not to: "+t);else if(i instanceof L)t instanceof A?t.segments.add(i):e.o("A PathSegment can only be added to a PathFigure, not to: "+t);else if(i instanceof ze)t instanceof vt||t instanceof _e?t.layout=i:e.o("A Layout can only be assigned to a Diagram or a Group, not to: "+t);else if(Array.isArray(i))for(let e=0;e<i.length;e++){const s=i[e];Tt.L2(t,s)}else e.K(i)?Tt.sv(t,i):e.o('Unknown initializer "'+i+'" for object being constructed by GraphObject.make: '+t)}static ev(t,i){if(t instanceof fe)t.text=i;else if(t instanceof he)t.figure=i;else if(t instanceof ye)t.source=i;else if(t instanceof ie){const e=$t.es.get(i);null!==e&&(t.type=e)}else if(t instanceof jt){const s=e.Eh(_t,i);null!==s?t.type=s:e.o("Unknown Brush type as an argument to GraphObject.make: "+i)}else if(t instanceof C){const s=e.Eh(P,i);null!==s&&(t.type=s)}else if(t instanceof L){const s=e.Eh(N,i);null!==s&&(t.type=s)}}static iv(t,i){e.it(t.oi)?t.oi(i):e.ir(t,i)}static sv(t,i){if(t instanceof jt){const e=new s;for(const s in i){const n=parseFloat(s);isNaN(n)?e[s]=i[s]:t.addColorStop(n,i[s])}vt.e0(t,e)}else if(t instanceof ae){if(void 0!==i.row){const s=i.row;(null==s||s===1/0||isNaN(s)||s<0)&&e.o("Must specify non-negative integer row for RowColumnDefinition "+i+", not: "+s),t.isRow=!0,t.index=s}else if(void 0!==i.column){const s=i.column;(null==s||s===1/0||isNaN(s)||s<0)&&e.o("Must specify non-negative integer column for RowColumnDefinition "+i+", not: "+s),t.isRow=!1,t.index=s}const n=new s;for(const t in i)"row"===t||"column"===t||(n[t]=i[t]);vt.e0(t,n)}else vt.e0(t,i)}static build(t,i,...s){const n=Tt.Gb.get(t);if(e.it(n)){const e=n([t].concat(s));if(e instanceof Tt)return i&&e.setProperties(i),e}e.o('GraphObject.build invoked object builder "'+t+'", but it did not return an Object')}static defineBuilder(t,i){e.s(t,"string",Tt,"defineBuilder:name"),e.k(i,Tt,"defineBuilder:func");t.toLowerCase();Tt.Gb.set(t,i)}static isBuilderDefined(t){return Tt.Gb.has(t)}static takeBuilderArgument(t,i,s){void 0===s&&(s=null);const n=t[1];return(e.it(s)?s(n):"string"==typeof n)?(t.splice(1,1),n):(void 0===i&&e.o("no "+(e.it(s)?"satisfactory":"string")+" argument for GraphObject builder "+t[0]),i)}static Gb=new m;static{Tt.Vertical=4,Tt.Horizontal=5,Tt.defineBuilder("Button",(t=>{const e="#f5f5f5",i="#737373",s="#d4d4d4",n="#737373",o="#a3a3a3",r=2.76142374915397,a=2.761423749153969,h=new ie(ie.Auto,{isActionable:!0,enabledChanged:(t,e)=>{if(t instanceof ie){const i=t.findObject("ButtonBorder");if(null!==i)if(void 0===t._buttonFillNormal&&(t._buttonFillNormal=i.fill),e){let e=null;null!==t.layer&&null!==t.diagram&&t.isVisibleObject()&&(e=t.layer.findObjectAt(t.diagram.lastInput.documentPoint)),e===t||null!==e&&e.isContainedBy(t)?i.fill=t._buttonFillOver:i.fill=t._buttonFillNormal}else i.fill=t._buttonFillDisabled}},cursor:"pointer"}).attach({_buttonFillNormal:void 0,_buttonStrokeNormal:void 0,_buttonFillOver:s,_buttonStrokeOver:n,_buttonFillDisabled:o}).add(new he("RoundedRectangle",{name:"ButtonBorder",spot1:new w(0,0,r,a),spot2:new w(1,1,-r,-a),parameter1:2,fill:e,stroke:i}));return h.mouseEnter=(t,e,i)=>{if(!e.isEnabledObject()||!(e instanceof ie))return;const s=e.findObject("ButtonBorder");s instanceof he&&(void 0===e._buttonFillNormal&&(e._buttonFillNormal=s.fill),s.fill=e._buttonFillOver,void 0===e._buttonStrokeNormal&&(e._buttonStrokeNormal=s.stroke),s.stroke=e._buttonStrokeOver)},h.mouseLeave=(t,e,i)=>{if(!e.isEnabledObject()||!(e instanceof ie))return;const s=e.findObject("ButtonBorder");s instanceof he&&(void 0!==e._buttonFillNormal&&(s.fill=e._buttonFillNormal),void 0!==e._buttonStrokeNormal&&(s.stroke=e._buttonStrokeNormal))},h})),Tt.defineBuilder("TreeExpanderButton",(t=>{const e=Tt.build("Button");return e.attach({_treeExpandedFigure:"MinusLine",_treeCollapsedFigure:"PlusLine",visible:!1}),e.add(new he("MinusLine",{name:"ButtonIcon",stroke:"#0a0a0a",strokeWidth:2,desiredSize:v.nu}).bindObject("figure","isTreeExpanded",((t,e)=>{const i=e.panel;return t?i._treeExpandedFigure:i._treeCollapsedFigure}))),e.bindObject("visible","isTreeLeaf",(t=>!t)),e.click=(t,e)=>{let i=e.part;if(i instanceof Pe&&(i=i.adornedPart),!(i instanceof Ce))return;const s=i.diagram;if(null===s)return;const n=s.commandHandler;if(i.isTreeExpanded){if(!n.canCollapseTree(i))return}else if(!n.canExpandTree(i))return;t.handled=!0,i.isTreeExpanded?n.collapseTree(i):n.expandTree(i)},e})),Tt.defineBuilder("SubGraphExpanderButton",(t=>{const e=Tt.build("Button");return e.attach({_subGraphExpandedFigure:"MinusLine",_subGraphCollapsedFigure:"PlusLine"}),e.add(new he("MinusLine",{name:"ButtonIcon",stroke:"#0a0a0a",strokeWidth:2,desiredSize:v.nu}).bindObject("figure","isSubGraphExpanded",((t,e)=>{const i=e.panel;return t?i._subGraphExpandedFigure:i._subGraphCollapsedFigure}))),e.click=(t,e)=>{let i=e.part;if(i instanceof Pe&&(i=i.adornedPart),!(i instanceof _e))return;const s=i.diagram;if(null===s)return;const n=s.commandHandler;if(i.isSubGraphExpanded){if(!n.canCollapseSubGraph(i))return}else if(!n.canExpandSubGraph(i))return;t.handled=!0,i.isSubGraphExpanded?n.collapseSubGraph(i):n.expandSubGraph(i)},e})),Tt.defineBuilder("ToolTip",(t=>new Pe(ie.Auto,{isShadowed:!0,shadowColor:"rgba(0, 0, 0, .4)",shadowOffset:new y(0,2)}).add(new he("RoundedRectangle",{name:"Border",parameter1:1,fill:"#f5f5f5",strokeWidth:0,spot1:new w(0,0,4,6),spot2:new w(1,1,-4,-4)})))),Tt.defineBuilder("ContextMenu",(t=>new Pe(ie.Vertical,{background:"#f5f5f5",isShadowed:!0,shadowColor:"rgba(0, 0, 0, .4)",shadowOffset:new y(0,2)}).bindObject("background","",(t=>null!==t.adornedPart&&t.hasPlaceholder()?null:"#f5f5f5")))),Tt.defineBuilder("ContextMenuButton",(t=>{const e=Tt.build("Button");e.stretch=5;const i=e.findObject("ButtonBorder");return i instanceof he&&(i.figure="Rectangle",i.strokeWidth=0,i.spot1=new w(0,0,4,6),i.spot2=new w(1,1,-4,-4)),e})),Tt.defineBuilder("PanelExpanderButton",(t=>{const e=Tt.takeBuilderArgument(t,"COLLAPSIBLE"),i=Tt.build("Button");i.attach({_buttonExpandedFigure:"M0 0 M0 6 L4 2 8 6 M8 8",_buttonCollapsedFigure:"M0 0 M0 2 L4 6 8 2 M8 8","ButtonBorder.fill":"rgba(0, 0, 0, 0)",_buttonFillNormal:"rgba(0, 0, 0, 0)","ButtonBorder.stroke":null,_buttonStrokeNormal:null,_buttonFillOver:"rgba(0, 0, 0, .2)",_buttonStrokeOver:null}),i.add(new he({name:"ButtonIcon",strokeWidth:2}).bindObject("geometryString","visible",(t=>t?i._buttonExpandedFigure:i._buttonCollapsedFigure),void 0,e));const s=i.findObject("ButtonBorder");return s instanceof he&&(s.stroke=null,s.fill="rgba(0, 0, 0, 0)"),i.click=(t,i)=>{if(!(i instanceof ie))return;const s=i.diagram;if(null===s||s.isReadOnly)return;let n=i.findBindingPanel();if(null===n&&(n=i.part),null!==n){const i=n.findObject(e);null!==i&&(t.handled=!0,s.startTransaction("Collapse/Expand Panel"),i.visible=!i.visible,s.commitTransaction("Collapse/Expand Panel"))}},i})),Tt.defineBuilder("CheckBoxButton",(t=>{const i=Tt.takeBuilderArgument(t),s=Tt.build("Button",{desiredSize:new v(14,14)});s.attach({"ButtonBorder.spot1":new w(0,0,1,1),"ButtonBorder.spot2":new w(1,1,-1,-1)});const n=new he({name:"ButtonIcon",geometryString:"M0 0 M0 8.85 L4.9 13.75 16.2 2.45 M16.2 16.2",strokeWidth:2,stretch:2,geometryStretch:6,visible:!1});return""!==i&&n.bindTwoWay("visible",i),s.add(n),s.click=(t,s)=>{if(!(s instanceof ie))return;const n=t.diagram;if(null===n||n.isReadOnly||""!==i&&n.model.isReadOnly)return;t.handled=!0;const o=s.findObject("ButtonIcon");n.startTransaction("checkbox"),null!==o&&(o.visible=!o.visible),e.it(s._doClick)&&s._doClick(t,s),n.commitTransaction("checkbox")},s})),Tt.defineBuilder("CheckBox",(t=>{const e=Tt.takeBuilderArgument(t),i=Tt.build("CheckBoxButton",{name:"Button",isActionable:!1,margin:new b(0,1,0,0)},e),s=new ie("Horizontal",{isActionable:!0,cursor:i.cursor,margin:new b(1),mouseEnter:i.mouseEnter,mouseLeave:i.mouseLeave,click:i.click}).attach({_buttonFillNormal:i._buttonFillNormal,_buttonStrokeNormal:i._buttonStrokeNormal,_buttonFillOver:i._buttonFillOver,_buttonStrokeOver:i._buttonStrokeOver,_buttonFillDisabled:i._buttonFillDisabled,_buttonClick:i.click});return s.add(i),i.mouseEnter=null,i.mouseLeave=null,i.click=null,s}))}}class Dt{fi;Pt;jn;Ci;qn;Ys;Pl;Nr;Cr;Lr;Rr;vr;Ar;Tr;Dr;I0;E0;Fr;B0;U0;V0;z0;Or;Ir;k0;D0;ws;gr;pr;$n;T0;A0;dr;x0;Y0;K0;constructor(){this.fi=!1,this.Pt="",this.jn=-1,this.Ci=null,this.qn=null,this.Ys=null,this.Pl="",this.Nr=null,this.Cr=null,this.Lr=null,this.Rr=null,this.vr=null,this.Ar=null,this.Tr=null,this.Dr=null,this.I0=null,this.E0=null,this.Fr=null,this.B0=null,this.U0=null,this.V0=null,this.z0=null,this.Or=null,this.Ir=null,this.k0=null,this.D0=null,this.ws=null,this.gr=v.sc,this.pr=v.Bk,this.$n=1,this.T0=1,this.A0=1,this.dr=0,this.x0=null,this.Y0=null,this.K0="category"}copy(){const t=new Dt;return t.Pt=this.Pt,t.jn=this.jn,t.Ci=this.Ci,t.Ys=this.Ys,t.Pl=this.Pl,t.Nr=this.Nr,t.Cr=this.Cr,t.Lr=this.Lr,t.Rr=this.Rr,t.vr=this.vr,t.Ar=this.Ar,t.Tr=this.Tr,t.Dr=this.Dr,t.I0=this.I0,t.E0=this.E0,t.Fr=this.Fr,t.B0=this.B0,t.U0=this.U0,t.V0=this.V0,t.z0=this.z0,t.Or=this.Or,t.Ir=this.Ir,t.k0=this.k0,t.D0=this.D0,t.ws=this.ws,t.gr=this.gr.P(),t.pr=this.pr.P(),t.$n=this.$n,t.T0=this.T0,t.A0=this.A0,t.dr=this.dr,t.x0=this.x0,t.Y0=this.Y0,t.K0=this.K0,t}}class Ot{m;constructor(){this.m=[1,0,0,1,0,0]}copy(){const t=new Ot;return t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5],t}translate(t,e){this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e}scale(t,e){this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e}rotate(t,e,i){if(t>=360?t-=360:t<0&&(t+=360),0===t)return;this.translate(e,i);let s=0,n=0;if(90===t)s=0,n=1;else if(180===t)s=-1,n=0;else if(270===t)s=0,n=-1;else{const e=t*Math.PI/180;s=Math.cos(e),n=Math.sin(e)}const o=this.m[0]*s+this.m[2]*n,r=this.m[1]*s+this.m[3]*n,a=this.m[0]*-n+this.m[2]*s,h=this.m[1]*-n+this.m[3]*s;this.m[0]=o,this.m[1]=r,this.m[2]=a,this.m[3]=h,this.translate(-e,-i)}}class Ft{type;x1;y1;r1;x2;y2;r2;colors;pattern;constructor(t){this.type=t,this.x1=0,this.y1=0,this.r1=0,this.x2=0,this.y2=0,this.r2=0,this.colors=[],this.pattern=null}addColorStop(t,e){this.colors.push({offset:t,color:e})}}class Rt{Tt;li;ua;Ku;A2;constructor(e,i,s){const n=void 0===i?t.document:i;this.ua=n,this.A2="http://www.w3.org/2000/svg";const o="http://www.w3.org/2000/xmlns/";void 0!==n&&(this.Tt=this.makeElement("svg",{width:"1px",height:"1px",viewBox:"0 0 1 1"}),this.style.display="block",this.style.letterSpacing="normal",this.style.wordSpacing="normal",s||(this.style.position="absolute"),this.Tt.setAttributeNS(o,"xmlns",this.A2),this.Tt.setAttributeNS(o,"xmlns:xlink","http://www.w3.org/1999/xlink")),this.Ku=null,this.li=new Et(this,s)}resize(t,e,i,s){return(this.width!==t||this.height!==e)&&(this.width=t,this.height=e,this.style.width=i+"px",this.style.height=s+"px",this.Tt.setAttributeNS(null,"width",i+"px"),this.Tt.setAttributeNS(null,"height",s+"px"),this.Tt.setAttributeNS(null,"viewBox","0 0 "+i+" "+s),this.li.T2.firstElementChild.setAttributeNS(null,"width",i+"px"),this.li.T2.firstElementChild.setAttributeNS(null,"height",s+"px"),!0)}makeElement(t,i,s){const n=this.ua.createElementNS(this.A2,t);if(e.K(i))for(const e in i)n.setAttributeNS("href"===e?"http://www.w3.org/1999/xlink":"",e,i[e]);return void 0!==s&&(n.textContent=s),n}getBoundingClientRect(){return this.Tt.getBoundingClientRect()}focus(){this.Tt.focus()}get width(){return this.Tt.width.baseVal.value}set width(t){this.Tt.setAttribute("width",t+"px")}get height(){return this.Tt.height.baseVal.value}set height(t){this.Tt.setAttribute("height",t+"px")}dispose(){this.ua=null}get style(){return this.Tt.style}}class Et{nf;of;un;Li;ze;fillStyle;font;globalAlpha;lineCap;lineDashOffset;lineJoin;lineWidth;miterLimit;shadowBlur;shadowColor;shadowOffsetX;shadowOffsetY;strokeStyle;textAlign;imageSmoothingEnabled;clipInsteadOfFill;lastCreatedElement;rf;lf;surface;svg;T2;TA;jb;Oo;mh;Ma;currentElement;clipPathGroup;diagramGroup;lastDrawnPart;currentPath;outerGroup;pathAttributes;Jr;br;filter;partClipRect;constructor(t,e){this.surface=t,this.svg=t.Tt,this.rf=[],this.lf=[],this.fillStyle="#000000",this.font="10px sans-serif",this.globalAlpha=1,this.lineCap="butt",this.lineDashOffset=0,this.lineJoin="miter",this.lineWidth=1,this.miterLimit=10,this.shadowBlur=0,this.shadowColor="rgba(0, 0, 0, 0)",this.shadowOffsetX=0,this.shadowOffsetY=0,this.Jr=!1,this.strokeStyle="#000000",this.textAlign="start",this.clipInsteadOfFill=!1,this.nf=0,this.of=0,this.un=0,this.lastCreatedElement=null,this.currentElement=null,this.Li=[],this.pathAttributes={},this.jb=!1,this.Oo=null,this.mh=0,this.ze=new Ot,this.clipPathGroup=this.newGroup2(),this.diagramGroup=this.newGroup2("gojs-diagram"),this.lastDrawnPart=null,this.currentPath=null;const i=u.gw++,s=this.makeElement("clipPath",{id:"mainClip"+i}),n={x:0,y:0,width:t.width,height:t.height};s.appendChild(this.makeElement("rect",n)),this.T2=s,this.svg.appendChild(this.clipPathGroup),this.clipPathGroup.appendChild(this.diagramGroup),this.svg.appendChild(s),this.clipPathGroup.setAttributeNS(null,"clip-path","url(#mainClip"+i+")"),this.TA={},this.br=!!e,this.filter="",this.partClipRect=null}setDiagramPosScale(t,e,i,s,n,o){void 0===this.diagramGroup?this.newGroup(t,e,i,s,n,o):this.diagramGroup.setAttribute("transform","matrix("+t+", "+e+", "+i+", "+s+", "+n+", "+o+")")}resetInnerSVG(){null!==this.diagramGroup&&(this.diagramGroup.innerHTML="")}arc(t,e,i,s,n,o,r,a){const h=2*Math.PI,l=1e-6,u=h-l,c=i*Math.cos(s),d=i*Math.sin(s),f=t+c,g=e+d,p=o?0:1;let m=o?s-n:n-s;(Math.abs(r-f)>l||Math.abs(a-g)>l)&&this.Li.push(["L",f,+g]),m<0&&(m=m%h+h),m>u?(this.Li.push(["A",i,i,0,1,p,t-c,e-d]),this.Li.push(["A",i,i,0,1,p,f,g])):m>l&&this.Li.push(["A",i,i,0,+(m>=Math.PI),p,t+i*Math.cos(n),e+i*Math.sin(n)])}beginPath(){this.Li=[],this.pathAttributes={stroke:"none",fill:"none"}}endPath(t){this.nv(this.Li,this.ze,t||0)}bezierCurveTo(t,e,i,s,n,o){this.Li.push(["C",t,e,i,s,n,o])}clearRect(t,e,i,s){}clip(){this.pathAttributes.clipPath=!0}closePath(){this.Li.push(["z"])}createLinearGradient(t,e,i,s){const n=new Ft("linear");return n.x1=t,n.y1=e,n.x2=i,n.y2=s,n}createPattern(t,e){let i="";t instanceof HTMLCanvasElement&&(i=t.toDataURL()),t instanceof HTMLImageElement&&(i=t.getAttribute("src"));const s=this.TA;if(s[i])return"url(#"+s[i]+")";const n="PATTERN"+u.gw++,o={width:t.width,height:t.height,id:n,patternUnits:"userSpaceOnUse"},r={x:0,y:0,width:t.width,height:t.height,href:i},a=this.makeElement("pattern",o);return a.appendChild(this.makeElement(vt.img,r)),this.svg.appendChild(a),s[i]=n,"url(#"+n+")"}createRadialGradient(t,e,i,s,n,o){const r=new Ft("radial");return r.x1=t,r.y1=e,r.r1=i,r.x2=s,r.y2=n,r.r2=o,r}amendImageTransform(t,e,i,s,n,o,r,a){const h=r/i,l=a/s;(0!==n||0!==o)&&this.ze.translate(n,o),(1!==h||1!==l)&&this.ze.scale(h,l),(0!==t||0!==e)&&this.ze.translate(-t,-e)}drawImage(t,e,i,s,n,o,r,a,h){let l="";t instanceof HTMLCanvasElement&&(l=t.toDataURL()),t instanceof HTMLImageElement&&(l=t.getAttribute("src"));const u=t instanceof HTMLImageElement?t.naturalWidth:t.width,c=t instanceof HTMLImageElement?t.naturalHeight:t.height;void 0===s&&(o=e,r=i,a=s=u,h=n=c),s=s||0,n=n||0,o=o||0,r=r||0,a=a||0,h=h||0,this.amendImageTransform(e,i,s,n,o,r,a,h);const d={x:0,y:0,width:u||s,height:c||n,href:l};S.z(s,a)&&S.z(n,h)?-1===l.toLowerCase().indexOf(".svg")&&-1===l.toLowerCase().indexOf("data:image/svg")&&(d.preserveAspectRatio="xMidYMid slice"):d.preserveAspectRatio="none",(0!==e||0!==i||s!==u||n!==c)&&(s+=e,n+=i,d["clip-path"]=`path('M ${e},${i} L ${s} ${i} L ${s} ${n} L ${e} ${n} z')`),this.processCommon(vt.img,d,this.ze),this._u(vt.img,d)}fill(t,e){t&&(this.pathAttributes["fill-rule"]="evenodd"),this.setFill(this.pathAttributes)}fillContext(t,e,i){this.clipInsteadOfFill?this.clip():this.fill(e,i)}createOrUpdateClipGroup(t,e){const i=this.newGroup(1,0,0,1,-e.x,-e.y);i.setAttributeNS(null,"class","spotClip"),t.hh=i}fillRect(t,e,i,s){this.addRect("fill",[t,e,i,s],this.ze)}fillBackground(t,e,i,s){const n={x:t,y:e,width:i,height:s};this.processCommon("fill",n,this.ze),this.setFill(n),this.svg.prepend(this.makeElement("rect",n))}fillText(t,e,i){this.addText("fill",[t,e,i],this.ze)}lineTo(t,e){this.Li.push(["L",t,e])}moveTo(t,e){this.Li.push(["M",t,e])}quadraticCurveTo(t,e,i,s){this.Li.push(["Q",t,e,i,s])}rect(t,e,i,s){this.Li.push(["M",t,e],["L",t+i,e],["L",t+i,e+s],["L",t,e+s],["z"])}restore(){this.ze=this.rf.pop(),this.Li=this.rf.pop();const t=this.rf.pop();this.fillStyle=t.fillStyle,this.font=t.font,this.globalAlpha=t.globalAlpha,this.lineCap=t.lineCap,this.lineDashOffset=t.lineDashOffset,this.lineJoin=t.lineJoin,this.lineWidth=t.lineWidth,this.miterLimit=t.miterLimit,this.shadowBlur=t.shadowBlur,this.shadowColor=t.shadowColor,this.shadowOffsetX=t.shadowOffsetX,this.shadowOffsetY=t.shadowOffsetY,this.strokeStyle=t.strokeStyle,this.textAlign=t.textAlign,this.partClipRect=t.partClipRect}save(){const t={fillStyle:this.fillStyle,font:this.font,globalAlpha:this.globalAlpha,lineCap:this.lineCap,lineDashOffset:this.lineDashOffset,lineJoin:this.lineJoin,lineWidth:this.lineWidth,miterLimit:this.miterLimit,shadowBlur:this.shadowBlur,shadowColor:this.shadowColor,shadowOffsetX:this.shadowOffsetX,shadowOffsetY:this.shadowOffsetY,strokeStyle:this.strokeStyle,textAlign:this.textAlign,partClipRect:this.partClipRect};this.rf.push(t);const e=[];for(let i=0;i<this.Li.length;i++)e.push(this.Li[i]);this.rf.push(e),this.rf.push(this.ze.copy())}setTransform(t,e,i,s,n,o){1===t&&0===e&&0===i&&1===s&&0===n&&0===o||this.newGroup(t,e,i,s,n,o)}setCurrentTransform(t,e,i,s,n,o){this.ze.m=[t,e,i,s,n,o]}getCurrentTransform(){const t=this.ze.m;return"matrix("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}scale(t,e){this.ze.scale(t,e)}translate(t,e){this.ze.translate(t,e)}transform(t,e,i,s,n,o){}commitTransform(){}stroke(){this.setStroke(this.pathAttributes)}strokeContext(){this.clipInsteadOfFill||this.stroke()}strokeRect(t,e,i,s){this.addRect("stroke",[t,e,i,s],this.ze)}makeElement(t,e,i){return this.surface.makeElement(t,e,i)}_u(t,e,i){const s=this.makeElement(t,e,i);return null!==this.currentElement?this.currentElement.appendChild(s):this.currentElement=s,this.lastCreatedElement=s,s}processCommon(t,e,i){if("fill"===t?this.setFill(e):"stroke"===t&&this.setStroke(e),null!==i){const t=i.m;e.transform="matrix("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}}setFill(t){if(this.fillStyle instanceof Ft)t.fill=this.addGradient(this.fillStyle,!0);else if(/^rgba\(/.test(this.fillStyle)){const e=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(this.fillStyle);t.fill="rgb("+e[1]+","+e[2]+","+e[3]+")",t["fill-opacity"]=e[4]}else t.fill=this.fillStyle}setFillOrStrokeInPlace(t,e){const i=e?"fill":"stroke";if(this.fillStyle instanceof Ft)t.setAttributeNS(null,"fill",this.addGradient(this.fillStyle,!0));else if(/^rgba\(/.test(this.fillStyle)){const e=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(this.fillStyle);t.setAttributeNS(null,i,"rgb("+e[1]+","+e[2]+","+e[3]+")"),t.setAttributeNS(null,i+"-opacity",e[4])}else t.setAttributeNS(null,i,this.fillStyle)}setStroke(t){if(this.strokeStyle instanceof Ft)t.stroke=this.addGradient(this.strokeStyle,!1);else if(/^rgba\(/.test(this.strokeStyle)){const e=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(this.strokeStyle);t.stroke="rgb("+e[1]+","+e[2]+","+e[3]+")",t["stroke-opacity"]=e[4]}else t.stroke=this.strokeStyle;t["stroke-width"]=this.lineWidth,t["stroke-linecap"]=this.lineCap,t["stroke-linejoin"]=this.lineJoin,t["stroke-miterlimit"]=this.miterLimit,this.jb&&(t["stroke-dasharray"]=this.Oo.toString(),t["stroke-dashoffset"]=this.mh)}addGradient(t,i){let s="";const n=null!==this.currentPath?this.currentPath.getAttribute(i?"fill":"stroke"):null;if(null!==n&&-1!==n.indexOf("GRAD")){s=n.split("#")[1].slice(0,-1);const t=this.svg.getElementById(s);null!==t&&t.remove()}else s="GRAD"+u.gw++;let o;if("linear"===t.type){const e={x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2,id:s,gradientUnits:"userSpaceOnUse"};o=this.makeElement("linearGradient",e)}else if("radial"===t.type){const e={x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2,r1:t.r1,r2:t.r2,id:s};o=this.makeElement("radialGradient",e)}else e.o("invalid gradient");const r=t.colors,a=r.length,h=[];for(let e=0;e<a;e++){const t=r[e],i=t.color,s={offset:t.offset,"stop-color":i};if(/^rgba\(/.test(i)){const t=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(i);s["stop-color"]="rgb("+t[1]+","+t[2]+","+t[3]+")",s["stop-opacity"]=t[4]}h.push(s)}h.sort(((t,e)=>t.offset>e.offset?1:-1));for(let e=0;e<a;e++)o.appendChild(this.makeElement("stop",h[e]));return this.svg.appendChild(o),"url(#"+s+")"}addRect(t,e,i){const s={x:e[0],y:e[1],width:e[2],height:e[3]};this.processCommon(t,s,i),this._u("rect",s)}addText(t,e,i){let s=this.textAlign;"left"===s?s="start":"right"===s?s="end":"center"===s&&(s="middle");const n={x:e[1],y:e[2],style:"font: "+this.font,"text-anchor":s};this.processCommon(t,n,i),this._u("text",n,e[0])}nv(t,e,i){const s=this.ov(t),n=this.pathAttributes;if(n.clipPath)this.lf.length>1&&this.lf[this.lf.length-2].setAttributeNS(null,"clip-path",'path("'+s+'") view-box');else if(n.d=s,this.processCommon("",n,e),null!==this.currentPath){const t=this.currentPath;if("g"!==t.nodeName)for(const e in n)"transform"!==e&&t.setAttributeNS(null,e,n[e]);else{const e=t.getElementsByTagName("path");for(const t in n)"transform"!==t&&e[i].setAttributeNS(null,t,n[t])}}else this._u("path",n)}ov(t){const e=[];for(let i=0;i<t.length;i++){const s=t[i].slice(),n=[s.shift()];if("A"===n[0])n.push(s.shift()+","+s.shift(),s.shift(),s.shift()+","+s.shift(),s.shift()+","+s.shift());else for(;s.length;)n.push(s.shift()+","+s.shift());e.push(n.join(" "))}return e.join(" ")}newGroup(t,e,i,s,n,o){const r=new Ot;r.m=[t,e,i,s,n,o];const a={};this.processCommon("g",a,r);const h=this._u("g",a);return this.lf.push(h),h}newGroup2(t){const e={};t&&(e.class=t);const i=this._u("g",e);return this.lf.push(i),i}endGroup(){return this.lf.pop()}dummyGroup(){return this.newGroup2(),this.endGroup()}shadowsSet(t,e,i){this.nf=t,this.of=e,this.un=i}shadowsOff(){this.Jr=!1,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowBlur=0}shadowsOn(){this.Jr=!0,this.shadowOffsetX=this.nf,this.shadowOffsetY=this.of,this.shadowBlur=this.un}enableDash(t,e){this.jb=!0,this.Oo=t,this.mh=e}disableDash(){this.jb=!1}clearContextCache(t){}setImageSmoothingEnabled(t){}rotate(t){this.ze.rotate(57.2958*t,0,0)}getImageData(t,e,i,s){return null}measureText(t){return null}removeOldGradient(t,e,i){const s=e.getAttribute(i);if(null===s)return;const n=s.split("#");if(1===n.length)return;const o=this.svg.getElementById(n[1].slice(0,-1));if(null!==o){const t=new RegExp(o.id,"g");1===this.svg.innerHTML.match(t).length&&o.remove()}}removePartFromView(t){null!==t.svg&&t.svg.parentNode===this.diagramGroup&&t.svg.remove()}}class Bt{Tt;li;ua;Ku;constructor(e,i,s,n){const o=void 0===i?t.document:i;this.ua=o,this.Ku=null;const r=o.createElement("canvas");r.tabIndex=0,this.Tt=r,this.li=new It(r,s,n),vt.Qe.set(r,e)}resize(t,e,i,s){return(this.width!==t||this.height!==e)&&(this.width=t,this.height=e,this.style.width=i+"px",this.style.height=s+"px",!0)}toDataURL(t,e){return this.Tt.toDataURL(t,e)}getBoundingClientRect(){return this.Tt.getBoundingClientRect()}focus(){this.Tt.focus()}get width(){return this.Tt.width}set width(t){this.Tt.width=t}get height(){return this.Tt.height}set height(t){this.Tt.height=t}dispose(){vt.Qe.delete(this.Tt),this.ua=null}get style(){return this.Tt.style}}class It{E;qb;Wb;Jb;clipInsteadOfFill;nf;of;un;Ma;Jr;br;constructor(t,i,s){this.E=t.getContext?t.getContext("2d",i):null,null===this.E&&e.o("Browser does not support HTML Canvas Element"),this.qb="",this.Wb="",this.Jb="",this.clipInsteadOfFill=!1,this.nf=0,this.of=0,this.un=0,this.Jr=!1,this.Ma=new k,this.br=!!s}createOrUpdateClipGroup(t,e){}setImageSmoothingEnabled(t){this.E.imageSmoothingEnabled=t}get fillStyle(){return this.E.fillStyle}set fillStyle(t){this.Jb!==t&&(this.E.fillStyle=t,this.Jb=t)}get font(){return this.E.font}set font(t){this.qb!==t&&(this.E.font=t,this.qb=t)}get globalAlpha(){return this.E.globalAlpha}set globalAlpha(t){this.E.globalAlpha=t}get lineCap(){return this.E.lineCap}set lineCap(t){this.E.lineCap=t}get lineDashOffset(){return this.E.lineDashOffset}set lineDashOffset(t){this.E.lineDashOffset=t}get lineJoin(){return this.E.lineJoin}set lineJoin(t){this.E.lineJoin=t}get lineWidth(){return this.E.lineWidth}set lineWidth(t){this.E.lineWidth=t}get miterLimit(){return this.E.miterLimit}set miterLimit(t){this.E.miterLimit=t}get shadowBlur(){return this.E.shadowBlur}set shadowBlur(t){this.E.shadowBlur=t}get shadowColor(){return this.E.shadowColor}set shadowColor(t){this.E.shadowColor=t}get shadowOffsetX(){return this.E.shadowOffsetX}set shadowOffsetX(t){this.E.shadowOffsetX=t}get shadowOffsetY(){return this.E.shadowOffsetY}set shadowOffsetY(t){this.E.shadowOffsetY=t}get strokeStyle(){return this.E.strokeStyle}set strokeStyle(t){this.Wb!==t&&(this.E.strokeStyle=t,this.Wb=t)}get textAlign(){return this.E.textAlign}set textAlign(t){this.E.textAlign=t}get imageSmoothingEnabled(){return this.E.imageSmoothingEnabled}set imageSmoothingEnabled(t){this.E.imageSmoothingEnabled=t}get filter(){return this.E.filter}set filter(t){this.E.filter=""===t?"none":t}arc(t,e,i,s,n,o,r,a){this.E.arc(t,e,i,s,n,o)}beginPath(){this.E.beginPath()}endPath(){}bezierCurveTo(t,e,i,s,n,o){this.E.bezierCurveTo(t,e,i,s,n,o)}clearRect(t,e,i,s){this.commitTransform(),this.E.clearRect(t,e,i,s)}clip(t){t?this.E.clip(t):this.E.clip()}closePath(){this.E.closePath()}createLinearGradient(t,e,i,s){return this.E.createLinearGradient(t,e,i,s)}createPattern(t,e){return this.E.createPattern(t,e)}createRadialGradient(t,e,i,s,n,o){return this.E.createRadialGradient(t,e,i,s,n,o)}drawImage(t,e,i,s,n,o,r,a,h){void 0===s?this.E.drawImage(t,e,i):this.E.drawImage(t,e,i,s,n,o,r,a,h)}fill(t,e){e?this.E.fill(e,t?"evenodd":"nonzero"):this.E.fill(t?"evenodd":"nonzero")}fillRect(t,e,i,s){this.E.fillRect(t,e,i,s)}fillBackground(t,e,i,s){this.E.fillRect(t,e,i,s)}fillText(t,e,i){this.E.fillText(t,e,i)}getImageData(t,e,i,s){return this.E.getImageData(t,e,i,s)}lineTo(t,e){this.E.lineTo(t,e)}measureText(t){return this.E.measureText(t)}moveTo(t,e){this.E.moveTo(t,e)}quadraticCurveTo(t,e,i,s){this.E.quadraticCurveTo(t,e,i,s)}rect(t,e,i,s){this.E.rect(t,e,i,s)}restore(){this.E.restore()}save(){this.commitTransform(),this.E.save()}rotate(t){this.Ma.cs(57.2958*t,0,0)}setTransform(t,e,i,s,n,o){this.Ma.setTo(t,e,i,s,n,o)}scale(t,e){this.Ma.tt(t,e)}translate(t,e){this.Ma.Fs(t,e)}stroke(t){t?this.E.stroke(t):this.E.stroke()}transform(t,e,i,s,n,o){if(1===t&&0===e&&0===i&&1===s&&0===n&&0===o)return;const r=this.Ma,a=r.m11*t+r.m21*e,h=r.m12*t+r.m22*e,l=r.m11*i+r.m21*s,u=r.m12*i+r.m22*s;r.dx=r.m11*n+r.m21*o+r.dx,r.dy=r.m12*n+r.m22*o+r.dy,r.m11=a,r.m12=h,r.m21=l,r.m22=u}commitTransform(){const t=this.Ma;this.E.setTransform(t.m11,t.m12,t.m21,t.m22,t.dx,t.dy)}fillContext(t,e,i){this.radialFill(t,e,i)||this.fillOrClip(e,i)}radialFill(t,e,i){if(!(t instanceof jt)||3!==t.type)return!1;const s=t._c,n=t.Yb;return n>s?(this.scale(s/n,1),this.translate((n-s)/2,0)):s>n&&(this.scale(1,n/s),this.translate(0,(s-n)/2)),this.fillOrClip(e,i),n>s?(this.translate(-(n-s)/2,0),this.scale(1/(s/n),1)):s>n&&(this.translate(0,-(s-n)/2),this.scale(1,1/(n/s))),!0}strokeContext(){this.clipInsteadOfFill||this.stroke()}fillOrClip(t,e){this.clipInsteadOfFill?this.clip(e):this.fill(t,e)}shadowsSet(t,e,i){this.nf=t,this.of=e,this.un=i}shadowsOff(){this.Jr=!1,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowBlur=0}shadowsOn(){this.Jr=!0,this.shadowOffsetX=this.nf,this.shadowOffsetY=this.of,this.shadowBlur=this.un}enableDash(t,e){const i=this.E;void 0!==i.setLineDash&&(i.setLineDash(t),i.lineDashOffset=e)}disableDash(){const t=this.E;void 0!==t.setLineDash&&(t.setLineDash(It.EmptyArray),t.lineDashOffset=0)}clearContextCache(t){t&&(this.qb=""),this.Wb="",this.Jb=""}removePartFromView(t){}static EmptyArray=Object.freeze([])}var _t=(t=>(t[t.Solid=1]="Solid",t[t.Linear=2]="Linear",t[t.Radial=3]="Radial",t[t.Pattern=4]="Pattern",t))(_t||{}),Vt=(t=>(t[t.Lab=1]="Lab",t[t.HSL=2]="HSL",t[t.Oklch=3]="Oklch",t))(Vt||{});class zt{n0;n1;n2;n3;constructor(){this.n0=0,this.n1=0,this.n2=0,this.n3=0}}class jt{h;j;Na;ei;gs;G0;H0;Io;j0;cn;_c;Yb;constructor(t,i){if(u.Gi(this),this.h=!1,void 0===t)this.j=1,this.Na="black";else if("string"==typeof t){const i=e.Eh(_t,t);null!==i?(this.j=i,this.Na="black"):(this.j=1,this.Na=t)}else Object.keys(_t).hasOwnProperty(t)?(this.j=t,this.Na="black"):"object"==typeof t&&(this.j=1,i=t);const s=this.j;if(2===s?(this.ei=w.TopCenter,this.gs=w.BottomCenter):3===s?(this.ei=w.Center,this.gs=w.Center):(this.ei=w.None,this.gs=w.None),this.G0=0,this.H0=NaN,this.Io=null,this.j0=null,this.cn=null,this._c=0,this.Yb=0,i){const t={};for(const e in i)isFinite(parseFloat(e))?this.addColorStop(parseFloat(e),i[e]):t[e]=i[e];Object.assign(this,t)}}copy(){const t=new jt;return t.j=this.j,t.Na=this.Na,t.ei=this.ei.P(),t.gs=this.gs.P(),t.G0=this.G0,t.H0=this.H0,null!==this.Io&&(t.Io=this.Io.copy()),t.j0=this.j0,t}u(){return this.h=!0,null!==this.Io&&this.Io.u(),this}oi(t){t in _t?this.type=t:e.ir(this,t)}toString(){let t="Brush(";if(1===this.type)t+=this.color;else if(2===this.type?t+="Linear ":3===this.type?t+="Radial ":4===this.type?t+="Pattern ":t+="(unknown) ",t+=this.start+" "+this.end,null!==this.colorStops){const e=this.colorStops.iterator;for(;e.next();){const i=e.key,s=e.value;t+=" "+i+":"+s}}return t+=")",t}addColorStop(t,i){return this.h&&e.L(this),("number"!=typeof t||!isFinite(t)||t>1||t<0)&&e.W(t,"0 <= loc <= 1",jt,"addColorStop:loc"),e.s(i,"string",jt,"addColorStop:color"),null===this.Io&&(this.Io=new m),this.Io.set(t,i),1===this.j&&(this.type=2),this.cn=null,this}get type(){return this.j}set type(t){this.h&&e.L(this,t),this.j=t,this.start.isNoSpot()&&(2===t?this.start=w.TopCenter:3===t&&(this.start=w.Center)),this.end.isNoSpot()&&(2===t?this.end=w.BottomCenter:3===t&&(this.end=w.Center)),this.cn=null}get color(){return this.Na}set color(t){this.h&&e.L(this,t),this.Na=t,this.cn=null}get start(){return this.ei}set start(t){this.h&&e.L(this,t),this.ei=t.P(),this.cn=null}get end(){return this.gs}set end(t){this.h&&e.L(this,t),this.gs=t.P(),this.cn=null}get startRadius(){return this.G0}set startRadius(t){this.h&&e.L(this,t),t<0&&e.W(t,">= zero",jt,"startRadius"),this.G0=t,this.cn=null}get endRadius(){return this.H0}set endRadius(t){this.h&&e.L(this,t),t<0&&e.W(t,">= zero",jt,"endRadius"),this.H0=t,this.cn=null}get colorStops(){return this.Io}set colorStops(t){this.h&&e.L(this,t),this.Io=t,this.cn=null}get pattern(){return this.j0}set pattern(t){this.h&&e.L(this,t),this.j0=t,this.cn=null}static randomColor(t,e){void 0===t&&(t=128),void 0===e&&(e=Math.max(t,255));const i=Math.abs(e-t);let s=Math.floor(t+Math.random()*i).toString(16),n=Math.floor(t+Math.random()*i).toString(16),o=Math.floor(t+Math.random()*i).toString(16);return s.length<2&&(s="0"+s),n.length<2&&(n="0"+n),o.length<2&&(o="0"+o),"#"+s+n+o}static isValidColor(e){return!t.CSS||t.CSS.supports("color",e)}static lighten(t){return jt.lightenBy(t)}lightenBy(t,i){this.h&&e.L(this);const s=void 0===t||"number"!=typeof t?.2:t,n=void 0===i?3:i;if(1===this.type)jt.Mo(this.color),this.color=jt.td(s,n);else if((2===this.type||3===this.type)&&null!==this.colorStops){const t=this.colorStops.iterator;for(;t.next();)jt.Mo(t.value),this.addColorStop(t.key,jt.td(s,n))}return this}static lightenBy(t,e,i){const s=void 0===e||"number"!=typeof e?.2:e,n=void 0===i?3:i;return jt.Mo(t),jt.td(s,n)}static darken(t){return jt.darkenBy(t)}darkenBy(t,i){this.h&&e.L(this);const s=void 0===t||"number"!=typeof t?.2:t,n=void 0===i?3:i;if(1===this.type)jt.Mo(this.color),this.color=jt.td(-s,n);else if((2===this.type||3===this.type)&&null!==this.colorStops){const t=this.colorStops.iterator;for(;t.next();)jt.Mo(t.value),this.addColorStop(t.key,jt.td(-s,n))}return this}static darkenBy(t,e,i){const s=void 0===e||"number"!=typeof e?.2:e,n=void 0===i?3:i;return jt.Mo(t),jt.td(-s,n)}static mix(t,e,i){jt.Mo(t);const s=jt.Y.n0,n=jt.Y.n1,o=jt.Y.n2,r=jt.Y.n3;jt.Mo(e),void 0===i&&(i=.5);const a=Math.round((jt.Y.n0-s)*i+s),h=Math.round((jt.Y.n1-n)*i+n),l=Math.round((jt.Y.n2-o)*i+o),u=Math.round((jt.Y.n3-r)*i+r);return`rgba(${a}, ${h}, ${l}, ${u})`}isDark(){if(1===this.type)return jt.isDark(this.color);if((2===this.type||3===this.type)&&null!==this.colorStops){const t=this.colorStops;if(3===this.type)return jt.isDark(t.first().value);if(null!==t.get(.5))return jt.isDark(t.get(.5));if(2===t.count){const e=t.toArray();return jt.isDark(jt.mix(e[0].value,e[1].value))}const e=t.iterator;let i=-1,s=-1,n=1,o=1;for(;e.next();){const t=e.key,r=Math.abs(.5-e.key);n>o&&r<n?(i=t,n=r):o>=n&&r<o&&(s=t,o=r)}if(i>s){let t=i;i=s,s=t,t=n,n=o,o=t}const r=s-i;return jt.isDark(jt.mix(t.get(i),t.get(s),1-o/r))}return!1}static isDark(t){return!!t&&(t instanceof jt?t.isDark():(jt.Mo(t),(299*jt.Y.n0+587*jt.Y.n1+114*jt.Y.n2)/1e3<128))}static td(t,i){switch(i){case 1:return jt.rv(),jt.Zn.n0=Math.min(100,Math.max(0,jt.Zn.n0+100*t)),jt.lv(),"rgba("+jt.Y.n0+", "+jt.Y.n1+", "+jt.Y.n2+", "+jt.Y.n3+")";case 2:return jt.GS(),jt.Ii.n2=Math.min(100,Math.max(0,jt.Ii.n2+100*t)),"hsla("+jt.Ii.n0+", "+jt.Ii.n1+"%, "+jt.Ii.n2+"%, "+jt.Ii.n3+")";case 3:return jt.hv(),jt.Qn.n0=Math.min(100,Math.max(0,jt.Qn.n0+100*t)),jt.av(),"rgba("+jt.Y.n0+", "+jt.Y.n1+", "+jt.Y.n2+", "+jt.Y.n3+")";default:e.o("Unknown color space: "+i)}}static Mo(t){const e=jt.$r;if(null===e)return;e.clearRect(0,0,1,1),e.fillStyle="#000000";const i=e.fillStyle;if(e.fillStyle=t,e.fillStyle!==i){e.fillRect(0,0,1,1);const t=e.getImageData(0,0,1,1).data;jt.Y.n0=t[0],jt.Y.n1=t[1],jt.Y.n2=t[2],jt.Y.n3=t[3]/255}else{e.fillStyle="#FFFFFF";e.fillStyle;e.fillStyle=t,e.fillStyle,jt.Y.n0=0,jt.Y.n1=0,jt.Y.n2=0,jt.Y.n3=1}}static GS(){const t=jt.Y.n0/255,e=jt.Y.n1/255,i=jt.Y.n2/255,s=Math.max(t,e,i),n=Math.min(t,e,i),o=s-n;let r,a;const h=(s+n)/2;if(0===o)r=a=0;else{switch(s){case t:r=(e-i)/o%6;break;case e:r=(i-t)/o+2;break;case i:r=(t-e)/o+4;break}r*=60,r<0&&(r+=360),a=o/(1-Math.abs(2*h-1))}jt.Ii.n0=Math.round(r),jt.Ii.n1=Math.round(100*a),jt.Ii.n2=Math.round(100*h),jt.Ii.n3=jt.Y.n3}static TE(){const t=jt.Ii.n0,e=jt.Ii.n1/100,i=jt.Ii.n2/100;let s,n,o;const r=(1-Math.abs(2*i-1))*e,a=t/60,h=r*(1-Math.abs(a%2-1));a>=0&&a<1?(s=r,n=h,o=0):a>=1&&a<2?(s=h,n=r,o=0):a>=2&&a<3?(s=0,n=r,o=h):a>=3&&a<4?(s=0,n=h,o=r):a>=4&&a<5?(s=h,n=0,o=r):a>=5&&a<6&&(s=r,n=0,o=h);const l=i-.5*r;s+=l,n+=l,o+=l,jt.Y.n0=Math.round(255*s),jt.Y.n1=Math.round(255*n),jt.Y.n2=Math.round(255*o),jt.Y.n3=jt.Ii.n3}static rv(){jt.DA(),jt.cv()}static lv(){jt.fv(),jt.FA()}static D2(t){return t/=255,t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}static F2(t){return t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055}static DA(){const t=jt.D2(jt.Y.n0),e=jt.D2(jt.Y.n1),i=jt.D2(jt.Y.n2);jt.Dt.n0=.4124564*t+.3575761*e+.1804375*i,jt.Dt.n1=.2126729*t+.7151522*e+.072175*i,jt.Dt.n2=.0193339*t+.119192*e+.9503041*i,jt.Dt.n3=jt.Y.n3}static FA(){const t=3.2404542*jt.Dt.n0+-1.5371385*jt.Dt.n1+-.4985314*jt.Dt.n2,e=-.969266*jt.Dt.n0+1.8760108*jt.Dt.n1+.041556*jt.Dt.n2,i=.0556434*jt.Dt.n0+-.2040259*jt.Dt.n1+1.0572252*jt.Dt.n2;jt.Y.n0=255*jt.F2(t),jt.Y.n1=255*jt.F2(e),jt.Y.n2=255*jt.F2(i),jt.Y.n3=jt.Dt.n3,jt.Y.n0=Math.round(jt.Y.n0),jt.Y.n0>255?jt.Y.n0=255:jt.Y.n0<0&&(jt.Y.n0=0),jt.Y.n1=Math.round(jt.Y.n1),jt.Y.n1>255?jt.Y.n1=255:jt.Y.n1<0&&(jt.Y.n1=0),jt.Y.n2=Math.round(jt.Y.n2),jt.Y.n2>255?jt.Y.n2=255:jt.Y.n2<0&&(jt.Y.n2=0)}static R2=216/24389;static $b=24389/27;static ed=[95.047,100,108.883];static v2(t){return t>jt.R2?Math.pow(t,1/3):(jt.$b*t+16)/116}static cv(){const t=jt.v2(100*jt.Dt.n0/jt.ed[0]),e=jt.v2(100*jt.Dt.n1/jt.ed[1]),i=jt.v2(100*jt.Dt.n2/jt.ed[2]);jt.Zn.n0=116*e-16,jt.Zn.n1=500*(t-e),jt.Zn.n2=200*(e-i),jt.Zn.n3=jt.Dt.n3}static RA(t){const e=t*t*t;return e>jt.R2?e:(116*t-16)/jt.$b}static fv(){const t=(jt.Zn.n0+16)/116,e=jt.Zn.n1/500+t,i=t-jt.Zn.n2/200;jt.Dt.n0=jt.ed[0]/100*jt.RA(e),jt.Dt.n1=jt.ed[1]/100*(jt.Zn.n0>jt.$b*jt.R2?Math.pow(t,3):jt.Zn.n0/jt.$b),jt.Dt.n2=jt.ed[2]/100*jt.RA(i),jt.Dt.n3=jt.Zn.n3}static uv(){let t=.8190224*jt.Dt.n0+.3619062*jt.Dt.n1+-.1288737*jt.Dt.n2,e=.03298366*jt.Dt.n0+.9292868*jt.Dt.n1+.03614466*jt.Dt.n2,i=.04817719*jt.Dt.n0+.2642395*jt.Dt.n1+.6335478*jt.Dt.n2;t=Math.cbrt(t),e=Math.cbrt(e),i=Math.cbrt(i),jt.ai.n0=.2104542*t+.7936177*e+-.004072046*i,jt.ai.n1=1.977998*t+-2.428592*e+.4505937*i,jt.ai.n2=.02590403*t+.7827717*e+-.8086757*i,jt.ai.n3=jt.Dt.n3,jt.ai.n0*=100}static dv(){jt.ai.n0/=100;let t=.9999999*jt.ai.n0+.3963377*jt.ai.n1+.2158037*jt.ai.n2,e=1.000000009*jt.ai.n0+-.1055613*jt.ai.n1+-.06385417*jt.ai.n2,i=1.00000005*jt.ai.n0+-.08948418*jt.ai.n1+-1.291485*jt.ai.n2;t=t**3,e=e**3,i=i**3,jt.Dt.n0=1.2268798*t+-.5578149*e+.281391*i,jt.Dt.n1=-.04057576*t+1.112286*e+-.07171106*i,jt.Dt.n2=-.07637294*t+-.4214933*e+1.586924*i,jt.Dt.n3=jt.ai.n3}static gv(){const t=180*Math.atan2(jt.ai.n2,jt.ai.n1)/Math.PI;jt.Qn.n0=jt.ai.n0,jt.Qn.n1=Math.sqrt(jt.ai.n1**2+jt.ai.n2**2),jt.Qn.n2=t>=0?t:t+360,jt.Qn.n3=jt.ai.n3}static mv(){jt.ai.n0=jt.Qn.n0,jt.ai.n1=jt.Qn.n1*Math.cos(jt.Qn.n2*Math.PI/180),jt.ai.n2=jt.Qn.n1*Math.sin(jt.Qn.n2*Math.PI/180),jt.ai.n3=jt.Qn.n3}static hv(){jt.DA(),jt.uv(),jt.gv()}static av(){jt.mv(),jt.dv(),jt.FA()}static Qu(t,i){"string"==typeof t||t instanceof jt||e.o("Value for "+i+" must be a color string or a Brush, not "+t)}static Solid=1;static Linear=2;static Radial=3;static Pattern=4;static Lab=1;static HSL=2;static $r=vt.isUsingDOM()?new Bt(null,void 0,{willReadFrequently:!0}).li:null;static Y=new zt;static Ii=new zt;static Dt=new zt;static Zn=new zt;static ai=new zt;static Qn=new zt}class $t{Pt="Base";static es=new m;static dn(t,e){e.name=t,$t.es.set(t,e)}get name(){return this.Pt}set name(t){this.Pt=t}constructor(){}get classType(){return ie}measure(t,e,i,s,n,o,r){}measureElement(t,e,i,s,n){t.ht(e,i,s,n)}arrange(t,e,i){}arrangeElement(t,e,i,s,n,o){t.Ut(e,i,s,n,o)}remeasureObject(t){t.tf()}Bi(t,e,i){}}class Xt extends $t{constructor(){super()}measure(t,e,i,s,n,o,r){const a=s.length,h=t.Eo();for(let l=0;l<a;l++){const t=s[l];if(!t.visible&&t!==h)continue;const a=t.margin,u=a.right+a.left,c=a.top+a.bottom;t.ht(e,i,o,r);const d=t.measuredBounds,f=Math.max(d.width+u,0),g=Math.max(d.height+c,0);let p=t.position.x,m=t.position.y;if(isFinite(p)||(p=0),isFinite(m)||(m=0),t instanceof he&&t.isGeometryPositioned){const e=t.strokeWidth/2;p-=e,m-=e}n.unionNoCheck(p,m,f,g)}}arrange(t,e,i){const s=e.length,n=t.padding,o=i.x-n.left,r=i.y-n.top;for(let a=0;a<s;a++){const t=e[a],i=t.measuredBounds,s=t.margin,n=t.position.x,h=t.position.y;let l=isNaN(n)?-o:n-o,u=isNaN(h)?-r:h-r;if(t instanceof he&&t.isGeometryPositioned){const e=t.strokeWidth/2;l-=e,u-=e}t.visible&&t.Ut(l+s.left,u+s.top,i.width,i.height)}}}$t.dn("Position",new Xt);class Gt extends $t{constructor(){super()}measure(t,i,s,n,o,r,a){const h=n.length,l=e.et(),u=t.Eo();for(let e=0;e<h;e++){const t=n[e];if(!t.visible&&t!==u)continue;const i=t.zs(!1);if(0!==i&&5!==i){l.push(t);continue}t.ht(1/0,s,0,a);const r=t.margin,h=t.measuredBounds,c=Math.max(h.width+r.right+r.left,0),d=Math.max(h.height+r.top+r.bottom,0);o.Fn(o.width+c,Math.max(o.height,d))}const c=l.length;t.desiredSize.height?s=Math.min(t.desiredSize.height,t.maxSize.height):0!==o.height&&(s=Math.min(o.height,t.maxSize.height));for(let e=0;e<c;e++){const t=l[e];if(!t.visible&&t!==u)continue;const i=t.margin,n=i.right+i.left,r=i.top+i.bottom;t.ht(1/0,s,0,a);const h=t.measuredBounds,c=Math.max(h.width+n,0),d=Math.max(h.height+r,0);o.width+=c,o.height=Math.max(o.height,d)}e.J(l)}arrange(t,e,i){const s=e.length,n=t.padding,o=n.top,r=t.isOpposite;let a=r?i.width:n.left;for(let h=0;h<s;h++){const s=o,l=e[h];if(!l.visible)continue;const u=l.measuredBounds,c=l.margin,d=c.top+c.bottom,f=o+n.bottom;let g=u.height;const p=l.zs(!1);(isNaN(l.desiredSize.height)&&2===p||4===p)&&(g=Math.max(i.height-d-f,0));const m=g+d+f;let y=l.alignment;y.isDefault()&&(y=t.defaultAlignment),y.isSpot()||(y=w.Center),r&&(a-=u.width+c.left+c.right),l.Ut(a+y.offsetX+c.left,s+y.offsetY+c.top+(i.height*y.y-m*y.y),u.width,g),r||(a+=u.width+c.left+c.right)}}}$t.dn("Horizontal",new Gt);class Yt extends $t{constructor(){super()}measure(t,i,s,n,o,r,a){const h=n.length,l=e.et(),u=t.Eo();for(let e=0;e<h;e++){const t=n[e];if(!t.visible&&t!==u)continue;const s=t.zs(!1);if(0!==s&&4!==s){l.push(t);continue}t.ht(i,1/0,r,0);const a=t.margin,h=t.measuredBounds,c=Math.max(h.width+a.right+a.left,0),d=Math.max(h.height+a.top+a.bottom,0);o.Fn(Math.max(o.width,c),o.height+d)}const c=l.length;t.desiredSize.width?i=Math.min(t.desiredSize.width,t.maxSize.width):0!==o.width&&(i=Math.min(o.width,t.maxSize.width));for(let e=0;e<c;e++){const t=l[e];if(!t.visible&&t!==u)continue;const s=t.margin,n=s.right+s.left,a=s.top+s.bottom;t.ht(i,1/0,r,0);const h=t.measuredBounds,c=Math.max(h.width+n,0),d=Math.max(h.height+a,0);o.width=Math.max(o.width,c),o.height+=d}e.J(l)}arrange(t,e,i){const s=e.length,n=t.padding,o=n.left,r=t.isOpposite;let a=r?i.height:n.top;for(let h=0;h<s;h++){const s=o,l=e[h];if(!l.visible)continue;const u=l.measuredBounds,c=l.margin,d=c.left+c.right,f=o+n.right;let g=u.width;const p=l.zs(!1);(isNaN(l.desiredSize.width)&&2===p||5===p)&&(g=Math.max(i.width-d-f,0));const m=g+d+f;let y=l.alignment;y.isDefault()&&(y=t.defaultAlignment),y.isSpot()||(y=w.Center),r&&(a-=u.height+c.bottom+c.top),l.Ut(s+y.offsetX+c.left+(i.width*y.x-m*y.x),a+y.offsetY+c.top,g,u.height),r||(a+=u.height+c.bottom+c.top)}}}$t.dn("Vertical",new Yt);class Kt extends $t{constructor(){super()}static vA=!1;measure(t,i,s,n,o,r,a){const h=n.length;if(0===h)return;const l=t.findMainElement();let u=l.margin,c=0,d=0;const f=u.right+u.left,g=u.top+u.bottom;l.ht(i,s,r,a);let p=l.measuredBounds,m=p.width,v=p.height,b=Math.max(m+f,0),k=Math.max(v+g,0);const S=t.isClipping;S&&0!==l.p0()&&!Kt.vA&&(Kt.vA=!0,e.ni("Main Shape for Spot Panel with isClipping = true must have a zero strokeWidth: "+t.toString()));const P=x.V(-u.left,-u.top,b,k);let M=x.V(0,0,m,v);this.O2(l,M,!0),m=M.width,v=M.height;let C=!0;const A=t.Eo();let N;for(let e=0;e<h;e++){const r=n[e];let a=i,h=s;if(r===l||!r.visible&&r!==A)continue;u=r.margin;let f=u.left,g=u.top;switch(c=u.right+u.left,d=u.top+u.bottom,N=r.zs(!1),N){case 2:a=m,h=v,c=0,d=0,f=0,g=0;break;case 5:a=m,c=0,f=0;break;case 4:h=v,d=0,g=0;break}r.ht(a,h,0,0),p=r.measuredBounds,b=Math.max(p.width+c,0),k=Math.max(p.height+d,0);let x=r.alignment;x.isDefault()&&(x=t.defaultAlignment),x.isSpot()||(x=w.Center);let S=r.alignmentFocus;S.isDefault()&&(S=w.Center);let P=null;r instanceof ie&&""!==r._n&&(P=r.findObject(r._n),P===r&&(P=null));let L=M.x-f,T=M.y-g;if(null!==P){r.Ut(0,0,p.width,p.height);const t=P.actualBounds,e=y.V(t.x+(S.x*t.width-S.offsetX),t.y+(S.y*t.height-S.offsetY));for(P=P.panel;P!==r;)P.T.gt(e),P=P.panel;L+=x.x*m+x.offsetX-e.x,T+=x.y*v+x.offsetY-e.y,y.e(e)}else L+=x.x*m+x.offsetX-(S.x*p.width+S.offsetX),T+=x.y*v+x.offsetY-(S.y*p.height+S.offsetY);C?(C=!1,o.i(L,T,b,k)):o.unionNoCheck(L,T,b,k)}switch(C?o.a(P):S?o.intersect(M.x,M.y,M.width,M.height):o.unionNoCheck(P.x,P.y,P.width,P.height),x.e(P),x.e(M),N=l.stretch,1===N&&(N=l.zs(!1)),N){case 0:return;case 2:if(!isFinite(i)&&!isFinite(s))return;break;case 5:if(!isFinite(i))return;break;case 4:if(!isFinite(s))return;break}p=l.measuredBounds,m=p.width,v=p.height,b=Math.max(m+f,0),k=Math.max(v+g,0),u=l.margin,M=x.V(-u.left,-u.top,b,k),this.O2(l,M,!0),m=M.width,v=M.height;for(let e=0;e<h;e++){const i=n[e];if(i===l||!i.visible&&i!==A)continue;u=i.margin,c=u.right+u.left,d=u.top+u.bottom,p=i.measuredBounds,b=Math.max(p.width+c,0),k=Math.max(p.height+d,0);let s=i.alignment;s.isDefault()&&(s=t.defaultAlignment),s.isSpot()||(s=w.Center);let r=i.alignmentFocus;r.isDefault()&&(r=w.Center),C?(C=!1,o.i(s.x*m+s.offsetX-(r.x*p.width+r.offsetX)-u.left,s.y*v+s.offsetY-(r.y*p.height+r.offsetY)-u.top,b,k)):o.unionNoCheck(s.x*m+s.offsetX-(r.x*p.width+r.offsetX)-u.left,s.y*v+s.offsetY-(r.y*p.height+r.offsetY)-u.top,b,k)}C?o.a(P):S?o.intersect(M.x,M.y,M.width,M.height):o.unionNoCheck(P.x,P.y,P.width,P.height),x.e(M)}arrange(t,e,i){const s=e.length;if(0===s)return;const n=t.findMainElement(),o=n.measuredBounds,r=o.width,a=o.height,h=t.padding,l=h.left,u=h.top;let c=l-i.x,d=u-i.y;n.Ut(c,d,r,a);const f=x.V(0,0,r,a);this.O2(n,f,!1);for(let g=0;g<s;g++){const s=e[g];if(s===n)continue;const o=s.measuredBounds,r=o.width,a=o.height;let h=s.alignment;h.isDefault()&&(h=t.defaultAlignment),h.isSpot()||(h=w.Center);let p=s.alignmentFocus;p.isDefault()&&(p=w.Center);let m=null;if(s instanceof ie&&""!==s._n&&(m=s.findObject(s._n),m===s&&(m=null)),null!==m){const t=m.actualBounds,e=y.V(t.x+(p.x*t.width-p.offsetX),t.y+(p.y*t.height-p.offsetY));for(m=m.panel;m!==s;)m.T.gt(e),m=m.panel;c=h.x*f.width+h.offsetX-e.x,d=h.y*f.height+h.offsetY-e.y,y.e(e)}else c=h.x*f.width+h.offsetX-(p.x*r+p.offsetX),d=h.y*f.height+h.offsetY-(p.y*a+p.offsetY);c+=f.x-i.x,d+=f.y-i.y,s.visible&&s.Ut(l+c,u+d,r,a)}x.e(f)}O2(t,e,i){let s=null;if(t instanceof ie&&""!==t._n&&(s=t.findObject(t._n),s===t&&(s=null)),null!==s)for(i&&t.Ut(0,0,e.width,e.height),e.a(s.actualBounds),s=s.panel;s!==t;)s.T.vg(e),s=s.panel}}$t.dn("Spot",new Kt);class Ut extends $t{constructor(){super()}measure(t,e,i,s,n,o,r){const a=s.length;if(0===a)return;const h=t.findMainElement();let l=h.margin,u=e,c=i;const d=l.right+l.left,f=l.top+l.bottom;h.ht(e,i,o,r);let g=h.measuredBounds,p=0,m=null;h instanceof he&&(m=h,p=m.strokeWidth*m.scale);let y=Math.max(g.width+d,0),x=Math.max(g.height+f,0),b=t.I2(h);const w=b.x*y+b.offsetX,k=b.y*x+b.offsetY;let S=t.E2(h);const P=S.x*y+S.offsetX,M=S.y*x+S.offsetY;isFinite(e)&&(u=Math.max(Math.abs(w-P)-p,0)),isFinite(i)&&(c=Math.max(Math.abs(k-M)-p,0));let C=0,A=0;o>0&&(C=Math.max(Math.abs(b.x*o+b.offsetX-(S.x*o+S.offsetX))-p,0)),r>0&&(A=Math.max(Math.abs(b.y*r+b.offsetY-(S.y*r+S.offsetY))-p,0));const N=v.l();N.i(0,0);const L=t.Eo();for(let v=0;v<a;v++){const t=s[v];if(t===h||!t.visible&&t!==L)continue;l=t.margin;const e=l.right+l.left,i=l.top+l.bottom;t.ht(u,c,C,A),g=t.measuredBounds,y=Math.max(g.width+e,0),x=Math.max(g.height+i,0),N.i(Math.max(y,N.width),Math.max(x,N.height))}if(1===a)return g=h.measuredBounds,n.width=y,n.height=x,void v.e(N);b=t.I2(h),S=t.E2(h);let T=0,D=0;S.x!==b.x&&S.y!==b.y&&(T=N.width/Math.abs(S.x-b.x),D=N.height/Math.abs(S.y-b.y)),v.e(N),p=0,null!==m&&(p=m.strokeWidth*m.scale,6===m.hS()&&(T=D=Math.max(T,D))),T+=Math.abs(b.offsetX)+Math.abs(S.offsetX)+p,D+=Math.abs(b.offsetY)+Math.abs(S.offsetY)+p;let O=h.stretch;switch(1===O&&(O=h.zs(!1)),O){case 0:o=0,r=0;break;case 2:isFinite(e)&&(T=e),isFinite(i)&&(D=i);break;case 5:isFinite(e)&&(T=e),r=0;break;case 4:o=0,isFinite(i)&&(D=i);break}h.tf(),h.ht(T,D,o,r),n.width=h.measuredBounds.width+d,n.height=h.measuredBounds.height+f}arrange(t,e,i){const s=e.length;if(0===s)return;const n=t.findMainElement(),o=n.measuredBounds,r=x.l();r.i(0,0,1,1);let a=n.margin;const h=a.left,l=a.top,u=t.padding,c=u.left,d=u.top;let f=h,g=l,p=o.width,m=o.height;n.Ut(c+f,d+g,p,m);const y=t.I2(n),v=t.E2(n),b=0+y.x*o.width+y.offsetX,k=0+y.y*o.height+y.offsetY,S=0+v.x*o.width+v.offsetX,P=0+v.y*o.height+v.offsetY;r.x=b,r.y=k,r.unionNoCheck(S,P,0,0),r.x+=h+c,r.y+=l+d;for(let M=0;M<s;M++){const i=e[M];if(i===n)continue;const s=i.measuredBounds;a=i.margin;const o=Math.max(s.width+a.right+a.left,0),h=Math.max(s.height+a.top+a.bottom,0);let l=i.alignment;l.isDefault()&&(l=t.defaultAlignment),l.isSpot()||(l=w.Center),f=r.width*l.x+l.offsetX-o*l.x+a.left+r.x,g=r.height*l.y+l.offsetY-h*l.y+a.top+r.y,p=r.width,m=r.height,i.visible&&(x.contains(r.x,r.y,r.width,r.height,f,g,s.width,s.height)?i.Ut(f,g,s.width,s.height):i.Ut(f,g,s.width,s.height,new x(r.x,r.y,r.width,r.height)))}x.e(r)}}$t.dn("Auto",new Ut);class Ht extends $t{constructor(){super(),this.name="Table"}measure(t,i,s,n,o,r,a){let h=n.length;const l=e.et(),u=e.et();for(let e=0;e<h;e++){const t=n[e],i=t instanceof ie?t:null;if(null!==i&&i.Wr()&&t.visible){u.push(i);const e=i.C.r,s=e.length;for(let n=0;n<s;n++){const s=e[n];i.type===ie.TableRow?s.row=t.row:i.type===ie.TableColumn&&(s.column=t.column),l.push(s)}}else l.push(t)}h=l.length,0===h&&(t.getRowDefinition(0),t.getColumnDefinition(0));const c=[];for(let e=0;e<h;e++){const t=l[e];t.visible&&(t.ue(!0),t.Jn(!0),c[t.row]||(c[t.row]=[]),c[t.row][t.column]||(c[t.row][t.column]=[]),c[t.row][t.column].push(t))}e.J(l);const d=e.et(),f=e.et(),g=e.et(),p={count:0},m={count:0};let y=i,x=s;const b=t.Xe,w=t.Ye;let k=null;h=b.length;for(let e=0;e<h;e++)k=b[e],void 0!==k&&(k.actual=0,k.Ai=0);h=w.length;for(let e=0;e<h;e++)k=w[e],void 0!==k&&(k.actual=0,k.Ai=0);let S=c.length,P=0;for(let e=0;e<S;e++)c[e]&&(P=Math.max(P,c[e].length));const M=Math.min(t.topIndex,S-1),C=Math.min(t.leftIndex,P-1);let A,N=0;S=c.length;const L=t.Eo();for(let e=0;e<S;e++){if(!c[e])continue;P=c[e].length;const i=t.getRowDefinition(e);i.actual=0,i.Ai=0;for(let s=0;s<P;s++){if(!c[e][s])continue;const n=t.getColumnDefinition(s);void 0===d[s]&&(n.actual=0,n.Ai=0,d[s]=!0);const o=c[e][s],r=o.length;for(let a=0;a<r;a++){const r=o[a];if(!r.visible&&r!==L)continue;const h=r.rowSpan>1,l=r.columnSpan>1;(h||l)&&!(e<M)&&!(s<C)&&f.push(r);const u=r.margin,c=u.right+u.left,d=u.top+u.bottom;A=r.P0(i,n,!1);const v=r.desiredSize,b=!isNaN(v.width),w=!isNaN(v.height);if(0!==A&&!(b&&w)&&!(e<M)&&!(s<C)&&(!l&&void 0===p[s]&&(2===A||5===A)&&(p[s]=-1,p.count++),!h&&void 0===m[e]&&(2===A||4===A)&&(m[e]=-1,m.count++),!h&&!l&&g.push(r)),r.ht(1/0,1/0,0,0),e<M||s<C)continue;const S=r.measuredBounds,P=Math.max(S.width+c,0),T=Math.max(S.height+d,0);if(1===r.rowSpan&&(0===A||5===A)){k=t.getRowDefinition(e);const i=k.computeEffectiveSpacing(),s=0===k._;N=Math.max(T-k.actual,0),N+(s?i:0)>x&&(N=Math.max(x-i,0)),k.Ai=k.Ai+N,k.actual=k._+N,x=Math.max(x-(N+(s?i:0)),0)}if(1===r.columnSpan&&(0===A||4===A)){k=t.getColumnDefinition(s);const e=k.computeEffectiveSpacing(),i=0===k._;N=Math.max(P-k.actual,0),N+(i?e:0)>y&&(N=Math.max(y-e,0)),k.Ai=k.Ai+N,k.actual=k._+N,y=Math.max(y-(N+(i?e:0)),0)}(h||l)&&r.tf()}}}e.J(d);let T=0,D=0;h=t.columnCount;for(let e=0;e<h;e++){const t=w[e];void 0!==t&&(T+=isNaN(t.de)?t.Ai:t.de,0!==t.Ai&&(T+=t.computeEffectiveSpacing()))}h=t.rowCount;for(let e=0;e<h;e++){const t=b[e];void 0!==t&&(D+=isNaN(t.de)?t.Ai:t.de,0!==t.Ai&&(D+=t.computeEffectiveSpacing()))}y=Math.max(i-T,0),x=Math.max(s-D,0);let O=x,F=y;h=g.length;for(let e=0;e<h;e++){const i=g[e],s=t.getRowDefinition(i.row),n=t.getColumnDefinition(i.column),o=i.measuredBounds,r=i.margin,a=r.right+r.left,h=r.top+r.bottom;0===n.Ai&&void 0!==p[i.column]?p[i.column]=Math.max(o.width+a,p[i.column]):p[i.column]=null,0===s.Ai&&void 0!==m[i.row]?m[i.row]=Math.max(o.height+h,m[i.row]):m[i.row]=null}let R,E=0,B=0;for(R in m)"count"!==R&&(E+=m[R]);for(R in p)"count"!==R&&(B+=p[R]);const I=v.l();for(let e=0;e<h;e++){const i=g[e];if(!i.visible&&i!==L)continue;const s=t.getRowDefinition(i.row),n=t.getColumnDefinition(i.column);let o=0;isFinite(n.width)?o=n.width:(o=isFinite(y)&&null!==p[i.column]?0===B?n.actual+y:p[i.column]/B*F:null!==p[i.column]?y:n.actual||y,o=Math.max(0,o-n.computeEffectiveSpacing()));let r=0;switch(isFinite(s.height)?r=s.height:(r=isFinite(x)&&null!==m[i.row]?0===E?s.actual+x:m[i.row]/E*O:null!==m[i.row]?x:s.actual||x,r=Math.max(0,r-s.computeEffectiveSpacing())),I.i(Math.max(n.minimum,Math.min(o,n.maximum)),Math.max(s.minimum,Math.min(r,s.maximum))),A=i.P0(s,n,!1),A){case 5:I.height=Math.max(I.height,s.actual+x);break;case 4:I.width=Math.max(I.width,n.actual+y);break}const a=i.margin,h=a.right+a.left,l=a.top+a.bottom;i.tf();let u=n.minimum,c=s.minimum;const d=i.measuredBounds;0===d.width&&null!==p[i.column]&&(u=Math.max(u,p[i.column])),0===d.height&&null!==m[i.row]&&(c=Math.max(u,m[i.row])),i.ht(I.width,I.height,u,c);const f=i.measuredBounds;let v=Math.max(f.width+h,0),b=Math.max(f.height+l,0);isFinite(y)&&(v=Math.min(v,I.width)),isFinite(x)&&(b=Math.min(b,I.height));let w=0;w=s.actual,s.actual=Math.max(s.actual,b),s.Ai=Math.max(s.Ai,b),N=s.actual-w,x=Math.max(x-N,0),null===m[i.row]&&(O=Math.max(O-N,0)),w=n.actual,n.actual=Math.max(n.actual,v),n.Ai=Math.max(n.Ai,v),N=n.actual-w,y=Math.max(y-N,0),null===p[i.column]&&(F=Math.max(F-N,0))}e.J(g);const _=v.l(),V=e.et(),z=e.et();if(h=f.length,0!==h)for(let e=0;e<S;e++){if(!c[e])continue;P=c[e].length;const i=t.getRowDefinition(e);V[e]=i.actual;for(let s=0;s<P;s++){if(!c[e][s])continue;const i=t.getColumnDefinition(s);z[s]=i.actual}}for(let e=0;e<h;e++){const n=f[e];if(!n.visible&&n!==L)continue;const o=t.getRowDefinition(n.row),r=t.getColumnDefinition(n.column);switch(I.i(Math.max(r.minimum,Math.min(i,r.maximum)),Math.max(o.minimum,Math.min(s,o.maximum))),A=n.P0(o,r,!1),A){case 2:0!==z[r.index]&&(I.width=Math.min(I.width,z[r.index])),0!==V[o.index]&&(I.height=Math.min(I.height,V[o.index]));break;case 5:0!==z[r.index]&&(I.width=Math.min(I.width,z[r.index]));break;case 4:0!==V[o.index]&&(I.height=Math.min(I.height,V[o.index]));break}isFinite(r.width)&&(I.width=r.width),isFinite(o.height)&&(I.height=o.height),_.i(0,0);let a=r.minimum,h=o.minimum;for(let e=1;e<n.rowSpan&&!(n.row+e>=t.rowCount);e++)k=t.getRowDefinition(n.row+e),N=0,N=2===A||4===A?Math.max(k.minimum,0===V[n.row+e]?k.maximum:Math.min(V[n.row+e],k.maximum)):Math.max(k.minimum,isNaN(k.de)?k.maximum:Math.min(k.de,k.maximum)),_.height+=N,h+=k.minimum;for(let e=1;e<n.columnSpan&&!(n.column+e>=t.columnCount);e++)k=t.getColumnDefinition(n.column+e),N=0,N=2===A||5===A?Math.max(k.minimum,0===z[n.column+e]?k.maximum:Math.min(z[n.column+e],k.maximum)):Math.max(k.minimum,isNaN(k.de)?k.maximum:Math.min(k.de,k.maximum)),_.width+=N,a+=k.minimum;I.width+=_.width,I.height+=_.height;const l=n.margin,u=l.right+l.left,c=l.top+l.bottom;n.ht(I.width,I.height,a,h);const d=n.measuredBounds,g=Math.max(d.width+u,0),p=Math.max(d.height+c,0);let m=0;for(let e=0;e<n.rowSpan&&!(n.row+e>=t.rowCount);e++)k=t.getRowDefinition(n.row+e),m+=k.total||0;if(m<p){let e=p-m;const i=p-m;if(null!==n.spanAllocation){const s=n.spanAllocation;for(let o=0;o<n.rowSpan&&!(e<=0||n.row+o>=t.rowCount);o++){k=t.getRowDefinition(n.row+o);const r=k._||0,a=s(n,k,i);k.actual=Math.min(k.maximum,r+a),k._!==r&&(e-=k._-r)}}for(;e>0;){const i=k._||0;if(isNaN(k.height)&&k.maximum>i&&(k.actual=Math.min(k.maximum,i+e),k._!==i&&(e-=k._-i)),0===k.index)break;k=t.getRowDefinition(k.index-1)}}let y=0;for(let e=0;e<n.columnSpan&&!(n.column+e>=t.columnCount);e++)k=t.getColumnDefinition(n.column+e),y+=k.total||0;if(y<g){let e=g-y;const i=g-y;if(null!==n.spanAllocation){const s=n.spanAllocation;for(let o=0;o<n.columnSpan&&!(e<=0||n.column+o>=t.columnCount);o++){k=t.getColumnDefinition(n.column+o);const r=k._||0,a=s(n,k,i);k.actual=Math.min(k.maximum,r+a),k._!==r&&(e-=k._-r)}}for(;e>0;){const i=k._||0;if(isNaN(k.width)&&k.maximum>i&&(k.actual=Math.min(k.maximum,i+e),k._!==i&&(e-=k._-i)),0===k.index)break;k=t.getColumnDefinition(k.index-1)}}}e.J(f),v.e(_),v.e(I),void 0!==V&&e.J(V),void 0!==z&&e.J(z);let j=0,$=0;const X=t.desiredSize,G=t.maxSize;A=t.zs(!0),T=0,D=0;let Y=0,K=0;h=t.columnCount;for(let e=0;e<h;e++)if(void 0!==w[e]){if(k=t.getColumnDefinition(e),isFinite(k.width)){Y+=k.width,Y+=k.computeEffectiveSpacing();continue}if(2===k.Zb()){Y+=k._,Y+=k.computeEffectiveSpacing();continue}0!==k._&&(T+=k._,T+=k.computeEffectiveSpacing())}j=isFinite(X.width)?Math.min(X.width,G.width):0!==A&&isFinite(i)?i:T,j=Math.max(j,isFinite(i)?Math.min(r,i):r),j=Math.max(j-Y,0);const U=0===T?1:Math.max(j/T,1);for(let e=0;e<h;e++)void 0!==w[e]&&(k=t.getColumnDefinition(e),!isFinite(k.width)&&2!==k.Zb()&&(k.actual=k._*U),k.position=o.width,0!==k._&&(o.width+=k._,o.width+=k.computeEffectiveSpacing()));h=t.rowCount;for(let e=0;e<h;e++)if(void 0!==b[e]){if(k=t.getRowDefinition(e),isFinite(k.height)){K+=k.height,K+=k.computeEffectiveSpacing();continue}if(2===k.Zb()){K+=k._,K+=k.computeEffectiveSpacing();continue}0!==k._&&(D+=k._,D+=k.computeEffectiveSpacing())}$=isFinite(X.height)?Math.min(X.height,G.height):0!==A&&isFinite(s)?s:D,$=Math.max($,isFinite(s)?Math.min(a,s):a),$=Math.max($-K,0);const H=0===D?1:Math.max($/D,1);for(let e=0;e<h;e++)void 0!==b[e]&&(k=t.getRowDefinition(e),!isFinite(k.height)&&2!==k.Zb()&&(k.actual=k._*H),k.position=o.height,0!==k._&&(o.height+=k._,o.height+=k.computeEffectiveSpacing()));h=u.length;for(let e=0;e<h;e++){const i=u[e];let s=0,n=0;i.type===ie.TableRow?(s=o.width,k=t.getRowDefinition(i.row),n=k.actual):(k=t.getColumnDefinition(i.column),s=k.actual,n=o.height),i.measuredBounds.i(0,0,s,n),i.ue(!1)}e.J(u),t.ph=c}arrange(t,e,i){const s=e.length,n=t.padding,o=n.left,r=n.top,a=t.ph;if(null===a)return;let h=0,l=0;const u=a.length;let c=0;for(let v=0;v<u;v++)a[v]&&(c=Math.max(c,a[v].length));const d=t.Xe,f=t.Ye;let g=0,p=0,m=Math.min(t.topIndex,u-1);if(d.length>0){for(;m!==u&&(void 0===d[m]||0===d[m]._);)m++;m=Math.max(Math.min(m,u-1),0),g=-d[m].position}let y=Math.min(t.leftIndex,c-1);if(f.length>0){for(;y!==c&&(void 0===f[y]||0===f[y]._);)y++;y=Math.max(Math.min(y,c-1),0),p=-f[y].position}let b=0,k=0;for(;b!==u&&void 0===d[b];)b++;for(;k!==u&&void 0===f[k];)k++;const S=t.part;let P=t.getRowDefinition(b),M=t.getColumnDefinition(k);for(let v=0;v<e.length;v++){const i=e[v];if(!(i instanceof ie&&i.visible&&i.Wr()))continue;i.type===ie.TableRow?(P=t.getRowDefinition(i.row),M=t.getColumnDefinition(k)):(P=t.getRowDefinition(b),M=t.getColumnDefinition(i.column)),l=P.position+g+r,0!==P._&&(l+=P.computeEffectiveSpacingTop(Math.max(b,m))),h=M.position+p+o,0!==M._&&(h+=M.computeEffectiveSpacingTop(Math.max(k,y)));const s=i.measuredBounds;i.$c(),i.actualBounds.Nt();const n=i.actualBounds,a=x.V(n.x,n.y,n.width,n.height);(n.x=i.type===ie.TableRow?o:h,n.y=i.type===ie.TableColumn?r:l,n.width=s.width,n.height=s.height,i.actualBounds.u(),i.Jn(!1),a.equalsApproxClose(n))?x.e(a):(null!==S&&(S.uh(),i.w0(S)),x.e(a))}const C=v.l();for(let v=0;v<u;v++){if(!a[v])continue;c=a[v].length;const e=t.getRowDefinition(v);l=e.position+g+r,0!==e._&&(l+=e.computeEffectiveSpacingTop(Math.max(b,m)));for(let s=0;s<c;s++){if(!a[v][s])continue;const n=t.getColumnDefinition(s);h=n.position+p+o,0!==n._&&(h+=n.computeEffectiveSpacingTop(Math.max(k,y)));const r=a[v][s],u=r.length;for(let o=0;o<u;o++){const a=r[o],u=a.measuredBounds;C.i(0,0);for(let e=1;e<a.rowSpan&&!(v+e>=t.rowCount);e++){const i=t.getRowDefinition(v+e);0!==i._&&(C.height+=i.total)}for(let e=1;e<a.columnSpan&&!(s+e>=t.columnCount);e++){const i=t.getColumnDefinition(s+e);0!==i._&&(C.width+=i.total)}const c=n._+C.width,d=e._+C.height;let f=h,g=l;const p=c,m=d,y=h,b=l;let k=c,S=d;h+c>i.width&&(k=Math.max(i.width-h,0)),l+d>i.height&&(S=Math.max(i.height-l,0));let P=a.alignment,M=0,A=0,N=0,L=0;if(P.isDefault()){P=t.defaultAlignment,P.isSpot()||(P=w.Center),M=P.x,A=P.y,N=P.offsetX,L=P.offsetY;const i=n.alignment,s=e.alignment;i.isSpot()&&(M=i.x,N=i.offsetX),s.isSpot()&&(A=s.y,L=s.offsetY)}else M=P.x,A=P.y,N=P.offsetX,L=P.offsetY;(isNaN(M)||isNaN(A))&&(M=.5,A=.5,N=0,L=0);let T=u.width,D=u.height;const O=a.margin,F=O.left+O.right,R=O.top+O.bottom,E=a.P0(e,n,!1);isNaN(a.desiredSize.width)&&(2===E||5===E)&&(T=Math.max(c-F,0)),isNaN(a.desiredSize.height)&&(2===E||4===E)&&(D=Math.max(d-R,0));const B=a.maxSize,I=a.minSize;T=Math.min(B.width,T),D=Math.min(B.height,D),T=Math.max(I.width,T),D=Math.max(I.height,D);const _=T+F,V=D+R;f+=p*M-_*M+N+O.left,g+=m*A-V*A+L+O.top,a.visible&&(x.contains(y,b,k,S,f,g,u.width,u.height)?a.Ut(f,g,T,D):a.Ut(f,g,T,D,new x(y,b,k,S)))}}}v.e(C);for(let v=0;v<s;v++){const t=e[v],i=t instanceof ie?t:null;if(null!==i&&i.Wr()){const e=t.actualBounds;t.naturalBounds.Nt(),t.naturalBounds.i(0,0,e.width,e.height),t.naturalBounds.u()}}}}$t.dn("Table",new Ht);class qt extends $t{constructor(){super()}measure(t,e,i,s,n,o,r){}arrange(t,e,i){}}$t.dn("TableRow",new qt);class Wt extends $t{constructor(){super()}measure(t,e,i,s,n,o,r){}arrange(t,e,i){}}$t.dn("TableColumn",new Wt);class Zt extends $t{constructor(){super()}measure(t,i,s,n,o,r,a){1!==n.length&&e.o("Viewbox Panel must contain exactly one GraphObject.");const h=n[0];h.tt=1,h.tf(),h.ht(1/0,1/0,r,a);let l=h.measuredBounds;const u=h.margin,c=u.right+u.left,d=u.top+u.bottom;if(isFinite(i)||isFinite(s)){const e=h.scale,n=l.width,o=l.height,u=Math.max(i-c,0),f=Math.max(s-d,0);let g=1;6===t.viewboxStretch?(0!==n&&0!==o&&(g=Math.min(u/n,f/o)),0===g&&(g=1e-4),h.tt*=g):(0!==n&&0!==o&&(g=Math.max(u/n,f/o)),0===g&&(g=1e-4),h.tt*=g),e!==h.scale&&(h.ue(!0),h.ht(1/0,1/0,r,a))}l=h.measuredBounds,o.width=isFinite(i)?i:Math.max(l.width+c,0),o.height=isFinite(s)?s:Math.max(l.height+d,0)}arrange(t,e,i){const s=e[0],n=s.measuredBounds,o=s.margin,r=o.right+o.left,a=o.top+o.bottom,h=Math.max(n.width+r,0),l=Math.max(n.height+a,0);let u=s.alignment;u.isDefault()&&(u=t.defaultAlignment),u.isSpot()||(u=w.Center),s.Ut(i.width*u.x-h*u.x+u.offsetX,i.height*u.y-l*u.y+u.offsetY,n.width,n.height)}}$t.dn("Viewbox",new Zt);class Jt extends $t{constructor(){super()}measure(t,e,i,s,n,o,r){null===t.yi&&(t.yi=new ne),this.pv(t),this.yv(t)}arrange(t,e,i){}Bi(t,e,i){const s=t.naturalBounds,n=s.width,o=s.height;e.save(),e.beginPath(),e.rect(0,0,n,o),e.clip(),e.endPath(),this.wv(t,e,i),e.restore(),e.clearContextCache(!1)}wv(t,e,i){let s=t.getDocumentScale()*i.scale;s<=0&&(s=1);const n=t.gridCellSize,o=n.width,r=n.height,a=t.naturalBounds,h=t.actualBounds,l=a.width,u=a.height,c=Math.ceil(l/o),d=Math.ceil(u/r),f=t.gridOrigin,g=f.x,p=f.y,m=t.yi.q0,y=t.C.r,v=y.length;for(let x=0;x<v;x++){const i=y[x];if(!i.visible)continue;const n=i.interval||1,f=Math.abs(n);if(o*f*s<2)continue;let v=i.segmentIndex;(!isFinite(v)||isNaN(v))&&(v=0),v<0&&(v=f-Math.min(-v,f)),v=Math.round(v%f);const b=i.opacity;let w=1;if(1!==b){if(0===b)continue;w=e.globalAlpha,e.globalAlpha=w*b}const k=m[x];let S=!1;const P=i.strokeDashArray;if(null!==P&&(S=!0,e.enableDash(P,i.strokeDashOffset)),null!==i.stroke&&i.strokeWidth>0&&("LineV"===i.figure||"LineH"===i.figure)){if(e.lineWidth=i.strokeWidth,t.rn(e,i.stroke,!1,!1,a,h),e.beginPath(),"LineV"===i.figure){const t=Math.floor((g-o)/o);for(let i=t;i<=t+c;i++){const t=i*o+g;0<=t&&t<=l&&this.Qb(i,n,v,k)&&(e.moveTo(t,0),e.lineTo(t,u))}}else if("LineH"===i.figure){const t=Math.floor((p-r)/r);for(let i=t;i<=t+d;i++){const t=i*r+p;0<=t&&t<=u&&this.Qb(i,n,v,k)&&(e.moveTo(0,t),e.lineTo(l,t))}}e.stroke(),e.endPath()}else if(null!==i.fill)if(t.rn(e,i.fill,!0,!1,a,h),"BarV"===i.figure){let t=i.width;isNaN(t)&&(t=o);const s=Math.floor((g-o)/o);for(let i=s;i<=s+c;i++){const s=i*o+g;0<=s+t&&s<=l&&this.Qb(i,n,v,k)&&e.fillRect(s,0,t,u)}}else if("BarH"===i.figure){let t=i.height;isNaN(t)&&(t=r);const s=Math.floor((p-r)/r);for(let i=s;i<=s+d;i++){const s=i*r+p;0<=s+t&&s<=u&&this.Qb(i,n,v,k)&&e.fillRect(0,s,l,t)}}S&&e.disableDash(),1!==b&&(e.globalAlpha=w)}}Qb(t,e,i,s){if(e<0)return t%e===i;if(t%e!==i)return!1;const n=s.length;for(let o=0;o<n;o++){const e=s[o];if(t%e===i)return!1}return!0}yv(t){const e=[],i=t.C.r,s=i.length;for(let n=0;n<s;n++){const t=i[n],o=[];if(e.push(o),!t.visible)continue;const r=t.interval;if(r<0)continue;const a=t.figure,h=this.B2(a);for(let e=0;e<s;e++){if(e===n)continue;const t=i[e];if(!t.visible)continue;const s=t.figure;if(this.B2(s)!==h)continue;const a=t.interval;a>r&&o.push(a)}}t.yi.q0=e}B2(t){return"LineV"===t||"BarV"===t}pv(t){let e=1,i=1;const s=t.C.r,n=s.length;for(let a=0;a<n;a++){const t=s[a],n=Math.abs(t.interval);n<2||(this.B2(t.figure)?i=i*n/S.DC(i,n):e=e*n/S.DC(e,n))}const o=t.gridCellSize,r=t.yi;r.Yc.isReal()?r.Yc.i(i*o.width,e*o.height):r.Yc=new v(i*o.width,e*o.height)}}$t.dn("Grid",new Jt);class Qt extends $t{constructor(){super()}measure(t,i,s,n,o,r,a){const h=n.length;if(!(t instanceof Pe||t instanceof De))return;let l=null,u=null;if(t instanceof De&&(l=t),t instanceof Pe&&(u=t,l=u.adornedPart,null===t.hf&&(t.hf=[])),!(l instanceof De))return;const c=l;if(0===h)return t.naturalBounds.Fn(0,0),void t.measuredBounds.i(0,0,0,0);const d=t instanceof Pe?null:l.path,f=l.routeBounds,g=t.Bo;g.i(0,0,f.width,f.height);const p=c.points,m=l.pointsCount;null!==u?u.sd(!1):null!==l&&l.sd(!1);const v=f.width,b=f.height,S=t.hf;if(S.length=0,null!==d){this.measureLinkPath(t,v,b,d);const e=d.measuredBounds;g.unionRect(e),S.push(e)}const P=k.l(),M=y.l(),C=y.l();for(let k=0;k<h;k++){const i=n[k];if(i===d)continue;let s=i.measuredBounds;if(i.isPanelMain&&i instanceof he){this.measureLinkPath(t,v,b,i),s=i.measuredBounds,g.unionRect(s),S.push(s);continue}if(m<2){i.ht(1/0,1/0,0,0),s=i.measuredBounds,g.unionRect(s),S.push(s);continue}const o=i.segmentIndex,r=i.segmentFraction;let a=i.alignmentFocus;a.isNoSpot()&&(a=w.Center);const h=i.segmentOrientation,l=i.segmentOffset;let u=0,A=0,N=0,L=0;if(isNaN(o)){const t=c.ot,s=e.et();t.getPointAndAngleAlongPath(r,s);const n=y.V(s[0],s[1]);L=s[2],0!==h&&(N=c.computeAngle(i,h,L),i.Yt=N,i.ue(!0),i.Jn(!0)),u=n.x,A=n.y,y.e(n),e.J(s)}else if(o<-m||o>=m){const t=y.l();c.OA(t),L=c.midAngle,0!==h&&(N=c.computeAngle(i,h,L),i.Yt=N,i.ue(!0),i.Jn(!0)),u=t.x-f.x,A=t.y-f.y,y.e(t)}else{let t,e,s=0;if(o>=0?(t=p.elt(o),e=o<m-1?p.elt(o+1):t):(s=m+o,t=p.elt(s),e=s>0?p.elt(s-1):t),L=0,t.equalsApprox(e)){let i,n;o>=0?(i=o>0?p.elt(o-1):t,n=o<m-2?p.elt(o+2):e):(i=s<m-1?p.elt(s+1):t,n=s>1?p.elt(s-2):e);const r=i.distanceSquaredPoint(t),a=e.distanceSquaredPoint(n);L=r>a+10?o>=0?i.directionPoint(t):t.directionPoint(i):a>r+10?o>=0?e.directionPoint(n):n.directionPoint(e):o>=0?i.directionPoint(n):n.directionPoint(i)}else L=o>=0?t.directionPoint(e):e.directionPoint(t);0!==h&&(N=c.computeAngle(i,h,L),i.Yt=N,i.ue(!0),i.Jn(!0)),u=t.x+(e.x-t.x)*r-f.x,A=t.y+(e.y-t.y)*r-f.y}i.ht(1/0,1/0,0,0),s=i.measuredBounds;const T=i.naturalBounds;let D=0;i instanceof he&&(D=i.strokeWidth);const O=T.width+D,F=T.height+D;P.Ri(),P.Fs(-s.x,-s.y),P.tt(i.scale,i.scale),P.cs(0===h?i.angle:L,O/2,F/2),(22===h||26===h)&&P.cs(90,O/2,F/2),(23===h||27===h)&&P.cs(-90,O/2,F/2),28===h&&(L>45&&L<135||L>225&&L<315)&&P.cs(-L,O/2,F/2);const R=new x(0,0,O,F);M.setRectSpot(R,a),P.gt(M);const E=-M.x+D/2*i.scale,B=-M.y+D/2*i.scale;C.a(l);const I=isNaN(l.x),_=isNaN(l.y);if(I||_){const t=O/2+3,e=F/2+3,i=L>=45&&L<=135,s=L>=225&&L<=315;0===h&&(i||s)?(C.x=_?t:l.y,C.y=I?e:l.x,i?o>=0||isNaN(o)&&r<.5||I&&(C.y=-e):s&&((o>=0||isNaN(o)&&r<.5)&&I&&(C.y=-e),_&&(C.x=-t))):(I&&(o>=0||isNaN(o)&&r<.5?C.x=t:C.x=-t),_&&(C.y=-e),C.rotate(L))}else C.rotate(L);u+=C.x,A+=C.y,R.i(u+E,A+B,s.width,s.height),S.push(R),g.unionRect(R)}if(null!==l){const t=l.labelNodes;for(;t.next();)t.value.ht(1/0,1/0)}t.Bo=g,t.position.i(f.x+g.x,f.y+g.y),o.Fn(g.width||0,g.height||0),k.e(P),y.e(M),y.e(C)}arrange(t,e,i){const s=e.length;if(!(t instanceof Pe||t instanceof De))return;let n=t,o=null;t instanceof Pe&&(o=t,n=o.adornedPart);const r=t,a=t instanceof Pe?null:n.path,h=t.hf;if(0!==h.length){let t=0;if(null!==a&&t<h.length){const e=h[t];t++,a.Ut(e.x-r.Bo.x,e.y-r.Bo.y,e.width,e.height)}for(let i=0;i<s;i++){const s=e[i];if(s!==a&&t<h.length){const e=h[t];t++,s.Ut(e.x-r.Bo.x,e.y-r.Bo.y,e.width,e.height)}}}const l=n.points,u=l.count;if(u>=2&&r instanceof De){const t=r.labelNodes;for(;t.next();){const e=t.value;r.xv(e,u,l)}}null!==o?o.sd(!1):n.sd(!1);const c=t.IA(y.l());t.location.i(t.position.x+c.x,t.position.y+c.y),y.e(c)}measureLinkPath(t,e,i,s){if(!1===s.Ao())return;let n=s.strokeWidth;if(0===n&&t instanceof Pe&&t.type===ie.Link&&t.adornedObject instanceof he&&(n=t.adornedObject.strokeWidth),n*=s.tt,t instanceof De&&null!==t.ot){const e=t.geometry.bounds;s.Wn(e.x-n/2,e.y-n/2,e.width+n,e.height+n)}else if(t instanceof Pe&&null!==t.adornedPart.ot){const e=t.adornedPart.ot.bounds;s.Wn(e.x-n/2,e.y-n/2,e.width+n,e.height+n)}else s.Wn(-n/2,-n/2,e+n,i+n);s.bv(),s.ue(!1)}}$t.dn("Link",new Qt);class te extends $t{constructor(){super()}measure(t,e,i,s,n,o,r){const a=t.findMainElement();t.Ke=[];const h=a.margin,l=h.right+h.left,u=h.top+h.bottom;a.ht(e,i,o,r);const c=a.measuredBounds,d=c.width,f=c.height,g=Math.max(d+l,0),p=Math.max(f+u,0),m=new x(-h.left,-h.top,g,p);t.Ke.push(m),n.a(m),this.determineGraduatedMarks(t,a);const y=t.xs;if(null===y)return;const v=s.length;for(let x=0;x<v;x++){const e=s[x],i=y[x];!e.visible||e===a||0===i.length||(e instanceof he?this.measureGraduatedTicks(t,e,i,n):e instanceof fe&&this.measureGraduatedLabels(t,e,i,n),e.ue(!1))}}arrange(t,e,i){if(null===t.Ke)return;const s=t.findMainElement(),n=t.xs;if(null===n)return;const o=t.Ke;let r=0,a=o[r];r++,null!==s&&s.Ut(a.x-i.x,a.y-i.y,a.width,a.height);const h=e.length;for(let l=0;l<h;l++){const t=e[l],h=n[l];!t.visible||t===s||0===h.length||(a=o[r],r++,t.Ut(a.x-i.x,a.y-i.y,a.width,a.height))}t.Ke=null}measureGraduatedTicks(t,e,i,s){let n=e.alignmentFocus;n.isNoSpot()&&(n=w.TopCenter);const o=e.angle;e.Yt=0,e.ht(1/0,1/0,0,0),e.Yt=o;const r=e.measuredBounds,a=r.width,h=r.height,l=x.V(0,0,a,h),u=y.l();u.setRectSpot(l,n),x.e(l);const c=-u.x,d=-u.y,f=new x,g=i.length;for(let p=0;p<g;p++){const t=i[p],s=t.pt.x,n=t.pt.y,o=t.angle;for(let i=0;i<4;i++){switch(i){case 0:u.i(c,d);break;case 1:u.i(c+a,d);break;case 2:u.i(c,d+h);break;case 3:u.i(c+a,d+h);break}u.rotate(o+e.angle),u.offset(s,n),0===p&&0===i?f.i(u.x,u.y,0,0):f.unionPoint(u),u.offset(-s,-n),u.rotate(-o-e.angle)}}y.e(u),null!==t.Ke&&t.Ke.push(f),s.unionNoCheck(f.x,f.y,f.width,f.height)}measureGraduatedLabels(t,e,i,s){null===t.Pe&&(t.Pe=new fe);const n=t.Pe;this.EA(e,n);let o=e.alignmentFocus;o.isNoSpot()&&(o=w.TopCenter);const r=e.segmentOrientation,a=e.segmentOffset,h=new x;let l=0,u=0,c=0,d=0,f=0;const g=i.length;for(let p=0;p<g;p++){const t=i[p];l=t.pt.x,u=t.pt.y,c=t.angle,d=e.angle,f=e.angle,0!==r&&(f=21===r||25===r?c+e.angle:c,d=De.computeAngle(r,f)),n.Yt=d,n.text=t.text||"",n.ht(1/0,1/0,0,0);const s=n.measuredBounds,g=n.naturalBounds,m=g.width,v=g.height,b=k.l();b.Ri(),b.Fs(-s.x,-s.y),b.tt(n.scale,n.scale),b.cs(f,m/2,v/2),(22===r||26===r)&&b.cs(90,m/2,v/2),(23===r||27===r)&&b.cs(-90,m/2,v/2),28===r&&(c>45&&c<135||c>225&&c<315)&&b.cs(-c,m/2,v/2);const w=x.V(0,0,m,v),S=y.l();S.setRectSpot(w,o),b.gt(S);const P=-S.x,M=-S.y,C=y.l();C.a(a),isNaN(C.x)&&(C.x=m/2+3),isNaN(C.y)&&(C.y=-(v/2+3)),C.rotate(c),l+=C.x+P,u+=C.y+M;const A=new x(l,u,s.width,s.height),N=new x(s.x,s.y,s.width,s.height),L=new x(g.x,g.y,g.width,g.height);t.labelAngle=d,t.lineCount=n.lineCount,t.lines=n.getMetrics(),t.actualBounds=A,t.measuredBounds=N,t.naturalBounds=L,0===p?h.a(A):h.unionRect(A),y.e(C),y.e(S),x.e(w),k.e(b)}null!==t.Ke&&t.Ke.push(h),s.unionNoCheck(h.x,h.y,h.width,h.height)}determineGraduatedMarks(t,i){const s=i.geometry,n=i.strokeWidth,o=s.flattenedSegments,r=s.flattenedLengths,a=s.flattenedTotalLength,h=o.length;let l=0,u=0;const c=e.et();for(let e=0;e<h;e++){const t=o[e],i=[];l=0,u=0;const s=t.length;for(let e=0;e<s;e+=2){const s=t[e],n=t[e+1];if(0===e){l=s,u=n;continue}let o=180*Math.atan2(n-u,s-l)/Math.PI;o<0&&(o+=360),i.push(o),l=s,u=n}c.push(i)}const d=this.kv(t),f=t.C.r,g=f.length;let p,m=0,v=0,x=a;t.xs=[];for(let e=0;e<g;e++){const h=f[e];if(p=[],!h.visible||h===i){t.xs.push(p);continue}const l=Math.abs(h.interval),u=t.graduatedTickUnit;if(u*l*a/t.graduatedRange<2&&null===h.graduatedSkip){t.xs.push(p);continue}let g=r[0][0],b=0,w=0;v=a*h.graduatedStart-1e-4,x=a*h.graduatedEnd+1e-4;const k=u*l;let S=t.graduatedTickBase;if(S<t.graduatedMin){let e=(t.graduatedMin-S)/k;e=e%1===0?e:Math.floor(e+1),S+=e*k}else if(S>t.graduatedMin+k){const e=Math.floor((S-t.graduatedMin)/k);S-=e*k}const P=d[e],M=S,C=1e-6*t.graduatedMax;for(let e=1;S<=t.graduatedMax+C;e++){if(this.Pv(t,S-t.graduatedTickBase,P)&&(S>t.graduatedMax&&(S=t.graduatedMax),(null===h.graduatedSkip||h instanceof fe&&!h.graduatedSkip(S,h)||h instanceof he&&!h.graduatedSkip(S,h))&&(m=(S-t.graduatedMin)*a/t.graduatedRange,m>a&&(m=a),v<=m&&m<=x))){let t=c[b][w],e=r[b][w];for(;b<r.length;){for(;m>g&&w<r[b].length-1;)w++,t=c[b][w],e=r[b][w],g+=e;if(m<=g)break;b++,w=0,t=c[b][w],e=r[b][w],g+=e}const a=o[b],l=a[2*w],u=a[2*w+1],d=a[2*w+2],f=a[2*w+3],v=(m-(g-e))/e,x=new y(l+(d-l)*v+n/2-s.bounds.x,u+(f-u)*v+n/2-s.bounds.y);if(x.scale(i.scale,i.scale),t=this.Sv(t,v,a,c[b],w),h instanceof fe){let e="";null!==h.graduatedFunction?(e=h.graduatedFunction(S,h),e=null!=e?e.toString():""):e=(+S.toFixed(2)).toString(),""!==e&&p.push({pt:x,angle:t,text:e})}else p.push({pt:x,angle:t})}S=M+e*k}t.xs.push(p)}e.J(c)}Sv(t,e,i,s,n){if(e<.5005&&e>.4995)return t;let o=t;if(e<.5?n>0?o=s[n-1]:S.z(i[0],i[i.length-2])&&S.z(i[1],i[i.length-1])&&(o=s[s.length-1]):e>.5&&(n+1<s.length?o=s[n+1]:S.z(i[0],i[i.length-2])&&S.z(i[1],i[i.length-1])&&(o=s[0])),t!==o){let i=Math.abs(t-o);if(i>180&&(t<o?t+=360:o+=360,i=Math.abs(t-o)),e<5e-4||e>.9995)return(t+o)/2%360;if(i<10){const i=1-Math.abs(.5-e);return(t*i+o*(1-i))%360}}return t}kv(t){if(null===t.ss){const e=[],i=t.C.r,s=i.length;for(let t=0;t<s;t++){const n=i[t],o=[];if(e.push(o),!n.visible)continue;const r=n.interval;if(!(r<0))for(let e=0;e<s;e++){if(e===t)continue;const s=i[e];if(!s.visible||n.constructor!==s.constructor)continue;const a=s.interval;a>r&&o.push(a)}}t.ss=e}return t.ss}Pv(t,e,i){const s=i.length;for(let n=0;n<s;n++){const s=i[n]*t.graduatedTickUnit,o=e%s,r=1e-6*t.graduatedTickUnit;if(o<r&&o>-r)return!1}return!0}Bi(t,e,i){const s=i.ta;i.ta=!0;const n=t.naturalBounds,o=n.width,r=n.height,a=e instanceof Et;e.save(),e.beginPath(),e.rect(-1,-1,o+1,r+1),e.clip(),e.endPath();const h=t.findMainElement();h.Bi(e,i);let l=t.getDocumentScale()*i.scale;l<=0&&(l=1);const u=h.actualBounds,c=t.C.r,d=t.xs,f=c.length;for(let g=0;g<f;g++){const s=c[g],n=d[g],o=n.length;if(s.visible&&s!==h&&0!==n.length)if(s instanceof he){if(t.graduatedTickUnit*s.interval*h.geometry.flattenedTotalLength/t.graduatedRange*l<2&&null===s.graduatedSkip)continue;const r=s.measuredBounds,c=s.strokeWidth*s.scale;let d=s.alignmentFocus;d.isNoSpot()&&(d=w.TopCenter);for(let h=0;h<o;h++){const o=n[h].pt,l=n[h].angle;this.Mv(s,o,u,l,r,c,d),s.Bi(e,i),a&&(t.svg.appendChild(s.svg),s.svg=null),s.Hr.Ri()}}else if(s instanceof fe){null===t.Pe&&(t.Pe=new fe);const r=t.Pe;this.EA(s,r),r.U2=!0;for(let h=0;h<o;h++){const o=n[h];if(o.actualBounds&&o.measuredBounds&&o.naturalBounds){r.Nv(o);const n=o.actualBounds;r.Ut(n.x,n.y,n.width,n.height),this.Cv(r,u,n,o.measuredBounds,o.naturalBounds),r.qr=s.part,r.Vs=s.panel,r.Bi(e,i),r.Vs=null,r.qr=null,a&&(t.svg.appendChild(r.svg),r.svg=null)}}}}i.ta=s,e.restore(),e.clearContextCache(!0)}Mv(t,e,i,s,n,o,r){const a=t.Hr;a.Ri(),a.Fs(e.x+i.x,e.y+i.y),a.cs(s+t.angle,0,0),a.Fs(-n.width*r.x+r.offsetX+o/2,-n.height*r.y+r.offsetY+o/2),a.tt(t.scale,t.scale),t.Zu(!1),t.lh.set(t.Hr),t.da=t.scale,t.ka(!1)}Cv(t,e,i,s,n){const o=t.Hr;o.Ri(),o.Fs(i.x+e.x,i.y+e.y),o.Fs(-s.x,-s.y),t.g0(o,n.x,n.y,n.width,n.height),t.Zu(!1),t.lh.set(t.Hr),t.da=t.scale,t.ka(!1)}EA(t,e){e.Lv(t)}}$t.dn("Graduated",new te);var ee=(t=>(t[t.Uniform=6]="Uniform",t[t.UniformToFill=7]="UniformToFill",t))(ee||{});class ie extends Tt{j;C;Zt;nd;Un;Zr;_n;Bo;V2;F;od;st;yi;_t;rd;yh;Ks;constructor(t,i){if(super(),this.j=null,void 0===t)this.j=ie.Position;else if("string"==typeof t){const e=$t.es.get(t);null!==e&&(this.j=e)}else t instanceof $t?this.j=t:t&&(this.j=ie.Position,i=t);null===this.j&&e.o("Panel type not specified or PanelLayout not loaded: "+t),this.n|=4194304|(this.j===ie.Grid?1048576:0),this.C=new h,this.Zt=b.Rg,this.nd=w.Default,this.Un=1,this.Zr=null,this._n="",this.Bo=new x(NaN,NaN,NaN,NaN),this.V2=null,this.F=null,this.od=6,this.yi=null,this.st=null,this._t=null,this.rd=NaN,this.yh=null,this.Ks=null,i&&Object.assign(this,i)}cloneProtected(t){super.cloneProtected(t),t.j=this.j,t.Zt=this.Zt.P(),t.nd=this.nd.P(),t.Un=this.Un,t._n=this._n,t.Bo.a(this.Bo),null!==this.F&&(t.F=this.F.copy(t)),t.od=this.od,null!==this.st&&(t.st=this.st.copy()),null!==this.yi&&(t.yi=this.yi.copy()),t._t=this._t,t.rd=this.rd,t.yh=this.yh}Ro(t){super.Ro(t),t.C=this.C;const e=t.C.r,i=e.length;for(let s=0;s<i;s++){const i=e[s];i.Vs=t}t.Zr=null}copy(){const t=super.copy();if(null!==t){const e=this.C.r,i=e.length;for(let s=0;s<i;s++){const i=e[s].copy();t.Av(i)}return t}return null}toString(){return"Panel("+this.type.name+")#"+u.as(this)}get type(){return this.j}set type(t){const e=this.j;e!==t&&(this.j=t,this.af=this.j===ie.Grid,this.c(),this.t("type",e,t))}get elements(){return this.C.iterator}get naturalBounds(){return this.zi}get padding(){return this.Zt}set padding(t){"number"==typeof t?(t<0&&e.W(t,">= 0",ie,"padding"),t=new b(t)):(t.left<0&&e.W(t.left,">= 0",ie,"padding:value.left"),t.right<0&&e.W(t.right,">= 0",ie,"padding:value.right"),t.top<0&&e.W(t.top,">= 0",ie,"padding:value.top"),t.bottom<0&&e.W(t.bottom,">= 0",ie,"padding:value.bottom"));const i=this.Zt;i.equals(t)||(t=t.P(),this.Zt=t,this.c(),this.t("padding",i,t))}get defaultAlignment(){return this.nd}set defaultAlignment(t){const e=this.nd;e.equals(t)||(t=t.P(),this.nd=t,this.c(),this.t("defaultAlignment",e,t))}get defaultStretch(){return this.Un}set defaultStretch(t){const e=this.Un;e!==t&&(this.Un=t,this.c(),this.t("defaultStretch",e,t))}get defaultSeparatorPadding(){return null!==this.F?this.F.W0:b.Rg}set defaultSeparatorPadding(t){"number"==typeof t&&(t=new b(t));const e=this.defaultSeparatorPadding;e.equals(t)||(t=t.P(),null===this.F&&(this.F=new oe),this.F.W0=t,this.c(),this.t("defaultSeparatorPadding",e,t))}get defaultRowSeparatorStroke(){return null!==this.F?this.F.J0:null}set defaultRowSeparatorStroke(t){const e=this.defaultRowSeparatorStroke;e!==t&&(null===t||"string"==typeof t||t instanceof jt)&&(t instanceof jt&&t.u(),null===this.F&&(this.F=new oe),this.F.J0=t,this.S(),this.t("defaultRowSeparatorStroke",e,t))}get defaultRowSeparatorStrokeWidth(){return null!==this.F?this.F.$0:1}set defaultRowSeparatorStrokeWidth(t){const e=this.defaultRowSeparatorStrokeWidth;e!==t&&isFinite(t)&&t>=0&&(null===this.F&&(this.F=new oe),this.F.$0=t,this.c(),this.t("defaultRowSeparatorStrokeWidth",e,t))}get defaultRowSeparatorDashArray(){return null!==this.F?this.F.Z0:null}set defaultRowSeparatorDashArray(t){const i=this.defaultRowSeparatorDashArray;if(i!==t){if(null!==t&&!Array.isArray(t)&&e.Zi(t,"Array",ie,"defaultRowSeparatorDashArray:value"),null!==t){const s=t.length;let n=0;for(let i=0;i<s;i++){const s=t[i];("number"!=typeof s||!(s>=0)||!isFinite(s))&&e.o("defaultRowSeparatorDashArray value "+s+" at index "+i+" must be a positive number or zero."),n+=s}if(0===n){if(null===i)return;t=null}}null===this.F&&(this.F=new oe),this.F.Z0=t,this.S(),this.t("defaultRowSeparatorDashArray",i,t)}}get defaultColumnSeparatorStroke(){return null!==this.F?this.F.Q0:null}set defaultColumnSeparatorStroke(t){const e=this.defaultColumnSeparatorStroke;e!==t&&(null===t||"string"==typeof t||t instanceof jt)&&(t instanceof jt&&t.u(),null===this.F&&(this.F=new oe),this.F.Q0=t,this.S(),this.t("defaultColumnSeparatorStroke",e,t))}get defaultColumnSeparatorStrokeWidth(){return null!==this.F?this.F._0:1}set defaultColumnSeparatorStrokeWidth(t){const e=this.defaultColumnSeparatorStrokeWidth;e!==t&&isFinite(t)&&t>=0&&(null===this.F&&(this.F=new oe),this.F._0=t,this.c(),this.t("defaultColumnSeparatorStrokeWidth",e,t))}get defaultColumnSeparatorDashArray(){return null!==this.F?this.F.tp:null}set defaultColumnSeparatorDashArray(t){const i=this.defaultColumnSeparatorDashArray;if(i!==t){if(null!==t&&!Array.isArray(t)&&e.Zi(t,"Array",ie,"defaultColumnSeparatorDashArray:value"),null!==t){const s=t.length;let n=0;for(let i=0;i<s;i++){const s=t[i];("number"!=typeof s||!(s>=0)||!isFinite(s))&&e.o("defaultColumnSeparatorDashArray value "+s+" at index "+i+" must be a positive number or zero."),n+=s}if(0===n){if(null===i)return;t=null}}null===this.F&&(this.F=new oe),this.F.tp=t,this.S(),this.t("defaultColumnSeparatorDashArray",i,t)}}get ph(){return null!==this.F?this.F.ph:null}set ph(t){null===this.F&&(this.F=new oe),this.F.ph=t}get viewboxStretch(){return this.od}set viewboxStretch(t){const e=this.od;e!==t&&(this.od=t,this.c(),this.t("viewboxStretch",e,t))}get gridCellSize(){return null!==this.yi?this.yi.ld:v.wC}set gridCellSize(t){null===this.yi&&(this.yi=new ne);const i=this.yi.ld;if(!i.equals(t)){(!t.isReal()||0===t.width||0===t.height)&&e.o("Invalid Panel.gridCellSize: "+t),this.yi.ld=t.P();const s=this.diagram;null!==s&&this===s.grid&&s._l(),this.S(),this.t("gridCellSize",i,t)}}get gridOrigin(){return null!==this.yi?this.yi.hd:y.wo}set gridOrigin(t){null===this.yi&&(this.yi=new ne);const i=this.yi.hd;if(!i.equals(t)){t.isReal()||e.o("Invalid Panel.gridOrigin: "+t),this.yi.hd=t.P();const s=this.diagram;null!==s&&this===s.grid&&s._l(),this.S(),this.t("gridOrigin",i,t)}}get graduatedMin(){return null!==this.st?this.st.ip:0}set graduatedMin(t){const e=this.graduatedMin;if(e!==t&&(null===this.st&&(this.st=new se),this.st.ip=t,this.c(),this.t("graduatedMin",e,t),this.Wc())){const t=this.part;null!==t&&this.ba(t,"graduatedRange")}}get graduatedMax(){return null!==this.st?this.st.ep:100}set graduatedMax(t){const e=this.graduatedMax;if(e!==t&&(null===this.st&&(this.st=new se),this.st.ep=t,this.c(),this.t("graduatedMax",e,t),this.Wc())){const t=this.part;null!==t&&this.ba(t,"graduatedRange")}}get graduatedRange(){return this.graduatedMax-this.graduatedMin}get graduatedTickUnit(){return null!==this.st?this.st.sp:10}set graduatedTickUnit(t){const e=this.graduatedTickUnit;e!==t&&t>0&&(null===this.st&&(this.st=new se),this.st.sp=t,this.c(),this.t("graduatedTickUnit",e,t))}get graduatedTickBase(){return null!==this.st?this.st.np:0}set graduatedTickBase(t){const e=this.graduatedTickBase;e!==t&&(null===this.st&&(this.st=new se),this.st.np=t,this.c(),this.t("graduatedTickBase",e,t))}get xs(){return null!==this.st?this.st.xs:null}set xs(t){null!==this.st?this.st.xs=t:null!==t&&(this.st=new se,this.st.xs=t)}get Ke(){return null!==this.st?this.st.Ke:null}set Ke(t){null!==this.st?this.st.Ke=t:null!==t&&(this.st=new se,this.st.Ke=t)}get ss(){return null!==this.st?this.st.ss:null}set ss(t){null!==this.st?this.st.ss=t:null!==t&&(this.st=new se,this.st.ss=t)}get Pe(){return null!==this.st?this.st.Pe:null}set Pe(t){null!==this.st?this.st.Pe=t:null!==t&&(this.st=new se,this.st.Pe=t)}w0(t){super.w0(t);const e=this.C.r,i=e.length;for(let s=0;s<i;s++)e[s].w0(t)}dh(t,e){if(this.j===ie.Grid)return t.commitTransform(),void this.j.Bi(this,t,e);if(this.j===ie.Graduated)return t.commitTransform(),void this.j.Bi(this,t,e);if(this.j===ie.Table)if(t.commitTransform(),t instanceof Et){const i=t.currentElement;t.currentElement=t.newGroup2("gojs-ts"),this.z2(t,e),t.endGroup(),t.currentElement=i}else this.z2(t,e);const i=this.isClipping&&this.j===ie.Spot;i&&t.save();const s=this.findMainElement(),n=this.C.r,o=n.length;for(let r=0;r<o;r++){const o=n[r];i&&o===s&&(t.clipInsteadOfFill=!0),o.Bi(t,e),i&&o===s&&(t.clipInsteadOfFill=!1)}i&&(t.restore(),t.clearContextCache(!0))}z2(t,e){t.lineCap="butt";const i=this.rowCount>0?this.Xe:null,s=this.columnCount>0?this.Ye:null;null!==i&&this._b(t,e,!0,i,!0),null!==s&&this._b(t,e,!1,s,!0),null!==i&&this.BA(t,!0,i),null!==s&&this.BA(t,!1,s),null!==i&&this._b(t,e,!0,i,!1),null!==s&&this._b(t,e,!1,s,!1)}BA(t,e,i){const s=i.length,n=this.actualBounds,o=this.naturalBounds;let r=!0;for(let a=0;a<s;a++){const s=i[a];if(void 0===s||0===s.actual)continue;if(r){r=!1;continue}if(e){if(s.position>o.height)continue}else if(s.position>o.width)continue;let h=s.separatorStrokeWidth;isNaN(h)&&(h=e?this.defaultRowSeparatorStrokeWidth:this.defaultColumnSeparatorStrokeWidth);let l=s.separatorStroke;if(null===l&&(l=e?this.defaultRowSeparatorStroke:this.defaultColumnSeparatorStroke),0===h||null===l)continue;this.rn(t,l,!1,!1,o,n);let u=!1,c=s.separatorDashArray;null===c&&(c=e?this.defaultRowSeparatorDashArray:this.defaultColumnSeparatorDashArray),null!==c&&(u=!0,t.enableDash(c,0)),t.beginPath();const d=s.position+h;e?d>o.height&&(h-=d-o.height):d>o.width&&(h-=d-o.width);let f=s.position+h/2;t.lineWidth=h;const g=this.Zt;if(e){f+=g.top;const e=g.left,i=o.width-g.right;t.moveTo(e,f),t.lineTo(i,f)}else{f+=g.left;const e=g.top,i=o.height-g.bottom;t.moveTo(f,e),t.lineTo(f,i)}t.stroke(),t.endPath(),u&&t.disableDash()}}_b(t,e,i,s,n){const o=s.length,r=this.actualBounds,a=this.naturalBounds,h=this.UA(!0),l=this.UA(!1);for(let u=0;u<o;u++){const e=s[u];if(void 0===e||null===e.background||e.coversSeparators===n||0===e.actual)continue;const o=i?r.height:r.width;if(e.position>o)continue;let c=e.computeEffectiveSpacing(),d=e.separatorStrokeWidth;isNaN(d)&&(d=i?this.defaultRowSeparatorStrokeWidth:this.defaultColumnSeparatorStrokeWidth);let f=e.separatorStroke;null===f&&(f=i?this.defaultRowSeparatorStroke:this.defaultColumnSeparatorStroke),(null===f||e.index===(i?h:l))&&(d=0),c-=d;const g=e.position+d;let p=c+e.actual;if(g+p>o&&(p=o-g),p<=0)continue;const m=this.Zt;this.rn(t,e.background,!0,!1,a,r),i?t.fillRect(m.left,g+m.top,r.width-(m.left+m.right),p):t.fillRect(g+m.left,m.top,p,r.height-(m.top+m.bottom))}}UA(t){const e=t?this.rowCount:this.columnCount;for(let i=0;i<e;i++){const e=t?this.Xe[i]:this.Ye[i];if(void 0!==e)return e.index}return 0}Qc(){const t=this.C.r,e=t.length;for(let i=0;i<e;i++)t[i].Qc();this.Ve(!0)}Zc(t,e,i){const s=this.svg;if(null===s)return!1;if(this.type===ie.Table){const i=s.getElementsByClassName("gojs-ts"),n=0!==i.length?i[0]:null;null!==n&&(n.innerHTML=""),t.currentElement=n,this.z2(t,e),t.currentElement=null}else{if(this.j===ie.Grid)return s.innerHTML="",s.remove(),!1;if(this.j===ie.Graduated)return s.innerHTML="",s.remove(),!1;if(this.j===ie.Spot&&this.isClipping)return s.innerHTML="",s.remove(),this.hh=null,this.Qc(),!1}if(!super.Zc(t,e,i))return!1;const n=this.C.r,o=n.length;for(let r=0;r<o;r++)n[r].Bi(t,e);return!0}$u(t){return!0}b0(t,e,i,s){if(!this.isClipping){if(this.Xs()&&null!==t.partClipRect){const e=t.partClipRect,n=this.C.r;let o=0,r=0;for(let t=0;t<n.length;t++){if(!n[t].isVisibleObject())continue;const e=n[t].actualBounds;o=0===t?e.x:Math.min(e.x,o),r=0===t?e.y:Math.min(e.y,r)}return void s.setAttributeNS(null,"clip-path",`path('M ${e.x-i.x-o},${e.y-i.y-r} l ${e.width} 0 l 0 ${e.height} l -${e.width} 0 z')`)}super.b0(t,e,i,s)}}Jc(t,e,i,s,n){const o=this.an(),r=this.T,a=1/(r.m11*r.m22-r.m12*r.m21);let h=r.m22*a,l=-r.m12*a,u=-r.m21*a,c=r.m11*a,d=a*(r.m21*r.dy-r.m22*r.dx),f=a*(r.m12*r.dx-r.m11*r.dy);if(null!==this.background){const o=t*h+e*u+d,a=t*l+e*c+f,g=i*h+s*u+d,p=i*l+s*c+f;n.i(0,0);const m=this.naturalBounds,y=S.dl(0,0,m.width,m.height,o,a,g,p,n);return n.T(r),y}{o||(h=1,l=0,u=0,c=1,d=0,f=0);const a=t*h+e*u+d,g=t*l+e*c+f,p=i*h+s*u+d,m=i*l+s*c+f;n.i(p,m);let v=(p-a)**2+(m-g)**2,x=!1;const b=this.C.r,w=b.length,k=y.l();let S=null,P=1/0,M=null;const C=this.isClipping&&this.j===ie.Spot;C&&(M=y.l(),S=this.findMainElement(),x=S.Jc(a,g,p,m,M),x&&(P=(a-M.x)**2+(g-M.y)**2));for(let t=0;t<w;t++){const e=b[t];if(!e.visible||e===S||!e.Jc(a,g,p,m,k))continue;x=!0;const i=(a-k.x)**2+(g-k.y)**2;i<v&&(v=i,n.set(k))}return C&&(P>v&&n.set(M),y.e(M)),y.e(k),o&&n.T(r),x}}Au(){const t=this.C.r,e=t.length;for(let i=0;i<e;i++)t[i].Au();super.Au()}c(t){if(this.Ao())return;super.c(t);let e=null;(this.j===ie.Auto||this.j===ie.Link)&&(e=this.findMainElement());const i=this.C.r,s=i.length;for(let n=0;n<s;n++){const t=i[n];if((t===e||t.isPanelMain)&&t.c(!0),t.desiredSize.isReal())continue;const s=t.zs(!1);!(t instanceof Ve)&&!(t instanceof ie)&&!(t instanceof fe)&&0===s||t.c(!0)}}tf(){if(this.Ao())return;this.ue(!0),this.Jn(!0);const t=this.C.r,e=t.length;for(let i=0;i<e;i++)t[i].tf()}$c(){if(!1===this.Kb()){this.Zu(!0),this.ka(!0);const t=this.C.r,e=t.length;for(let i=0;i<e;i++)t[i].k2()}}k2(){this.ka(!0);const t=this.C.r,e=t.length;for(let i=0;i<e;i++)t[i].k2()}Wu(t,e,i,s){const n=this.Bo;n.i(0,0,0,0);const o=this.desiredSize,r=this.minSize;void 0===i&&(i=r.width,s=r.height),i=Math.max(i,r.width),s=Math.max(s,r.height);const a=this.maxSize;isNaN(o.width)||(t=Math.min(o.width,a.width)),isNaN(o.height)||(e=Math.min(o.height,a.height)),t=Math.max(i,t),e=Math.max(s,e);const h=this.Zt;t=Math.max(t-h.left-h.right,0),e=Math.max(e-h.top-h.bottom,0);const l=this.C.r;this.j.measure(this,t,e,l,n,i,s);let u=n.width+h.left+h.right,c=n.height+h.top+h.bottom;isFinite(o.width)&&(u=o.width),isFinite(o.height)&&(c=o.height),u=Math.min(a.width,u),c=Math.min(a.height,c),u=Math.max(r.width,u),c=Math.max(r.height,c),u=Math.max(i,u),c=Math.max(s,c),n.Fn(u,c),this.naturalBounds.Fn(u,c),this.Wn(0,0,u,c)}findMainElement(){if(null===this.Zr){const t=this.C.r,e=t.length;if(0===e)return null;for(let i=0;i<e;i++){const e=t[i];if(!0===e.isPanelMain)return this.Zr=e,e}this.Zr=t[0]}return this.Zr}Eo(){return null!==this.part?this.part.locationObject:null}get panelLayoutState(){return this.V2}set panelLayoutState(t){this.V2=t}fh(t,e,i,s){const n=this.C.r;if(this.actualBounds.i(t,e,i,s),!this.desiredSize.isReal()){let t=this.zs(!0);const e=this.measuredBounds,n=e.width,o=e.height,r=this.jr,a=r.left+r.right,h=r.top+r.bottom;switch(n===i&&o===s&&(t=0),t){case 0:(n>i||o>s)&&(this.c(),this.ht(n>i?i:n,o>s?s:o,0,0));break;case 2:this.c(!0),this.ht(i+a,s+h,0,0);break;case 5:this.c(!0),this.ht(i+a,o+h,0,0);break;case 4:this.c(!0),this.ht(n+a,s+h,0,0);break}}this.j.arrange(this,n,this.Bo)}ch(t){const e=this.naturalBounds,i=this.Eo();if(x.contains(0,0,e.width,e.height,t.x,t.y)){const e=this.C.r,s=e.length,n=y.V(0,0);for(let o=s;o--;){const s=e[o];if((s.visible||s===i)&&(n.set(t).Oe(s.T),s.containsPoint(n)))return y.e(n),!0}return y.e(n),null!==this.Lt}return!1}d0(t){if(this.jn===t)return this;const e=this.C.r,i=e.length;for(let s=0;s<i;s++){const i=e[s].d0(t);if(null!==i)return i}return null}walkVisualTreeFrom(t,e){if(e(this,t),t instanceof ie){const i=t.C.r,s=i.length;for(let t=0;t<s;t++)this.walkVisualTreeFrom(i[t],e)}}Yr(t){this.VA(this,t)}VA(t,e){e(t);const i=t.C.r,s=i.length;for(let n=0;n<s;n++){const t=i[n];t instanceof ie&&this.VA(t,e)}}Tv(t){this.zA(this,t)}zA(t,e){if(e(t),t instanceof ie){const i=t.C.r,s=i.length;for(let t=0;t<s;t++)this.zA(i[t],e)}}findInVisualTree(t){return this.XA(this,t)}XA(t,e){if(e(t))return t;if(t instanceof ie){const i=t.C.r,s=i.length;for(let t=0;t<s;t++){const s=this.XA(i[t],e);if(null!==s)return s}}return null}findObject(t){if(this.name===t)return this;const e=this.C.r;let i=e.length;this.Dv()&&(i=this.op());for(let s=0;s<i;s++){const i=e[s];if(i instanceof ie){const e=i.findObject(t);if(null!==e)return e}if(i.name===t)return i}return null}YA(){const t=this.C.r,e=t.length;let i=0;for(let s=0;s<e;s++){const e=t[s];e instanceof ie?i=Math.max(i,e.YA()):e instanceof he&&(i=Math.max(i,e.Fv()))}return i}an(){return!(this.type===ie.TableRow||this.type===ie.TableColumn)}Wr(){return this.type===ie.TableRow||this.type===ie.TableColumn}bL(t,e,i){if(!1===this.pickable||(void 0===e&&(e=null),void 0===i&&(i=null),this._e()))return null;const s=this.naturalBounds,n=1/this.getDocumentScale(),o=this.an(),r=o?t:y.V(t.x,t.y).Oe(this.T),a=this.diagram;let h=10,l=5;if(null!==a&&(h=a.getInputOption("extraTouchArea"),l=h/2),x.contains(-l*n,-l*n,s.width+h*n,s.height+h*n,r.x,r.y)){if(!this.af){const s=this.C.r,n=s.length,a=y.l(),h=this.isClipping&&this.j===ie.Spot,l=h?this.findMainElement():null;if(h&&(l.an()?a.set(t).Oe(l.T):a.set(t),!l.containsPoint(a)))return y.e(a),o||y.e(r),null;const u=this.Eo();for(let c=n;c--;){const n=s[c];if(!n.visible&&n!==u||(n.an()?a.set(t).Oe(n.T):a.set(t),h&&n===l))continue;let d=null;if(n instanceof ie?d=n.bL(a,e,i):!0===n.pickable&&n.containsPoint(a)&&(d=n),null!==d&&(null!==e&&(d=e(d)),null!==d&&(null===i||i(d))))return y.e(a),o||y.e(r),d}y.e(a)}if(null===this.background)return o||y.e(r),null;const n=x.contains(0,0,s.width,s.height,r.x,r.y)?this:null;return o||y.e(r),n}return o||y.e(r),null}kL(t,e,i,s){if(!1===this.pickable)return!1;void 0===e&&(e=null),void 0===i&&(i=null);const n=this.naturalBounds,o=this.an(),r=o?t:y.V(t.x,t.y).Oe(this.T),a=this.Wr(),h=x.contains(0,0,n.width,n.height,r.x,r.y);if(a||h){if(!this.af){const n=this.C.r,o=n.length,r=y.l(),a=this.Eo();for(let h=o;h--;){const o=n[h];if(!o.visible&&o!==a)continue;o.an()?r.set(t).Oe(o.T):r.set(t);let l=o;const u=o instanceof ie?o:null;if(null!==u?u.kL(r,e,i,s):l.containsPoint(r)){if(!1===l.pickable)continue;null!==e&&(l=e(l)),null!==l&&(null===i||i(l))&&s.add(l)}}y.e(r)}return o||y.e(r),h&&null!==this.background}return o||y.e(r),!1}Tm(t,e,i,s,n,o){if(!1===this.pickable)return!1;void 0===e&&(e=null),void 0===i&&(i=null);let r=o;if(void 0===r&&(r=k.l(),r.Ri()),r.nc(this.T),this.containedInRect(t,r))return this.X2(e,i,n),void 0===o&&k.e(r),!0;if(this.intersectsRect(t,r)){if(!this.af){const o=this.Eo(),a=this.C.r,h=a.length;for(let l=h;l--;){const h=a[l];if(!h.visible&&h!==o)continue;const u=h.actualBounds,c=this.naturalBounds;if(u.x>c.width||u.y>c.height||u.x+u.width<0||u.y+u.height<0)continue;let d=h;const f=h instanceof ie?h:null,g=k.l();g.set(r),(null!==f?f.Tm(t,e,i,s,n,g):d.wA(t,s,g))&&(null!==e&&(d=e(d)),null!==d&&(null===i||i(d))&&n.add(d)),k.e(g)}}return void 0===o&&k.e(r),s}return void 0===o&&k.e(r),!1}X2(t,e,i){const s=this.C.r,n=s.length;for(let o=n;o--;){const n=s[o];if(!n.visible)continue;const r=n.actualBounds,a=this.naturalBounds;if(r.x>a.width||r.y>a.height||r.x+r.width<0||r.y+r.height<0)continue;n instanceof ie&&n.X2(t,e,i);let h=n;null!==t&&(h=t(h)),null!==h&&(null===e||e(h))&&i.add(h)}}PL(t,e,i,s,n,o){if(!1===this.pickable)return!1;void 0===i&&(i=null),void 0===s&&(s=null);const r=this.naturalBounds,a=this.an(),h=a?t:y.V(t.x,t.y).Oe(this.T),l=a?e:y.V(e.x,e.y).Oe(this.T),u=h.distanceSquaredPoint(l),c=h.x>0&&h.x<r.width&&h.y>0&&h.y<r.height||y.distanceLineSegmentSquared(h.x,h.y,0,0,0,r.height)<=u||y.distanceLineSegmentSquared(h.x,h.y,0,r.height,r.width,r.height)<=u||y.distanceLineSegmentSquared(h.x,h.y,r.width,r.height,r.width,0)<=u||y.distanceLineSegmentSquared(h.x,h.y,r.width,0,0,0)<=u,d=h.distanceSquared(0,0)<=u&&h.distanceSquared(0,r.height)<=u&&h.distanceSquared(r.width,0)<=u&&h.distanceSquared(r.width,r.height)<=u;if(a||(y.e(h),y.e(l)),c){if(!this.af){const r=y.l(),h=y.l(),l=this.Eo(),u=this.C.r,c=u.length;for(let d=c;d--;){const c=u[d];if(!c.visible&&c!==l)continue;const f=c.actualBounds,g=this.naturalBounds;if(a&&(f.x>g.width||f.y>g.height||f.x+f.width<0||f.y+f.height<0))continue;if(c.an()){const i=c.T;r.set(t).Oe(i),h.set(e).Oe(i)}else r.set(t),h.set(e);let p=c;const m=c instanceof ie?c:null;(null!==m?m.PL(r,h,i,s,n,o):p.xA(r,h,n))&&(null!==i&&(p=i(p)),null!==p&&(null===s||s(p))&&o.add(p))}y.e(r),y.e(h)}return n?c:d}return!1}I2(t){let e=null;if(t instanceof he){e=t.spot1,e===w.Default&&(e=null);const i=t.geometry;null!==i&&null===e&&(e=i.spot1)}return null===e&&(e=w.TopLeft),e}E2(t){let e=null;if(t instanceof he){e=t.spot2,e===w.Default&&(e=null);const i=t.geometry;null!==i&&null===e&&(e=i.spot2)}return null===e&&(e=w.BottomRight),e}add(...t){for(let e=0;e<t.length;e++)this.insertAt(this.C.count,t[e]);return this}elt(t){return this.C.elt(t)}insertAt(t,i){i instanceof ke&&e.o("Cannot add a Part to a Panel: "+i+"; use a Panel instead"),(this===i||this.isContainedBy(i))&&(this===i&&e.o("Cannot make a Panel contain itself: "+this.toString()),e.o("Cannot make a Panel indirectly contain itself: "+this.toString()+" already contains "+i.toString()));const s=i.panel;if(null!==s&&s!==this&&e.o("Cannot add a GraphObject that already belongs to another Panel to this Panel: "+i.toString()+", already contained by "+s.toString()+", cannot be shared by this Panel: "+this.toString()),this.j===ie.Grid&&!(i instanceof he)&&e.o("Can only add Shapes to a Grid Panel, not: "+i),this.j===ie.Graduated&&!(i instanceof he||i instanceof fe)&&e.o("Can only add Shapes or TextBlocks to a Graduated Panel, not: "+i),i.Pa(this),i.qr=null,null!==this.itemArray){const t=i.data;e.K(t)&&(null===this.Ks&&(this.Ks=new m),this.Ks.set(t,i))}const n=this.C;let o=-1;if(s===this){let r=-1;const a=this.C.r,h=a.length;for(let t=0;t<h;t++)if(a[t]===i){r=t;break}if(-1!==r){if(r===t||r+1>=n.count&&t>=n.count)return;n.removeAt(r),o=r}else e.o("element "+i.toString()+" has panel "+s.toString()+" but is not contained by it.")}(t<0||t>n.count)&&(t=n.count),n.insertAt(t,i),(0===t||i.isPanelMain)&&(this.Zr=null),this.Ao()||this.c(),i.c(!1),(null!==i.portId||i instanceof ie&&!0===i.fn)&&(this.fn=!0),this.ss=null,this.isEnabledObject()||this.t1(i,!1);const r=this.part;if(null!==r){r.L0(),r.cf(),this.fn&&r instanceof Ce&&(r.fn=!0),r.fn&&r instanceof Ce&&(r.ne=null);const e=this.diagram;if(null!==e&&e.undoManager.isUndoingRedoing)return;-1!==o&&r.raiseChangedEvent(4,"elements",this,i,null,o,null),r.raiseChangedEvent(3,"elements",this,null,i,null,t)}}get fn(){return 0!==(8388608&this.n)}set fn(t){0!==(8388608&this.n)!==t&&(this.n=8388608^this.n)}m2(){return 0!==(16777216&this.n)}Y2(t){t?this.n|=16777216:this.n&=-16777217}Av(t){t.Pa(this),t.qr=null;const e=this.C,i=e.count;e.insertAt(i,t);const s=this.part;if(null!==s){s.L0(),null!==t.portId&&s instanceof Ce&&(s.fn=!0);const e=this.diagram;if(null!==e&&e.undoManager.isUndoingRedoing)return;s.raiseChangedEvent(3,"elements",this,null,t,null,i)}}$R(t){const e=this.C.r,i=e.length;let s=-1;for(let n=0;n<i;n++)if(e[n]===t){s=n;break}return s}remove(t){const e=this.C.r,i=e.length;let s=-1;for(let n=0;n<i;n++)if(e[n]===t){s=n;break}-1!==s&&this.te(s,!0)}removeAt(t){t>=0&&this.te(t,!0)}te(t,i){const s=this.C,n=s.elt(t);if(n.qr=null,n.Pa(null),null!==this.Ks){const t=n.data;e.K(t)&&this.Ks.delete(t)}s.removeAt(t),this.ue(!1),this.c(),this.Zr===n&&(this.Zr=null),this.ss=null;const o=this.part;if(null!==o){o.L0(),o.cf(),o.invalidateAdornments(),o instanceof Ce&&(n instanceof ie?n.walkVisualTreeFrom(n,((t,e)=>o.N2(e,i))):o.N2(n,i));const e=this.diagram;if(null!==e&&e.undoManager.isUndoingRedoing)return;o.raiseChangedEvent(4,"elements",this,n,null,t,null)}}get Xe(){return null===this.F&&(this.F=new oe),this.F.Xe}get rowCount(){return null===this.F?0:this.Xe.length}getRowDefinition(t){t<0&&e.W(t,">= 0",ie,"getRowDefinition:idx"),t=Math.round(t);const i=this.Xe;if(void 0===i[t]){const e=new ae;e.Pa(this),e.isRow=!0,e.index=t,i[t]=e,this.raiseChangedEvent(3,"rowdefs",this,null,e,null,t)}return i[t]}removeRowDefinition(t){if(t<0&&e.W(t,">= 0",ie,"removeRowDefinition:idx"),0===this.rowCount)return;t=Math.round(t);const i=this.Xe,s=i[t];if(s){i[t]=void 0;let e=i.length-1;for(;e>=0&&void 0===i[e--];)i.length--;this.raiseChangedEvent(4,"rowdefs",this,s,null,t,null),this.c()}}$L(t,e){const i=this.Xe;if(!(t<0)){if(i[t]=e instanceof ae?e:void 0,!e){let t=i.length-1;for(;t>=0&&void 0===i[t--];)i.length--}this.c()}}get Ye(){return null===this.F&&(this.F=new oe),this.F.Ye}get columnCount(){return null===this.F?0:this.Ye.length}getColumnDefinition(t){t<0&&e.W(t,">= 0",ie,"getColumnDefinition:idx"),t=Math.round(t);const i=this.Ye;if(void 0===i[t]){const e=new ae;e.Pa(this),e.isRow=!1,e.index=t,i[t]=e,this.raiseChangedEvent(3,"coldefs",this,null,e,null,t)}return i[t]}removeColumnDefinition(t){if(t<0&&e.W(t,">= 0",ie,"removeColumnDefinition:idx"),0===this.columnCount)return;t=Math.round(t);const i=this.Ye,s=i[t];if(s){i[t]=void 0;let e=i.length-1;for(;e>=0&&void 0===i[e--];)i.length--;this.raiseChangedEvent(4,"coldefs",this,s,null,t,null),this.c()}}ZL(t,e){const i=this.Ye;if(!(t<0)){if(i[t]=e instanceof ae?e:void 0,!e){let t=i.length-1;for(;t>=0&&void 0===i[t--];)i.length--}this.c()}}addRowColumnDefinition(t){let e=null;return t.isRow?e=this.getRowDefinition(t.index):t.isRow||(e=this.getColumnDefinition(t.index)),e&&e.Hb(t),this}addRowDefinition(t,e){const i=this.getRowDefinition(t);return i&&i.Hb(new ae(e)),this}addColumnDefinition(t,e){const i=this.getColumnDefinition(t);return i&&i.Hb(new ae(e)),this}get rowSizing(){return null!==this.F?this.F.rp:3}set rowSizing(t){const e=this.rowSizing;e!==t&&(null===this.F&&(this.F=new oe),this.F.rp=t,this.c(),this.t("rowSizing",e,t))}get columnSizing(){return null!==this.F?this.F.lp:3}set columnSizing(t){const e=this.columnSizing;e!==t&&(null===this.F&&(this.F=new oe),this.F.lp=t,this.c(),this.t("columnSizing",e,t))}get topIndex(){return null!==this.F?this.F.hp:0}set topIndex(t){const i=this.topIndex;i!==t&&((!isFinite(t)||t<0)&&e.o("Panel.topIndex must be greater than zero and a real number, not: "+t),null===this.F&&(this.F=new oe),this.F.hp=t,this.c(),this.t("topIndex",i,t))}get leftIndex(){return null!==this.F?this.F.ap:0}set leftIndex(t){const i=this.leftIndex;i!==t&&((!isFinite(t)||t<0)&&e.o("Panel.leftIndex must be greater than zero and a real number, not: "+t),null===this.F&&(this.F=new oe),this.F.ap=t,this.c(),this.t("leftIndex",i,t))}findRowForLocalY(t){if(t<0||this.type!==ie.Table||0===this.rowCount)return-1;let e=0;const i=this.Xe,s=i.length;let n=this.topIndex;for(;n<s;n++){const s=i[n];if(void 0!==s&&(e+=s.total,t<e))return n}return n}findColumnForLocalX(t){if(t<0||this.type!==ie.Table||0===this.columnCount)return-1;let e=0;const i=this.Ye,s=i.length;let n=this.leftIndex;for(;n<s;n++){const s=i[n];if(void 0!==s&&(e+=s.total,t<e))return n}return n}graduatedPointForValue(t,e){if(void 0===e&&(e=new y(NaN,NaN)),this.type!==ie.Graduated)return e.i(NaN,NaN),e;t=Math.min(Math.max(t,this.graduatedMin),this.graduatedMax);const i=this.findMainElement();return i.geometry.getPointAlongPath((t-this.graduatedMin)/this.graduatedRange,e),i.T.gt(e)}graduatedValueForPoint(t){if(this.type!==ie.Graduated)return NaN;const e=this.findMainElement();return e.T.$e(t),e.geometry.getFractionForPoint(t)*this.graduatedRange+this.graduatedMin}get data(){return this._t}set data(t){const i=this._t;if(i!==t){const s=this instanceof ke&&!(this instanceof Pe);s&&e.s(t,"object",ie,"data"),this.Et(),this._t=t;const n=this.diagram;if(null!==n)if(s)n.partManager.Rv(this,i,t);else{const e=this.panel;null!==e&&null!==e.Ks&&(null!==i&&e.Ks.delete(i),null!==t&&e.Ks.set(t,this))}if(this.t("data",i,t),null!==n&&n.undoManager.isUndoingRedoing)return;null!==t&&this.updateTargetBindings()}}get itemIndex(){return this.rd}set itemIndex(t){const e=this.rd;e!==t&&(this.rd=t,this.t("itemIndex",e,t))}get Ys(){return null!==this.p?this.p.Ys:null}set Ys(t){this.Ci!==t&&(null===this.p&&(this.p=new Dt),this.p.Ys=t)}C2(){return null!==this.Ys}AA(){const t=this.Ys;return null!==t&&t.h}freezeBindings(){return this.Et()}Et(){let t=this.Ys;if(null===t)null!==this.data&&e.o("Template cannot have .data be non-null: "+this),this.Ys=t=new h;else if(t.h)return this;const i=new h;this.Y2(!1),this.walkVisualTreeFrom(this,((e,s)=>{s.ah();const n=s.Ci;if(null!==n){s.P2(!1);const o=n.iterator;for(;o.next();){const n=o.value;2===n.mode&&s.P2(!0);const r=n.sourceName;if(n.isToObject){"/"===r&&e.Y2(!0);const t=n.yA(e,s);null!==t&&(i.add(t),null===t.qn&&(t.qn=new h),t.qn.add(n))}t.add(n)}}if(s instanceof ie&&s.type===ie.Table){if(s.rowCount>0){const e=s.Xe,i=e.length;for(let s=0;s<i;s++){const i=e[s];if(void 0!==i&&null!==i.bs){const e=i.bs.iterator;for(;e.next();){const s=e.value;s.be=i,s.ad=2,s.ff=i.index,t.add(s)}}}}if(s.columnCount>0){const e=s.Ye,i=e.length;for(let s=0;s<i;s++){const i=e[s];if(void 0!==i&&null!==i.bs){const e=i.bs.iterator;for(;e.next();){const s=e.value;s.be=i,s.ad=1,s.ff=i.index,t.add(s)}}}}}}));const s=i.iterator;for(;s.next();){const t=s.value;if(null!==t.qn){t.P2(!0);const e=t.qn.iterator;for(;e.next();){const i=e.value;null===t.Ci&&(t.Ci=new h),t.Ci.add(i)}}t.qn=null}let n=t.iterator;for(;n.next();){const t=n.value;let i=t.be;if(null!==i){t.be=null;const s=t.targetProperty,n=s.indexOf(".");if(n>0&&i instanceof ie){const o=s.substring(0,n),r=s.substring(n+1),a=i.findObject(o);null!==a?(i=a,t.targetProperty=r):(e.ni('Warning: unable to find GraphObject named "'+o+'" for Binding: '+t.toString()),i=null)}if(i instanceof ae){const e=u.as(i.panel);t.targetId=void 0===e?-1:e,i.panel.jn=t.targetId}else if(i instanceof Tt){const e=u.as(i);t.targetId=void 0===e?-1:e,i.jn=t.targetId}else e.o("Unknown type of binding target: "+i);t.check(i)}}return t.u(),this instanceof ke&&this.ke()&&this.ensureBounds(),this}static DE=!1;copyTemplate(t){void 0===t&&(t=!1);const e=this.copy();return e.Tv((t=>{t instanceof ie&&(t.Ys=null,t._t=null);const e=t.Ci;null!==e&&(t.Ci=null,e.each((e=>t.bind(e.copy()))));const i=t.ws;null!==i&&(t.ws=null,i.each((e=>t.trigger(e.value.copy()))))})),t&&e.Et(),e}updateTargetBindings(t){const e=this.Ys;if(null===e)return;void 0===t&&(t="");const i=this.diagram?.model,s=e.iterator;for(;s.next();){const e=s.value,n=this.KA(e,t);if(null===n)continue;const{data:o,elt:r}=n;e.isToTheme&&null===this.diagram||void 0!==r&&e.updateTarget(r,o,void 0,i)}}To(){if(null!==this.diagram)if(this.C2()){const t=this.diagram.model,e=this.Ys.iterator;for(;e.next();){const i=e.value;if(!i.isToTheme)continue;const s=this.KA(i);if(null===s)continue;const{data:n,elt:o}=s;void 0!==o&&i.updateTarget(o,n,void 0,t)}}else{const t=this.C.r,e=t.length;for(let i=0;i<e;i++)t[i].To()}}KA(t,e=""){const i=t.sourceProperty;if(""!==e&&""!==i&&i!==e)return null;const s=t.targetProperty;if(null===t.converter&&""===s)return null;let n=this.data;const o=t.sourceName;if(t.isToObject){if(n=this.pA(o),null===n)return null}else if(t.isToModel){const t=this.diagram;if(null===t)return null;n=t.model.modelData}let r=this;const a=t.targetId;if(-1!==a){if(r=this.d0(a),null===r)return null}else null!==t.be&&(r=t.be);"/"===o?n=r.part:"."===o?n=r:".."===o&&(n=r.panel);const h=t.ad;if(0!==h){if(!(r instanceof ie))return null;1===h?r=r.getColumnDefinition(t.ff):2===h&&(r=r.getRowDefinition(t.ff))}return{data:n,elt:r}}get itemArray(){return this.yh}set itemArray(t){const e=this.yh;if(e!==t||null!==t&&this.vv(t)){const i=this.diagram;if(e!==t&&(null!==i&&null!==e&&i.partManager.IM(this,i),this.yh=t,null!==i&&null!==t&&i.partManager.OM(this,i)),this.t("itemArray",e,t),null!==i&&i.undoManager.isUndoingRedoing)return;this.GA(e,t)}}findItemPanelForData(t){return null==t||null===this.Ks?null:(e.ec(t,ie,"findItemPanelForData"),this.Ks.get(t))}vv(t){const e=this.C.r,i=e.length,s=t.length;let n=0,o=null;for(;n<i&&(o=e[n],!(o instanceof ie)||null===o.data);)n++,o=e[n];if(i-n!==s)return!0;if(null===o)return s>0;let r=0;for(;n<i&&r<s;){if(o=e[n],!(o instanceof ie)||o.data!==t[r])return!0;n++,r++}return!1}op(){if(this.type===ie.Spot||this.type===ie.Auto)return Math.min(this.C.length,1);if(this.type===ie.Link){const t=this.C,e=t.length;let i=0;for(;i<e;i++){const e=t.elt(i);if(!(e instanceof he)||!e.isPanelMain)return i}return i}if(this.type===ie.Table&&this.C.length>0){const t=this.C.elt(0);if(t.isPanelMain&&t instanceof ie&&t.Wr())return 1}return 0}rebuildItemElements(){const t=this.op();for(;this.C.length>t;)this.te(this.C.length-1,!1);this.GA(null,this.itemArray)}GA(t,e){const i=this.op(),s=e;if(null!==s&&0!==s.length)if(this.C.length<=i){const t=s.length;for(let e=0;e<t;e++)this.i1(s[e],e,!0)}else{let t=i;for(let i=0;i<s.length;i++,t++){const e=s[i],n=t<this.C.length?this.C.elt(t):null;if(n instanceof ie){if(n.data!==e){const s=this.K2(n.data,i),o=this.K2(e,i);let r=o!==s;if(!r){const t=this.G2(n.data,i,s);r=this.G2(e,i,o)!==t}r?(this.te(t,!1),this.i1(e,i,!1)):n.data=e}}else this.i1(e,i,!1)}for(;t<this.C.length;)this.te(t,!1);this.Zr=null,this.H2(i,0),this.Ao()||this.c(),this.ss=null,this.isEnabledObject()||this.t1(this,!1);const e=this.part;null!==e&&(e.L0(),e.cf(),this.fn&&e instanceof Ce&&(e.fn=!0),e.fn&&e instanceof Ce&&(e.ne=null))}else for(;this.C.length>i;)this.te(this.C.length-1,!1)}i1(t,i,s){if(null==t||i<0)return null;const n=this.K2(t,i),o=this.G2(t,i,n);if(null!==o){o.Et();const n=o.copy();if(n.m2()){const t=this.findBindingPanel();null!==t&&t.Y2(!0)}e.K(t)&&(null===this.Ks&&(this.Ks=new m),this.Ks.set(t,n));const r=i+this.op();return this.insertAt(r,n),s&&(n._t=t,this.H2(r,i),n._t=null),n.data=t,n}return null}Ov(t){if(t<0)return;const e=t+this.op();this.te(e,!0),this.H2(e,t)}H2(t,e){const i=this.C;let s=t,n=e;for(;s<i.length;){const t=i.elt(s);t instanceof ie&&t.Iv(s,n),s++,n++}}Iv(t,e){this.type===ie.TableRow?this.row=t:this.type===ie.TableColumn&&(this.column=t),this.itemIndex=e}Dv(){return null!==this.yh||null!==this.itemTemplateMap}get itemTemplate(){return null===this.itemTemplateMap?null:this.itemTemplateMap.get("")}set itemTemplate(t){if(null===this.itemTemplateMap){if(null===t)return;this.itemTemplateMap=new m}const i=this.itemTemplateMap.get("");if(i!==t){(t instanceof ke||t.isPanelMain)&&e.o("Panel.itemTemplate must not be a Part or be Panel.isPanelMain: "+t),this.itemTemplateMap.set("",t),this.t("itemTemplate",i,t);const s=this.diagram;if(null!==s&&s.undoManager.isUndoingRedoing)return;this.rebuildItemElements()}}get itemTemplateMap(){return null!==this.p?this.p.Y0:null}set itemTemplateMap(t){const e=this.itemTemplateMap;if(e!==t){const i=t.iterator;for(;i.next();){i.value}this.Gt().Y0=t,this.t("itemTemplateMap",e,t);const s=this.diagram;if(null!==s&&s.undoManager.isUndoingRedoing)return;this.rebuildItemElements()}}get itemCategoryProperty(){return null!==this.p?this.p.K0:"category"}set itemCategoryProperty(t){const i=this.itemCategoryProperty;i!==t&&("string"!=typeof t&&!e.it(t)&&e.Zi(t,"string or function",ie,"itemCategoryProperty"),this.Gt().K0=t,this.t("itemCategoryProperty",i,t))}K2(t,i){if(null===t)return"";const s=this.itemCategoryProperty;let n="";if(e.it(s))n=s(t);else{if("string"!=typeof s||!e.K(t))return"";{if(""===s)return"";const e=this.diagram,i=null!==e?e.model:null;n=i?i.yt(t,s):ti.yt(t,s)}}return void 0===n?"":"string"==typeof n?n:void e.o("Panel.getCategoryForItemData found a non-string category for "+t+": "+n)}static HA=!1;static jA=null;G2(t,i,s){const n=this.itemTemplateMap;let o=null;return null!==n&&(o=n.get(s)),null===o&&(null!==n&&(o=n.get("")),null===o&&(ie.HA||(ie.HA=!0,e.ni('No item template Panel found for category "'+s+'" on '+this),e.ni("  Using default item template."),ie.jA=(new ie).add((new fe).bind("text","",e.toString).theme("stroke","text"))),o=ie.jA)),o}get af(){return 0!==(1048576&this.n)}set af(t){const i=0!==(1048576&this.n);i!==t&&(e.s(t,"boolean",ie,"isAtomic"),this.n=1048576^this.n,this.t("isAtomic",i,t))}get isClipping(){return 0!==(2097152&this.n)}set isClipping(t){const e=0!==(2097152&this.n);e!==t&&(this.Qc(),this.n=2097152^this.n,this instanceof _e&&(this.si=null),this.c(),this.t("isClipping",e,t))}get isOpposite(){return 0!==(33554432&this.n)}set isOpposite(t){const e=0!==(33554432&this.n);e!==t&&(this.n=33554432^this.n,this.c(),this.t("isOpposite",e,t))}get isEnabled(){return 0!==(4194304&this.n)}set isEnabled(t){const e=0!==(4194304&this.n);if(e!==t){const i=null===this.panel||this.panel.isEnabledObject();this.n=4194304^this.n,this.t("isEnabled",e,t);const s=this.diagram;if(null!==s&&s.undoManager.isUndoingRedoing)return;i&&this.t1(this,t)}}t1(t,e){const i=t.enabledChanged;if(null!==i&&i(t,e),t instanceof ie){const i=t.C.r,s=i.length;for(let t=0;t<s;t++){const s=i[t];e&&s instanceof ie&&!s.isEnabled||this.t1(s,e)}}}get alignmentFocusName(){return this._n}set alignmentFocusName(t){const e=this._n;e!==t&&(this._n=t,this.c(),this.t("alignmentFocusName",e,t))}static definePanelLayout(t,e){$t.dn(t,e)}static isBuilderDefined(t){return $t.es.has(t)}static Position=$t.es.get("Position");static Horizontal=$t.es.get("Horizontal");static Vertical=$t.es.get("Vertical");static Spot=$t.es.get("Spot");static Auto=$t.es.get("Auto");static Table=$t.es.get("Table");static Viewbox=$t.es.get("Viewbox");static TableRow=$t.es.get("TableRow");static TableColumn=$t.es.get("TableColumn");static Link=$t.es.get("Link");static Grid=$t.es.get("Grid");static Graduated=$t.es.get("Graduated")}ie.definePanelLayout=ie.definePanelLayout;class se{ip;ep;sp;np;xs;Ke;ss;Pe;constructor(){this.ip=0,this.ep=100,this.sp=10,this.np=0,this.xs=null,this.Ke=null,this.ss=null,this.Pe=null}copy(){const t=new se;return t.ip=this.ip,t.ep=this.ep,t.sp=this.sp,t.np=this.np,t.xs=this.xs,t.Ke=this.Ke,t.ss=this.ss,t.Pe=this.Pe,t}}class ne{ld;hd;Yc;q0;constructor(){this.ld=v.wC,this.hd=y.wo,this.Yc=v.pw,this.q0=[]}copy(){const t=new ne;return t.ld=this.ld.copy(),t.hd=this.hd.copy(),t.Yc=this.Yc.copy(),t.q0=this.q0,t}}class oe{Xe;Ye;rp;lp;hp;ap;W0;$0;J0;Z0;_0;Q0;tp;ph;constructor(){this.Xe=[],this.Ye=[],this.rp=3,this.lp=3,this.hp=0,this.ap=0,this.W0=b.Rg,this.$0=1,this.J0=null,this.Z0=null,this._0=1,this.Q0=null,this.tp=null,this.ph=null}copy(t){const e=new oe,i=this.Xe,s=i.length,n=e.Xe;for(let h=0;h<s;h++){if(void 0===i[h])continue;const e=i[h].copy();e.Pa(t),n[h]=e}const o=this.Ye,r=o.length,a=e.Ye;for(let h=0;h<r;h++){if(void 0===o[h])continue;const e=o[h].copy();e.Pa(t),a[h]=e}return e.rp=this.rp,e.lp=this.lp,e.hp=this.hp,e.ap=this.ap,e.W0=this.W0.P(),e.$0=this.$0,e.J0=this.J0,e.Z0=this.Z0,e._0=this._0,e.Q0=this.Q0,e.tp=this.tp,e.ph=this.ph,e}}var re=(t=>(t[t.Default=1]="Default",t[t.None=2]="None",t[t.ProportionalExtra=3]="ProportionalExtra",t))(re||{});class ae{Vs;cp;At;Ca;La;hi;at;cd;$n;Qr;fd;ud;Aa;Lt;dd;bs;_;Ai;de;constructor(t){u.Gi(this),this.Vs=null,this.cp=!0,this.At=0,this.de=NaN,this.Ca=0,this.La=1/0,this.hi=w.Default,this._=0,this.Ai=0,this.at=0,this.bs=null,this.cd=1,this.$n=1,this.Qr=null,this.fd=null,this.ud=NaN,this.Aa=null,this.Lt=null,this.dd=!1,t&&(Object.assign(this,t),void 0!==t.column?(this.isRow=!1,this.index=t.column):void 0!==t.row&&(this.isRow=!0,this.index=t.row))}copy(){const t=new ae;return t.cp=this.cp,t.At=this.At,t.de=this.de,t.Ca=this.Ca,t.La=this.La,t.hi=this.hi,t._=this._,t.Ai=this.Ai,t.at=this.at,t.$n=this.$n,t.cd=this.cd,null===this.Qr?t.Qr=null:t.Qr=this.Qr.P(),t.fd=this.fd,t.ud=this.ud,t.Aa=null,null!==this.Aa&&(t.separatorDashArray=this.Aa.slice()),t.Lt=this.Lt,t.dd=this.dd,t.bs=this.bs,t}Hb(t){t.isRow?void 0!==t.height&&(this.height=t.height):void 0!==t.width&&(this.width=t.width),void 0!==t.minimum&&(this.minimum=t.minimum),void 0!==t.maximum&&(this.maximum=t.maximum),void 0!==t.alignment&&(this.alignment=t.alignment),void 0!==t.stretch&&(this.stretch=t.stretch),void 0!==t.sizing&&(this.sizing=t.sizing),void 0!==t.separatorPadding&&(this.separatorPadding=t.separatorPadding),void 0!==t.separatorStroke&&(this.separatorStroke=t.separatorStroke),void 0!==t.separatorStrokeWidth&&(this.separatorStrokeWidth=t.separatorStrokeWidth),void 0!==t.separatorDashArray&&(this.Aa=t.separatorDashArray),void 0!==t.background&&(this.background=t.background),void 0!==t.coversSeparators&&(this.coversSeparators=t.coversSeparators),void 0!==t.bs&&(this.bs=t.bs)}oi(t){t in re?this.sizing=t:e.ir(this,t)}toString(){return"RowColumnDefinition "+(this.isRow?"(Row ":"(Column ")+this.index+") #"+u.as(this)}static Default=1;static None=2;static ProportionalExtra=3;Pa(t){this.Vs=t}computeEffectiveSpacingTop(t){let e=0;const i=this.Vs;if(this.index!==t){let t=this.separatorStroke;null===t&&null!==i&&(t=this.isRow?i.defaultRowSeparatorStroke:i.defaultColumnSeparatorStroke),null!==t&&(e=this.separatorStrokeWidth,isNaN(e)&&(e=null!==i?this.isRow?i.defaultRowSeparatorStrokeWidth:i.defaultColumnSeparatorStrokeWidth:0))}let s=this.Qr;if(null===s){if(null===i)return e;s=i.defaultSeparatorPadding}return e+(this.isRow?s.top:s.left)}computeEffectiveSpacing(){let t=0;const e=this.Vs;let i=0;const s=this.isRow;if(null!==e&&e.type===ie.Table){const t=s?e.Xe.length:e.Ye.length;for(let n=0;n<t;n++){const t=s?e.Xe[n]:e.Ye[n];if(void 0!==t&&0!==t._){i=t.index;break}}}if(this.index!==i){let i=this.separatorStroke;null===i&&null!==e&&(i=s?e.defaultRowSeparatorStroke:e.defaultColumnSeparatorStroke),null!==i&&(t=this.separatorStrokeWidth,isNaN(t)&&(t=null!==e?s?e.defaultRowSeparatorStrokeWidth:e.defaultColumnSeparatorStrokeWidth:0))}let n=this.Qr;if(null===n){if(null===e)return t;n=e.defaultSeparatorPadding}return t+(this.isRow?n.top+n.bottom:n.left+n.right)}t(t,e,i,s,n){const o=this.Vs;if(null!==o&&(o.raiseChangedEvent(2,t,this,e,i,s,n),null!==this.bs)){const e=o.diagram;if(null!==e&&!e.fe){const e=o.findBindingPanel();if(null!==e){const i=e.data;if(null!==i){const s=this.bs.iterator;for(;s.next();)s.value.updateSource(this,i,t,e)}}}}}get panel(){return this.Vs}get isRow(){return this.cp}set isRow(t){this.cp=t}get index(){return this.At}set index(t){this.At=t}get height(){return this.de}set height(t){const i=this.de;i!==t&&(t<0&&e.W(t,">= 0",ae,"height"),this.de=t,this.actual=this._,null!==this.panel&&this.panel.c(),this.t("height",i,t))}get width(){return this.de}set width(t){const i=this.de;i!==t&&(t<0&&e.W(t,">= 0",ae,"width"),this.de=t,this.actual=this._,null!==this.panel&&this.panel.c(),this.t("width",i,t))}get minimum(){return this.Ca}set minimum(t){const i=this.Ca;i!==t&&((t<0||!isFinite(t))&&e.W(t,">= 0",ae,"minimum"),this.Ca=t,this.actual=this._,null!==this.panel&&this.panel.c(),this.t("minimum",i,t))}get maximum(){return this.La}set maximum(t){const i=this.La;i!==t&&(t<0&&e.W(t,">= 0",ae,"maximum"),this.La=t,this.actual=this._,null!==this.panel&&this.panel.c(),this.t("maximum",i,t))}get alignment(){return this.hi}set alignment(t){const e=this.hi;e.equals(t)||(this.hi=t.P(),null!==this.panel&&this.panel.c(),this.t("alignment",e,t))}get stretch(){return this.$n}set stretch(t){const e=this.$n;e!==t&&(this.$n=t,null!==this.panel&&this.panel.c(),this.t("stretch",e,t))}get separatorPadding(){return this.Qr}set separatorPadding(t){"number"==typeof t&&(t=new b(t));const e=this.Qr;(null===t||null===e||!e.equals(t))&&(null!==t&&(t=t.P()),this.Qr=t,null!==this.panel&&this.panel.c(),this.t("separatorPadding",e,t))}get separatorStroke(){return this.fd}set separatorStroke(t){const e=this.fd;e!==t&&(null!==t&&jt.Qu(t,"RowColumnDefinition.separatorStroke"),t instanceof jt&&t.u(),this.fd=t,null!==this.panel&&this.panel.c(),this.t("separatorStroke",e,t))}get separatorStrokeWidth(){return this.ud}set separatorStrokeWidth(t){const e=this.ud;e!==t&&(this.ud=t,null!==this.panel&&this.panel.c(),this.t("separatorStrokeWidth",e,t))}get separatorDashArray(){return this.Aa}set separatorDashArray(t){const i=this.Aa;if(i!==t){if(null!==t&&!Array.isArray(t)&&e.Zi(t,"Array",ae,"separatorDashArray:value"),null!==t){const s=t.length;let n=0;for(let i=0;i<s;i++){const s=t[i];("number"!=typeof s||!(s>=0)||!isFinite(s))&&e.o("separatorDashArray value "+s+" at index "+i+" must be a positive number or zero."),n+=s}if(0===n){if(null===i)return;t=null}}this.Aa=t,null!==this.panel&&this.panel.S(),this.t("separatorDashArray",i,t)}}get background(){return this.Lt}set background(t){const e=this.Lt;e!==t&&(null!==t&&jt.Qu(t,"RowColumnDefinition.background"),t instanceof jt&&t.u(),this.Lt=t,null!==this.panel&&this.panel.S(),this.t("background",e,t))}get coversSeparators(){return this.dd}set coversSeparators(t){const i=this.dd;i!==t&&(e.s(t,"boolean",ae,"coversSeparators"),this.dd=t,null!==this.panel&&this.panel.S(),this.t("coversSeparators",i,t))}get sizing(){return this.cd}set sizing(t){const e=this.cd;e!==t&&(this.cd=t,null!==this.panel&&this.panel.c(),this.t("sizing",e,t))}Zb(){if(1===this.sizing){const t=this.Vs;return this.isRow?t.rowSizing:t.columnSizing}return this.sizing}get actual(){return this._}set actual(t){isNaN(this.de)?this._=Math.max(Math.min(this.La,t),this.Ca):this._=Math.max(Math.min(this.La,this.de),this.Ca)}get measured(){return this.Ai}set measured(t){this.Ai=t}get total(){return this._+this.computeEffectiveSpacing()}get position(){return this.at}set position(t){this.at=t}bind(t,e,i,s){return this.sf(t,e,i,s),this}bindTwoWay(t,e,i,s){const n=this.sf(t,e,i,s);return void 0===s&&n.makeTwoWay(),this}theme(t,e,i,s,n){return this.gh(t,e,i,s,n),this}themeData(t,e,i,s,n){return this.gh(t,e,i,s,n).ofData(),this}themeObject(t,e,i,s,n,o){return this.gh(t,e,i,s,n).ofObject(o),this}themeModel(t,e,i,s,n){return this.gh(t,e,i,s,n).ofModel(),this}sf(t,e,i,s){let n;return n="string"==typeof t?new Je(t,e,i,s):t,this.X0(n),n}gh(t,e,i,s,n){let o;return o="string"==typeof t?new Qe(t,e,i,s,n):t,this.X0(o),o}X0(t){t.be=this;const i=this.panel;if(null!==i){const s=i.findBindingPanel();null!==s&&s.AA()&&e.o("Cannot add a Binding to a RowColumnDefinition that is already frozen: "+t+" on "+i)}null===this.bs&&(this.bs=new h),this.bs.add(t)}}class he extends Tt{ot;ks;gd;Ta;Hi;Uo;Oo;Ht;md;pd;G;constructor(t,e){super(),this.ot=null,this.ks=null,this.gd="None",this.Ta="black",this.Hi="black",this.Uo=1,this.Oo=null,this.Ht=null,this.md=NaN,this.pd=NaN,this.G=null,"string"==typeof t?this.figure=t:t&&Object.assign(this,t),e&&Object.assign(this,e)}cloneProtected(t){super.cloneProtected(t),t.ot=this.ot,t.ks=this.ks,t.gd=this.gd,t.Ta=this.Ta,t.Hi=this.Hi,t.Uo=this.Uo,null!==this.Oo&&(t.Oo=this.Oo.slice()),null!==this.Ht&&(this.Ht.fi?t.Ht=this.Ht:t.Ht=this.Ht.copy()),t.md=this.md,t.pd=this.pd,null!==this.G&&(t.G=this.G.copy())}Da(){return null===this.Ht?this.Ht=new le:this.Ht.fi&&(this.Ht=this.Ht.copy()),this.Ht}ah(){super.ah(),null!==this.Ht&&(this.Ht.fi=!0)}oi(t){t in M?this.geometryStretch=t:super.oi(t)}toString(){return"Shape("+("None"!==this.figure?this.figure:"None"!==this.toArrow?this.toArrow:this.fromArrow)+")#"+u.as(this)}Ev(t,i){const s=this.pathPattern;s.ht(1/0,1/0);const n=s.measuredBounds;s.Ut(0,0,n.width,n.height);const o=this.geometry;t.save(),t.beginPath();const r=e.et();if(1===o.type)r.push(o.startX),r.push(o.startY),r.push(o.endX),r.push(o.endY),this.yd(t,i,r,s);else if(4===o.type){const n=o.figures.iterator;for(;n.next();){const o=n.value;r.length=0,r.push(o.startX),r.push(o.startY);let a=o.startX,h=o.startY,l=a,u=h;const c=o.segments.r,d=c.length;for(let n=0;n<d;n++){const d=c[n];switch(d.type){case 1:this.yd(t,i,r,s),r.length=0,r.push(d.endX),r.push(d.endY),a=d.endX,h=d.endY,l=a,u=h;break;case 2:r.push(d.endX),r.push(d.endY),a=d.endX,h=d.endY;break;case 3:S.vn(a,h,d.point1X,d.point1Y,d.point2X,d.point2Y,d.endX,d.endY,.5,r),a=d.endX,h=d.endY;break;case 4:S.Og(a,h,d.point1X,d.point1Y,d.endX,d.endY,.5,r),a=d.endX,h=d.endY;break;case 5:{const t=d.xo(o),e=t.length;if(0===e){r.push(d.centerX),r.push(d.centerY),a=d.centerX,h=d.centerY;break}for(let i=0;i<e;i++){const e=t[i];S.vn(a,h,e[2],e[3],e[4],e[5],e[6],e[7],.5,r),a=e[6],h=e[7]}break}case 6:{const t=d.Bh(o,a,h),e=t.length;if(0===e){r.push(d.endX),r.push(d.endY),a=d.endX,h=d.endY;break}for(let i=0;i<e;i++){const e=t[i];S.vn(a,h,e[2],e[3],e[4],e[5],e[6],e[7],.5,r),a=e[6],h=e[7]}break}default:e.o("Segment not of valid type: "+d.type)}d.isClosed&&(r.push(l),r.push(u),this.yd(t,i,r,s))}this.yd(t,i,r,s)}}else if(2===o.type)r.push(o.startX),r.push(o.startY),r.push(o.endX),r.push(o.startY),r.push(o.endX),r.push(o.endY),r.push(o.startX),r.push(o.endY),r.push(o.startX),r.push(o.startY),this.yd(t,i,r,s);else if(3===o.type){const e=new A;e.startX=o.endX,e.startY=(o.startY+o.endY)/2;const n=new L(5);n.startAngle=0,n.sweepAngle=360,n.centerX=(o.startX+o.endX)/2,n.centerY=(o.startY+o.endY)/2,n.radiusX=Math.abs(o.startX-o.endX)/2,n.radiusY=Math.abs(o.startY-o.endY)/2,e.add(n);const a=n.xo(e),h=a.length;if(0===h)r.push(n.centerX),r.push(n.centerY);else{let t=e.startX,i=e.startY;for(let e=0;e<h;e++){const s=a[e];S.vn(t,i,s[2],s[3],s[4],s[5],s[6],s[7],.5,r),t=s[6],i=s[7]}}this.yd(t,i,r,s)}e.J(r),t.restore(),t.clearContextCache(!1)}Bv(t){let e=t.measuredBounds.width;return t instanceof he&&(e-=t.strokeWidth),e<1&&(e=1),e}yd(t,i,s,n){const o=s.length;if(o<4)return;const r=n.measuredBounds,a=Math.max(1,r.width),h=r.height;let l=s[0],u=s[1],c=0,d=0,f=0,g=0,p=0,m=0,y=0,v=0;const x=e.et();for(let e=2;e<o;e+=2)c=s[e],d=s[e+1],f=c-l,g=d-u,0===f&&(f=.001),p=g/f,m=Math.atan2(g,f),y=Math.sqrt(f*f+g*g),x.push([f,m,p,y]),v+=y,l=c,u=d;l=s[0],u=s[1];const b=this.Bv(n);let w=b;const k=a/2;let S=0!==k,P=0,M=x[P];f=M[0],m=M[1],p=M[2],y=M[3];let C=0;for(;v>=.1;){if(0===C&&(S?(w=b,w-=k,v-=k,S=!1):w=b,0===w&&(w=1)),w>v)return w=v,void e.J(x);w>y?(C=w-y,w=y):C=0;let s=Math.sqrt(w*w/(1+p*p));if(f<0&&(s=-s),l+=s,u+=p*s,t.translate(l,u),t.rotate(m),t.translate(-a/2,-h/2),0===C&&n.dh(t,i),t.translate(a/2,h/2),t.rotate(-m),t.translate(-l,-u),v-=w,y-=w,0!==C){if(P++,P===x.length)return void e.J(x);M=x[P],f=M[0],m=M[1],p=M[2],y=M[3],w=C}}e.J(x)}dh(t,e){const i=t instanceof Et;let s=this.Hi;const n=this.Ta;if(null===s&&null===n)return;const o=this.ot;if(null===o)return;t.commitTransform();const r=this.actualBounds,a=this.naturalBounds;null!==n&&this.rn(t,n,!0,!1,a,r);const h=this.part;let l=this.Uo;null!==s&&0===l&&null!==h&&(this.isPanelMain||h.findMainElement()===this)&&(l=h.Uv()),0===l&&(s=null),null!==s&&0!==l&&(this.rn(t,s,!1,!1,a,r),t.lineWidth=l,t.lineJoin=this.strokeJoin,t.lineCap=this.strokeCap,t.miterLimit=this.strokeMiterLimit);let u=!1;h&&e.getRenderingHint("drawShadows")&&(u=h.isShadowed),!1===t.Jr&&(u=!1);let c=!0;null!==s&&(null===n||"transparent"===n)&&(c=!1);let d=!1;const f=this.strokeDashArray;if(null!==f&&(d=!0,t.enableDash(f,this.strokeDashOffset)),1===o.type)t.beginPath(),t.moveTo(o.startX,o.startY),t.lineTo(o.endX,o.endY),null!==s&&t.strokeContext(),t.endPath();else if(2===o.type){const e=o.startX,i=o.startY,r=o.endX,a=o.endY,h=Math.min(e,r),l=Math.min(i,a),d=Math.abs(r-e),f=Math.abs(a-i);t.beginPath(),t.rect(h,l,d,f),null!==n&&t.fillContext(n,!1,null),null!==s&&(c&&u&&t.shadowsOff(),t.strokeContext(),c&&u&&t.shadowsOn()),t.endPath()}else if(3===o.type){const e=o.startX,i=o.startY,r=o.endX,a=o.endY,h=Math.abs(r-e)/2,l=Math.abs(a-i)/2,d=Math.min(e,r)+h,f=Math.min(i,a)+l;t.beginPath(),t.moveTo(d,f-l),t.bezierCurveTo(d+S.Rn*h,f-l,d+h,f-S.Rn*l,d+h,f),t.bezierCurveTo(d+h,f+S.Rn*l,d+S.Rn*h,f+l,d,f+l),t.bezierCurveTo(d-S.Rn*h,f+l,d-h,f+S.Rn*l,d-h,f),t.bezierCurveTo(d-h,f-S.Rn*l,d-S.Rn*h,f-l,d,f-l),t.closePath(),null!==n&&t.fillContext(n,!1,null),null!==s&&(c&&u&&t.shadowsOff(),t.strokeContext(),c&&u&&t.shadowsOn()),t.endPath()}else if(4===o.type){const e=o.figures,r=e.length;for(let o=0;o<r;o++){const r=e.r[o];i?this.buildPath(t,r):null===r.Ee&&(r.Ee=new Path2D,this.buildPath(r.Ee,r));const a=r.isFilled;u?r.isShadowed?(!0===a&&"transparent"!==n&&null!==n&&t.fillContext(n,r.isEvenOdd,r.Ee),null!==s&&(a&&c&&t.shadowsOff(),t.stroke(r.Ee),a&&c&&t.shadowsOn())):(t.shadowsOff(),a&&"transparent"!==n&&null!==n&&t.fillContext(n,r.isEvenOdd,r.Ee),null!==s&&t.stroke(r.Ee),t.shadowsOn()):(a&&null!==n&&t.fillContext(n,r.isEvenOdd,r.Ee),null!==s&&t.stroke(r.Ee)),t.endPath(o)}}d&&t.disableDash(),null!==this.pathPattern&&this.Ev(t,e)}buildPath(t,e){t instanceof Path2D||t.beginPath(),t.moveTo(e.startX,e.startY);const i=e.segments.r,s=i.length;let n=null;for(let o=0;o<s;o++){const s=i[o];switch(s.type){case 1:t.moveTo(s.endX,s.endY);break;case 2:t.lineTo(s.endX,s.endY);break;case 3:t.bezierCurveTo(s.point1X,s.point1Y,s.point2X,s.point2Y,s.endX,s.endY);break;case 4:t.quadraticCurveTo(s.point1X,s.point1Y,s.endX,s.endY);break;case 5:if(s.radiusX===s.radiusY){const i=null!==n?n.endX:e.startX,o=null!==n?n.endY:e.startY,r=Math.PI/180;t.arc(s.point1X,s.point1Y,s.radiusX,s.startAngle*r,(s.startAngle+s.sweepAngle)*r,s.sweepAngle<0,i,o)}else{const i=s.xo(e),n=i.length;if(0===n){t.lineTo(s.centerX,s.centerY);break}for(let e=0;e<n;e++){const s=i[e];0===e&&t.lineTo(s[0],s[1]),t.bezierCurveTo(s[2],s[3],s[4],s[5],s[6],s[7])}}break;case 6:{let i,o=0,r=0;if(null!==n&&5===n.type){i=n.xo(e);const a=i.length;if(0===a){t.lineTo(s.endX,s.endY);break}const h=i[a-1]||null;null!==h&&(o=h[6],r=h[7])}else o=null!==n?n.endX:e.startX,r=null!==n?n.endY:e.startY;i=s.Bh(e,o,r);const a=i.length;if(0===a){t.lineTo(s.endX,s.endY);break}for(let e=0;e<a;e++){const s=i[e];t.bezierCurveTo(s[2],s[3],s[4],s[5],s[6],s[7])}break}}s.isClosed&&t.closePath(),n=s}}Zc(t,e,i){if(!super.Zc(t,e,i)||null===this.Hi&&null===this.Ta||null===this.ot||null!==this.pathPattern)return!1;const s=this.svg.getElementsByTagName("path");return this.geometry.figures.length===s.length&&(t.currentPath=this.svg,this.dh(t,e),t.currentPath=null,!0)}$u(t){return null!==this.geometry&&this.geometry.figures.length>1||null!==this.pathPattern||super.$u(t)}b2(t,e){if("g"!==t.nodeName)t.setAttributeNS(null,"filter",e);else{const i=t.getElementsByTagName("path");for(let t=0;t<i.length;t++)i[t].setAttributeNS(null,"filter",e)}}getDocumentPoint(t,i){if(void 0===i&&(i=new y),t instanceof w){const s=t;s.isNoSpot()&&e.o("getDocumentPoint Spot must be a real, specific Spot, not: "+s.toString());const n=this.naturalBounds,o=this.strokeWidth;return i.i(s.x*(n.width+o)-o/2+n.x+s.offsetX,s.y*(n.height+o)-o/2+n.y+s.offsetY),this.Bs.gt(i),i}return i.set(t),this.Bs.gt(i),i}getDocumentBounds(t){void 0===t&&(t=new x);const e=this.naturalBounds,i=this.Bs,s=x.V(e.x,e.y,e.width,e.height),n=this.strokeWidth;s.inflate(n/2,n/2);const o=y.V(s.x,s.y).T(i);return t.i(o.x,o.y,0,0),o.i(s.right,s.y).T(i),t.unionNoCheck(o.x,o.y,0,0),o.i(s.right,s.bottom).T(i),t.unionNoCheck(o.x,o.y,0,0),o.i(s.x,s.bottom).T(i),t.unionNoCheck(o.x,o.y,0,0),x.e(s),y.e(o),t}ch(t,i){const s=this.geometry;if(null===s||null===this.fill&&null===this.stroke)return!1;const n=s.bounds;let o=this.strokeWidth/2;1===s.type&&!i&&(o+=2);const r=x.l();if(r.a(n),r.inflate(o+2,o+2),!r.containsPoint(t))return x.e(r),!1;const a=o+1e-4;if(1===s.type){if(null===this.stroke)return!1;const e=(s.startX-s.endX)*(t.x-s.endX)+(s.startY-s.endY)*(t.y-s.endY),i=(s.endX-s.startX)*(t.x-s.startX)+(s.endY-s.startY)*(t.y-s.startY);return!(e<0||i<0)&&(x.e(r),S.vi(s.startX,s.startY,s.endX,s.endY,o,t.x,t.y))}if(2===s.type){const e=s.startX,i=s.startY,n=s.endX,h=s.endY;if(r.x=Math.min(e,n),r.y=Math.min(i,h),r.width=Math.abs(n-e),r.height=Math.abs(h-i),null===this.fill){if(r.inflate(-a,-a),r.containsPoint(t))return x.e(r),!1;r.inflate(a,a)}null!==this.stroke&&r.inflate(o,o);const l=r.containsPoint(t);return x.e(r),l}if(3===s.type){const e=s.startX,i=s.startY,n=s.endX,o=s.endY;let h=Math.min(e,n),l=Math.min(i,o);const u=Math.abs(n-e),c=Math.abs(o-i);let d=u/2,f=c/2;if(h=t.x-(h+d),l=t.y-(l+f),null===this.fill){if(d-=a,f-=a,d<=0||f<=0)return x.e(r),!1;if(h*h/(d*d)+l*l/(f*f)<=1)return x.e(r),!1;d+=a,f+=a}return null!==this.stroke&&(d+=a,f+=a),x.e(r),!(d<=0||f<=0)&&h*h/(d*d)+l*l/(f*f)<=1}if(4===s.type)return x.e(r),null===this.fill?s.EC(t.x,t.y,o):s.jk(t,o,this.strokeWidth>1,i);e.o("Unknown Geometry type: "+s.type)}Wu(t,i,s,n){const o=this.desiredSize,r=this.Uo;let a;if(t=Math.max(t,0),i=Math.max(i,0),null!==this.ks)a=this.geometry.bounds;else{const t=this.figure;let i=he.j2[t];if(void 0===i){let s=S.In[t];"string"==typeof s&&(s=S.In[s]),e.it(s)?(i=s(null,100,100),he.j2[t]=i):e.o("Unsupported Figure: "+t)}a=i.bounds}let h=a.width,l=a.height,u=a.width,c=a.height;switch(this.zs(!0)){case 0:s=0,n=0;break;case 2:u=Math.max(t-r,0),c=Math.max(i-r,0);break;case 5:u=Math.max(t-r,0),n=0;break;case 4:s=0,c=Math.max(i-r,0);break}isFinite(o.width)&&(u=o.width),isFinite(o.height)&&(c=o.height);const d=this.maxSize,f=this.minSize;s=Math.max(s-r,f.width),n=Math.max(n-r,f.height),u=Math.min(d.width,u),c=Math.min(d.height,c),u=isFinite(u)?Math.max(s,u):Math.max(h,s),c=isFinite(c)?Math.max(n,c):Math.max(l,n);const g=this.hS();switch(g){case 0:break;case 2:h=u,l=c;break;case 6:{let t=Math.min(u/h,c/l);isFinite(t)||(t=1),h*=t,l*=t;break}default:e.o(g+" is not a valid geometryStretch.")}if(null!==this.ks){0===h&&(h=.001),0===l&&(l=.001);const t=(null!==this.ks?this.ks:this.ot).aF(h,l);this.ot=t}else(null===this.ot||!S.z(this.ot.rc,t-r)||!S.z(this.ot.lc,i-r))&&(this.ot=he.Vv(this,h,l));a=this.ot.bounds,t===1/0||i===1/0?this.Wn(a.x-r/2,a.y-r/2,0===t&&0===h?0:a.width+r,0===i&&0===l?0:a.height+r):this.Wn(-r/2,-r/2,u+r,c+r),o.isReal()?(u=o.width,c=o.height,u=Math.min(d.width,u),c=Math.min(d.height,c),u=Math.max(f.width,u),c=Math.max(f.height,c),this.zi.i(0,0,u,c)):this.zi.a(a)}hS(){const t=this.geometryStretch;return null!==this.ks?1===t?2:t:1===t?he.j2[this.figure].defaultStretch:t}fh(t,e,i,s){this.commonArrange(t,e,i,s)}getNearestIntersectionPoint(t,e,i){return this.Jc(t.x,t.y,e.x,e.y,i)}Jc(t,i,s,n,o){const r=this.T,a=1/(r.m11*r.m22-r.m12*r.m21),h=r.m22*a,l=-r.m12*a,u=-r.m21*a,c=r.m11*a,d=a*(r.m21*r.dy-r.m22*r.dx),f=a*(r.m12*r.dx-r.m11*r.dy),g=t*h+i*u+d,p=t*l+i*c+f,m=s*h+n*u+d,v=s*l+n*c+f,b=this.Uo/2;let w=this.ot;null===w&&(this.ht(1/0,1/0),w=this.ot);const k=w.bounds;let P=!1;if(1===w.type)if(this.strokeWidth<=1.5)P=S.On(w.startX,w.startY,w.endX,w.endY,g,p,m,v,o);else{let t=0,i=0;if(w.startX===w.endX)t=b,i=0;else{const e=(w.endY-w.startY)/(w.endX-w.startX);i=b/Math.sqrt(1+e*e),t=i*e}const s=e.et();let n=new y;S.On(w.startX+t,w.startY+i,w.endX+t,w.endY+i,g,p,m,v,n)&&s.push(n),n=new y,S.On(w.startX-t,w.startY-i,w.endX-t,w.endY-i,g,p,m,v,n)&&s.push(n),n=new y,S.On(w.startX+t,w.startY+i,w.startX-t,w.startY-i,g,p,m,v,n)&&s.push(n),n=new y,S.On(w.endX+t,w.endY+i,w.endX-t,w.endY-i,g,p,m,v,n)&&s.push(n);const r=s.length;if(0===r)return e.J(s),!1;P=!0;let a=1/0;for(let e=0;e<r;e++){const t=s[e],i=(t.x-g)**2+(t.y-p)**2;i<a&&(a=i,o.x=t.x,o.y=t.y)}e.J(s)}else if(2===w.type)P=S.dl(k.x-b,k.y-b,k.x+k.width+b,k.y+k.height+b,g,p,m,v,o);else if(3===w.type){const t=x.V(k.x,k.y,k.width,k.height).inflate(b,b);P=this.zv(t,g,p,m,v,o),x.e(t)}else if(4===w.type){let r=0,a=0,h=0,l=0;const u=y.l();let c=m-g,d=v-p,f=c*c+d*d,x=g,M=p;if(f>0&&k.contains(x,M)&&(u.x=x,u.y=M,this.containsPoint(u)))for(0!==c&&Math.abs(c)<.5?(d*=.5/c,c=.5):0!==d&&Math.abs(d)<.5&&(c*=.5/d,d=.5),x-=c,M-=d;k.contains(x,M);)x-=c,M-=d;const C=.6;o.x=m,o.y=v;for(let t=0;t<w.figures.count;t++){const i=w.figures.r[t],s=i.isFilled?x:g,n=i.isFilled?M:p,c=i.segments;r=i.startX,a=i.startY;let d=r,y=a;for(let t=0;t<c.count;t++){const g=c.r[t],p=g.type;h=g.endX,l=g.endY;let x=!1;switch(p){case 1:d=h,y=l;break;case 2:x=this.e1(r,a,h,l,s,n,m,v,u);break;case 3:x=S.Ig(r,a,g.point1X,g.point1Y,g.point2X,g.point2Y,h,l,s,n,m,v,C,u);break;case 4:x=S.Ig(r,a,r+2/3*(g.point1X-r),a+2/3*(g.point1Y-a),h+2/3*(g.point1X-h),l+2/3*(g.point1Y-l),h,l,s,n,m,v,C,u);break;case 5:case 6:{const t=5===g.type?g.xo(i):g.Bh(i,r,a),e=t.length;if(0===e){x=this.e1(r,a,5===g.type?g.centerX:g.endX,5===g.type?g.centerY:g.endY,s,n,m,v,u);break}let c=null;for(let i=0;i<e;i++){if(c=t[i],0===i&&this.e1(r,a,c[0],c[1],s,n,m,v,u)){const t=this.s1(s,n,u,f,o);t<f&&(f=t,P=!0)}if(S.Ig(c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],s,n,m,v,C,u)){const t=this.s1(s,n,u,f,o);t<f&&(f=t,P=!0)}}h=c[6],l=c[7];break}default:e.o("Unknown Segment type: "+p)}if(r=h,a=l,x){const t=this.s1(s,n,u,f,o);t<f&&(f=t,P=!0)}if(g.isClosed&&(h=d,l=y,this.e1(r,a,h,l,s,n,m,v,u))){const t=this.s1(s,n,u,f,o);t<f&&(f=t,P=!0)}}}let A=s-t,N=n-i;const L=Math.sqrt(A*A+N*N);0!==L&&(A/=L,N/=L),o.x-=A*b,o.y-=N*b,y.e(u)}else e.o("Unknown Geometry type: "+w.type);return!!P&&(this.T.gt(o),!0)}s1(t,e,i,s,n){const o=i.x-t,r=i.y-e,a=o*o+r*r;return a<s?(n.x=i.x,n.y=i.y,a):s}e1(t,e,i,s,n,o,r,a,h){if(S.z(t,i)&&S.z(e,s)||S.z(n,r)&&S.z(o,a))return!1;let l=!1;const u=(n-r)*(e-s)-(o-a)*(t-i);if(0===u)return!1;if(h.x=((n*a-o*r)*(t-i)-(n-r)*(t*s-e*i))/u,h.y=((n*a-o*r)*(e-s)-(o-a)*(t*s-e*i))/u,(t>i?t-i:i-t)<(e>s?e-s:s-e)){const t=e<s?e:s,i=e<s?s:e;(h.y>t||S.z(h.y,t))&&(h.y<i||S.z(h.y,i))&&(l=!0)}else{const e=t<i?t:i,s=t<i?i:t;(h.x>e||S.z(h.x,e))&&(h.x<s||S.z(h.x,s))&&(l=!0)}return l}Xv(t,e,i){return!1!==this.pickable&&(i.nc(this.T),e?this.Yv(t,i):this.containedInRect(t,i))}containedInRect(t,e){if(void 0===e)return t.containsRect(this.actualBounds);let i=this.ot;null===i&&(this.ht(1/0,1/0),i=this.ot);const s=i.bounds,n=this.strokeWidth/2;let o=!1;const r=y.l();return r.i(s.x-n,s.y-n),t.containsPoint(e.gt(r))&&(r.i(s.x-n,s.bottom+n),t.containsPoint(e.gt(r))&&(r.i(s.right+n,s.bottom+n),t.containsPoint(e.gt(r))&&(r.i(s.right+n,s.y-n),t.containsPoint(e.gt(r))&&(o=!0)))),y.e(r),o}intersectsRect(t,e){if(this.containedInRect(t,e)||void 0===e&&(e=this.T,t.containsRect(this.actualBounds)))return!0;const i=k.l();i.set(e),i.ww();const s=t.left,n=t.right,o=t.top,r=t.bottom,a=y.l();if(a.i(s,o),i.gt(a),this.ch(a,!0))return y.e(a),!0;if(a.i(n,o),i.gt(a),this.ch(a,!0))return y.e(a),!0;if(a.i(s,r),i.gt(a),this.ch(a,!0))return y.e(a),!0;if(a.i(n,r),i.gt(a),this.ch(a,!0))return y.e(a),!0;const h=y.l(),l=y.l();i.set(e),i.NC(this.T),i.ww(),h.x=n,h.y=o,h.T(i),a.x=s,a.y=o,a.T(i);let u=!1;return this.Fa(a,h,l)?u=!0:(a.x=n,a.y=r,a.T(i),this.Fa(a,h,l)?u=!0:(h.x=s,h.y=r,h.T(i),this.Fa(a,h,l)?u=!0:(a.x=s,a.y=o,a.T(i),this.Fa(a,h,l)&&(u=!0)))),y.e(a),k.e(i),y.e(h),y.e(l),u}Fa(t,e,i){if(!this.getNearestIntersectionPoint(t,e,i))return!1;const s=t.x,n=t.y,o=e.x,r=e.y,a=i.x,h=i.y;if(s===o){let t=0,e=0;return n<r?(t=n,e=r):(t=r,e=n),h>=t&&h<=e}{let t=0,e=0;return s<o?(t=s,e=o):(t=o,e=s),a>=t&&a<=e}}Yv(t,e){if(this.containedInRect(t,e)||void 0===e&&(e=this.T,t.containsRect(this.actualBounds)))return!0;const i=t.left,s=t.right,n=t.top,o=t.bottom,r=y.l(),a=y.l(),h=y.l(),l=k.l();l.set(e),l.NC(this.T),l.ww(),a.x=s,a.y=n,a.T(l),r.x=i,r.y=n,r.T(l);let u=!1;return this.Fa(r,a,h)?u=!0:(r.x=s,r.y=o,r.T(l),this.Fa(r,a,h)?u=!0:(a.x=i,a.y=o,a.T(l),this.Fa(r,a,h)?u=!0:(r.x=i,r.y=n,r.T(l),this.Fa(r,a,h)&&(u=!0)))),k.e(l),y.e(r),y.e(a),y.e(h),u}xA(t,i,s){if(s&&null!==this.fill&&this.ch(t,!0))return!0;let n=t.distanceSquaredPoint(i);const o=n;this.strokeWidth>1.5&&(n=this.strokeWidth/2+Math.sqrt(n),n*=n);let r=this.ot;if(null===r&&(this.ht(1/0,1/0),r=this.ot,null===r))return!1;if(!s){const e=r.bounds,i=e.x,s=e.y,o=e.x+e.width,a=e.y+e.height;if(y.distanceSquared(t.x,t.y,i,s)<=n&&y.distanceSquared(t.x,t.y,o,s)<=n&&y.distanceSquared(t.x,t.y,i,a)<=n&&y.distanceSquared(t.x,t.y,o,a)<=n)return!0}function a(t,e){const i=t.length;for(let s=0;s<i;s+=2)if(e.distanceSquared(t[s],t[s+1])>n)return!0;return!1}const h=r.startX,l=r.startY,u=r.endX,c=r.endY;if(1===r.type){const e=y.distanceLineSegmentSquared(t.x,t.y,h,l,u,c),i=(u-h)*(t.x-h)+(c-l)*(t.y-l),s=(h-u)*(t.x-u)+(l-c)*(t.y-c),r=i>=0&&s>=0?n:o;return e<=r}if(2===r.type){let e=!1;return s&&(e=y.distanceLineSegmentSquared(t.x,t.y,h,l,h,c)<=n||y.distanceLineSegmentSquared(t.x,t.y,h,l,u,l)<=n||y.distanceLineSegmentSquared(t.x,t.y,u,l,u,c)<=n||y.distanceLineSegmentSquared(t.x,t.y,h,c,u,c)<=n),e}if(3===r.type){const e=(h+u)/2,i=(l+c)/2,o=t.x-e,r=t.y-i,a=Math.abs(u-h)/2,d=Math.abs(c-l)/2;if(0===a||0===d)return y.distanceLineSegmentSquared(t.x,t.y,h,l,u,c)<=n;if(s){const t=S.tF(a,d,o,r);return t*t<=n}return!(y.distanceSquared(o,r,-a,0)>=n||y.distanceSquared(o,r,0,-d)>=n||y.distanceSquared(o,r,0,d)>=n||y.distanceSquared(o,r,a,0)>=n)}if(4===r.type){const i=r.bounds,o=i.x,h=i.y,l=i.x+i.width,u=i.y+i.height;if(t.x>l&&t.x<o&&t.y>u&&t.y<h&&y.distanceLineSegmentSquared(t.x,t.y,o,h,o,u)>n&&y.distanceLineSegmentSquared(t.x,t.y,o,h,l,h)>n&&y.distanceLineSegmentSquared(t.x,t.y,l,u,o,u)>n&&y.distanceLineSegmentSquared(t.x,t.y,l,u,l,h)>n)return!1;const c=Math.sqrt(n);if(!s){const i=r.figures;for(let s=0;s<i.count;s++){const o=i.r[s];let r=o.startX,h=o.startY;if(t.distanceSquared(r,h)>n)return!1;const l=o.segments.r,u=l.length;for(let i=0;i<u;i++){const s=l[i];switch(s.type){case 1:case 2:if(r=s.endX,h=s.endY,t.distanceSquared(r,h)>n)return!1;break;case 3:{const i=e.et();S.vn(r,h,s.point1X,s.point1Y,s.point2X,s.point2Y,s.endX,s.endY,.8,i);const o=a(i,t);if(e.J(i),o||(r=s.endX,h=s.endY,t.distanceSquared(r,h)>n))return!1;break}case 4:{const i=e.et();S.Og(r,h,s.point1X,s.point1Y,s.endX,s.endY,.8,i);const o=a(i,t);if(e.J(i),o||(r=s.endX,h=s.endY,t.distanceSquared(r,h)>n))return!1;break}case 5:case 6:{const i=5===s.type?s.xo(o):s.Bh(o,r,h),l=i.length;if(0===l){if(r=5===s.type?s.centerX:s.endX,h=5===s.type?s.centerY:s.endY,t.distanceSquared(r,h)>n)return!1;break}let u=null;const c=e.et();for(let s=0;s<l;s++)if(u=i[s],c.length=0,S.vn(u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],.8,c),a(c,t))return e.J(c),!1;e.J(c),null!==u&&(r=u[6],h=u[7]);break}default:e.o("Unknown Segment type: "+s.type)}}}return!0}if(null===this.fill?r.EC(t.x,t.y,c):r.jk(t,c,!0,!1))return!0}return!1}zv(t,e,i,s,n,o){if(0===t.width)return S.On(t.x,t.y,t.x,t.y+t.height,e,i,s,n,o);if(0===t.height)return S.On(t.x,t.y,t.x+t.width,t.y,e,i,s,n,o);{const r=t.width/2,a=t.height/2,h=t.x+r,l=t.y+a;let u=9999;if(e!==s&&(u=(i-n)/(e-s)),Math.abs(u)<9999){const t=i-l-u*(e-h);if(r*r*(u*u)+a*a-t*t<0)return o.x=NaN,o.y=NaN,!1;const s=Math.sqrt(r*r*(u*u)+a*a-t*t),n=(-r*r*u*t+r*a*s)/(a*a+r*r*(u*u))+h,c=(-r*r*u*t-r*a*s)/(a*a+r*r*(u*u))+h,d=u*(n-h)+t+l,f=u*(c-h)+t+l,g=Math.abs((e-n)**2)+Math.abs((i-d)**2),p=Math.abs((e-c)**2)+Math.abs((i-f)**2);g<p?(o.x=n,o.y=d):(o.x=c,o.y=f)}else{const t=a*a,s=r*r,n=e-h,u=t-t/s*(n*n);if(u<0)return o.x=NaN,o.y=NaN,!1;const c=Math.sqrt(u),d=l+c,f=l-c,g=Math.abs(d-i),p=Math.abs(f-i);g<p?(o.x=e,o.y=d):(o.x=e,o.y=f)}return!0}}Fv(){return this.Uo/2*this.strokeMiterLimit*this.getDocumentScale()}get geometry(){return null!==this.ot?this.ot:this.ks}set geometry(t){const e=this.ot,i=this.ks;if(e===t)return;null!==t?(this.ot=t.u(),this.ks=this.ot):(this.ot=null,this.ks=null);const s=this.part;if(null!==s&&s.cf(),this.c(),this.t("geometry",e||i,t),this.Wc()){const t=this.part;null!==t&&this.ba(t,"geometryString")}}get geometryString(){return null===this.geometry?"":this.geometry.toString()}set geometryString(t){const e=C.parse(t),i=e.normalize();this.geometry=e;const s=y.V(-i.x,-i.y);this.position=s,y.e(s)}get isGeometryPositioned(){return 0!==(1048576&this.n)}set isGeometryPositioned(t){const e=0!==(1048576&this.n);e!==t&&(this.n=1048576^this.n,this.c(),this.t("isGeometryPositioned",e,t))}ee(){this.ot=null}get fill(){return this.Ta}set fill(t){const e=this.Ta;e!==t&&(null!==t&&jt.Qu(t,"Shape.fill"),t instanceof jt&&t.u(),this.Ta=t,this.S(),this.t("fill",e,t))}get stroke(){return this.Hi}set stroke(t){const e=this.Hi;e!==t&&(null!==t&&jt.Qu(t,"Shape.stroke"),t instanceof jt&&t.u(),this.Hi=t,this.S(),this.t("stroke",e,t))}get strokeWidth(){return this.Uo}set strokeWidth(t){const i=this.Uo;if(i!==t)if(t>=0){this.Uo=t,this.c();const e=this.part;null!==e&&e.cf(),this.t("strokeWidth",i,t)}else e.W(t,"value >= 0",he,"strokeWidth:value")}p0(){return this.Uo}get strokeCap(){return null!==this.Ht?this.Ht.fp:"butt"}set strokeCap(t){const i=this.strokeCap;i!==t&&("string"!=typeof t||"butt"!==t&&"round"!==t&&"square"!==t?e.W(t,'"butt", "round", or "square"',he,"strokeCap"):(this.Da().fp=t,this.S(),this.t("strokeCap",i,t)))}get strokeJoin(){return null!==this.Ht?this.Ht.dp:"miter"}set strokeJoin(t){const i=this.strokeJoin;i!==t&&("string"!=typeof t||"miter"!==t&&"bevel"!==t&&"round"!==t?e.W(t,'"miter", "bevel", or "round"',he,"strokeJoin"):(this.Da().dp=t,this.S(),this.t("strokeJoin",i,t)))}get strokeMiterLimit(){return null!==this.Ht?this.Ht.gp:10}set strokeMiterLimit(t){const e=this.strokeMiterLimit;if(e!==t&&t>=1){this.Da().gp=t,this.S();const i=this.part;null!==i&&i.cf(),this.t("strokeMiterLimit",e,t)}}get strokeDashArray(){return this.Oo}set strokeDashArray(t){const i=this.Oo;if(i!==t){if(null!==t&&!Array.isArray(t)&&e.Zi(t,"Array",he,"strokeDashArray:value"),null!==t){const s=t.length;let n=0;for(let i=0;i<s;i++){const s=t[i];(!(s>=0)||!isFinite(s))&&e.o("strokeDashArray:value "+s+" at index "+i+" must be a positive number or zero."),n+=s}if(0===n){if(null===i)return;t=null}}this.Oo=t,this.S(),this.t("strokeDashArray",i,t)}}get strokeDashOffset(){return null!==this.Ht?this.Ht.mh:0}set strokeDashOffset(t){const e=this.strokeDashOffset;e!==t&&t>=0&&(this.Da().mh=t,this.S(),this.t("strokeDashOffset",e,t))}get figure(){return this.gd}set figure(t){const i=this.gd;if(i!==t){let s=S.In[t];if(e.it(s)?s=t:(s=S.In[t.toLowerCase()],s||e.o("Unknown Shape.figure: "+t)),i!==s){const t=this.part;null!==t&&t.cf(),this.gd=s,this.ks=null,this.ee(),this.c(),this.t("figure",i,s)}}}get toArrow(){return null!==this.Ot?this.Ot.mp:"None"}set toArrow(t){const i=this.toArrow;if(!0===t?t="Standard":!1===t&&(t=""),i!==t){const s=he.qA(t);null===s?e.o("Unknown Shape.toArrow: "+t):i!==s&&(null===this.Ot&&(this.Ot=new Ie),this.Ot.mp=s,this.ks=null,this.ee(),this.c(),this.WA(s),this.t("toArrow",i,s))}}get fromArrow(){return null!==this.Ot?this.Ot.pp:"None"}set fromArrow(t){const i=this.fromArrow;if(!0===t?t="Standard":!1===t&&(t=""),i!==t){const s=he.qA(t);null===s?e.o("Unknown Shape.fromArrow: "+t):i!==s&&(null===this.Ot&&(this.Ot=new Ie),this.Ot.pp=s,this.ks=null,this.ee(),this.c(),this.WA(s),this.t("fromArrow",i,s))}}WA(t){const e=this.diagram;if(null!==e&&e.undoManager.isUndoingRedoing)return;this.tv();const i=w.MiddleRight;"None"!==this.toArrow?(this.segmentIndex=-1,this.alignmentFocus=i):"None"!==this.fromArrow&&(this.segmentIndex=0,this.alignmentFocus=new w(1-i.x,i.y))}get spot1(){return null!==this.Ht?this.Ht.En:w.Default}set spot1(t){const e=this.spot1;e.equals(t)||(t=t.P(),this.Da().En=t,this.c(),this.t("spot1",e,t))}get spot2(){return null!==this.Ht?this.Ht.Bn:w.Default}set spot2(t){const e=this.spot2;e.equals(t)||(t=t.P(),this.Da().Bn=t,this.c(),this.t("spot2",e,t))}get parameter1(){return this.md}set parameter1(t){const e=this.md;e!==t&&(this.md=t,this.ee(),this.c(),this.t("parameter1",e,t))}get parameter2(){return this.pd}set parameter2(t){const e=this.pd;e!==t&&(this.pd=t,this.ee(),this.c(),this.t("parameter2",e,t))}get naturalBounds(){return this.zi}bv(){const t=this.desiredSize;if(t.isReal()||null===this.ot)this.zi.i(0,0,t.width,t.height);else{const t=this.ot.bounds;this.zi.a(t)}}get pathPattern(){return null!==this.Ht?this.Ht.yp:null}set pathPattern(t){const e=this.pathPattern;e!==t&&(this.Da().yp=t,this.S(),this.t("pathPattern",e,t))}get geometryStretch(){return null!==this.Ht?this.Ht.wp:1}set geometryStretch(t){const e=this.geometryStretch;e!==t&&(this.Da().wp=t,this.c(),this.t("geometryStretch",e,t))}get interval(){return null!==this.G?this.G.uf:1}set interval(t){const e=this.interval;if(t=Math.round(t),e!==t&&0!==t&&isFinite(t)){null===this.G&&(this.G=new pe),this.G.uf=t;const i=this.diagram;null!==i&&this.panel===i.grid&&i._l(),this.c();const s=this.panel;null!==s&&(s.ss=null),this.t("interval",e,t)}}get graduatedStart(){return null!==this.G?this.G.df:0}set graduatedStart(t){const e=this.graduatedStart;e!==t&&(t<0?t=0:t>1&&(t=1),null===this.G&&(this.G=new pe),this.G.df=t,this.c(),this.t("graduatedStart",e,t))}get graduatedEnd(){return null!==this.G?this.G.gf:1}set graduatedEnd(t){const e=this.graduatedEnd;e!==t&&(t<0?t=0:t>1&&(t=1),null===this.G&&(this.G=new pe),this.G.gf=t,this.c(),this.t("graduatedEnd",e,t))}get graduatedSkip(){return null!==this.G?this.G.mf:null}set graduatedSkip(t){const i=this.graduatedSkip;i!==t&&(null!==t&&e.k(t,he,"graduatedSkip"),null===this.G&&(this.G=new pe),this.G.mf=t,this.c(),this.t("graduatedSkip",i,t))}static Vv(t,i,s){let n=null;if("None"!==t.toArrow)n=he.gn[t.toArrow];else if("None"!==t.fromArrow)n=he.gn[t.fromArrow];else{let o=S.In[t.figure];"string"==typeof o&&(o=S.In[o]),void 0===o&&e.o("Unknown Shape.figure: "+t.figure),n=o(t,i,s),n.rc=i,n.lc=s}if(null===n){const o=S.In.Rectangle;e.it(o)&&(n=o(t,i,s))}return n}static getFigureGenerators(){const t=new m;for(const e in S.In){if(e===e.toLowerCase())continue;const i=S.In[e];t.set(e,i)}return t.u(),t}static defineFigureGenerator(t,i){e.s(t,"string",he,"defineFigureGenerator:name"),"string"==typeof i||e.k(i,he,"defineFigureGenerator:func");const s=t.toLowerCase(),n=S.In;n[t]=i,n[s]=t}static isFigureDefined(t){return S.In.has(t)}static getArrowheadGeometries(){const t=new m;for(const e in S.Ug)if(void 0===he.gn[e]){const t=C.parse(S.Ug[e],!1);he.gn[e]=t;const i=e.toLowerCase();i!==e&&(he.gn[i]=e)}for(const e in he.gn){if(e===e.toLowerCase())continue;const i=he.gn[e];i instanceof C&&t.set(e,i)}return t.u(),t}static defineArrowheadGeometry(t,i){e.s(t,"string",he,"defineArrowheadGeometry:name");let s=null;"string"==typeof i?(e.s(i,"string",he,"defineArrowheadGeometry:pathstr"),s=C.parse(i,!1)):s=i;const n=t.toLowerCase();("none"===n||t===n)&&e.o("Shape.defineArrowheadGeometry name must not be empty or None or all-lower-case: "+t);const o=he.gn;o[t]=s,o[n]=t}static isArrowheadDefined(t){return he.gn.has(t)}static gn=new s;static j2=new s;static qA(t){let e=he.gn[t];if(void 0===e){const i=t.toLowerCase();if("none"===i)return"None";if(e=he.gn[i],void 0===e){let t=null;for(const e in S.Ug)if(e.toLowerCase()===i){t=e;break}if(null!==t){const e=C.parse(S.Ug[t],!1);return he.gn[t]=e,i!==t&&(he.gn[i]=t),t}}}return"string"==typeof e?e:e instanceof C?t:null}}class le{fi;fp;dp;gp;mh;yp;wp;En;Bn;constructor(){this.fi=!1,this.fp="butt",this.dp="miter",this.gp=10,this.mh=0,this.yp=null,this.wp=1,this.En=w.Default,this.Bn=w.Default}copy(){const t=new le;return t.fp=this.fp,t.dp=this.dp,t.gp=this.gp,t.mh=this.mh,t.yp=this.yp,t.wp=this.wp,t.En=this.En.P(),t.Bn=this.Bn.P(),t}}var ue=(t=>(t[t.None=0]="None",t[t.Fit=1]="Fit",t[t.DesiredSize=2]="DesiredSize",t[t.BreakAll=3]="BreakAll",t))(ue||{}),ce=(t=>(t[t.Clip=0]="Clip",t[t.Ellipsis=1]="Ellipsis",t))(ce||{}),de=(t=>(t[t.Trim=0]="Trim",t[t.None=1]="None",t))(de||{});class fe extends Tt{ri;Hi;mn;ge;ui;y0;wd;G;rt;Tl;to;pn;Ce;Ti;yn;constructor(t,e){return super(),this.n|=2097152,this.ri="",this.Hi="black",this.mn="13px sans-serif",this.ge=0,this.ui=0,this.y0=0,this.wd=null,this.G=null,this.rt=null,this.Tl=0,this.to=null,this.pn=0,this.Ce=null,this.Ti=null,this.yn=null,"string"==typeof t?this.text=t:t&&Object.assign(this,t),e&&Object.assign(this,e),this}cloneProtected(t){super.cloneProtected(t),t.ri=this.ri,t.Hi=this.Hi,t.mn=this.mn,t.ge=this.ge,t.ui=this.ui,t.y0=this.y0,t.wd=this.wd,null!==this.G&&(t.G=this.G.copy()),null!==this.rt&&(this.rt.fi?t.rt=this.rt:t.rt=this.rt.copy()),t.Tl=this.Tl,t.to=this.to,t.pn=this.pn,t.Ce=this.Ce,t.Ti=this.Ti,t.yn=this.yn}wn(){return null===this.rt?this.rt=new ge:this.rt.fi&&(this.rt=this.rt.copy()),this.rt}ah(){super.ah(),null!==this.rt&&(this.rt.fi=!0)}Lv(t){this.n=6144|t.n,this.$t=t.opacity,this.Lt=t.background,this.is=t.desiredSize.P(),this.minSize=t.minSize.P(),this.maxSize=t.maxSize.P(),null!==t.wi?this.wi=t.wi.copy():this.wi=null,this.tt=t.scale,this.Yt=t.angle,this.stretch=t.stretch,this.jr=t.margin.P(),this.hi=t.alignment.P(),this.Hu=t.alignmentFocus.P(),this.segmentFraction=t.segmentFraction,this.segmentOffset=t.segmentOffset.P(),this.segmentOrientation=t.segmentOrientation,null!==t.si&&(this.si=t.si.copy()),this.shadowVisible=t.shadowVisible,this.ri=t.ri,this.Hi=t.Hi,this.mn=t.mn,null!==this.G&&(this.G=t.G.copy()),null!==t.rt&&(t.rt.fi?this.rt=t.rt:this.rt=t.rt.copy()),this.Tl=t.Tl}Nv(t){if(this.ri=t.text||"",this.Yt=t.labelAngle||0,this.ge=t.lineCount||0,this.Kv(t.lines),t.naturalBounds&&(this.zi=t.naturalBounds),t.actualBounds){const e=t.actualBounds;this.Ut(e.x,e.y,e.width,e.height)}}oi(t){t in ue?this.wrap=t:super.oi(t)}toString(){return this.ri.length>22?'TextBlock("'+this.ri.substring(0,20)+'"...)':'TextBlock("'+this.ri+'")'}static getEllipsis(){return fe.xp}static setEllipsis(t){fe.xp=t,fe.o1=new s,fe.q2=0}static getBaseline(){return fe.l1}static setBaseline(t){fe.l1=t}static l1=null;static getUnderline(){return fe.h1}static setUnderline(t){fe.h1=t}static h1=null;static None=0;static WrapFit=1;static WrapDesiredSize=2;static WrapBreakAll=3;static OverflowClip=0;static OverflowEllipsis=1;static FormatTrim=0;static FormatNone=1;c(){super.c(),this.Ve(!0)}get font(){return this.mn}set font(t){const e=this.mn;e!==t&&(this.mn=t,this.to=null,this.c(),this.t("font",e,t))}static isValidFont(e){return!t.CSS||t.CSS.supports("font",e)}get text(){return this.ri}set text(t){const e=this.ri;t=null!=t?t.toString():"",e!==t&&(this.ri=t,this.c(),this.t("text",e,t))}get textAlign(){return null!==this.rt?this.rt.bp:"start"}set textAlign(t){const e=this.textAlign;e!==t&&("start"===t||"end"===t||"left"===t||"right"===t||"center"===t)&&(this.wn().bp=t,this.S(),this.t("textAlign",e,t))}get flip(){return null!==this.rt?this.rt.io:0}set flip(t){const e=this.flip;e!==t&&(this.wn().io=t,this.S(),this.t("flip",e,t))}get verticalAlignment(){return null!==this.rt?this.rt._r:w.Top}set verticalAlignment(t){const e=this.verticalAlignment;e.equals(t)||(t=t.P(),this.wn()._r=t,this.ef(),this.t("verticalAlignment",e,t))}get naturalBounds(){if(!this.zi.isReal()){const t=v.l();this.W2(this.ri,999999,t);let e=t.width;v.e(t);let i=this.JA(e);const s=this.desiredSize;isNaN(s.width)||(e=s.width),isNaN(s.height)||(i=s.height),this.zi.Fn(e,i)}return this.zi}get isMultiline(){return 0!==(2097152&this.n)}set isMultiline(t){const e=0!==(2097152&this.n);e!==t&&(this.n=2097152^this.n,this.c(),this.t("isMultiline",e,t))}get isUnderline(){return 0!==(4194304&this.n)}set isUnderline(t){const e=0!==(4194304&this.n);e!==t&&(this.n=4194304^this.n,this.Ve(!0),this.S(),this.t("isUnderline",e,t))}get isStrikethrough(){return 0!==(8388608&this.n)}set isStrikethrough(t){const e=0!==(8388608&this.n);e!==t&&(this.n=8388608^this.n,this.Ve(!0),this.S(),this.t("isStrikethrough",e,t))}get wrap(){return null!==this.rt?this.rt.kp:2}set wrap(t){const e=this.wrap;e!==t&&(this.wn().kp=t,this.c(),this.t("wrap",e,t))}get overflow(){return null!==this.rt?this.rt.Pp:0}set overflow(t){const e=this.overflow;e!==t&&(this.wn().Pp=t,this.c(),this.t("overflow",e,t))}get isOverflowed(){return 0!==(16777216&this.n)}J2(t){t?this.n|=16777216:this.n&=-16777217}get stroke(){return this.Hi}set stroke(t){const e=this.Hi;e!==t&&(null!==t&&jt.Qu(t,"TextBlock.stroke"),t instanceof jt&&t.u(),this.Hi=t,"string"!=typeof t&&this.Qc(),this.S(),this.t("stroke",e,t))}get lineCount(){return this.ge}get lineHeight(){return this.Sp()}get editable(){return 0!==(1048576&this.n)}set editable(t){const e=0!==(1048576&this.n);e!==t&&(this.n=1048576^this.n,this.t("editable",e,t))}get U2(){return 0!==(33554432&this.n)}set U2(t){this.n=33554432^this.n}get textEditor(){return null!==this.rt?this.rt.Mp:null}set textEditor(t){const e=this.textEditor;e!==t&&(this.wn().Mp=t,this.t("textEditor",e,t))}get errorFunction(){return null!==this.rt?this.rt.ns:null}set errorFunction(t){const i=this.errorFunction;i!==t&&(null!==t&&e.k(t,fe,"errorFunction"),this.wn().ns=t,this.t("errorFunction",i,t))}get interval(){return null!==this.G?this.G.uf:1}set interval(t){const e=this.interval;if(t=Math.round(t),e!==t&&0!==t&&isFinite(t)){null===this.G&&(this.G=new pe),this.G.uf=t,this.c();const i=this.panel;null!==i&&(i.ss=null),this.t("interval",e,t)}}get graduatedStart(){return null!==this.G?this.G.df:0}set graduatedStart(t){const e=this.graduatedStart;e!==t&&(t<0?t=0:t>1&&(t=1),null===this.G&&(this.G=new pe),this.G.df=t,this.c(),this.t("graduatedStart",e,t))}get graduatedEnd(){return null!==this.G?this.G.gf:1}set graduatedEnd(t){const e=this.graduatedEnd;e!==t&&(t<0?t=0:t>1&&(t=1),null===this.G&&(this.G=new pe),this.G.gf=t,this.c(),this.t("graduatedEnd",e,t))}get graduatedFunction(){return null!==this.G?this.G.Np:null}set graduatedFunction(t){const i=this.graduatedFunction;i!==t&&(null!==t&&e.k(t,fe,"graduatedFunction"),null===this.G&&(this.G=new pe),this.G.Np=t,this.c(),this.t("graduatedFunction",i,t))}get graduatedSkip(){return null!==this.G?this.G.mf:null}set graduatedSkip(t){const i=this.graduatedSkip;i!==t&&(null!==t&&e.k(t,fe,"graduatedSkip"),null===this.G&&(this.G=new pe),this.G.mf=t,this.c(),this.t("graduatedSkip",i,t))}dh(t,e){if(null===this.Hi||0===this.ri.length||null===this.mn)return;const i=this.naturalBounds,s=this.actualBounds,n=i.width,o=i.height,r=this.Sp();let a=t.textAlign=this.textAlign;const h=e.zu;"start"===a?a=h?"right":"left":"end"===a&&(a=h?"left":"right");const l=this.isUnderline,u=this.isStrikethrough;this.rn(t,this.Hi,!0,!1,i,s),(l||u)&&this.rn(t,this.Hi,!1,!1,i,s);const c=0;let d=0;const f=n;let g=!1;e.Qt===t&&!(e.Qt instanceof Et)&&!this.U2&&!0===e.getRenderingHint("textGreeking")&&r*this.da*e.scale<3&&(g=!0);const p=this.spacingAbove,m=this.spacingBelow;switch(this.flip){case 0:break;case 2:t.translate(n,0),t.scale(-1,1);break;case 1:t.translate(0,o),t.scale(1,-1);break;case 3:t.translate(n,o),t.scale(-1,-1);break}t.commitTransform();const y=this.ge,v=(p+r+m)*y;if(o>v){const t=this.verticalAlignment;d=t.y*o-t.y*v+t.offsetY}if(1===y&&null!==this.yn){let e=this.ui;e>f&&(e=f),d+=p,this.$A(this.yn,t,c,d,f,r,e,g,a,l,u)}else if(null!==this.Ce&&null!==this.Ti)for(let x=0;x<y;x++){let e=this.Ce[x];e>f&&(e=f),d+=p,this.$A(this.Ti[x],t,c,d,f,r,e,g,a,l,u),d+=r+m}switch(this.flip){case 0:break;case 2:t.scale(-1,1),t.translate(-n,0);break;case 1:t.scale(1,-1),t.translate(0,-o);break;case 3:t.scale(-1,-1),t.translate(-n,-o);break}}$A(t,e,i,s,n,o,r,a,h,l,u){let c=0;if(a){"left"===h?c=0:"right"===h?c=n-r:"center"===h&&(c=(n-r)/2);const t=e.globalAlpha;return e.globalAlpha=t/2,e.fillRect(i+c,s+o/4,r,o/2),void(e.globalAlpha=t)}"left"===h?c=0:"right"===h?c=n:"center"===h&&(c=n/2);const d=null!==fe.l1?fe.l1(this,o):.75*o;e.fillText(t,i+c,s+d);let f=o/20|0;if(0===f&&(f=1),"right"===h?c-=r:"center"===h&&(c-=r/2),l){const t=null!==fe.h1?fe.h1(this,o):.8*o;this.ZA(i+c,s+t,i+c+r,s+t,f,e),e instanceof Et&&e.lastCreatedElement.classList.add("gojs-td")}if(u){let t=s+o-o/2.2|0;f%2!==0&&(t+=.5),this.ZA(i+c,t,i+c+r,t,f,e),e instanceof Et&&e.lastCreatedElement.classList.add("gojs-td")}}ZA(t,e,i,s,n,o){o.beginPath(),o.lineWidth=n,o.moveTo(t,e),o.lineTo(i,s),o.stroke(),o.endPath()}Zc(t,e,i){if(!super.Zc(t,e,i))return!1;if(this.rn(t,this.Hi,!0,!1,this.naturalBounds,this.actualBounds),i){if(0===this.svg.getElementsByTagName("text").length)return!0;const e=this.svg.getElementsByClassName("gojs-td");for(let i=0;i<e.length;i++)t.setFillOrStrokeInPlace(e[i],!1)}else this.Gv(this.svg,this.text,t);return!0}Gv(t,e,i){t.innerHTML=e,i.setFillOrStrokeInPlace(t,!0)}$u(t){return!!(this.lineCount>1||this.isUnderline||this.isStrikethrough)||super.$u(t)}b2(t,e){if("g"!==t.nodeName)t.setAttributeNS(null,"filter",e);else{const i=t.getElementsByTagName("text");for(let t=0;t<i.length;t++)i[t].setAttributeNS(null,"filter",e)}}Hv(){this.pn=0,this.ui=0,this.to=null,this.Ce=null,this.Ti=null,this.yn=null}Wu(t,e,i,s){const n=this.ge;this.Tl=t,this.J2(!1);const o=this.mn;null!==fe.$r&&fe.QA!==o&&(fe.$r.font=o,fe.QA=o),this.Hv();let r=0,a=0;isNaN(this.desiredSize.width)?(r=this.jv(),r=Math.min(r,t/this.scale)):r=this.desiredSize.width,null!==this.panel&&(r=Math.min(r,this.panel.maxSize.width)),a=this.JA(r),a=isNaN(this.desiredSize.height)?Math.min(a,e/this.scale):this.desiredSize.height,this.qv(t,a),(1===this.wrap||isNaN(this.desiredSize.width))&&(r=isNaN(t)?this.ui:Math.min(t,this.ui)),r=Math.max(i,r),a=Math.max(s,a),this.zi.Fn(r,a),this.Wn(0,0,r,a),null!==this.svg&&n!==this.ge&&this.Ve(!0)}fh(t,e,i,s){this.commonArrange(t,e,i,s)}xn(t,e){null===this.yn?(this.yn=t,this.ui=e):((null===this.Ti||null===this.Ce)&&(this.Ti=[],this.Ce=[],this.Ti.push(this.yn),this.Ce.push(this.ui)),this.Ti.push(t),this.Ce.push(e),this.Ti.length>this.maxLines&&(this.n|=16777216))}W2(t,e,i){const s=0===this.formatting;s&&(t=t.trim());let n=0,o=0,r=0;const a=this.mn,h=this.spacingAbove+this.spacingBelow,l=Math.max(0,this.Sp()+h),u=1===this.overflow?this._A(a):0;if(this.ge>=this.maxLines)return void(null!==i&&i.i(0,l));let c=t;if(0===this.wrap){if(this.pn=1,o=this.getStringWidth(t),0===u||o<=e)return this.ui=Math.max(this.ui,o),this.xn(t,this.ui),void(null!==i&&i.i(o,l));let n=this.xd(c);c=c.substring(n.length);let a=this.xd(c);for(o=this.getStringWidth(n+a),r=0;a.length>0&&o<=e;){n+=a,c=c.substring(a.length),a=this.xd(c),r=o;let t=n+a;s&&(t=t.trim()),o=this.getStringWidth(t)}for(s&&(a=a.trim()),n+=a,e=Math.max(1,e-u);this.getStringWidth(n)>e&&n.length>1;)n=n.substring(0,n.length-1);return this.J2(!0),n+=fe.xp,r=this.getStringWidth(n),this.ui=r,this.xn(n,r),void(null!==i&&i.i(r,l))}let d=0;for(0===c.length&&(d=1,this.xn(c,0));c.length>0;){let t=this.xd(c);for(c=c.substring(t.length);this.getStringWidth(t)>e;){let i=1;for(o=this.getStringWidth(t.substring(0,i)),r=0;o<=e;)i++,r=o,o=this.getStringWidth(t.substring(0,i));let s=0;1===i?(s=o,n=Math.max(n,o)):(s=r,n=Math.max(n,r)),i--,i<1&&(i=1);const a=t.substring(0,i);if(this.xn(a,s),d++,t=t.substring(i),this.ge+d>this.maxLines)break}let i=this.xd(c);for(o=this.getStringWidth(t+i),r=0;i.length>0&&o<=e;){t+=i,c=c.substring(i.length),i=this.xd(c),r=o;let e=t+i;s&&(e=e.trim()),o=this.getStringWidth(e)}if(s&&(t=t.trim()),""===t)continue;""===t[t.length-1]&&(t=t.substring(0,t.length-1)+"");let a=0;if(0===i.length?(a=o,n=Math.max(n,o)):(r=this.getStringWidth(t),a=r,n=Math.max(n,r)),this.xn(t,a),d++,this.ge+d>this.maxLines)break}this.pn=Math.min(this.maxLines-this.ge,d),this.ui=Math.max(this.ui,n),null!==i&&i.i(this.ui,l*this.pn)}qv(t,e){if(0===this.ui||null===this.Ce||null===this.Ti||1!==this.overflow)return;const i=this.mn,s=1===this.overflow?this._A(i):0,n=this.spacingAbove+this.spacingBelow,o=Math.max(0,this.Sp()+n),r=Math.min(this.maxLines-1,Math.max(Math.floor(e/o+.01)-1,0));if(r+1>=this.Ti.length)return;this.J2(!0);let a=this.Ti[r];const h=Math.max(1,t-s);for(;this.getStringWidth(a)>h&&a.length>1;)a=a.substring(0,a.length-1);a+=fe.xp;const l=this.getStringWidth(a);this.Ti[r]=a,this.Ti=this.Ti.slice(0,r+1),this.Ce[r]=l,this.Ce=this.Ce.slice(0,r+1),this.pn=this.Ti.length,this.ui=Math.max(this.ui,l),this.ge=this.pn,1===this.ge&&(this.yn=this.Ti[0])}xd(t){if(3===this.wrap)return t.substring(0,1);let e=t.length,i=0;const s=fe.Wv;for(;i<e&&!s.test(t.charAt(i));)i++;for(1===this.formatting&&(e=Math.min(e,i+1));i<e&&s.test(t.charAt(i));)i++;return i>=t.length?t:t.substring(0,i)}getStringWidth(t){return null===fe.$r?8*t.length:fe.$r.measureText(t).width}Sp(){if(null!==this.to)return this.to;const t=this.mn;let e=0;return null===fe.$r?(e=16,this.to=e,e):(void 0!==fe.$2[t]&&fe.tT<5e3?e=fe.$2[t]:(e=1.3*fe.$r.measureText("M").width,fe.$2[t]=e,fe.tT++),this.to=e,e)}_A(t){if(null===fe.$r)return 6;let e=0;return void 0!==fe.o1[t]&&fe.q2<5e3?e=fe.o1[t]:(e=fe.$r.measureText(fe.xp).width,fe.o1[t]=e,fe.q2++),e}a1(t,e){return t.indexOf("\n",e)}JA(t){let e=this.ri.replace(/\r\n/g,"\n").replace(/\r/g,"\n");const i=this.spacingAbove+this.spacingBelow,s=Math.max(0,this.Sp()+i);if(0===e.length)return this.ui=0,this.ge=1,s;if(!this.isMultiline){const t=this.a1(e,0);t>=0&&(e=e.substring(0,t))}let n=0;this.ge=0;let o=0,r=-1,a=!1;for(;!a;){if(r=this.a1(e,o),-1===r&&(r=e.length,a=!0),o<=r){const i=e.substring(o,r);if(0!==this.wrap){this.pn=0;const e=v.l();this.W2(i,t,e),n+=e.height,v.e(e),this.ge+=this.pn}else this.W2(i,t,null),n+=s,this.ge++;this.ge===this.maxLines&&(a=!0)}o=r+1}return this.y0=n,n}jv(){let t=this.ri.replace(/\r\n/g,"\n").replace(/\r/g,"\n");if(0===t.length)return 8;if(this.isMultiline){let e=0,i=0,s=!1;for(;!s;){let n=this.a1(t,i);-1===n&&(n=t.length,s=!0);let o=t.substring(i,n);0===this.formatting&&(o=o.trim()),e=Math.max(e,this.getStringWidth(o)),i=n+1}return e}{const e=this.a1(t,0);return e>=0&&(t=t.substring(0,e)),this.getStringWidth(t)}}get textValidation(){return null!==this.rt?this.rt.Al:null}set textValidation(t){const i=this.textValidation;i!==t&&(null!==t&&e.k(t,fe,"textValidation"),this.wn().Al=t,this.t("textValidation",i,t))}get textEdited(){return null!==this.rt?this.rt.Cp:null}set textEdited(t){const i=this.textEdited;i!==t&&(null!==t&&e.k(t,fe,"textEdited"),this.wn().Cp=t,this.t("textEdited",i,t))}get spacingAbove(){return null!==this.rt?this.rt.Lp:0}set spacingAbove(t){const e=this.spacingAbove;e!==t&&(this.wn().Lp=t,this.c(),this.t("spacingAbove",e,t))}get spacingBelow(){return null!==this.rt?this.rt.Ap:0}set spacingBelow(t){const e=this.spacingBelow;e!==t&&(this.wn().Ap=t,this.c(),this.t("spacingBelow",e,t))}get formatting(){return null!==this.rt?this.rt.Tp:0}set formatting(t){const e=this.formatting;e!==t&&(this.wn().Tp=t,this.c(),this.t("formatting",e,t))}get maxLines(){return null!==this.rt?this.rt.Dp:1/0}set maxLines(t){const i=this.maxLines;i!==t&&(t=Math.floor(t),t<=0&&e.W(t,"> 0",fe,"maxLines"),this.wn().Dp=t,this.c(),this.t("maxLines",i,t))}getMetrics(){return[this.ui,this.Tl,this.to,this.pn,this.Ce,this.Ti,this.yn]}Kv(t){void 0!==t&&(this.ui=t[0],this.Tl=t[1],this.to=t[2],this.pn=t[3],this.Ce=t[4],this.Ti=t[5],this.yn=t[6])}get metrics(){return{arrSize:null!==this.Ce?this.Ce:[this.ui],arrText:null!==this.Ti?this.Ti:[this.yn],maxLineWidth:this.ui,fontHeight:this.to}}get choices(){return this.wd}set choices(t){const e=this.wd;e!==t&&(this.wd=t,this.t("choices",e,t))}static Wv=new RegExp("[ ]");static $2=new s;static tT=0;static o1=new s;static q2=0;static xp="...";static QA="";static $r=vt.isUsingDOM()?new Bt(null).li:null}class ge{fi;ns;io;Tp;Dp;Pp;Lp;Ap;bp;Cp;Mp;Al;_r;kp;constructor(){this.fi=!1,this.ns=null,this.io=0,this.Tp=0,this.Dp=1/0,this.Pp=0,this.Lp=0,this.Ap=0,this.bp="start",this.Cp=null,this.Mp=null,this.Al=null,this._r=w.Top,this.kp=2}copy(){const t=new ge;return t.ns=this.ns,t.io=this.io,t.Tp=this.Tp,t.Dp=this.Dp,t.Pp=this.Pp,t.Lp=this.Lp,t.Ap=this.Ap,t.bp=this.bp,t.Cp=this.Cp,t.Mp=this.Mp,t.Al=this.Al,t._r=this._r,t.kp=this.kp,t}}class pe{uf;df;gf;Np;mf;constructor(){this.uf=1,this.df=0,this.gf=1,this.Np=null,this.mf=null}copy(){const t=new pe;return t.uf=this.uf,t.df=this.df,t.gf=this.gf,t.Np=this.Np,t.mf=this.mf,t}}var me=(t=>(t[t.None=0]="None",t[t.Fill=2]="Fill",t[t.Uniform=6]="Uniform",t[t.UniformToFill=7]="UniformToFill",t))(me||{});class ye extends Tt{tl;dt;il;pf;ns;el;yf;io;wf;xf;Xb;constructor(t,e){super(),this.n|=2097152,this.tl=null,this.dt="",this.il=x.JD,this.pf=2,this.ns=null,this.el=null,this.yf=w.Center,this.io=0,this.wf=null,this.xf=null,this.Xb=null,"string"==typeof t?this.source=t:t&&Object.assign(this,t),e&&Object.assign(this,e)}cloneProtected(t){super.cloneProtected(t),t.dt=this.dt,t.element=this.tl,t.il=this.il.P(),t.pf=this.pf,t.io=this.io,t.ns=this.ns,t.el=this.el,t.yf=this.yf.P(),t.xf=this.xf}oi(t){t in me?this.imageStretch=t:super.oi(t)}toString(){return"Picture("+this.source+")#"+u.as(this)}get bf(){return 0!==(1048576&this.n)}set bf(t){this.bf!==t&&(this.n=1048576^this.n)}get Fp(){return 0!==(2097152&this.n)}set Fp(t){this.Fp!==t&&(this.n=2097152^this.n)}get hn(){return 0!==(4194304&this.n)}set hn(t){this.hn!==t&&(this.n=4194304^this.n)}static clearCache(t){void 0===t&&(t=""),e.s(t,"string",ye,"clearCache:url"),""!==t?ye.Rp[t]&&(delete ye.Rp[t],ye.c1--):(ye.Rp=new s,ye.c1=0)}static tA(t,e){e.iT||(e.f1=i=>{ye.Jv(e,i),t.desiredSize.isReal()||(t.ue(!1),t.c())},e.u1=t=>ye.$v(e,t),e.addEventListener("load",e.f1),e.addEventListener("error",e.u1),e.iT=!0)}static BR(t){t.f1&&t.removeEventListener("load",t.f1),t.u1&&t.removeEventListener("error",t.u1),delete t.f1,delete t.u1,delete t.iT}get element(){return this.tl}set element(t){const i=this.tl;if(this.Ve(!0),i!==t){this.bf=t instanceof HTMLCanvasElement;const s=t instanceof HTMLImageElement;null!==t&&!(s||t instanceof HTMLVideoElement||this.bf)&&e.o("Picture.element must be an instance of Image, Canvas, or Video, not: "+t);const n=this.diagram;null!==n&&n.YM(this),this.tl=t,null!==t&&s&&void 0===t.ts&&(t.ts=new u),null!==n&&s&&n.XM(this),this.t("element",i,t),this.S()}}IR(){const t=this.tl;if(null===t)return;const e=this.desiredSize.isReal();(this.bf||!0===t.complete)&&(t.o0&&(t.vp instanceof Event&&null!==this.ns?this.ns(this,t.vp):!0===t.hn&&!t.vp&&null!==this.el&&t.Z2&&this.el(this,t.Z2)),t.hn=!0),t.hn&&e&&null!==this.diagram&&this.diagram.Vu.add(this)}Zv(){if(null===this.tl)return void(this.wf=!1);const t=new Bt(null).li;try{t.drawImage(this.tl,0,0)}catch{this.Fp=!1}try{t.getImageData(0,0,1,1).data[3]&&(this.wf=!1),this.wf=!1}catch{this.wf=!0}}get source(){return this.dt}set source(t){const i=this.dt;if(i!==t){this.Ve(!0),e.s(t,"string",ye,"source"),this.dt=t;let s=ye.Rp;if(!vt.isUsingDOM())return void this.t("source",i,t);let n=null;if(void 0!==s[t])n=s[t];else if(""!==t){ye.c1>30&&(ye.clearCache(),s=ye.Rp),n=e.hs("img"),n.o0=!0,ye.tA(this,n);const i=this.xf;null!==i&&(n.crossOrigin=i(this)),n.src=t,s[t]=n,ye.c1++}this.element=n,null!==n&&void 0===n.__goCache&&(n.__goCache=new ve),this.c(),this.S(),this.t("source",i,t)}}static Jv(t,e){let i;t.hn=!0,t.vp=!1;const s=t.ts.copy();if(null==s)return;const n=s.iterator;for(;n.next();){const s=n.value;s.S();const o=t.getAttribute("src")||"",r=s.Wl.get(o);if(null===r)continue;const a=r.length;for(let n=0;n<a;n++)i=r[n],i.desiredSize.isReal()||s.Vu.add(i),i.Ve(!0),s.requestUpdate(),t.o0&&(void 0===t.Z2&&(t.Z2=e),null!==i.el&&i.el(i,e))}t.ts.clear()}static $v(t,i){let s;t.vp=i;const n=t.ts.copy();if(null==n)return;const o=n.iterator;for(;o.next();){const n=o.value,r=t.getAttribute("src")||"",a=n.Wl.get(r);if(null===a)continue;const h=a.length,l=e.et();for(let t=0;t<h;t++)l.push(a[t]);if(t.o0)for(let t=0;t<h;t++)s=l[t],null!==s.ns&&s.ns(s,i);e.J(l)}t.ts.clear()}reloadSource(){if(""===this.source)return;ye.clearCache(this.source);const t=this.source;this.source="",this.source=t}redraw(){this.S(),this.Ve(!0)}get sourceCrossOrigin(){return this.xf}set sourceCrossOrigin(t){if(this.xf!==t&&(null!==t&&e.k(t,ye,"sourceCrossOrigin"),this.xf=t,null!==this.element)){const e=this.element.getAttribute("src");null===t&&"string"==typeof e?this.element.crossOrigin=null:null!==t&&(this.element.crossOrigin=t(this)),this.element.src=e}}get sourceRect(){return this.il}set sourceRect(t){const e=this.il;e.equals(t)||(t=t.P(),this.il=t,this.S(),this.t("sourceRect",e,t))}get imageStretch(){return this.pf}set imageStretch(t){const e=this.pf;e!==t&&(this.pf=t,this.S(),this.t("imageStretch",e,t))}get flip(){return this.io}set flip(t){const e=this.io;e!==t&&(this.io=t,this.S(),this.t("flip",e,t))}get imageAlignment(){return this.yf}set imageAlignment(t){const e=this.yf;e.equals(t)||(t=t.P(),this.yf=t,this.S(),this.t("imageAlignment",e,t))}get errorFunction(){return this.ns}set errorFunction(t){const i=this.ns;i!==t&&(null!==t&&e.k(t,ye,"errorFunction"),this.ns=t,this.t("errorFunction",i,t))}get successFunction(){return this.el}set successFunction(t){const i=this.el;i!==t&&(null!==t&&e.k(t,ye,"successFunction"),this.el=t,this.t("successFunction",i,t))}dh(t,e){const i=this.tl;if(null===i)return;const s=i.getAttribute("src");if(i instanceof HTMLImageElement&&(null===s||""===s)||i.vp instanceof Event&&t instanceof It)return;const n=t instanceof Et,o=this.naturalBounds;let r=0,a=0;const h=this.bf;let l=h?+i.width:i.naturalWidth,u=h?+i.height:i.naturalHeight;if(void 0===l&&i.videoWidth&&(l=i.videoWidth),void 0===u&&i.videoHeight&&(u=i.videoHeight),0===l||0===u)return;const c=l,d=u;this.sourceRect.isReal()&&(r=this.il.x,a=this.il.y,l=this.il.width,u=this.il.height);let f=l,g=u;const p=this.pf,m=this.yf;switch(p){case 0:if(this.sourceRect.isReal())break;f>=o.width&&(r=r+m.offsetX+(f*m.x-o.width*m.x)),g>=o.height&&(a=a+m.offsetY+(g*m.y-o.height*m.y)),l=Math.min(o.width,f),u=Math.min(o.height,g);break;case 2:f=o.width,g=o.height;break;case 6:case 7:let t=0;6===p?(t=Math.min(o.height/g,o.width/f),f*=t,g*=t):7===p&&(t=Math.max(o.height/g,o.width/f),f*=t,g*=t,f>=o.width&&(r=(r+m.offsetX+(f*m.x-o.width*m.x)/f)*l),g>=o.height&&(a=(a+m.offsetY+(g*m.y-o.height*m.y)/g)*u),l*=1/(f/o.width),u*=1/(g/o.height),f=o.width,g=o.height);break}const y=l*u,v=this.getDocumentScale()*e.scale,x=f*v,b=g*v,w=x*b,k=y/w,S=i.__goCache;let P=null;const M=ye.Qv;if(!n){if(i.hn&&void 0!==S&&c<8e3&&d<8e3&&w>4&&k>M*M){null===S.Vt&&(S.eT(4,c,d,i),S.eT(16,c,d,i));const t=S.Vt,e=t.length;for(let i=0;i<e&&t[i].bd*t[i].bd<k;i++)P=t[i]}if(!e.Uu&&(null===this.wf&&this.Zv(),this.wf))return}const C=f<o.width?m.offsetX+(o.width*m.x-f*m.x):0,A=g<o.height?m.offsetY+(o.height*m.y-g*m.y):0;switch(this.flip){case 0:break;case 2:t.translate(Math.min(o.width,f),0),t.scale(-1,1);break;case 1:t.translate(0,Math.min(o.height,g)),t.scale(1,-1);break;case 3:t.translate(Math.min(o.width,f),Math.min(o.height,g)),t.scale(-1,-1);break}if(t.commitTransform(),e.getRenderingHint("pictureRatioOptimization")&&!e.ta&&void 0!==S&&null!==P&&1!==P.bd){t.save();const e=P.bd;try{t.drawImage(P.dt,r/e,a/e,Math.min(P.dt.width,l/e),Math.min(P.dt.height,u/e),C,A,Math.min(o.width,f),Math.min(o.height,g)),t instanceof Et&&(this.Xb=[r/e,a/e,Math.min(P.dt.width,l/e),Math.min(P.dt.height,u/e),C,A,Math.min(o.width,f),Math.min(o.height,g)])}catch{this.Fp=!1}t.restore()}else try{t.drawImage(i,r,a,l,u,C,A,Math.min(o.width,f),Math.min(o.height,g)),t instanceof Et&&(this.Xb=[r,a,l,u,C,A,Math.min(o.width,f),Math.min(o.height,g)])}catch{this.Fp=!1}switch(this.flip){case 0:break;case 2:t.scale(-1,1),t.translate(-Math.min(o.width,f),0);break;case 1:t.scale(1,-1),t.translate(0,-Math.min(o.height,g));break;case 3:t.scale(-1,-1),t.translate(-Math.min(o.width,f),-Math.min(o.height,g));break}}get naturalBounds(){return this.zi}Wu(t,e,i,s){const n=this.desiredSize,o=this.zs(!0),r=this.tl,a=this.bf;let h=0,l=0;(a||!this.hn&&r&&r.complete)&&(this.hn=!0),null===r?(isFinite(n.width)||(t=i),isFinite(n.height)||(e=s)):(h=a?+r.width:r.naturalWidth,l=a?+r.height:r.naturalHeight),isFinite(n.width)||2===o||5===o?(isFinite(t)||(this.sourceRect.isReal()?t=this.sourceRect.width:null!==r&&(t=h)),i=0):null!==r&&!1!==this.hn&&(t=this.sourceRect.isReal()?this.sourceRect.width:h),isFinite(n.height)||2===o||4===o?(isFinite(e)||(this.sourceRect.isReal()?e=this.sourceRect.height:null!==r&&(e=l)),s=0):null!==r&&!1!==this.hn&&(e=this.sourceRect.isReal()?this.sourceRect.height:l),isFinite(n.width)&&(t=n.width),isFinite(n.height)&&(e=n.height);const u=this.maxSize,c=this.minSize;i=Math.max(i||0,c.width),s=Math.max(s||0,c.height),t=Math.min(u.width,t),e=Math.min(u.height,e),t=Math.max(i,t),e=Math.max(s,e),null!==r&&!r.complete&&(isFinite(t)||(t=0),isFinite(e)||(e=0)),this.zi.Fn(t,e),this.Wn(0,0,t,e)}fh(t,e,i,s){this.commonArrange(t,e,i,s)}static Rp=new s;static c1=0;static Qv=4}class ve{Vt;constructor(){this.Vt=null}eT(t,e,i,s){null===this.Vt&&(this.Vt=[]);const n=new Bt(null),o=n.li,r=1/t;if(n.width=e/t,n.height=i/t,0===n.width||0===n.height)return;const a=new xe(n.Tt,t);let h=s,l=1;if(this.Vt.length>0){const t=this.Vt[this.Vt.length-1];h=t.dt,l=t.bd}o.setTransform(r*l,0,0,r*l,0,0),o.commitTransform(),o.drawImage(h,0,0),this.Vt.push(a)}}class xe{dt;bd;constructor(t,e){this.dt=t,this.bd=e}}class be{bi;Kg;constructor(){this.Kg=new C,this.bi=null}Ri(t){null!==t?(this.Kg=t,t.figures.clear()):this.Kg=new C,this.bi=null}hu(t,e,i,s,n,o){if(void 0!==s&&!0===s){const i=new L(1);i.endX=t,i.endY=e,this.bi.segments.add(i)}else this.bi=new A,this.bi.startX=t,this.bi.startY=e,this.bi.isFilled=i,this.bi.isEvenOdd=o||!1,this.Kg.figures.add(this.bi);void 0!==n&&(this.bi.isShadowed=n)}oF(){const t=this.bi.segments.length;t>0&&this.bi.segments.elt(t-1).close()}rF(){this.bi.segments.length>0&&(this.bi.isFilled=!0)}lF(t){this.bi.isShadowed=t}FE(t){this.bi.isEvenOdd=t}eF(t,e,i){void 0===i&&(i=!1);const s=new L(1);s.endX=t,s.endY=e,i&&s.close(),this.bi.segments.add(s)}rr(t,e,i){void 0===i&&(i=!1);const s=new L(2);s.endX=t,s.endY=e,i&&s.close(),this.bi.segments.add(s)}lr(t,e,i,s,n,o,r){void 0===r&&(r=!1);const a=new L(3);a.point1X=t,a.point1Y=e,a.point2X=i,a.point2Y=s,a.endX=n,a.endY=o,r&&a.close(),this.bi.segments.add(a)}Mw(t,e,i,s,n){void 0===n&&(n=!1);const o=new L(4);o.point1X=t,o.point1Y=e,o.endX=i,o.endY=s,n&&o.close(),this.bi.segments.add(o)}sF(t,e,i,s,n,o,r){void 0===o&&(o=0),void 0===r&&(r=!1);const a=new L(5);a.startAngle=t,a.sweepAngle=e,a.centerX=i,a.centerY=s,a.radiusX=n,a.radiusY=0!==o?o:n,r&&a.close(),this.bi.segments.add(a)}nF(t,e,i,s,n,o,r,a){void 0===a&&(a=!1);const h=new L(6,o,r,t,e,i,s,n);a&&h.close(),this.bi.segments.add(h)}static Q2=null;static RC(t){const e=be.Q2;if(null!==e)return be.Q2=null,e.Ri(t),e;{const e=new be;return e.Ri(t),e}}static vC(t){be.Q2=t}}{const t=function(t,e){const i=t.toLowerCase(),s=S.In;s[t]=e,s[i]=t};t("Rectangle",((t,e,i)=>{const s="r"+e+","+i;let n=S.nr[s];return void 0!==n||(n=new C(2),n.endX=e,n.endY=i,S.or<S.Vg&&(S.nr[s]=n,S.or++)),n})),t("Square",((t,e,i)=>{const s="s"+e+","+i;let n=S.nr[s];return void 0!==n||(n=new C(2),n.endX=e,n.endY=i,n.defaultStretch=6,S.or<S.Vg&&(S.nr[s]=n,S.or++)),n}));const e=(t,e,i,s,n)=>{(isNaN(s)||s<0)&&(s=5),isNaN(n)&&(n=15);const o="rr"+e+","+i+","+s+","+n;let r=S.nr[o];if(void 0!==r)return r;let a=s;1===(1&n)?(a=Math.min(a,2===(2&n)?e/3:e),a=Math.min(a,8===(8&n)?i/3:i)):a=0;const h=new A(a,0,!0);r=(new C).add(h);const l=w.TopLeft.copy(),u=w.BottomRight.copy();if(2===(2&n)){let t=s;t=Math.min(t,1===(1&n)?e/3:e),t=Math.min(t,4===(4&n)?i/3:i);const o=t*S.Rn;h.add(new L(2,e-t,0)).add(new L(3,e,t,e-o,0,e,o)),l.offsetY=o,u.offsetX=-o}else h.add(new L(2,e,0));if(4===(4&n)){let t=s;t=Math.min(t,8===(8&n)?e/3:e),t=Math.min(t,2===(2&n)?i/3:i);const o=t*S.Rn;h.add(new L(2,e,i-t)).add(new L(3,e-t,i,e,i-o,e-o,i)),u.offsetX=-o,u.offsetY=-o}else h.add(new L(2,e,i));if(8===(8&n)){let t=s;t=Math.min(t,4===(4&n)?e/3:e),t=Math.min(t,1===(1&n)?i/3:i);const o=t*S.Rn;h.add(new L(2,t,i)).add(new L(3,0,i-t,o,i,0,i-o)),l.offsetX=o,u.offsetY=-o}else h.add(new L(2,0,i));if(1===(1&n)){const t=a*S.Rn;h.add(new L(2,0,a)).add(new L(3,a,0,0,t,t,0).close()),l.offsetX=t,l.offsetY=t}else h.add(new L(2,0,0).close());return r.spot1=l,r.spot2=u,S.or<S.Vg&&(S.nr[o]=r,S.or++),r};t("RoundedRectangle",((t,i,s)=>{const n=t?t.parameter1:NaN,o=t?t.parameter2:NaN;return e(t,i,s,n,o)})),t("Border","RoundedRectangle"),t("RoundedTopRectangle",((t,i,s)=>{const n=t?t.parameter1:NaN;return e(t,i,s,n,3)})),t("RoundedBottomRectangle",((t,i,s)=>{const n=t?t.parameter1:NaN;return e(t,i,s,n,12)})),t("RoundedLeftRectangle",((t,i,s)=>{const n=t?t.parameter1:NaN;return e(t,i,s,n,9)})),t("RoundedRightRectangle",((t,i,s)=>{const n=t?t.parameter1:NaN;return e(t,i,s,n,6)})),t("Ellipse",((t,e,i)=>{const s="e"+e+","+i;let n=S.nr[s];return void 0!==n||(n=new C(3),n.endX=e,n.endY=i,n.spot1=w.Vk,n.spot2=w.zk,S.or<S.Vg&&(S.nr[s]=n,S.or++)),n})),t("Circle",((t,e,i)=>{const s="c"+e+","+i;let n=S.nr[s];return void 0!==n||(n=new C(3),n.endX=e,n.endY=i,n.spot1=w.Vk,n.spot2=w.zk,n.defaultStretch=6,S.or<S.Vg&&(S.nr[s]=n,S.or++)),n})),t("TriangleRight",((t,e,i)=>(new C).add(new A(0,0).add(new L(2,e,.5*i)).add(new L(2,0,i).close())).setSpots(0,.25,.5,.75))),t("TriangleDown",((t,e,i)=>(new C).add(new A(0,0).add(new L(2,e,0)).add(new L(2,.5*e,i).close())).setSpots(.25,0,.75,.5))),t("TriangleLeft",((t,e,i)=>(new C).add(new A(e,i).add(new L(2,0,.5*i)).add(new L(2,e,0).close())).setSpots(.5,.25,1,.75))),t("TriangleUp",((t,e,i)=>(new C).add(new A(e,i).add(new L(2,0,i)).add(new L(2,.5*e,0).close())).setSpots(.25,.5,.75,1))),t("Triangle","TriangleUp"),t("Diamond",((t,e,i)=>(new C).add(new A(.5*e,0).add(new L(2,0,.5*i)).add(new L(2,.5*e,i)).add(new L(2,e,.5*i).close())).setSpots(.25,.25,.75,.75))),t("LineH",((t,e,i)=>{const s=new C(1);return s.startX=0,s.startY=i/2,s.endX=e,s.endY=i/2,s})),t("LineV",((t,e,i)=>{const s=new C(1);return s.startX=e/2,s.startY=0,s.endX=e/2,s.endY=i,s})),t("None","Rectangle"),t("BarH","Rectangle"),t("BarV","Rectangle"),t("MinusLine","LineH"),t("PlusLine",((t,e,i)=>(new C).add(new A(0,i/2,!1).add(new L(2,e,i/2)).add(new L(1,e/2,0)).add(new L(2,e/2,i))))),t("XLine",((t,e,i)=>(new C).add(new A(0,i,!1).add(new L(2,e,0)).add(new L(1,0,0)).add(new L(2,e,i))))),t("LineRight",((t,e,i)=>(new C).add(new A(.25*e,0,!1).add(new L(2,.75*e,.5*i)).add(new L(2,.25*e,i))))),t("LineDown",((t,e,i)=>(new C).add(new A(0,.25*i,!1).add(new L(2,.5*e,.75*i)).add(new L(2,e,.25*i))))),t("LineLeft",((t,e,i)=>(new C).add(new A(.75*e,0,!1).add(new L(2,.25*e,.5*i)).add(new L(2,.75*e,i))))),t("LineUp",((t,e,i)=>(new C).add(new A(0,.75*i,!1).add(new L(2,.5*e,.25*i)).add(new L(2,e,.75*i))))),t("Capsule",((t,e,i)=>{const s=new C;if(e<i){const n=e/2,o=new A(0,n,!0);s.add(o),o.add(new L(5,180,180,n,n,n,n)),o.add(new L(2,e,i-n)),o.add(new L(5,0,180,n,i-n,n,n)),o.add(new L(2,0,n));const r=isFinite(t.parameter1)?t.parameter1:.156*e;return s.spot1=new w(0,0,0,r),s.spot2=new w(1,1,0,-r),s}if(e>i){const n=i/2,o=new A(n,0,!0);s.add(o),o.add(new L(2,e-n,0)),o.add(new L(5,270,180,e-n,n,n,n)),o.add(new L(2,n,i)),o.add(new L(5,90,180,n,n,n,n));const r=isFinite(t.parameter1)?t.parameter1:.156*i;return s.spot1=new w(0,0,r,0),s.spot2=new w(1,1,-r,0),s}return s.type=3,s.endX=e,s.endY=i,s.spot1=w.Vk,s.spot2=w.zk,s}));const i=(t,e)=>new A(t,e,!1,!1),s=(t,e,i)=>t.add(new L(2,e,i)),n=(t,e,i)=>t.add(new L(1,e,i));t("Borders",((t,e,o)=>{let r=t?t.parameter1:NaN;isNaN(r)?r=10:r&=15;const a=new C;let h;return 10===r?(h=i(e,0),s(h,e,o),n(h,0,o),s(h,0,0)):5===r?(h=i(0,0),s(h,e,0),n(h,e,o),s(h,0,o)):1===r?(h=i(0,0),s(h,e,0),n(h,e,o)):2===r?(h=i(e,0),s(h,e,o)):4===r?(h=i(e,o),s(h,0,o)):8===r?(h=i(0,o),s(h,0,0),n(h,e,o)):3===r?(h=i(0,0),s(h,e,0),s(h,e,o)):6===r?(h=i(e,0),s(h,e,o),s(h,0,o)):12===r?(h=i(e,o),s(h,0,o),s(h,0,0)):9===r?(h=i(0,o),s(h,0,0),s(h,e,0)):7===r?(h=i(0,0),s(h,e,0),s(h,e,o),s(h,0,o)):14===r?(h=i(e,0),s(h,e,o),s(h,0,o),s(h,0,0)):13===r?(h=i(e,o),s(h,0,o),s(h,0,0),s(h,e,0)):11===r?(h=i(0,o),s(h,0,0),s(h,e,0),s(h,e,o)):15===r?(h=i(0,0),s(h,e,0),s(h,e,o),s(h,0,o),h.add(new L(2,0,0).close())):(h=i(0,0),n(h,e,o)),a.add(h),a}))}S.Ug={"":"",Standard:"F1 m 0,0 l 8,4 -8,4 2,-4 z",Backward:"F1 m 8,0 l -2,4 2,4 -8,-4 z",Triangle:"F1 m 0,0 l 8,4.62 -8,4.62 z",BackwardTriangle:"F1 m 8,4 l 0,4 -8,-4 8,-4 0,4 z",Boomerang:"F1 m 0,0 l 8,4 -8,4 4,-4 -4,-4 z",BackwardBoomerang:"F1 m 8,0 l -8,4 8,4 -4,-4 4,-4 z",SidewaysV:"m 0,0 l 8,4 -8,4 0,-1 6,-3 -6,-3 0,-1 z",BackwardV:"m 8,0 l -8,4 8,4 0,-1 -6,-3 6,-3 0,-1 z",OpenTriangle:"m 0,0 l 8,4 -8,4",BackwardOpenTriangle:"m 8,0 l -8,4 8,4",OpenTriangleLine:"m 0,0 l 8,4 -8,4 m 8.5,0 l 0,-8",BackwardOpenTriangleLine:"m 8,0 l  -8,4 8,4 m -8.5,0 l 0,-8",OpenTriangleTop:"m 0,0 l 8,4 m 0,4",BackwardOpenTriangleTop:"m 8,0 l -8,4 m 0,4",OpenTriangleBottom:"m 0,8 l 8,-4",BackwardOpenTriangleBottom:"m 0,4 l 8,4",HalfTriangleTop:"F1 m 0,0 l 0,4 8,0 z m 0,8",BackwardHalfTriangleTop:"F1 m 8,0 l 0,4 -8,0 z m 0,8",HalfTriangleBottom:"F1 m 0,4 l 0,4 8,-4 z",BackwardHalfTriangleBottom:"F1 m 8,4 l 0,4 -8,-4 z",ForwardSemiCircle:"m 4,0 b 270 180 0 4 4",BackwardSemiCircle:"m 4,8 b 90 180 0 -4 4",Feather:"m 0,0 l 3,4 -3,4",BackwardFeather:"m 3,0 l -3,4 3,4",DoubleFeathers:"m 0,0 l 3,4 -3,4 m 3,-8 l 3,4 -3,4",BackwardDoubleFeathers:"m 3,0 l -3,4 3,4 m 3,-8 l -3,4 3,4",TripleFeathers:"m 0,0 l 3,4 -3,4 m 3,-8 l 3,4 -3,4 m 3,-8 l 3,4 -3,4",BackwardTripleFeathers:"m 3,0 l -3,4 3,4 m 3,-8 l -3,4 3,4 m 3,-8 l -3,4 3,4",ForwardSlash:"m 0,8 l 5,-8",BackSlash:"m 0,0 l 5,8",DoubleForwardSlash:"m 0,8 l 4,-8 m -2,8 l 4,-8",DoubleBackSlash:"m 0,0 l 4,8 m -2,-8 l 4,8",TripleForwardSlash:"m 0,8 l 4,-8 m -2,8 l 4,-8 m -2,8 l 4,-8",TripleBackSlash:"m 0,0 l 4,8 m -2,-8 l 4,8 m -2,-8 l 4,8",Fork:"m 0,4 l 8,0 m -8,0 l 8,-4 m -8,4 l 8,4",BackwardFork:"m 8,4 l -8,0 m 8,0 l -8,-4 m 8,4 l -8,4",LineFork:"m 0,0 l 0,8 m 0,-4 l 8,0 m -8,0 l 8,-4 m -8,4 l 8,4",BackwardLineFork:"m 8,4 l -8,0 m 8,0 l -8,-4 m 8,4 l -8,4 m 8,-8 l 0,8",CircleFork:"F1 m 6,4 b 0 360 -3 0 3 z m 0,0 l 6,0 m -6,0 l 6,-4 m -6,4 l 6,4",BackwardCircleFork:"F1 m 0,4 l 6,0 m -6,-4 l 6,4 m -6,4 l 6,-4 m 6,0 b 0 360 -3 0 3",CircleLineFork:"F1 m 6,4 b 0 360 -3 0 3 z m 1,-4 l 0,8 m 0,-4 l 6,0 m -6,0 l 6,-4 m -6,4 l 6,4",BackwardCircleLineFork:"F1 m 0,4 l 6,0 m -6,-4 l 6,4 m -6,4 l 6,-4 m 0,-4 l 0,8 m 7,-4 b 0 360 -3 0 3",Circle:"F1 m 8,4 b 0 360 -4 0 4 z",Block:"F1 m 0,0 l 0,8 8,0 0,-8 z",StretchedDiamond:"F1 m 0,3 l 5,-3 5,3 -5,3 -5,-3 z",Diamond:"F1 m 0,4 l 4,-4 4,4 -4,4 -4,-4 z",Chevron:"F1 m 0,0 l 5,0 3,4 -3,4 -5,0 3,-4 -3,-4 z",StretchedChevron:"F1 m 0,0 l 8,0 3,4 -3,4 -8,0 3,-4 -3,-4 z",NormalArrow:"F1 m 0,2 l 4,0 0,-2 4,4 -4,4 0,-2 -4,0 z",X:"m 0,0 l 8,8 m 0,-8 l -8,8",TailedNormalArrow:"F1 m 0,0 l 2,0 1,2 3,0 0,-2 2,4 -2,4 0,-2 -3,0 -1,2 -2,0 1,-4 -1,-4 z",DoubleTriangle:"F1 m 0,0 l 4,4 -4,4 0,-8 z  m 4,0 l 4,4 -4,4 0,-8 z",BigEndArrow:"F1 m 0,0 l 5,2 0,-2 3,4 -3,4 0,-2 -5,2 0,-8 z",ConcaveTailArrow:"F1 m 0,2 h 4 v -2 l 4,4 -4,4 v -2 h -4 l 2,-2 -2,-2 z",RoundedTriangle:"F1 m 0,1 a 1,1 0 0 1 1,-1 l 7,3 a 0.5,1 0 0 1 0,2 l -7,3 a 1,1 0 0 1 -1,-1 l 0,-6 z",SimpleArrow:"F1 m 1,2 l -1,-2 2,0 1,2 -1,2 -2,0 1,-2 5,0 0,-2 2,2 -2,2 0,-2 z",AccelerationArrow:"F1 m 0,0 l 0,8 0.2,0 0,-8 -0.2,0 z m 2,0 l 0,8 1,0 0,-8 -1,0 z m 3,0 l 2,0 2,4 -2,4 -2,0 0,-8 z",BoxArrow:"F1 m 0,0 l 4,0 0,2 2,0 0,-2 2,4 -2,4 0,-2 -2,0 0,2 -4,0 0,-8 z",TriangleLine:"F1 m 8,4 l -8,-4 0,8 8,-4 z m 0.5,4 l 0,-8",CircleEndedArrow:"F1 m 10,4 l -2,-3 0,2 -2,0 0,2 2,0 0,2 2,-3 z m -4,0 b 0 360 -3 0 3 z",DynamicWidthArrow:"F1 m 0,3 l 2,0 2,-1 2,-2 2,4 -2,4 -2,-2 -2,-1 -2,0 0,-2 z",EquilibriumArrow:"m 0,3 l 8,0 -3,-3 m 3,5 l -8,0 3,3",FastForward:"F1 m 0,0 l 3.5,4 0,-4 3.5,4 0,-4 1,0 0,8 -1,0 0,-4 -3.5,4 0,-4 -3.5,4 0,-8 z",Kite:"F1 m 0,4 l 2,-4 6,4 -6,4 -2,-4 z",HalfArrowTop:"F1 m 0,0 l 4,4 4,0 -8,-4 z m 0,8",HalfArrowBottom:"F1 m 0,8 l 4,-4 4,0 -8,4 z",OpposingDirectionDoubleArrow:"F1 m 0,4 l 2,-4 0,2 4,0 0,-2 2,4 -2,4 0,-2 -4,0 0,2 -2,-4 z",PartialDoubleTriangle:"F1 m 0,0 4,3 0,-3 4,4 -4,4 0,-3 -4,3 0,-8 z",LineCircle:"F1 m 0,0 l 0,8 m 7 -4 b 0 360 -3 0 3 z",DoubleLineCircle:"F1 m 0,0 l 0,8 m 2,-8 l 0,8 m 7 -4 b 0 360 -3 0 3 z",TripleLineCircle:"F1 m 0,0 l 0,8 m 2,-8 l 0,8 m 2,-8 l 0,8 m 7 -4 b 0 360 -3 0 3 z",CircleLine:"F1 m 6 4 b 0 360 -3 0 3 z m 1,-4 l 0,8",DiamondCircle:"F1 m 8,4 l -4,4 -4,-4 4,-4 4,4 m 8,0 b 0 360 -4 0 4 z",PlusCircle:"F1 m 8,4 b 0 360 -4 0 4 l -8 0 z m -4 -4 l 0 8",OpenRightTriangleTop:"m 8,0 l 0,4 -8,0 m 0,4",OpenRightTriangleBottom:"m 8,8 l 0,-4 -8,0",Line:"m 0,0 l 0,8",DoubleLine:"m 0,0 l 0,8 m 2,0 l 0,-8",TripleLine:"m 0,0 l 0,8 m 2,0 l 0,-8 m 2,0 l 0,8",PentagonArrow:"F1 m 8,4 l -4,-4 -4,0 0,8 4,0 4,-4 z"};var we=(t=>(t[t.None=0]="None",t[t.Added=1]="Added",t[t.Removed=2]="Removed",t[t.Shown=4]="Shown",t[t.Hidden=8]="Hidden",t[t.NodeSized=16]="NodeSized",t[t.GroupLayout=32]="GroupLayout",t[t.NodeReplaced=64]="NodeReplaced",t[t.Standard=127]="Standard",t[t.All=16777215]="All",t))(we||{});class ke extends ie{w;Vo;H;sl;nl;zo;ri;Xo;wh;Gs;Yo;kd;qS;sT;Op;Ip;constructor(t,e){let i;void 0===t||t instanceof $t||"string"==typeof t?i=t:t&&(e=t),super(i),this.w=2408959,this.Vo="",this.H=null,this.sl="",this.nl=null,this.zo=null,this.ri="",this.Xo=null,this.wh=null,this.Gs=new y(NaN,NaN).u(),this.Yo=null,this.kd=NaN,this.qS=-1,this.sT=new x,this.Op=null,this.Ip=NaN,e&&Object.assign(this,e)}cloneProtected(t){super.cloneProtected(t),t.w=49152|-4097&this.w,t.Vo=this.Vo,null!==this.H&&(this.H.fi?t.H=this.H:t.H=this.H.copy()),t.sl=this.sl,t.zo=null,t.ri=this.ri,t.Gs.a(this.Gs),t.kd=this.kd}Ro(t){super.Ro(t),t.uh(),t.nl=null,t.Yo=null,t.Op=null}toString(){let t=e.Dn(this.constructor)+"#"+u.as(this);return null!==this.data&&(t+="("+e.toString(this.data)+")"),t}static LayoutNone=0;static LayoutAdded=1;static LayoutRemoved=2;static LayoutShown=4;static LayoutHidden=8;static LayoutNodeSized=16;static LayoutGroupLayout=32;static LayoutNodeReplaced=64;static LayoutStandard=127;static LayoutAll=16777215;ji(){return null===this.H?this.H=new Se:this.H.fi&&(this.H=this.H.copy()),this.H}ah(){super.ah(),null!==this.H&&(this.H.fi=!0)}qc(t,e,i,s,n,o,r){const a=this.diagram;null!==a&&(3===t&&"elements"===e?n instanceof ie?n.Yr((t=>{a.partManager.OM(t,a)})):n instanceof ye&&a.XM(n):4===t&&"elements"===e&&(n instanceof ie?n.Yr((t=>a.partManager.IM(t,a))):n instanceof ye&&a.YM(n)),a.raiseChangedEvent(t,e,i,s,n,o,r))}updateTargetBindings(t){if(super.updateTargetBindings(t),null===this.data)return;const e=this.C.r,i=e.length;for(let n=0;n<i;n++){const t=e[n];t instanceof ie&&t.Yr((t=>{null!==t.data&&t.updateTargetBindings()}))}const s=this.adornments;for(;s.next();)s.value.updateTargetBindings(t)}To(){if(super.To(),this.C2()){const t=this.C.r,e=t.length;for(let i=0;i<e;i++){const e=t[i];e instanceof ie&&e.Yr((t=>t.To()))}}const t=this.adornments;for(;t.next();)t.value.To()}updateRelationshipsFromData(){null!==this.data&&this.diagram?.partManager.updateRelationshipsFromData(this)}get key(){const t=this.diagram;if(null!==t)return t.model.getKeyForNodeData(this.data)}get adornments(){return null===this.zo?n.instance:this.zo.iteratorValues}findAdornment(t){const e=this.zo;return null===e?null:e.get(t)}addAdornment(t,e){if(null===e)return;let i=null,s=this.zo;if(null!==s&&(i=s.get(t)),i!==e){if(null!==i){const t=i.diagram;null!==t&&t.remove(i)}null===s&&(s=new m,this.zo=s),e.Vo!==t&&(e.category=t),s.set(t,e);const n=this.diagram;if(null!==n){n.add(e);const t=e.adornedObject;if(null!==t){const i=t.findBindingPanel();null!==i&&(e.data=i.data)}}}}removeAdornment(t){const e=this.zo;if(null===e)return;const i=e.get(t);if(null!==i){const t=i.diagram;null!==t&&(t.remove(i),i.data=null)}e.delete(t),0===e.count&&(this.zo=null)}clearAdornments(){const t=this.zo;if(null===t)return;const i=e.et(),s=t.iterator;for(;s.next();){const t=s.key;i.push(t)}const n=i.length;for(let e=0;e<n;e++)this.removeAdornment(i[e]);e.J(i)}updateAdornments(){const t=this.diagram;if(null===t)return;this._v(t),this.tO(t);let e=this.adornments;for(;e.next();){const t=e.value;t.c(),t.hasPlaceholder()&&t.placeholder?.c()}for(e=this.adornments;e.next();)e.value.updateTargetBindings()}invalidateAdornments(){const t=this.diagram;null!==t&&(t.Ql(),!0!==this.nT()&&this.oT(!0))}WS(){!1!==this.nT()&&(this.updateAdornments(),this.oT(!1))}_v(t){const e="Selection";if(this.isSelected&&this.selectionAdorned){const i=this.selectionObject;if(null!==i&&this.actualBounds.isReal()&&this.isVisible()&&i.isVisibleObject()&&i.actualBounds.isReal()){let s=this.findAdornment(e);if(null===s){let e=this.selectionAdornmentTemplate;null===e&&(e=this.Nl()?t.linkSelectionAdornmentTemplate:this instanceof _e?t.groupSelectionAdornmentTemplate:t.nodeSelectionAdornmentTemplate),s=e.copy(),null!==s&&(this.Nl()&&this.selectionObject===this.path&&(s.type=ie.Link),s.adornedObject=i)}if(null!==s)return s.type===ie.Link&&s.c(),void this.addAdornment(e,s)}}this.removeAdornment(e)}tO(t){const e=this;t.toolManager.mouseDownTools.each((t=>{t.isEnabled&&t.updateAdornments(e)})),t.toolManager.updateAdornments(e)}HS(t){this.Xo=t,null===t&&this.ZR()}get layer(){return this.Xo}get diagram(){const t=this.Xo;return null==t?null:t.diagram}get layerName(){return this.sl}set layerName(t){const e=this.sl;if(e===t)return;let i=this.diagram;if(null!==i&&(null===i.findLayer(t)||i.partManager.addsToTemporaryLayer))return;this.sl=t,null!==i&&i.invalidateDocumentBounds(),this.t("layerName",e,t);const s=this.layer;if(null===s||s.name===t||(i=s.diagram,null===i))return;const n=i.findLayer(t);if(null===n||n===s)return;let o=s.te(-1,this,!0);o>=0&&i.raiseChangedEvent(4,"parts",s,this,null,o,!0),o=n.Wh(99999999,this,!0),s.visible!==n.visible&&this.Ei(n.visible),o>=0&&i.raiseChangedEvent(3,"parts",n,null,this,!0,o);const r=this.layerChanged;if(null===r)return;const a=i.X;i.X=!0,r(this,s,n),i.X=a}get layerChanged(){return null!==this.H?this.H.Ep:null}set layerChanged(t){const i=this.layerChanged;i!==t&&(null!==t&&e.k(t,ke,"layerChanged"),this.ji().Ep=t,this.t("layerChanged",i,t))}get zOrder(){return this.kd}set zOrder(t){const e=this.kd;if(e===t)return;this.kd=t;const i=this.layer;null!==i&&i.bx(-1,this),this.t("zOrder",e,t);const s=this.diagram;null!==s&&s.S()}iO(){const t=this.layer;null!==t&&t.bx(-1,this)}d1(){if(!1!==this.th())return;this._2(!0),this.$c();const t=this.diagram;null!==t&&(t._m(this),t.requestUpdate())}rT(){if(this.w|=2097152,!1===this.th())return;const t=this.position,e=this.location;(!e.isReal()||!t.isReal())&&this.lT(t,e);const i=this.Ni,s=x.l().a(i);i.Nt(),i.x=t.x,i.y=t.y,i.u(),this.Ju(s,i),x.e(s),this._2(!1),this.$c()}Wn(t,e,i,s){const n=this.se;n.i(t,e,i,s),null===this.wi&&(this.wi=new k);const o=this.wi;o.Ri(),this.g0(o,t,e,i,s),this.wi=o,o.Xk()||o.vg(n)}g0(t,e,i,s,n){if(1!==this.tt&&t.tt(this.tt),0===this.Yt)return;let o=w.Center;this.locationSpot.isSpot()&&(o=this.locationSpot);const r=y.l();if(this.locationObject!==this){const t=this.locationObject,e=t.naturalBounds;r.setSpot(e.x,e.y,e.width,e.height,o),null!==t.wi&&t.wi.gt(r),r.offset(-t.measuredBounds.x,-t.measuredBounds.y);let i=t.panel;for(;null!==i&&i!==this;)null!==i.wi&&i.wi.gt(r),r.offset(-i.measuredBounds.x,-i.measuredBounds.y),i=i.panel}else r.setSpot(e,i,s,n,o);t.cs(this.Yt,r.x,r.y),y.e(r)}get locationObject(){if(null===this.Yo)if(this instanceof Pe&&this.type!==ie.Link&&this.hasPlaceholder())this.Yo=this.placeholder;else{const t=this.locationObjectName;if(""!==t){const e=this.findObject(t);this.Yo=null!==e?e:this}else this.Yo=this}return this.Yo?.visible?this.Yo:this}get minLocation(){return null!==this.H?this.H.Bp:y.gC}set minLocation(t){const e=this.minLocation;e.equals(t)||(t=t.P(),this.ji().Bp=t,this.t("minLocation",e,t))}get maxLocation(){return null!==this.H?this.H.Up:y.mC}set maxLocation(t){const e=this.maxLocation;e.equals(t)||(t=t.P(),this.ji().Up=t,this.t("maxLocation",e,t))}get locationObjectName(){return null!==this.H?this.H.Vp:""}set locationObjectName(t){const e=this.locationObjectName;e!==t&&(this.ji().Vp=t,this.Yo=null,this.c(),this.t("locationObjectName",e,t))}get locationSpot(){return null!==this.H?this.H.zp:w.TopLeft}set locationSpot(t){const e=this.locationSpot;e.equals(t)||(t=t.P(),this.ji().zp=t,this.c(),this.t("locationSpot",e,t))}move(t,e){!0===e?this.location=t:this.position=t}moveTo(t,e,i){const s=y.V(t,e);this.move(s,i),y.e(s)}isVisible(){if(!this.visible)return!1;const t=this.layer;if(null!==t){if(!t.visible)return!1;const e=t.diagram;if(null!==e&&e.animationManager.nx(this))return!0}const e=this.containingGroup;return!(null!==e&&(!e.isSubGraphExpanded||!e.isVisible()))}Ei(t){const e=this.diagram;t?(this.invalidateLayout(4),this.invalidateAdornments(),null!==e&&e._m(this)):(this.invalidateLayout(8),this.clearAdornments()),this.uh(),null!==e&&(e.invalidateDocumentBounds(),e.S())}findObject(t){if(this.name===t)return this;let e=this.Op;if(null===e&&(this.Op=e=new m),null!==e.get(t))return e.get(t);const i=super.findObject(t);return null!==i?(e.set(t,i),i):(e.set(t,null),null)}L0(){this.Op=null}getRelativePoint(t,e,i){void 0===i&&(i=new y);const s=e.isNoSpot()?w.Center:e,n=t.naturalBounds;if(i.i(n.width*s.x+s.offsetX,n.height*s.y+s.offsetY),null===t||t===this)return i;t.T.gt(i);let o=t.panel;for(;null!==o&&o!==this;)o.T.gt(i),o=o.panel;return null!==this.wi&&this.wi.gt(i),i.offset(-this.se.x,-this.se.y),i}getDocumentBounds(t){return void 0===t&&(t=new x),t.a(this.actualBounds)}ensureBounds(){this.ht(1/0,1/0),this.Ut()}IA(t){const e=this.locationSpot,i=this.locationObject;let s=i.naturalBounds;s.isReal()||(s=x.Fg);const n=i instanceof he?i.strokeWidth:0;if(t.setSpot(0,0,s.width+n,s.height+n,e),i!==this){t.offset(-n/2,-n/2),i.T.gt(t);let e=i.panel;for(;null!==e&&e!==this;)e.T.gt(t),e=e.panel}return null!==this.wi&&this.wi.gt(t),t.offset(-this.se.x,-this.se.y),t}qh(t,e){const i=void 0===e?this.sT:e,s=this.eO(),n=2*s;if(!this.isShadowed)return i.i(t.x-1-s,t.y-1-s,t.width+2+n,t.height+2+n),i;let o=t.x,r=t.y,a=t.width,h=t.height;const l=this.shadowBlur,u=this.shadowOffset;return a+=l,h+=l,o-=l/2,r-=l/2,u.x>0?a+=u.x:(o+=u.x,a-=u.x),u.y>0?h+=u.y:(r+=u.y,h-=u.y),i.i(o-1,r-1,a+2,h+2),i}Uv(){return this.type===ie.Link&&this instanceof Pe&&"Selection"===this.category&&this.adornedObject instanceof he&&this.adornedPart.findMainElement()===this.adornedObject?this.adornedObject.strokeWidth:0}eO(){return isNaN(this.Ip)&&(this.Ip=this.YA()),this.Ip}cf(){this.Ip=NaN}Ut(){if(!1===this._e())return void this.rT();this.Jn(!1);const t=this.Ni,e=x.l();e.a(t);const i=this.Ml();this.fh(0,0,this.se.width,this.se.height);const s=this.position;this.lT(s,this.location),t.Nt(),t.x=s.x,t.y=s.y,t.u(),this.Ju(e,t),e.equals(t)?this.ps(i):this.ke()&&(!S.f(e.width,t.width)||!S.f(e.height,t.height))&&this.qS>=0&&this.invalidateLayout(16),x.e(e),this._2(!1)}Ju(t,e){const i=this.diagram;if(null===i)return;let s=!1;if(!1===i._h&&t.isReal()){const n=x.l();n.a(i.documentBounds),n.subtractMargin(i.padding),t.x>n.x&&t.y>n.y&&t.right<n.right&&t.bottom<n.bottom&&e.x>n.x&&e.y>n.y&&e.right<n.right&&e.bottom<n.bottom&&(s=!0),x.e(n)}(!0===this.sO()||!t.equals(e))&&this.GL(s,i),i.S(),(t.isReal()||e.isReal())&&!t.equalsApproxClose(e)&&(this instanceof Ce&&!i.undoManager.isUndoingRedoing&&this.invalidateConnectedLinks(),this.uh())}get location(){return this.Gs}set location(t){const e=t.x,i=t.y,s=this.Gs;(s.x!==e&&(!isNaN(s.x)||!isNaN(e))||s.y!==i&&(!isNaN(s.y)||!isNaN(i)))&&(t=t.copy(),this.nO(t,s)&&this.t("location",s,t.copy()))}nO(t,e){if(this.Nl())return!1;if(this.Gs=t,this.w|=2097152,!1===this._e()){this.d1();const i=this.at;if(i.isReal()){const s=this.diagram;if(null===s||s.animationManager.isTicking||!s.undoManager.isUndoingRedoing){const n=i.copy();i.i(i.x+(t.x-e.x),i.y+(t.y-e.y)),this.hT(s,i,n.x,n.y),this.t("position",n,i.copy())}}}return!0}S2(t,e,i){if(this.Nl()||!t.isReal())return!1;const s=this.diagram;if(null!==s&&this.hT(s,t,e,i),this.at=t,this.w&=-2097153,this.Gs.isReal()&&(null===s||s.animationManager.isTicking||!s.undoManager.isUndoingRedoing)){const s=this.Gs;this.Gs=new y(s.x+(t.x-e),s.y+(t.y-i)),this.t("location",s,this.Gs.copy())}return!1===this.th()&&!1===this._e()&&(this.d1(),this.rT()),!0}hT(t,e,i,s){if(null===t||this instanceof Pe)return;const n=t.animationManager;n.pi&&n.dL(this,new y(i,s),e,!1)}bc(t,e,i){const s=this.Gs,n=this.at;if(i){if(s.x===t&&s.y===e)return;this.th()||this._e()?n.i(NaN,NaN):n.i(n.x+t-s.x,n.y+e-s.y),s.i(t,e)}else{if(n.x===t&&n.y===e)return;s.i(s.x+t-n.x,s.y+e-n.y),n.i(t,e)}this.d1()}M2(){this.w&=-2097153,this.d1()}lT(t,e){const i=this.IA(y.l()),s=this.diagram,n=e.isReal(),o=t.isReal();n&&o?2097152&this.w?this.aT(t,e,s,i):this.cT(t,e,s,i):n?this.aT(t,e,s,i):o&&this.cT(t,e,s,i),this.w|=2097152,y.e(i),this.$c()}aT(t,e,i,s){const n=t.x,o=t.y;if(t.i(e.x-s.x,e.y-s.y),null!==i){const e=i.animationManager,s=e.defaultAnimation.isAnimating;!s&&e.pi&&!(this instanceof Pe)&&e.dL(this,new y(n,o),t,!1),!s&&(t.x!==n||t.y!==o)&&this.t("position",new y(n,o),t.copy())}}cT(t,e,i,s){const n=e.copy();e.i(t.x+s.x,t.y+s.y),!e.equals(n)&&null!==i&&this.t("location",n,e.copy())}GL(t,e){this.p2(!1),this instanceof Ce&&e.WM(this),!this.layer.isTemporary&&!t&&e.invalidateDocumentBounds();const i=this.Ni,s=e.viewportBounds;s.isReal()?this.Ml()?(i.intersectsRectPlus(s,10)||this.ps(!1),this.updateAdornments()):this.isVisible()&&i.intersectsRect(s)?(this.ps(!0),this.updateAdornments()):this.invalidateAdornments():e.Ic=!0}Xr(){return!0}ke(){return!0}Nl(){return!1}Xs(){return!0}hasPlaceholder(){return!1}get category(){return this.Vo}set category(t){const e=this.Vo;if(e===t)return;null!==this.svg&&(this.svg.remove(),this.Ve(!0));const i=this.diagram,s=this.data;let n=null;if(null!==i&&null!==s&&!(this instanceof Pe)){const t=i.model.undoManager;t.isEnabled&&!t.isUndoingRedoing&&(n=this.clone(),n.C.addAll(this.C))}if(this.Vo=t,this.t("category",e,t),null===i||null===s||this instanceof Pe){if(this instanceof Pe){const t=this.adornedPart;if(null!==t){const i=t.zo;null!==i&&i.delete(e),t.addAdornment(this.category,this)}}}else{const o=i.model;if(o.undoManager.isUndoingRedoing)return;if(this.Nl()){i.partManager.setLinkCategoryForData(s,t);const n=i.partManager.findLinkTemplateForCategory(t);if(null!==n){n.Et();const i=n.copy();null!==i&&this.tN(i,e,t)}}else{null!==o&&o.setCategoryForNodeData(s,t);const n=i.partManager.findTemplateForNodeData(s,t);if(null!==n){n.Et();const i=n.copy();if(null!==i&&!(i instanceof De)){const s=this.location.copy();this.tN(i,e,t),this.location.isReal()||(this.location=s)}}}if(null!==n){const t=this.clone();t.C.addAll(this.C),this.t("self",n,t)}}}get self(){return this}set self(t){this.tN(t,this.category,t.category)}static fT=!1;tN(t,i,s){t.constructor!==this.constructor&&(ke.fT||(ke.fT=!0,e.ni('Should not change the class of the Part when changing category from "'+i+'" to "'+s+'"'),e.ni("  Old class: "+e.Dn(this.constructor)+", new class: "+e.Dn(t.constructor)+", part: "+this.toString()))),this.clearAdornments();const n=this.data,o=this.layerName,r=this.isSelected,a=this.isHighlighted;let h=!0,l=!0,u=!1;this instanceof Ce&&(h=this.isTreeLeaf,l=this.isTreeExpanded,u=this.wasTreeExpanded),t.Ro(this),t.cloneProtected(this),this.Vo=s,null!==this.svg&&(this.svg.remove(),this.svg=null,this.Ve(!0)),this.c(),this.S();const c=this.diagram;let d=!0;null!==c&&(d=c.skipsUndoManager,c.skipsUndoManager=!0),this._t=n,this.w=r?4096|this.w:-4097&this.w,this.w=a?524288|this.w:-524289&this.w,this instanceof Ce&&(this.v=h?4|this.v:-5&this.v,this.v=l?1|this.v:-2&this.v,this.v=u?2|this.v:-3&this.v),null!==n&&this.updateTargetBindings();const f=this.layerName;f!==o&&(this.sl=o,this.layerName=f),null!==c&&(c.skipsUndoManager=d),this.ke()&&this.invalidateLayout(64)}canCopy(){if(!this.copyable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowCopy)return!1;const e=t.diagram;return null===e||!!e.allowCopy}canDelete(){if(!this.deletable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowDelete)return!1;const e=t.diagram;return null===e||!!e.allowDelete}canEdit(){if(!this.textEditable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowTextEdit)return!1;const e=t.diagram;return null===e||!!e.allowTextEdit}canGroup(){if(!this.groupable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowGroup)return!1;const e=t.diagram;return null===e||!!e.allowGroup}canMove(){if(!this.movable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowMove)return!1;const e=t.diagram;return null===e||!!e.allowMove}canReshape(){if(!this.reshapable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowReshape)return!1;const e=t.diagram;return null===e||!!e.allowReshape}canResize(){if(!this.resizable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowResize)return!1;const e=t.diagram;return null===e||!!e.allowResize}canRotate(){if(!this.rotatable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowRotate)return!1;const e=t.diagram;return null===e||!!e.allowRotate}canSelect(){if(!this.selectable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowSelect)return!1;const e=t.diagram;return null===e||!!e.allowSelect}get copyable(){return 0!==(1&this.w)}set copyable(t){const e=0!==(1&this.w);e!==t&&(this.w=1^this.w,this.t("copyable",e,t))}get deletable(){return 0!==(2&this.w)}set deletable(t){const e=0!==(2&this.w);e!==t&&(this.w=2^this.w,this.t("deletable",e,t))}get textEditable(){return 0!==(4&this.w)}set textEditable(t){const e=0!==(4&this.w);e!==t&&(this.w=4^this.w,this.t("textEditable",e,t),this.invalidateAdornments())}get groupable(){return 0!==(8&this.w)}set groupable(t){const e=0!==(8&this.w);e!==t&&(this.w=8^this.w,this.t("groupable",e,t))}get movable(){return 0!==(16&this.w)}set movable(t){const e=0!==(16&this.w);e!==t&&(this.w=16^this.w,this.t("movable",e,t))}get selectionAdorned(){return 0!==(32&this.w)}set selectionAdorned(t){const e=0!==(32&this.w);e!==t&&(this.w=32^this.w,this.t("selectionAdorned",e,t),this.invalidateAdornments())}get isInDocumentBounds(){return 0!==(64&this.w)}set isInDocumentBounds(t){const e=0!==(64&this.w);if(e!==t){this.w=64^this.w;const i=this.diagram;null!==i&&i.invalidateDocumentBounds(),this.t("isInDocumentBounds",e,t)}}get isLayoutPositioned(){return 0!==(128&this.w)}set isLayoutPositioned(t){const e=0!==(128&this.w);e!==t&&(this.w=128^this.w,this.t("isLayoutPositioned",e,t),this.invalidateLayout(t?4:8))}get selectable(){return 0!==(256&this.w)}set selectable(t){const e=0!==(256&this.w);e!==t&&(this.w=256^this.w,this.t("selectable",e,t),this.invalidateAdornments())}get reshapable(){return 0!==(512&this.w)}set reshapable(t){const e=0!==(512&this.w);e!==t&&(this.w=512^this.w,this.t("reshapable",e,t),this.invalidateAdornments())}get resizable(){return 0!==(1024&this.w)}set resizable(t){const e=0!==(1024&this.w);e!==t&&(this.w=1024^this.w,this.t("resizable",e,t),this.invalidateAdornments())}get rotatable(){return 0!==(2048&this.w)}set rotatable(t){const e=0!==(2048&this.w);e!==t&&(this.w=2048^this.w,this.t("rotatable",e,t),this.invalidateAdornments())}get isSelected(){return 0!==(4096&this.w)}set isSelected(t){const e=0!==(4096&this.w);if(e!==t){const i=this.diagram;if(t){if(!this.canSelect())return;if(null!==i){const t=i.maxSelectionCount;if(i.selection.count>=t)return}}this.w=4096^this.w;let s=!1;if(null!==i){s=i.skipsUndoManager,i.skipsUndoManager=!0;const e=i.selection;e.Nt(),t?e.add(this):e.delete(this),e.u()}this.t("isSelected",e,t),this.invalidateAdornments();const n=this.selectionChanged;null!==n&&n(this),null!==i&&(i.requestUpdate(),i.skipsUndoManager=s)}}get isHighlighted(){return 0!==(524288&this.w)}set isHighlighted(t){const e=0!==(524288&this.w);if(e!==t){this.w=524288^this.w;const i=this.diagram;if(null!==i){const e=i.highlighteds;e.Nt(),t?e.add(this):e.delete(this),e.u()}this.t("isHighlighted",e,t),this.S();const s=this.highlightedChanged;null!==s&&s(this)}}get isShadowed(){return 0!==(8192&this.w)}set isShadowed(t){const e=0!==(8192&this.w);e!==t&&(this.w=8192^this.w,this.Ve(!0),this.t("isShadowed",e,t),this.S())}nT(){return 0!==(16384&this.w)}oT(t){t?this.w|=16384:this.w&=-16385}th(){return 0!==(32768&this.w)}_2(t){t?this.w|=32768:this.w&=-32769}sO(){return 0!==(65536&this.w)}p2(t){t?this.w|=65536:this.w&=-65537}Ml(){return 0!==(131072&this.w)}ps(t){t?this.w|=131072:this.w&=-131073}uT(){return 0!==(1048576&this.w)}g1(t){t?this.w|=1048576:this.w&=-1048577}get isAnimated(){return 0!==(262144&this.w)}set isAnimated(t){const e=0!==(262144&this.w);e!==t&&(this.w=262144^this.w,this.t("isAnimated",e,t))}get highlightedChanged(){return null!==this.H?this.H.Xp:null}set highlightedChanged(t){const i=this.highlightedChanged;i!==t&&(null!==t&&e.k(t,ke,"highlightedChanged"),this.ji().Xp=t,this.t("highlightedChanged",i,t))}get selectionObjectName(){return null!==this.H?this.H.Yp:""}set selectionObjectName(t){const e=this.selectionObjectName;e!==t&&(this.ji().Yp=t,this.nl=null,this.t("selectionObjectName",e,t))}get selectionAdornmentTemplate(){return null!==this.H?this.H.Kp:null}set selectionAdornmentTemplate(t){const e=this.selectionAdornmentTemplate;e!==t&&(null!==t&&t.Et(),this.ji().Kp=t,this.t("selectionAdornmentTemplate",e,t))}get selectionObject(){if(null===this.nl){const t=this.selectionObjectName;if(null!==t&&""!==t){const e=this.findObject(t);this.nl=null!==e?e:this}else if(this instanceof De){const t=this.path;this.nl=null!==t?t:this}else this.nl=this}return this.nl}get selectionChanged(){return null!==this.H?this.H.Gp:null}set selectionChanged(t){const i=this.selectionChanged;i!==t&&(null!==t&&e.k(t,ke,"selectionChanged"),this.ji().Gp=t,this.t("selectionChanged",i,t))}get resizeAdornmentTemplate(){return null!==this.H?this.H.Hp:null}set resizeAdornmentTemplate(t){const e=this.resizeAdornmentTemplate;e!==t&&(this.ji().Hp=null!==t?t.Et():null,this.t("resizeAdornmentTemplate",e,t))}get resizeObjectName(){return null!==this.H?this.H.jp:""}set resizeObjectName(t){const e=this.resizeObjectName;e!==t&&(this.ji().jp=t,this.t("resizeObjectName",e,t))}get resizeObject(){const t=this.resizeObjectName;if(""!==t){const e=this.findObject(t);if(null!==e)return e}return this}get resizeCellSize(){return null!==this.H?this.H.qp:v.pw}set resizeCellSize(t){const e=this.resizeCellSize;e.equals(t)||(t=t.P(),this.ji().qp=t,this.t("resizeCellSize",e,t))}get rotateAdornmentTemplate(){return null!==this.H?this.H.Wp:null}set rotateAdornmentTemplate(t){const e=this.rotateAdornmentTemplate;e!==t&&(this.ji().Wp=null!==t?t.Et():null,this.t("rotateAdornmentTemplate",e,t))}get rotateObjectName(){return null!==this.H?this.H.Jp:""}set rotateObjectName(t){const e=this.rotateObjectName;e!==t&&(this.ji().Jp=t,this.t("rotateObjectName",e,t))}get rotateObject(){const t=this.rotateObjectName;if(""!==t){const e=this.findObject(t);if(null!==e)return e}return this}get rotationSpot(){return null!==this.H?this.H.$p:w.Default}set rotationSpot(t){const e=this.rotationSpot;e.equals(t)||(t=t.P(),this.ji().$p=t,this.t("rotationSpot",e,t))}get text(){return this.ri}set text(t){const e=this.ri;e!==t&&(this.ri=t,this.t("text",e,t))}get containingGroup(){return this.wh}set containingGroup(t){if(this.ke()){const i=this.wh;if(i!==t){null!==t&&(this===t||t.isMemberOf(this))&&(this===t&&e.o("Cannot make a Group a member of itself: "+this.toString()),e.o("Cannot make a Group indirectly contain itself: "+this.toString()+" already contains "+t.toString())),this.invalidateLayout(2);const s=this.diagram;if(null!==i?i.iN(this):this instanceof _e&&null!==s&&s.Vr.delete(this),this.wh=t,null!==t?t.eN(this):this instanceof _e&&null!==s&&s.Vr.add(this),this.invalidateLayout(1),null!==s&&s.X){const e=this.data,i=s.model;if(null!==e&&i.jc()){const s=null!==t?t.data:null;i.setGroupForData(e,i.getKeyForNodeData(s))}}const n=this.containingGroupChanged;if(null!==n){let e=!0;null!==s&&(e=s.X,s.X=!0),n(this,i,t),null!==s&&(s.X=e)}if(this instanceof _e){const t=new u;ke.nh(t,this,!0,0,!0);const e=t.iterator;for(;e.next();){const t=e.value;if(t instanceof Ce){const e=t.linksConnected;for(;e.next();)e.value.Pd()}}}if(this instanceof Ce){const t=this.linksConnected;for(;t.next();)t.value.Pd();const e=this.labeledLink;null!==e&&e.Pd()}this.t("containingGroup",i,t),null!==t&&t.iO()}}else e.o("cannot set the Part.containingGroup of a Link or Adornment")}uh(){const t=this.containingGroup;null!==t&&(t.hasPlaceholder()&&t.placeholder?.c(),t.c(),t.invalidateConnectedLinks())}S(){const t=this.diagram;null!==t&&!this._e()&&!this.th()&&this.isVisible()&&this.Ni.isReal()&&t.S(this.qh(this.Ni))}c(){if(this.Ao())return;super.c();const t=this.diagram;null!==t&&(t._m(this),this instanceof Ce&&null!==this.labeledLink&&this.labeledLink.ef(),t.requestUpdate(!0))}ef(t){if(this._e())return;const e=this.diagram;null!==e&&(e._m(this),this instanceof Ce&&this.invalidateConnectedLinks(),e.requestUpdate()),this.Jn(!0)}Rm(t){if(!t){const t=this.wh;null!==t&&t.eN(this)}}vm(t){if(!t){const t=this.wh;null!==t&&t.iN(this)}}Xc(){const t=this.data;if(null!==t){const e=this.diagram;if(null!==e){const i=e.model;null!==i&&i.removeNodeData(t)}}}get containingGroupChanged(){return null!==this.H?this.H.Zp:null}set containingGroupChanged(t){const i=this.containingGroupChanged;i!==t&&(null!==t&&e.k(t,ke,"containingGroupChanged"),this.ji().Zp=t,this.t("containingGroupChanged",i,t))}findSubGraphLevel(){return this.sN(this)}sN(t){const e=t.containingGroup;if(null!==e)return 1+this.sN(e);if(t instanceof Ce){const e=t.labeledLink;if(null!==e)return this.sN(e)}return 0}findTopLevelPart(){return this.nN(this)}nN(t){const e=t.containingGroup;if(null!==e)return this.nN(e);if(t instanceof Ce){const e=t.labeledLink;if(null!==e)return this.nN(e)}return t}get isTopLevel(){return!(null!==this.containingGroup||this instanceof Ce&&null!==this.labeledLink)}isMemberOf(t){return t instanceof _e&&this.oN(this,t)}oN(t,e){if(t===e||null===e)return!1;const i=t.containingGroup;if(null!==i&&(i===e||this.oN(i,e)))return!0;if(t instanceof Ce){const i=t.labeledLink;if(null!==i)return this.oN(i,e)}return!1}findCommonContainingGroup(t){if(null===t)return null;if(this===t)return this.containingGroup;let e=this;for(;null!==e;){if(e instanceof _e&&e.g1(!0),e instanceof Ce){const t=e.labeledLink;null!==t&&(e=t)}e=e.containingGroup}let i=null;for(e=t;null!==e;){if(e.uT()){i=e;break}if(e instanceof Ce){const t=e.labeledLink;null!==t&&(e=t)}e=e.containingGroup}for(e=this;null!==e;){if(e instanceof _e&&e.g1(!1),e instanceof Ce){const t=e.labeledLink;null!==t&&(e=t)}e=e.containingGroup}return i}get layoutConditions(){return null!==this.H?this.H.Qp:127}set layoutConditions(t){const e=this.layoutConditions;e!==t&&(this.ji().Qp=t,this.t("layoutConditions",e,t))}canLayout(){if(!this.isLayoutPositioned||!this.isVisible())return!1;const t=this.layer;return!(null!==t&&t.isTemporary||this instanceof Ce&&this.isLinkLabel)}oO(t){if(!this.isLayoutPositioned||!(t&this.layoutConditions))return!1;const e=this.layer;if(null!==e&&e.isTemporary||this instanceof Ce&&this.isLinkLabel)return!1;const i=this.diagram;return!(null!==i&&i.undoManager.isUndoingRedoing)}invalidateLayout(t){if(void 0===t&&(t=16777215),!this.oO(t))return;const e=this.wh;if(null!==e){const i=e.layout;null!==i?i.invalidateLayout():e.invalidateLayout(t)}else{const t=this.diagram;if(null!==t){const e=t.layout;null!==e&&e.invalidateLayout()}}}HL(){if(!this.isVisible())return!1;const t=this.layer;return!(null!==t&&t.isTemporary)}static nh(t,e,i,s,n,o){if(void 0===o&&(o=null),!t.has(e)&&(null===o||o(e))&&!(e instanceof Pe))if(t.add(e),e instanceof Ce){if(i&&e instanceof _e){const r=e.memberParts;for(;r.next();){const e=r.value;ke.nh(t,e,i,s,n,o)}}if(!1!==n){const r=e.linksConnected;for(;r.next();){const e=r.value;if(t.has(e))continue;const a=e.fromNode,h=e.toNode,l=null===a||t.has(a),u=null===h||t.has(h);(n?l&&u:l||u)&&ke.nh(t,e,i,s,n,o)}}if(s>1){const r=e.findTreeChildrenNodes();for(;r.next();){const e=r.value;ke.nh(t,e,i,s-1,n,o)}}}else if(e instanceof De){const r=e.labelNodes;for(;r.next();){const e=r.value;ke.nh(t,e,i,s,n,o)}}}get dragComputation(){return null!==this.H?this.H._p:null}set dragComputation(t){const i=this.dragComputation;i!==t&&(null!==t&&e.k(t,ke,"dragComputation"),this.ji()._p=t,this.t("dragComputation",i,t))}get shadowOffset(){return null!==this.H?this.H.ty:y.pC}set shadowOffset(t){const e=this.shadowOffset;e.equals(t)||(t=t.P(),this.ji().ty=t,this.S(),this.t("shadowOffset",e,t))}get shadowColor(){return null!==this.H?this.H.iy:"gray"}set shadowColor(t){const e=this.shadowColor;e!==t&&(this.ji().iy=t,this.S(),this.t("shadowColor",e,t))}get shadowBlur(){return null!==this.H?this.H.un:4}set shadowBlur(t){const e=this.shadowBlur;e!==t&&(this.ji().un=t,this.S(),this.t("shadowBlur",e,t))}}class Se{fi;Ep;Zp;Kp;Yp;Gp;Xp;Hp;jp;qp;Wp;Jp;$p;Vp;zp;Bp;Up;_p;Qp;ty;iy;un;constructor(){this.fi=!1,this.Ep=null,this.Zp=null,this.Kp=null,this.Yp="",this.Gp=null,this.Xp=null,this.Hp=null,this.jp="",this.qp=v.pw,this.Wp=null,this.Jp="",this.$p=w.Default,this.Vp="",this.zp=w.TopLeft,this.Bp=y.gC,this.Up=y.mC,this._p=null,this.Qp=127,this.ty=y.pC,this.iy="gray",this.un=4}copy(){const t=new Se;return t.Ep=this.Ep,t.Zp=this.Zp,t.Kp=this.Kp,t.Yp=this.Yp,t.Gp=this.Gp,t.Xp=this.Xp,t.Hp=this.Hp,t.jp=this.jp,t.qp=this.qp.P(),t.Wp=this.Wp,t.Jp=this.Jp,t.$p=this.$p.P(),t.Vp=this.Vp,t.zp=this.zp.P(),t.Bp=this.Bp.P(),t.Up=this.Up.P(),t._p=this._p,t.Qp=this.Qp,t.ty=this.ty.P(),t.iy=this.iy,t.un=this.un,t}}class Pe extends ke{us;Ft;sS;nS;hf;constructor(t,e){let i;void 0===t||t instanceof $t||"string"==typeof t?i=t:t&&(e=t),super(i),this.w&=-257,this.sl="Adornment",this.us=null,this.sS=0,this.nS=!1,this.Ft=null,this.hf=null,e&&Object.assign(this,e)}toString(){const t=this.adornedPart;return"Adornment("+this.category+")"+(null!==t?t.toString():"")}updateRelationshipsFromData(){}sd(t){const e=this.adornedObject;if(!(e instanceof he))return;const i=e.part;if(!(i instanceof De))return;const s=i.path;let n=s.geometry;i.sd(t),n=s.geometry;const o=this.C.r,r=o.length;for(let a=0;a<r;a++){const t=o[a];t.isPanelMain&&t instanceof he&&(t.ot=n)}}hasPlaceholder(){return null!==this.Ft&&this.Ft.isVisibleObject()}get placeholder(){return this.Ft}get adornedObject(){return this.us}set adornedObject(t){const e=this.adornedPart;let i=null;null!==t&&(i=t.part),null!==e&&(null===t||e!==i)&&e.removeAdornment(this.category),this.us=t,null!==i&&i.addAdornment(this.category,this)}get adornedPart(){const t=this.us;return null!==t?t.part:null}Xr(){const t=this.us;if(null===t)return!0;const e=t.part;return null===e||!e._e()}ke(){return!1}get containingGroup(){return null}qc(t,e,i,s,n,o,r){if(3===t&&"elements"===e){if(n instanceof Ve)null===this.Ft&&(this.Ft=n);else if(n instanceof ie){const t=n.findInVisualTree((t=>t instanceof Ve));t instanceof Ve&&null===this.Ft&&(this.Ft=t)}}else 4===t&&"elements"===e&&null!==this.Ft&&(s===this.Ft||s instanceof ie&&this.Ft.isContainedBy(s))&&(this.Ft=null);super.qc(t,e,i,s,n,o,r)}updateAdornments(){}Xc(){}}var Me=(t=>(t[t.None=0]="None",t[t.Evenly=1]="Evenly",t[t.Packed=2]="Packed",t))(Me||{});class Ce extends ke{v;Rt;kf;ol;xh;ne;ti;constructor(t,e){let i;void 0===t||t instanceof $t||"string"==typeof t?i=t:t&&(e=t),super(i),this.v=13,this.Rt=null,this.ti=new h,this.kf=null,this.ol=null,this.ne=null,this.xh=!1,e&&Object.assign(this,e)}cloneProtected(t){super.cloneProtected(t),t.v=this.v,null!==this.Rt&&(this.Rt.fi?t.Rt=this.Rt:t.Rt=this.Rt.copy())}Ro(t){super.Ro(t),t.invalidateConnectedLinks(),t.ol=this.ol,t.ne=null}static SpreadingNone=0;static SpreadingEvenly=1;static SpreadingPacked=2;rl(){return null===this.Rt?this.Rt=new Ae:this.Rt.fi&&(this.Rt=this.Rt.copy()),this.Rt}ah(){super.ah(),null!==this.Rt&&(this.Rt.fi=!0)}dT(t){null!==t&&(null===this.ol&&(this.ol=new u),this.ol.add(t))}gT(t){null!==t&&null!==this.ol&&this.ol.delete(t)}mT(t,e,i){if(null===t||null===this.ol)return null;const s=this.ol.iterator;for(;s.next();){const n=s.value;if(n.ey===this&&n.m1===t&&n.rN===e&&n.lN===i||n.ey===t&&n.m1===this&&n.rN===i&&n.lN===e)return n}return null}invalidateLinkBundle(t,e,i){null==e&&(e=""),null==i&&(i="");const s=this.mT(t,e,i);null!==s&&s.Sd()}qc(t,e,i,s,n,o,r){(3===t&&"elements"===e||4===t&&"elements"===e)&&(this.ne=null),super.qc(t,e,i,s,n,o,r)}invalidateConnectedLinks(t){const e=this.linksConnected;for(;e.next();){const i=e.value;void 0!==t&&t.has(i)||(this.qi(i.fromPort),this.qi(i.toPort),i.invalidateRoute())}}bA(t){const e=this.linksConnected;for(;e.next();){const i=e.value;i.fromPort!==t&&i.toPort!==t||(this.qi(i.fromPort),this.qi(i.toPort),i.invalidateRoute())}}qi(t){if(null===t)return;const e=t.Gu;null!==e&&e.Sd();const i=t.part,s=i.containingGroup;null!==s&&!i.isVisible()&&s.qi(s.port)}Xr(){return!0}get portSpreading(){return null!==this.Rt?this.Rt.ny:1}set portSpreading(t){const e=this.portSpreading;if(e!==t){this.rl().ny=t,this.t("portSpreading",e,t);const i=this.diagram;if(null!==i&&i.undoManager.isUndoingRedoing)return;this.invalidateConnectedLinks()}}get avoidable(){return 0!==(8&this.v)}set avoidable(t){const e=0!==(8&this.v);if(e!==t){this.v=8^this.v;const i=this.diagram;null!==i&&i.WM(this),this.t("avoidable",e,t)}}get avoidableMargin(){return null!==this.Rt?this.Rt.ly:b.PC}set avoidableMargin(t){"number"==typeof t&&(t=new b(t));const e=this.avoidableMargin;if(!e.equals(t)){t=t.P(),this.rl().ly=t;const i=this.diagram;null!==i&&i.WM(this),this.t("avoidableMargin",e,t)}}canAvoid(){return this.avoidable&&!this.isLinkLabel}getAvoidableRect(t){return t.set(this.actualBounds),t.addMargin(this.avoidableMargin),t}findVisibleNode(){let t=this;for(;null!==t&&!t.isVisible();)t=t.containingGroup;return t}isVisible(){if(!super.isVisible())return!1;let t=!0,e=1;const i=this.diagram;if(null!==i){if(i.animationManager.nx(this))return!0;t=i.isTreePathToChildren,e=i.treeCollapsePolicy}if(1===e){const t=this.findTreeParentNode();if(null!==t&&!t.isTreeExpanded)return!1}else if(2===e){const e=t?this.findLinksInto():this.findLinksOutOf();let i=!1,s=!1;for(;e.next();){const n=e.value;if(n.isTreeLink){i=!0;const e=t?n.fromNode:n.toNode;if(e&&e.isTreeExpanded){s=!0;break}}}if(i&&!s)return!1}else if(3===e){const e=t?this.findLinksInto():this.findLinksOutOf();let i=!1,s=!1;for(;e.next();){const n=e.value;if(n.isTreeLink){i=!0;const e=t?n.fromNode:n.toNode;if(e&&!e.isTreeExpanded){s=!0;break}}}if(i&&s)return!1}const s=this.labeledLink;return null===s||s.isVisible()}Ei(t){super.Ei(t);const e=this.linksConnected;for(;e.next();){const i=e.value;if(t&&null!==this.containingGroup){const t=i.getOtherNode(this);null!==t&&!t.isMemberOf(this.containingGroup)&&i.invalidateRoute()}i.Ei(t)}}get linksConnected(){return this.ti.iterator}findExternalTreeLinksConnected(){const t=new u,e=new u;return this.pT(this,t,e),e.iterator}pT(t,e,i){if(null===t||e.has(t))return;e.add(t);let s=!0;const n=this.diagram;null!==n&&(s=n.isTreePathToChildren),t.linksConnected.each((n=>{n.isTreeLink?(s?n.fromNode===t:n.toNode===t)&&this.pT(s?n.toNode:n.fromNode,e,i):i.add(n)}))}findLinksConnected(t){if(void 0===t&&(t=null),null===t)return this.ti.iterator;const e=new r(this.ti),i=this;return e.predicate=e=>e.fromNode===i&&e.fromPortId===t||e.toNode===i&&e.toPortId===t,e}findLinksOutOf(t){void 0===t&&(t=null);const e=new r(this.ti),i=this;return e.predicate=e=>e.fromNode===i&&(null===t||e.fromPortId===t),e}findLinksInto(t){void 0===t&&(t=null);const e=new r(this.ti),i=this;return e.predicate=e=>e.toNode===i&&(null===t||e.toPortId===t),e}findNodesConnected(t){void 0===t&&(t=null);let e=null,i=null;const s=this.ti.iterator;for(;s.next();){const n=s.value;if(n.fromNode===this){if(null===t||n.fromPortId===t){const t=n.toNode;null!==e?e.add(t):null!==i&&i!==t?(e=new u,e.add(i),e.add(t)):i=t}}else if(n.toNode===this&&(null===t||n.toPortId===t)){const t=n.fromNode;null!==e?e.add(t):null!==i&&i!==t?(e=new u,e.add(i),e.add(t)):i=t}}return null!==e?e.iterator:null!==i?new o(i):n.instance}findNodesOutOf(t){void 0===t&&(t=null);let e=null,i=null;const s=this.ti.iterator;for(;s.next();){const n=s.value;if(n.fromNode===this&&(null===t||n.fromPortId===t)){const t=n.toNode;null!==e?e.add(t):null!==i&&i!==t?(e=new u,e.add(i),e.add(t)):i=t}}return null!==e?e.iterator:null!==i?new o(i):n.instance}findNodesInto(t){void 0===t&&(t=null);let e=null,i=null;const s=this.ti.iterator;for(;s.next();){const n=s.value;if(n.toNode===this&&(null===t||n.toPortId===t)){const t=n.fromNode;null!==e?e.add(t):null!==i&&i!==t?(e=new u,e.add(i),e.add(t)):i=t}}return null!==e?e.iterator:null!==i?new o(i):n.instance}findLinksBetween(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null);const s=new r(this.ti),n=this;return s.predicate=s=>s.fromNode===n&&s.toNode===t&&(null===e||s.fromPortId===e)&&(null===i||s.toPortId===i)||s.fromNode===t&&s.toNode===n&&(null===i||s.fromPortId===i)&&(null===e||s.toPortId===e),s}findLinksTo(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null);const s=new r(this.ti),n=this;return s.predicate=s=>!(s.fromNode!==n||s.toNode!==t||null!==e&&s.fromPortId!==e||null!==i&&s.toPortId!==i),s}get linkConnected(){return null!==this.Rt?this.Rt.hy:null}set linkConnected(t){const i=this.linkConnected;i!==t&&(null!==t&&e.k(t,Ce,"linkConnected"),this.rl().hy=t,this.t("linkConnected",i,t))}get linkDisconnected(){return null!==this.Rt?this.Rt.ay:null}set linkDisconnected(t){const i=this.linkDisconnected;i!==t&&(null!==t&&e.k(t,Ce,"linkDisconnected"),this.rl().ay=t,this.t("linkDisconnected",i,t))}get linkValidation(){return null!==this.Rt?this.Rt.Sl:null}set linkValidation(t){const i=this.linkValidation;i!==t&&(null!==t&&e.k(t,Ce,"linkValidation"),this.rl().Sl=t,this.t("linkValidation",i,t))}p1(t,e){this.qi(e);const i=this.ti.has(t);if(i||this.ti.add(t),!i||t.fromNode===t.toNode){const i=this.linkConnected;if(null!==i){let s=!0;const n=this.diagram;null!==n&&(s=n.X,n.X=!0),i(this,t,e),null!==n&&(n.X=s)}}if(!i){if(!t.isTreeLink)return;const e=t.fromNode,i=t.toNode;if(null!==e&&null!==i&&e!==i){let t=!0;const s=this.diagram;null!==s&&(t=s.isTreePathToChildren);const n=t?i:e,o=t?e:i;if(n.xh||(n.xh=o),o.isTreeLeaf){if(null!==s&&s.undoManager.isUndoingRedoing)return;t?e===o&&(o.isTreeLeaf=!1):i===o&&(o.isTreeLeaf=!1)}}}}w1(t,e){this.qi(e);const i=this.ti.delete(t);let s=null;if(i||t.toNode===t.fromNode){const i=this.linkDisconnected;if(s=this.diagram,null!==i){let n=!0;null!==s&&(n=s.X,s.X=!0),i(this,t,e),null!==s&&(s.X=n)}}if(i){if(!t.isTreeLink)return;let e=!0;null!==s&&(e=s.isTreePathToChildren);const i=e?t.toNode:t.fromNode,n=e?t.fromNode:t.toNode;if(null!==i&&(i.xh=!1),null!==n&&!n.isTreeLeaf)if(0===n.ti.count){if(n.xh=null,null!==s&&s.undoManager.isUndoingRedoing)return;n.isTreeLeaf=!0}else n.r0()}}r0(){if(this.xh=!1,0===this.ti.count)return;let t=!0;const e=this.diagram;if(null!==e&&e.undoManager.isUndoingRedoing)return;null!==e&&(t=e.isTreePathToChildren);const i=this.ti.iterator;for(;i.next();){const e=i.value;if(e.isTreeLink)if(t){if(e.fromNode===this)return void(this.isTreeLeaf=!1)}else if(e.toNode===this)return void(this.isTreeLeaf=!1)}this.isTreeLeaf=!0}updateRelationshipsFromData(){const t=this.diagram;null!==t&&t.partManager.updateRelationshipsFromData(this)}Rm(t){if(super.Rm(t),!t){this.r0();const t=this.kf;null!==t&&t.yT(this)}}vm(t){if(super.vm(t),!t){const t=this.kf;null!==t&&t.wT(this)}}Xc(){if(this.ti.count>0){const t=this.diagram;if(null!==t){const e=null===t.commandHandler||t.commandHandler.deletesConnectedLinks,i=this.ti.copy().iterator;for(;i.next();){const s=i.value;e?t.remove(s):(s.fromNode===this&&(s.fromNode=null),s.toNode===this&&(s.toNode=null))}}}this.labeledLink=null,super.Xc()}get isLinkLabel(){return null!==this.kf}get labeledLink(){return this.kf}set labeledLink(t){const e=this.kf;if(e!==t){const i=this.diagram,s=this.data;if(null!==e){if(e.wT(this),null!==i&&null!==s&&!i.undoManager.isUndoingRedoing){const t=e.data,n=i.model;if(null!==t&&n.Ra()){const e=n.getKeyForNodeData(s);void 0!==e&&n.removeLabelKeyForLinkData(t,e)}}this.containingGroup=null}if(this.kf=t,null!==t){if(t.yT(this),null!==i&&null!==s&&!i.undoManager.isUndoingRedoing){const e=t.data,n=i.model;if(null!==e&&n.Ra()){const t=n.getKeyForNodeData(s);void 0!==t&&n.addLabelKeyForLinkData(e,t)}}this.containingGroup=t.containingGroup}this.ef(),this.t("labeledLink",e,t)}}findVisiblePort(t){let e=t;for(;null!==e&&(!e.actualBounds.isReal()||!e.isVisibleObject());)e=e.panel;return null===e?this.port:e}findPort(t){if(null===this.ne){if(""===t&&!1===this.fn)return this;this.xT()}let e=this.ne.get(t);return null!==e||""!==t&&(e=this.ne.get(""),null!==e)?e:this}get port(){return this.findPort("")}get ports(){return null===this.ne&&this.xT(),this.ne.iteratorValues}xT(){null===this.ne?this.ne=new m:this.ne.clear(),this.walkVisualTreeFrom(this,((t,e)=>t.LA(e))),0===this.ne.count&&this.ne.set("",this)}LA(t){const e=t.portId;null!==e&&null!==this.ne&&this.ne.set(e,t)}N2(t,i){const s=t.portId;if(null!==s){null!==this.ne&&this.ne.delete(s);const t=this.diagram;if(null!==t&&i){let i=null;const n=this.findLinksConnected(s);for(;n.next();){const t=n.value;null===i&&(i=e.et()),i.push(t)}if(null!==i){for(let e=0;e<i.length;e++){const s=i[e];t.remove(s)}e.J(i)}}}}isInTreeOf(t){if(null===t||t===this)return!1;let e=!0;const i=this.diagram;null!==i&&(e=i.isTreePathToChildren);let s=this;const n=t;let o;if(e)for(;s!==n;){o=null;const t=s.ti.iterator;for(;t.next();){const e=t.value;if(e.isTreeLink&&(o=e.fromNode,o!==s&&o!==this))break}if(o===this||null===o||o===s)return!1;s=o}else for(;s!==n;){o=null;const t=s.ti.iterator;for(;t.next();){const e=t.value;if(e.isTreeLink&&(o=e.toNode,o!==s&&o!==this))break}if(o===this||null===o||o===s)return!1;s=o}return!0}findTreeRoot(){let t=!0;const e=this.diagram;null!==e&&(t=e.isTreePathToChildren);let i,s=this;if(t)for(;;){i=null;const t=s.ti.iterator;for(;t.next();){const e=t.value;if(e.isTreeLink&&(i=e.fromNode,i!==s&&i!==this))break}if(i===this)return this;if(null===i||i===s)return s;s=i}else for(;;){i=null;const t=s.ti.iterator;for(;t.next();){const e=t.value;if(e.isTreeLink&&(i=e.toNode,i!==s&&i!==this))break}if(i===this)return this;if(null===i||i===s)return s;s=i}}findCommonTreeParent(t){if(null===t)return null;if(this===t)return this;let e=this;for(;null!==e;)e.g1(!0),e=e.findTreeParentNode();let i=null;for(e=t;null!==e;){if(e.uT()){i=e;break}e=e.findTreeParentNode()}for(e=this;null!==e;)e.g1(!1),e=e.findTreeParentNode();return i}findTreeParentLink(){let t=!0;const e=this.diagram;null!==e&&(t=e.isTreePathToChildren);const i=this.ti.iterator;if(t)for(;i.next();){const t=i.value;if(t.isTreeLink&&t.fromNode!==this)return t}else for(;i.next();){const t=i.value;if(t.isTreeLink&&t.toNode!==this)return t}return null}findTreeParentNode(){const t=this.xh;if(null===t)return null;if(t instanceof Ce)return t;const e=this.diagram,i=null===e||e.isTreePathToChildren,s=this.ti.iterator;for(;s.next();){const t=s.value;if(!t.isTreeLink)continue;const e=i?t.fromNode:t.toNode;if(e!==this)return this.xh=e,e}return this.xh=null,null}findTreeParentChain(){function t(e,i){i.add(e);const s=e.findTreeParentLink();if(null!==s){i.add(s);const n=e.findTreeParentNode();if(null===n)return;t(n,i)}}const e=new u;return t(this,e),e}findTreeLevel(){return this.rO(this)}rO(t){let e=0,i=t.findTreeParentNode();for(;null!==i&&i!==t;)i=i.findTreeParentNode(),e++;return e}findTreeChildrenLinks(){let t=!0;const e=this.diagram;null!==e&&(t=e.isTreePathToChildren);const i=new r(this.ti),s=this;return i.predicate=t?t=>!(!t.isTreeLink||t.fromNode!==s):t=>!(!t.isTreeLink||t.toNode!==s),i}findTreeChildrenNodes(){let t=!0;const e=this.diagram;null!==e&&(t=e.isTreePathToChildren);let i=null,s=null;const r=this.ti.iterator;if(t)for(;r.next();){const t=r.value;if(t.isTreeLink&&t.fromNode===this){const e=t.toNode;null!==i?i.add(e):null!==s&&s!==e?(i=new h,i.add(s),i.add(e)):s=e}}else for(;r.next();){const t=r.value;if(t.isTreeLink&&t.toNode===this){const e=t.fromNode;null!==i?i.add(e):null!==s&&s!==e?(i=new h,i.add(s),i.add(e)):s=e}}return null!==i?i.iterator:null!==s?new o(s):n.instance}findTreeParts(t){void 0===t&&(t=1/0),e.s(t,"number",Ce,"findTreeParts:level");const i=new u;return ke.nh(i,this,!1,t,!0),i}collapseTree(t){void 0===t&&(t=1),t<1&&(t=1);const e=this.diagram;if(null===e||e.isCollapsingExpanding)return;e.isCollapsingExpanding=!0;const i=new u;i.add(this),this.bT(i,e.isTreePathToChildren,t,e,this,1===e.treeCollapsePolicy),e.isCollapsingExpanding=!1}bT(t,e,i,s,n,o){if(i>1){const r=e?this.findLinksOutOf():this.findLinksInto();for(;r.next();){const a=r.value;if(!a.isTreeLink)continue;const h=a.getOtherNode(this);null!==h&&h!==this&&!t.has(h)&&(t.add(h),h.bT(t,e,i-1,s,n,o))}}else this.kT(t,e,s,n,o)}kT(t,e,i,s,n){const o=s===this||this.isTreeExpanded,r=e?this.findLinksOutOf():this.findLinksInto();for(;r.next();){const a=r.value;if(!a.isTreeLink)continue;const h=a.getOtherNode(this);if(null!==h&&h!==this){const r=t.has(h);if(r||t.add(h),o){const t=e?h.findNodesInto():h.findNodesOutOf(),n=this;t.all((t=>t===n||!t.isTreeExpanded))&&i.Lc(h,s),h.uh(),h.Ei(!1)}h.isTreeExpanded&&(h.wasTreeExpanded=h.isTreeExpanded,r||h.kT(t,e,i,s,n))}}this.isTreeExpanded=!1}expandTree(t){void 0===t&&(t=2),t<2&&(t=2);const e=this.diagram;if(null===e||e.isCollapsingExpanding)return;e.isCollapsingExpanding=!0;const i=new u;i.add(this),this.PT(i,e.isTreePathToChildren,t,e,this,1===e.treeCollapsePolicy),e.isCollapsingExpanding=!1}PT(t,e,i,s,n,o){const r=n!==this&&this.isTreeExpanded,a=e?this.findLinksOutOf():this.findLinksInto();for(;a.next();){const h=a.value;if(!h.isTreeLink)continue;r||h.Se||h.invalidateRoute();const l=h.getOtherNode(this);if(null!==l&&l!==this&&!t.has(l)){if(t.add(l),!r){l.Ei(!0),l.uh();const t=e?l.findNodesInto():l.findNodesOutOf(),i=this;t.all((t=>t===i||!t.isTreeExpanded))&&s.Cc(l,n)}(i>2||l.wasTreeExpanded)&&(l.wasTreeExpanded=!1,l.PT(t,e,i-1,s,n,o))}}this.isTreeExpanded=!0}get isTreeExpanded(){return 0!==(1&this.v)}set isTreeExpanded(t){const e=0!==(1&this.v);if(e!==t){this.v=1^this.v;const i=this.diagram;this.t("isTreeExpanded",e,t);const s=this.treeExpandedChanged;if(null!==s){let t=!0;null!==i&&(t=i.X,i.X=!0),s(this),null!==i&&(i.X=t)}if(null!==i&&i.undoManager.isUndoingRedoing)return void this.Ei(t);t?this.expandTree():this.collapseTree()}}get wasTreeExpanded(){return 0!==(2&this.v)}set wasTreeExpanded(t){const e=0!==(2&this.v);e!==t&&(this.v=2^this.v,this.t("wasTreeExpanded",e,t))}get treeExpandedChanged(){return null!==this.Rt?this.Rt.cy:null}set treeExpandedChanged(t){const i=this.treeExpandedChanged;i!==t&&(null!==t&&e.k(t,Ce,"treeExpandedChanged"),this.rl().cy=t,this.t("treeExpandedChanged",i,t))}get isTreeLeaf(){return 0!==(4&this.v)}set isTreeLeaf(t){const e=0!==(4&this.v);e!==t&&(this.v=4^this.v,this.t("isTreeLeaf",e,t))}get isTreeRoot(){return null===this.findTreeParentLink()}}class Ae{fi;hy;ay;Sl;cy;ly;ny;fy;uy;eh;gy;constructor(){this.fi=!1,this.hy=null,this.ay=null,this.Sl=null,this.cy=null,this.ly=b.PC,this.ny=1,this.fy=null,this.uy=null,this.eh=null,this.gy=null}copy(){const t=new Ae;return t.hy=this.hy,t.ay=this.ay,t.Sl=this.Sl,t.cy=this.cy,t.ly=this.ly.P(),t.ny=this.ny,t.fy=this.fy,t.uy=this.uy,t.eh=this.eh,t.gy=this.gy,t}}var Ne=(t=>(t[t.None=0]="None",t[t.End=17]="End",t[t.Scale=18]="Scale",t[t.Stretch=19]="Stretch",t))(Ne||{}),Le=(t=>(t[t.Normal=1]="Normal",t[t.Orthogonal=2]="Orthogonal",t[t.AvoidsNodes=6]="AvoidsNodes",t[t.AvoidsNodesStraight=7]="AvoidsNodesStraight",t))(Le||{}),Te=(t=>(t[t.None=0]="None",t[t.Bezier=9]="Bezier",t[t.JumpGap=10]="JumpGap",t[t.JumpOver=11]="JumpOver",t))(Te||{});class De extends ke{Mt;eo;so;Md;no;oo;Nd;Pf;Cd;Ld;Ad;va;Td;Hs;xi;ll;xr;Sf;Ko;hN;aN;b1;cN;fN;Oa;k1;ot;Go;static Ia=null;static Ea=null;hf;uN;dN;constructor(t){super(ie.Link),this.Mt=8,this.eo=null,this.so="",this.Md=null,this.no=null,this.oo="",this.Nd=null,this.Pf=0,this.Cd=0,this.Ld=0,this.Ad=NaN,this.va=1,this.Td=.5,this.Hs=null,this.xi=(new h).u(),this.ll=null,this.xr=null,this.Sf=new x,this.ot=new C,this.Ko=null,this.Go=null,this.hN=null,this.aN=null,this.uN=0,this.dN=0,this.b1=new y,this.cN=null,this.fN=null,this.Oa=null,this.k1=NaN,this.ct=null,this.hf=[],t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.Mt=-113&this.Mt,t.so=this.so,t.Md=this.Md,t.oo=this.oo,t.Nd=this.Nd,t.Pf=this.Pf,t.Cd=this.Cd,t.Ld=this.Ld,t.Ad=this.Ad,t.va=this.va,t.Td=this.Td,null!==this.ct&&(t.ct=this.ct.copy())}Ro(t){super.Ro(t),this.so=t.so,this.oo=t.oo,t.ll=null,t.invalidateRoute(),t.Go=this.Go;const e=t.fromPort;null!==e&&t.fromNode.qi(e);const i=t.toPort;null!==i&&t.toNode.qi(i)}oi(t){t in Le||t in Te||t in Ne?De.gN(t)?this.routing=t:9===t||10===t||11===t?this.curve=t:17===t||18===t||19===t?this.adjusting=t:1===t||0===t||e.o("Unknown Link enum value for a Link property: "+t):super.oi(t)}static Normal=1;static Orthogonal=2;static AvoidsNodes=6;static AvoidsNodesStraight=7;static None=0;static Bezier=9;static JumpGap=10;static JumpOver=11;static End=17;static Scale=18;static Stretch=19;static OrientAlong=21;static OrientPlus90=22;static OrientMinus90=23;static OrientOpposite=24;static OrientUpright=25;static OrientPlus90Upright=26;static OrientMinus90Upright=27;static OrientUpright45=28;static lO=8;static hO=16;static aO=14;static Ba=8;Ue(){return null===this.ct&&(this.ct=new Be),this.ct}xv(t,i,s){const n=t.segmentIndex,o=t.segmentFraction;let r=t.alignmentFocus;const a=t.segmentOrientation,h=t.segmentOffset;let l=0,u=0,c=0,d=0;if(isNaN(n)){const i=this.ot,s=e.et();i.getPointAndAngleAlongPath(o,s);const n=y.V(s[0],s[1]);if(n.add(this.getPoint(0)),1===i.type)n.offset(-i.startX,-i.startY);else{const t=i.figures.first();n.offset(-t.startX,-t.startY)}d=s[2],0!==a&&(c=this.computeAngle(t,a,d),t.angle=c),l=n.x,u=n.y,y.e(n),e.J(s)}else if(n<-i||n>=i){const e=y.l();this.OA(e),d=this.midAngle,0!==a&&(c=this.computeAngle(t,a,d),t.angle=c),l=e.x,u=e.y,y.e(e)}else{let e,r,h=0;if(n>=0?(e=s.r[n],r=n<i-1?s.r[n+1]:e):(h=i+n,e=s.r[h],r=h>0?s.r[h-1]:e),e.equalsApprox(r)){let t,o;n>=0?(t=n>0?s.r[n-1]:e,o=n<i-2?s.r[n+2]:r):(t=h<i-1?s.r[h+1]:e,o=h>1?s.r[h-2]:r);const a=t.distanceSquaredPoint(e),l=r.distanceSquaredPoint(o);d=a>l+10?n>=0?t.directionPoint(e):e.directionPoint(t):l>a+10?n>=0?r.directionPoint(o):o.directionPoint(r):n>=0?t.directionPoint(o):o.directionPoint(t)}else d=n>=0?e.directionPoint(r):r.directionPoint(e);0!==a&&(c=this.computeAngle(t,a,d),t.angle=c),l=e.x+(r.x-e.x)*o,u=e.y+(r.y-e.y)*o}if(r.isNone())return void(t.location=new y(l,u));r.isNoSpot()&&(r=w.Center);const f=k.l();f.Ri(),f.tt(t.scale,t.scale),f.cs(t.angle,0,0);const g=t.naturalBounds,p=x.V(0,0,g.width,g.height),m=y.l();m.setRectSpot(p,r),f.gt(m);let v=-m.x,b=-m.y;const S=g.width,P=g.height,M=y.l();M.a(h);const C=isNaN(h.x),A=isNaN(h.y);if(C||A){const t=S/2+3,e=P/2+3,i=d>=45&&d<=135,s=d>=225&&d<=315;0===a&&(i||s)?(M.x=A?t:h.y,M.y=C?e:h.x,i?n>=0||isNaN(n)&&o<.5||C&&(M.y=-e):s&&((n>=0||isNaN(n)&&o<.5)&&C&&(M.y=-e),A&&(M.x=-t))):(C&&(n>=0||isNaN(n)&&o<.5?M.x=t:M.x=-t),A&&(M.y=-e),M.rotate(d))}else M.rotate(d);l+=M.x,u+=M.y,f.vg(p),v+=p.x,b+=p.y;const N=y.V(l+v,u+b);t.move(N),y.e(N),y.e(M),y.e(m),x.e(p),k.e(f)}Xr(){let t=this.fromNode;if(null!==t){const e=t.findVisibleNode();if(null!==e&&(t=e),t._e()||t.th())return!1}let e=this.toNode;if(null!==e){const t=e.findVisibleNode();if(null!==t&&(e=t),e._e()||e.th())return!1}return!0}S2(t,e,i){return!1}M2(){}ke(){return!1}computeAngle(t,e,i){return De.computeAngle(e,i)}static computeAngle(t,e){let i=0;switch(t){default:case 0:i=0;break;case 21:i=e;break;case 22:i=e+90;break;case 23:i=e-90;break;case 24:i=e+180;break;case 25:i=S.Bg(e),i>90&&i<270&&(i-=180);break;case 26:i=S.Bg(e+90),i>90&&i<270&&(i-=180);break;case 27:i=S.Bg(e-90),i>90&&i<270&&(i-=180);break;case 28:if(i=S.Bg(e),i>45&&i<135||i>225&&i<315)return 0;i>90&&i<270&&(i-=180);break}return S.Bg(i)}get fromNode(){return this.eo}set fromNode(t){const e=this.eo;if(e!==t){const i=this.fromPort;null!==e&&(this.no!==e&&e.w1(this,i),this.my(),this.invalidateLayout(2)),this.eo=t,null!==t&&this.Ei(t.isVisible()),this.Ko=null,this.invalidateRoute();const s=this.diagram;null!==s&&s.X&&s.partManager.setFromNodeForLink(this,t,e);const n=this.fromPort,o=this.fromPortChanged;if(null!==o){let t=!0;null!==s&&(t=s.X,s.X=!0),o(this,i,n),null!==s&&(s.X=t)}null!==t&&(this.no!==t&&t.p1(this,n),this.yy(),this.invalidateLayout(1)),this.t("fromNode",e,t),this.Pd()}}get fromPortId(){return this.so}set fromPortId(t){const e=this.so;if(e!==t){const i=this.fromPort;null!==i&&this.fromNode?.qi(i),this.my(),this.so=t;const s=this.fromPort;null!==s&&this.fromNode?.qi(s);const n=this.diagram;if(null!==n){const e=this.data,i=n.model;null!==e&&i.Ra()&&i.setFromPortIdForLinkData(e,t)}if(i!==s){this.Ko=null,this.invalidateRoute();const t=this.fromPortChanged;if(null!==t){let e=!0;null!==n&&(e=n.X,n.X=!0),t(this,i,s),null!==n&&(n.X=e)}}this.yy(),this.t("fromPortId",e,t)}}get fromPort(){const t=this.eo;if(null===t)return null;const e=this.so;return t.findPort(e)}get fromPortChanged(){return this.Md}set fromPortChanged(t){const i=this.Md;i!==t&&(null!==t&&e.k(t,De,"fromPortChanged"),this.Md=t,this.t("fromPortChanged",i,t))}get toNode(){return this.no}set toNode(t){const e=this.no;if(e!==t){const i=this.toPort;null!==e&&(this.eo!==e&&e.w1(this,i),this.my(),this.invalidateLayout(2)),this.no=t,null!==t&&this.Ei(t.isVisible()),this.Ko=null,this.invalidateRoute();const s=this.diagram;null!==s&&s.X&&s.partManager.setToNodeForLink(this,t,e);const n=this.toPort,o=this.toPortChanged;if(null!==o){let t=!0;null!==s&&(t=s.X,s.X=!0),o(this,i,n),null!==s&&(s.X=t)}null!==t&&(this.eo!==t&&t.p1(this,n),this.yy(),this.invalidateLayout(1)),this.t("toNode",e,t),this.Pd()}}get toPortId(){return this.oo}set toPortId(t){const e=this.oo;if(e!==t){const i=this.toPort;null!==i&&this.toNode?.qi(i),this.my(),this.oo=t;const s=this.toPort;null!==s&&this.toNode?.qi(s);const n=this.diagram;if(null!==n){const e=this.data,i=n.model;null!==e&&i.Ra()&&i.setToPortIdForLinkData(e,t)}if(i!==s){this.Ko=null,this.invalidateRoute();const t=this.toPortChanged;if(null!==t){let e=!0;null!==n&&(e=n.X,n.X=!0),t(this,i,s),null!==n&&(n.X=e)}}this.yy(),this.t("toPortId",e,t)}}get toPort(){const t=this.no;if(null===t)return null;const e=this.oo;return t.findPort(e)}get toPortChanged(){return this.Nd}set toPortChanged(t){const i=this.Nd;i!==t&&(null!==t&&e.k(t,De,"toPortChanged"),this.Nd=t,this.t("toPortChanged",i,t))}get fromSpot(){return null!==this.ct?this.ct.ga:w.Default}set fromSpot(t){const e=this.fromSpot;if(!e.equals(t)){if(t=t.P(),this.Ue().ga=t,this.t("fromSpot",e,t),e.isSide()||t.isSide()){const t=this.fromNode;null!==t&&t.qi(this.fromPort)}this.invalidateRoute()}}get fromEndSegmentLength(){return null!==this.ct?this.ct.pa:NaN}set fromEndSegmentLength(t){const i=this.fromEndSegmentLength;if(i!==t){if(t<0&&e.W(t,">= 0",De,"fromEndSegmentLength"),this.Ue().pa=t,this.t("fromEndSegmentLength",i,t),this.computeSpot(!0,this.fromPort).isSide()){const t=this.fromNode;null!==t&&t.qi(this.fromPort)}this.invalidateRoute()}}get fromShortLength(){return null!==this.ct?this.ct.wa:NaN}set fromShortLength(t){const e=this.fromShortLength;e!==t&&(this.Ue().wa=t,this.ee(),this.t("fromShortLength",e,t))}get toSpot(){return null!==this.ct?this.ct.ma:w.Default}set toSpot(t){const e=this.toSpot;if(!e.equals(t)){if(t=t.P(),this.Ue().ma=t,this.t("toSpot",e,t),e.isSide()||t.isSide()){const t=this.toNode;null!==t&&t.qi(this.toPort)}this.invalidateRoute()}}get toEndSegmentLength(){return null!==this.ct?this.ct.ya:NaN}set toEndSegmentLength(t){const i=this.toEndSegmentLength;if(i!==t){if(t<0&&e.W(t,">= 0",De,"toEndSegmentLength"),this.Ue().ya=t,this.t("toEndSegmentLength",i,t),this.computeSpot(!1,this.toPort).isSide()){const t=this.toNode;null!==t&&t.qi(this.toPort)}this.invalidateRoute()}}get toShortLength(){return null!==this.ct?this.ct.xa:NaN}set toShortLength(t){const e=this.toShortLength;e!==t&&(this.Ue().xa=t,this.ee(),this.t("toShortLength",e,t))}Pd(){const t=this.fromNode,e=this.toNode;let i=null;if(i=null!==t?null!==e?t.findCommonContainingGroup(e):t.containingGroup:null!==e?e.containingGroup:null,this.cO(i),this.isLabeledLink){const t=this.labelNodes;for(;t.next();){const e=t.value;e.containingGroup=i}}}cO(t){const e=this.wh;if(e!==t){null!==e&&e.iN(this),this.wh=t,null!==t&&t.eN(this);const i=this.containingGroupChanged;if(null!==i){let s=!0;const n=this.diagram;null!==n&&(s=n.X,n.X=!0),i(this,e,t),null!==n&&(n.X=s)}this.Se&&(this.cN===e||this.fN===e)&&this.invalidateRoute()}}uh(){const t=this.containingGroup;null!==t&&this.fromNode!==t&&this.toNode!==t&&t.computesBoundsIncludingLinks&&super.uh()}getOtherNode(t){const e=this.fromNode;return t===e?this.toNode:e}getOtherPort(t){const e=this.fromPort;return t===e?this.toPort:e}get isLabeledLink(){return null!==this.Hs&&this.Hs.count>0}get labelNodes(){return null===this.Hs?n.instance:this.Hs.iterator}yT(t){null===this.Hs&&(this.Hs=new u),this.Hs.add(t),this.c()}wT(t){null!==this.Hs&&(this.Hs.delete(t),this.c())}Rm(t){if(super.Rm(t),this.Ua()&&this.invalidateOtherJumpOvers(this.actualBounds),!t){const t=this.eo;let e=null;null!==t&&(e=this.fromPort,t.p1(this,e));const i=this.no;let s=null;null!==i&&(s=this.toPort,(i!==t||s!==e)&&i.p1(this,s)),this.yy()}}vm(t){if(super.vm(t),this.Ua()&&this.invalidateOtherJumpOvers(this.actualBounds),!t){const t=this.eo;let e=null;null!==t&&(e=this.fromPort,t.w1(this,e));const i=this.no;let s=null;null!==i&&(s=this.toPort,(i!==t||s!==e)&&i.w1(this,s)),this.my()}}Xc(){if(this.Se=!0,null!==this.Hs){const t=this.diagram;if(null!==t){const e=this.Hs.copy().iterator;for(;e.next();){const i=e.value;t.remove(i)}}}if(null!==this.data){const t=this.diagram;null!==t&&t.partManager.mN(this)}}updateRelationshipsFromData(){if(null===this.data)return;const t=this.diagram;null!==t&&t.partManager.updateRelationshipsFromData(this)}move(t,e){const i=e?this.location:this.position;let s=i.x;isNaN(s)&&(s=0);let n=i.y;isNaN(n)&&(n=0);const o=t.x-s,r=t.y-n;if(!0===e)super.move(t,!1);else{const t=y.V(i.x+o,i.y+r);super.move(t,!1),y.e(t)}this.cr(o,r);const a=this.labelNodes;for(;a.next();){const t=a.value,e=t.position;t.moveTo(e.x+o,e.y+r)}}get relinkableFrom(){return 0!==(1&this.Mt)}set relinkableFrom(t){const e=0!==(1&this.Mt);e!==t&&(this.Mt=1^this.Mt,this.t("relinkableFrom",e,t),this.invalidateAdornments())}get relinkableTo(){return 0!==(2&this.Mt)}set relinkableTo(t){const e=0!==(2&this.Mt);e!==t&&(this.Mt=2^this.Mt,this.t("relinkableTo",e,t),this.invalidateAdornments())}canRelinkFrom(){if(!this.relinkableFrom)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowRelink)return!1;const e=t.diagram;return!(null!==e&&!e.allowRelink)}canRelinkTo(){if(!this.relinkableTo)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowRelink)return!1;const e=t.diagram;return!(null!==e&&!e.allowRelink)}get resegmentable(){return 0!==(4&this.Mt)}set resegmentable(t){const e=0!==(4&this.Mt);e!==t&&(this.Mt=4^this.Mt,this.t("resegmentable",e,t),this.invalidateAdornments())}get isTreeLink(){return 0!==(8&this.Mt)}set isTreeLink(t){const e=0!==(8&this.Mt);e!==t&&(this.Mt=8^this.Mt,this.t("isTreeLink",e,t),null!==this.fromNode&&this.fromNode.r0(),null!==this.toNode&&this.toNode.r0())}get path(){const t=this.findMainElement();return t instanceof he?t:null}get routeBounds(){return this.updateRoute(),this.fO(this.Sf)}fO(t){let e=1/0,i=1/0;const s=this.pointsCount;if(0===s)return t.i(NaN,NaN,0,0),t;if(1===s){const s=this.getPoint(0);e=Math.min(s.x,e),i=Math.min(s.y,i),t.i(s.x,s.y,0,0)}else if(2===s){const s=this.getPoint(0),n=this.getPoint(1);e=Math.min(s.x,n.x),i=Math.min(s.y,n.y),t.i(s.x,s.y,0,0),t.unionPoint(n)}else if(9===this.computeCurve()&&s>=3&&!this.isOrthogonal){let n=this.getPoint(0);if(e=n.x,i=n.y,t.i(e,i,0,0),3===s){const s=this.getPoint(1);e=Math.min(s.x,e),i=Math.min(s.y,i);const o=this.getPoint(2);e=Math.min(o.x,e),i=Math.min(o.y,i),S.ou(n.x,n.y,s.x,s.y,s.x,s.y,o.x,o.y,.5,t)}else for(let o=3;o<s;o+=3){const r=this.getPoint(o-2);o+3>=s&&(o=s-1);const a=this.getPoint(o-1),h=this.getPoint(o);S.ou(n.x,n.y,r.x,r.y,a.x,a.y,h.x,h.y,.5,t),e=Math.min(h.x,e),i=Math.min(h.y,i),n=h}}else{const n=this.getPoint(0),o=this.getPoint(1);e=Math.min(n.x,o.x),i=Math.min(n.y,o.y),t.i(n.x,n.y,0,0),t.unionPoint(o);for(let r=2;r<s;r++){const s=this.getPoint(r);e=Math.min(s.x,e),i=Math.min(s.y,i),t.unionPoint(s)}}return this.b1.i(e-t.x,i-t.y),t}get midPoint(){return this.updateRoute(),this.computeMidPoint(new y)}OA(t){return this.updateRoute(),this.computeMidPoint(t)}computeMidPoint(t){const e=this.pointsCount;if(0===e)return t.a(y.Ok),t;if(1===e)return t.a(this.getPoint(0)),t;if(2===e){const e=this.getPoint(0),i=this.getPoint(1);return t.i((e.x+i.x)/2,(e.y+i.y)/2),t}if(this.isOrthogonal&&(this.computeCorner()>=15||9===this.computeCurve())){this.ot.getPointAlongPath(.5,t),t.add(this.getPoint(0));const e=this.ot.figures.first();return t.offset(-e.startX,-e.startY),t}if(9===this.computeCurve()){if(3===e){const e=this.getPoint(0),i=this.getPoint(1),s=this.getPoint(2);return S.AC(e.x,e.y,i.x,i.y,i.x,i.y,s.x,s.y,t),t}const i=(e-1)/3|0,s=3*(i/2|0);if(i%2===1){const e=this.getPoint(s),i=this.getPoint(s+1),n=this.getPoint(s+2),o=this.getPoint(s+3);return S.AC(e.x,e.y,i.x,i.y,n.x,n.y,o.x,o.y,t),t}return t.a(this.getPoint(s)),t}const i=this.flattenedLengths,s=this.flattenedTotalLength;let n=0,o=0,r=0;for(;n<s/2&&o<e&&(r=i[o],!(n+r>s/2));)n+=r,o++;const a=this.getPoint(o),h=this.getPoint(o+1);if(Math.abs(a.x-h.x)<1)a.y>h.y?t.i(a.x,a.y-(s/2-n)):t.i(a.x,a.y+(s/2-n));else if(Math.abs(a.y-h.y)<1)a.x>h.x?t.i(a.x-(s/2-n),a.y):t.i(a.x+(s/2-n),a.y);else{const e=(s/2-n)/r,i=e*(h.x-a.x),o=e*(h.y-a.y);t.i(a.x+i,a.y+o)}return t}get midAngle(){return this.updateRoute(),this.computeMidAngle()}computeMidAngle(){const t=this.pointsCount;if(t<2)return NaN;if(2===t){const t=this.getPoint(0),e=this.getPoint(1);return t.directionPoint(e)}if(this.isOrthogonal&&(this.computeCorner()>=15||9===this.computeCurve()))return this.ot.getAngleAlongPath(.5);if(9===this.computeCurve()&&t>=4){const e=(t-1)/3|0;let i=3*(e/2|0);if(e%2===1){i=Math.floor(i);const t=this.getPoint(i),e=this.getPoint(i+1),s=this.getPoint(i+2),n=this.getPoint(i+3);return S.QD(t.x,t.y,e.x,e.y,s.x,s.y,n.x,n.y)}if(i>0&&i+1<t){const t=this.getPoint(i-1),e=this.getPoint(i+1);return t.directionPoint(e)}}const e=this.flattenedLengths,i=this.flattenedTotalLength;let s=0,n=0,o=0;for(;s<i/2&&n<t&&(o=e[n],!(s+o>i/2));)s+=o,n++;const r=this.getPoint(n),a=this.getPoint(n+1);if(Math.abs(r.x-a.x)<1&&Math.abs(r.y-a.y)<1){if(n>0&&n+2<t){const t=this.getPoint(n-1),e=this.getPoint(n+2);return t.directionPoint(e)}}else{if(Math.abs(r.x-a.x)<1)return r.y>a.y?270:90;if(Math.abs(r.y-a.y)<1)return r.x>a.x?180:0}return r.directionPoint(a)}get flattenedLengths(){return null!==this.Oa?this.Oa:(this.Se||this.P1(),this.uO())}get flattenedTotalLength(){let t=this.k1;if(isNaN(t)){const e=this.flattenedLengths,i=e.length;t=0;for(let s=0;s<i;s++)t+=e[s];this.k1=t}return t}uO(){null===this.Oa?this.Oa=[]:this.Oa.length=0;const t=this.Oa,e=this.pointsCount;for(let i=0;i<e-1;i++){let e=0;const s=this.getPoint(i),n=this.getPoint(i+1);S.z(s.x,n.x)?(e=n.y-s.y,e<0&&(e=-e),t.push(e)):S.z(s.y,n.y)?(e=n.x-s.x,e<0&&(e=-e),t.push(e)):(e=Math.sqrt(s.distanceSquaredPoint(n)),t.push(e))}return t}get points(){return this.xi}set points(t){const i=this.xi;if(i===t)return;let s=null;if(Array.isArray(t)){const i=t;let n=i.length%2===0;if(n)for(let t=0;t<i.length;t++)if("number"!=typeof i[t]||isNaN(i[t])){n=!1;break}if(n){s=new h;for(let t=0;t<i.length/2;t++){const e=new y(i[2*t],i[2*t+1]).u();s.add(e)}}else{let t=!0;for(let s=0;s<i.length;s++){const n=i[s];if(!e.K(n)||"number"!=typeof n.x||isNaN(n.x)||"number"!=typeof n.y||isNaN(n.y)){t=!1;break}}if(t){s=new h;for(let t=0;t<i.length;t++){const e=i[t];s.add(new y(e.x,e.y).u())}}}}else if(t instanceof h){s=t.copy();const e=s.iterator;for(;e.next();)e.value.u()}else e.o("Link.points value is not an instance of List or Array: "+t);if(null===s)return;s.u(),this.xi=s,this.ee(),this.P1();const n=this.diagram;null!==n&&(!n.Uh&&!n.undoManager.isUndoingRedoing&&n.wx.add(this),n.animationManager.pi&&n.animationManager.US(this,s)),this.t("points",i,s)}get pointsCount(){return this.xi.count}getPoint(t){return this.xi.r[t]}setPoint(t,e){this.xi.setElt(t,e)}setPointAt(t,e,i){this.xi.setElt(t,new y(e,i))}insertPoint(t,e){this.xi.insertAt(t,e)}insertPointAt(t,e,i){this.xi.insertAt(t,new y(e,i))}addPoint(t){this.xi.add(t)}addPointAt(t,e){this.xi.add(new y(t,e))}removePoint(t){this.xi.removeAt(t)}clearPoints(){this.xi.clear()}cr(t,e){if(0===t&&0===e)return;if(0===this.pointsCount)return this.defaultFromPoint&&this.defaultFromPoint.offset(t,e),void(this.defaultToPoint&&this.defaultToPoint.offset(t,e));const i=this.Se,s=new h,n=this.xi.iterator;for(;n.next();){const i=n.value;s.add(new y(i.x+t,i.y+e).u())}s.u();const o=this.xi;this.xi=s;const r=this.diagram;isNaN(t)||isNaN(e)||null!==r&&r.animationManager.pi?this.c():(this.Gs.i(this.Gs.x+t,this.Gs.y+e),this.at.i(this.at.x+t,this.at.y+e),this.ef()),i?this.P1():(this.defaultFromPoint&&(this.defaultFromPoint=this.getPoint(0)),this.defaultToPoint&&(this.defaultToPoint=this.getPoint(this.pointsCount-1))),null!==r&&r.animationManager.pi&&r.animationManager.US(this,s),this.t("points",o,s)}startRoute(){null===this.ll&&(this.ll=this.xi,this.xi=this.xi.copy())}commitRoute(){if(null===this.ll)return;const t=this.ll,e=this.xi;let i=1/0,s=1/0;const n=t.r,o=n.length;for(let c=0;c<o;c++){const t=n[c];i=Math.min(t.x,i),s=Math.min(t.y,s)}let r=1/0,a=1/0;const h=e.r,l=h.length;for(let c=0;c<l;c++){const t=h[c];r=Math.min(t.x,r),a=Math.min(t.y,a),t.u()}if(e.u(),l===o)for(let c=0;c<l;c++){const t=n[c],e=h[c];if(t.x-i!==e.x-r||t.y-s!==e.y-a){this.ee();break}}else this.ee();this.ll=null;const u=this.diagram;null!==u&&u.animationManager.pi&&u.animationManager.US(this,e),this.P1(),this.t("points",t,e)}rollbackRoute(){null!==this.ll&&(this.xi=this.ll,this.ll=null)}BF(){null!==this.xr&&(this.points=this.xr,this.xr=null)}P1(){0!==this.xi.count?(this.Se=!0,this.Oa=null,this.k1=NaN,this.defaultFromPoint=this.getPoint(0),this.defaultToPoint=this.getPoint(this.pointsCount-1),this.S1(!1)):this.Se=!1}invalidateRoute(){if(this.suspendsRouting)return;const t=this.path;if(null===t)return;const e=this.diagram;if(e){if(e.wx.has(this)||e.undoManager.isUndoingRedoing)return;const t=e.animationManager;if(t.isTicking&&!t.isAnimating)return;null!==this.xr&&!t.isTicking&&(this.xr=null)}this.Se=!1,this.c(),t.c()}get Se(){return 0!==(16&this.Mt)}set Se(t){0!==(16&this.Mt)!==t&&(this.Mt=16^this.Mt)}get suspendsRouting(){return 0!==(32&this.Mt)}set suspendsRouting(t){0!==(32&this.Mt)!==t&&(this.Mt=32^this.Mt)}get wy(){return 0!==(64&this.Mt)}set wy(t){0!==(64&this.Mt)!==t&&(this.Mt=64^this.Mt)}get pN(){return 0!==(512&this.Mt)}set pN(t){0!==(512&this.Mt)!==t&&(this.Mt=512^this.Mt)}get defaultFromPoint(){return this.hN}set defaultFromPoint(t){this.hN=null!==t?t.copy():null}get defaultToPoint(){return this.aN}set defaultToPoint(t){this.aN=null!==t?t.copy():null}updateRoute(){if(this.Se||this.wy)return;let t=!0;try{this.wy=!0,this.startRoute(),t=this.computePoints()}catch{this.wy=!1,this.rollbackRoute()}finally{this.wy=!1,t?this.commitRoute():this.rollbackRoute()}}computePoints(){const t=this.diagram;if(null===t)return!1;let e=this.fromNode,i=null;if(null===e?(De.Ia||(De.Ia=new Ce,De.Ia.desiredSize=v.sc,De.Ia.ensureBounds()),this.defaultFromPoint&&(De.Ia.location=this.defaultFromPoint,De.Ia.ensureBounds(),e=De.Ia,i=De.Ia)):i=this.fromPort,null!==i&&!e.isVisible()){const t=e.findVisibleNode();null!==t&&t!==e?(e=t,i=t.port):e=t}if(this.cN=e,null===e||!e.location.isReal()||null===i||(i=e.findVisiblePort(i),null===i))return!1;let s=this.toNode,n=null;if(null===s?(De.Ea||(De.Ea=new Ce,De.Ea.desiredSize=v.sc,De.Ea.ensureBounds()),this.defaultToPoint&&(De.Ea.location=this.defaultToPoint,De.Ea.ensureBounds(),s=De.Ea,n=De.Ea)):n=this.toPort,null!==n&&!s.isVisible()){const t=s.findVisibleNode();null!==t&&t!==s?(s=t,n=t.port):s=t}if(this.fN=s,null===s||!s.location.isReal()||null===n||(n=s.findVisiblePort(n),null===n))return!1;const o=this.pointsCount,r=this.computeSpot(!0,i),a=this.computeSpot(!1,n),h=this.Dd(r),l=this.Dd(a),u=i===n&&null!==i,c=this.isOrthogonal;let d=9===this.curve;u&&!c?(d=!0,this.Ko=!0):this.Ko=!1;const f=0===this.computeAdjusting()||u;if(!c&&!u&&h&&l){let t=!1;if(!f&&o>=3){let h=this.getLinkPoint(e,i,r,!0,!1,s,n),l=this.getLinkPoint(s,n,a,!1,!1,e,i);t=this.adjustPoints(0,h,o-1,l),t&&(h=this.getLinkPoint(e,i,r,!0,!1,s,n),l=this.getLinkPoint(s,n,a,!1,!1,e,i),this.adjustPoints(0,h,o-1,l))}t||(this.clearPoints(),d?this.dO(e,i,r,s,n,a):this.gO(e,i,r,s,n,a))}else{const t=this.isAvoiding;f&&(c&&t||u)&&this.clearPoints();const d=u?this.computeCurviness():0,g=this.getLinkPoint(e,i,r,!0,c,s,n);let p=0,m=0,v=0;if(c||!h||u){let t=this.computeEndSegmentLength(e,i,r,!0);if(v=this.getLinkDirection(e,i,g,r,!0,c,s,n),u&&(h||r.equals(a)||!c&&r.x+a.x===1&&r.y+a.y===1)&&(v-=c?90:30,d<0&&(v-=180)),v<0?v+=360:v>=360&&(v-=360),u&&(t+=Math.abs(d)*(c?1:2)),0===v?p=t:90===v?m=t:180===v?p=-t:270===v?m=-t:(p=t*Math.cos(v*Math.PI/180),m=t*Math.sin(v*Math.PI/180)),r.isNoSpot()&&u){const t=i.getDocumentPoint(w.Center,y.l()),s=y.V(t.x+1e3*p,t.y+1e3*m);this.getLinkPointFromPoint(e,i,t,s,!0,g),y.e(t),y.e(s)}}const x=this.getLinkPoint(s,n,a,!1,c,e,i);let b=0,k=0,S=0;if(c||!l||u){let t=this.computeEndSegmentLength(s,n,a,!1);if(S=this.getLinkDirection(s,n,x,a,!1,c,e,i),u&&(l||r.equals(a)||!c&&r.x+a.x===1&&r.y+a.y===1)&&(S+=c?0:30,d<0&&(S+=180)),S<0?S+=360:S>=360&&(S-=360),u&&(t+=Math.abs(d)*(c?1:2)),0===S?b=t:90===S?k=t:180===S?b=-t:270===S?k=-t:(b=t*Math.cos(S*Math.PI/180),k=t*Math.sin(S*Math.PI/180)),a.isNoSpot()&&u){const t=n.getDocumentPoint(w.Center,y.l()),e=y.V(t.x+1e3*b,t.y+1e3*k);this.getLinkPointFromPoint(s,n,t,e,!1,x),y.e(t),y.e(e)}}let P=g;(c||!h||u)&&(P=new y(g.x+p,g.y+m));let M=x;(c||!l||u)&&(M=new y(x.x+b,x.y+k)),!f&&!c&&h&&o>3&&this.adjustPoints(0,g,o-2,M)?this.setPoint(o-1,x):!f&&!c&&l&&o>3&&this.adjustPoints(1,P,o-1,x)?this.setPoint(0,g):!f&&(c?o>=6:o>4)&&this.adjustPoints(1,P,o-2,M)?(this.setPoint(0,g),this.setPoint(o-1,x)):(this.clearPoints(),this.addPoint(g),(c||!h||u)&&this.addPoint(P),c&&this.addOrthoPoints(P,v,M,S,e,s),(c||!l||u)&&this.addPoint(M),this.addPoint(x))}return t.addInvalidRoute(this),!0}yN(t,e){return Math.abs(e.x-t.x)>Math.abs(e.y-t.y)?(e.x>=t.x?e.x=t.x+9e9:e.x=t.x-9e9,e.y=t.y):(e.y>=t.y?e.y=t.y+9e9:e.y=t.y-9e9,e.x=t.x),e}getLinkPointFromPoint(t,e,i,s,n,o){if(void 0===o&&(o=new y),null===t||null===e)return o.a(i),o;if(!t.isVisible()){const i=t.findVisibleNode();null!==i&&i!==t&&(t=i,e=t.port)}let r=0,a=0,h=0,l=0,u=null,c=e.panel;if(null!==c&&!c.an()&&(c=c.panel),null===c)r=s.x,a=s.y,h=i.x,l=i.y;else{u=c.Bs;const t=1/(u.m11*u.m22-u.m12*u.m21),e=u.m22*t,n=-u.m12*t,o=-u.m21*t,d=u.m11*t,f=t*(u.m21*u.dy-u.m22*u.dx),g=t*(u.m12*u.dx-u.m11*u.dy);r=s.x*e+s.y*o+f,a=s.x*n+s.y*d+g,h=i.x*e+i.y*o+f,l=i.x*n+i.y*d+g}return e.Jc(r,a,h,l,o),null!==u&&o.T(u),o}mO(t,e){const i=t.Gu;return null!==i?i.ST(e):null}M1(t){if(null===t)return null;let e=t.Gu;return null===e&&(e=new Re(t.part,t),t.Gu=e),e.ST(this)}getLinkPoint(t,e,i,s,n,o,r,a){if(void 0===a&&(a=new y),i.isSpot()&&!this.Dd(i))return e.getDocumentPoint(i,a),a;if(i.isSide()){const h=this.M1(e);if(null!==h){const l=h.Fd;if(a.a(l),n&&7===this.routing){const l=this.M1(r);if(null!==l&&h.Mf<l.Mf){const h=y.l(),l=y.l(),u=new x(e.getDocumentPoint(w.TopLeft,h),e.getDocumentPoint(w.BottomRight,l)),c=this.computeSpot(!s,r),d=this.getLinkPoint(o,r,c,!s,n,t,e,l);(i.includesSide(w.LeftSide)||i.includesSide(w.RightSide))&&d.y>=u.y&&d.y<=u.y+u.height?a.y=d.y:(i.includesSide(w.TopSide)||i.includesSide(w.BottomSide))&&d.x>=u.x&&d.x<=u.x+u.width&&(a.x=d.x),y.e(h),y.e(l)}}return a}}const h=e.getDocumentPoint(this.N1(i,s),y.l());let l=null;if(this.pointsCount>(n?6:2))l=s?this.getPoint(1):this.getPoint(this.pointsCount-2),n&&(l=this.yN(h,l.copy()));else{const t=this.computeSpot(!s,r),e=y.l();l=r.getDocumentPoint(this.N1(t,!s),e),n&&(l=this.yN(h,l)),y.e(e)}return this.getLinkPointFromPoint(t,e,h,l,s,a),y.e(h),a}getLinkDirection(t,e,i,s,n,o,r,a){let h=this.pO(t,e,i,s,n,o,r,a);if(r&&s.isNoSpot()&&r.isMemberOf(t)&&(h+=180,h>=360&&(h-=360)),this.Dd(s)||null===e)return h;const l=e.getDocumentAngle();return 0===l||(45<=l&&l<135?h+=90:135<=l&&l<225?h+=180:225<=l&&l<315&&(h+=270),h>=360&&(h-=360)),h}pO(t,e,i,s,n,o,r,a){if(s.isSpot())return s.x>s.y?s.x>1-s.y?0:s.x<1-s.y?270:315:s.x<s.y?s.x>1-s.y?90:s.x<1-s.y?180:135:s.x<.5?225:s.x>.5?45:0;if(s.isSide()){const t=this.M1(e);if(null===t)return s.includesSide(w.TopSide)?270:s.includesSide(w.BottomSide)?90:s.includesSide(w.LeftSide)?180:0;switch(t.me){case 1:return 270;case 2:return 180;default:case 4:return 0;case 8:return 90}}if(null===e||null===a)return 0;const h=e.getDocumentPoint(w.Center,y.l());let l=null;if(this.pointsCount>(o?6:2))l=n?this.getPoint(1):this.getPoint(this.pointsCount-2),l=o?this.yN(h,l.copy()):i;else{const t=y.l();l=a.getDocumentPoint(w.Center,t),y.e(t)}let u=0;return u=Math.abs(l.x-h.x)>Math.abs(l.y-h.y)?l.x>=h.x?0:180:l.y>=h.y?90:270,y.e(h),u}computeEndSegmentLength(t,e,i,s){if(null!==e&&i.isSide()){const t=this.M1(e);if(null!==t)return t.C1}let n=NaN;return n=s?this.fromEndSegmentLength:this.toEndSegmentLength,null!==e&&isNaN(n)&&(n=s?e.fromEndSegmentLength:e.toEndSegmentLength),isNaN(n)&&(n=10),n}computeSpot(t,e){return void 0===e&&(e=null),t?this.yO(e||this.fromPort):this.wO(e||this.toPort)}yO(t){if(null===t)return w.Center;let e=this.fromSpot;return e.isDefault()&&(e=t.fromSpot),e===w.Default?w.None:e}wO(t){if(null===t)return w.Center;let e=this.toSpot;return e.isDefault()&&(e=t.toSpot),e===w.Default?w.None:e}Dd(t){return t===w.None||.5===t.x&&.5===t.y}N1(t,e){return.5===t.x&&.5===t.y?t:w.Center}computeOtherPoint(t,e){if(0!==this.computeAdjusting()&&this.pointsCount>4)return this.computeMidPoint(new y);{const t=this.mO(e,this);return null!==t?t.Fd:e.getDocumentPoint(w.Center)}}computeShortLength(t){if(t){let t=this.fromShortLength;if(isNaN(t)){const e=this.fromPort;null!==e&&(t=e.fromShortLength)}return isNaN(t)?0:t}{let t=this.toShortLength;if(isNaN(t)){const e=this.toPort;null!==e&&(t=e.toShortLength)}return isNaN(t)?0:t}}Tm(t,e,i,s,n,o){if(!1===this.pickable)return!1;let r;if(void 0===e&&(e=null),void 0===i&&(i=null),void 0===o?(r=k.l(),r.Ri()):r=o,r.nc(this.T),this.containedInRect(t,r))return this.X2(e,i,n),void 0===o&&k.e(r),!0;if(this.intersectsRect(t,r)){let a=!1;if(!this.af){const o=this.C.r,h=o.length;for(let l=h;l--;){const h=o[l];if(!h.visible&&h!==this.locationObject)continue;const u=h.actualBounds,c=this.naturalBounds;if(u.x>c.width||u.y>c.height||u.x+u.width<0||u.y+u.height<0)continue;const d=h,f=k.l();if(f.set(r),d instanceof ie?a=d.Tm(t,e,i,s,n,f):this.path===d?d instanceof he&&(a=d.Xv(t,s,f)):a=d.wA(t,s,f),a){let t=d;null!==e&&(t=e(d)),t&&(null===i||i(t))&&n.add(t)}k.e(f)}}return void 0===o&&k.e(r),a||null!==this.background}return void 0===o&&k.e(r),!1}get isOrthogonal(){return 2===(2&this.va)}static gN(t){return 2===(2&t)}get isAvoiding(){return 4===(4&this.va)}computeCurve(){if(null===this.Ko){const t=this.fromPort,e=null!==t&&t===this.toPort,i=this.isOrthogonal;this.Ko=e&&!i}return this.Ko?9:this.curve}computeCorner(){if(9===this.curve)return 0;let t=this.corner;return(isNaN(t)||t<0)&&(t=10),t}findMidLabel(){const t=this.path,e=this.C.r,i=e.length;for(let n=0;n<i;n++){const i=e[n];if(i!==t&&!i.isPanelMain&&(i.segmentIndex===-1/0||isNaN(i.segmentIndex)))return i}const s=this.labelNodes;for(;s.next();){const t=s.value;if(t.segmentIndex===-1/0||isNaN(t.segmentIndex))return t}return null}computeSpacing(){if(!this.isVisible())return 0;let t=De.aO;t=Math.max(t,this.computeThickness());const e=this.fromPort,i=this.toPort;if(null!==e&&null!==i){const s=this.findMidLabel();if(null!==s){const n=s.naturalBounds,o=s.margin,r=isNaN(n.width)?30:n.width*s.scale+o.left+o.right,a=isNaN(n.height)?14:n.height*s.scale+o.top+o.bottom,h=s.segmentOrientation;if(21===h||25===h||24===h)t=Math.max(t,a);else if(23===h||27===h||22===h||26===h)t=Math.max(t,r);else{const s=e.getDocumentPoint(w.Center).directionPoint(i.getDocumentPoint(w.Center))/180*Math.PI;t=Math.max(t,Math.abs(Math.sin(s)*r)+Math.abs(Math.cos(s)*a)+1)}9===this.curve&&(t*=1.333)}}return t}arrangeBundledLinks(t,e){if(e)for(let i=0;i<t.length;i++){const e=t[i];0===e.computeAdjusting()&&e.invalidateRoute()}}computeCurviness(){let t=this.curviness;if(isNaN(t)){t=De.hO;const i=this.Go;if(null!==i){const s=e.et();let n=0;const o=i.js;for(let t=0;t<o.length;t++){const e=o[t].computeSpacing();s.push(e),n+=e}let r=-n/2;for(let e=0;e<o.length;e++){if(o[e]===this){t=r+s[e]/2;break}r+=s[e]}i.ey===this.fromNode&&(t=-t),e.J(s)}}return t}computeThickness(){if(!this.isVisible())return 0;const t=this.path;return null!==t?Math.max(t.strokeWidth,1):1}hasCurviness(){return!isNaN(this.curviness)||null!==this.Go}gO(t,e,i,s,n,o){const r=this.getLinkPoint(t,e,i,!0,!1,s,n),a=this.getLinkPoint(s,n,o,!1,!1,t,e);if(this.hasCurviness()){const t=a.x-r.x,e=a.y-r.y,i=this.computeCurviness(),s=i,n=r.x+t/2,o=r.y+e/2;let h=n,l=o;if(S.f(e,0))t>0?l-=s:l+=s;else{const r=-t/e;let a=Math.sqrt(s*s/(r*r+1));i<0&&(a=-a),h=(e<0?-1:1)*a+n,l=r*(h-n)+o}this.addPoint(r),this.addPointAt(h,l),this.addPoint(a)}else{this.addPoint(r),this.addPoint(a);const h=x.l();e.getDocumentBounds(h);const l=h.containsPoint(a);n.getDocumentBounds(h);const u=h.containsPoint(r);if(l||u){const h=e.getDocumentPoint(this.N1(i,!0),new y);this.setPoint(0,this.getLinkPointFromPoint(t,e,h,a,!0,h));const l=n.getDocumentPoint(this.N1(o,!1),new y);this.setPoint(1,this.getLinkPointFromPoint(s,n,l,r,!1,l))}x.e(h)}}dO(t,e,i,s,n,o){const r=this.getLinkPoint(t,e,i,!0,!1,s,n),a=this.getLinkPoint(s,n,o,!1,!1,t,e),h=a.x-r.x,l=a.y-r.y,u=this.computeCurviness();let c=0,d=0,f=r.x+h/3,g=r.y+l/3,p=f,m=g;S.f(l,0)?h>0?m-=u:m+=u:(c=-h/l,d=Math.sqrt(u*u/(c*c+1)),u<0&&(d=-d),p=(l<0?-1:1)*d+f,m=c*(p-f)+g),f=r.x+2*h/3,g=r.y+2*l/3;let y=f,v=g;S.f(l,0)?h>0?v-=u:v+=u:(y=(l<0?-1:1)*d+f,v=c*(y-f)+g),this.clearPoints(),this.addPoint(r),this.addPointAt(p,m),this.addPointAt(y,v),this.addPoint(a),this.setPoint(0,this.getLinkPoint(t,e,i,!0,!1,s,n)),this.setPoint(3,this.getLinkPoint(s,n,o,!1,!1,t,e))}adjustPoints(t,e,i,s){let n=this.computeAdjusting();if(this.isOrthogonal){if(18===n)return!1;19===n&&(n=17)}switch(n){case 18:return this.xO(t,e,i,s);case 19:return this.bO(t,e,i,s);case 17:return this.kO(t,e,i,s);default:return!1}}xO(t,e,i,s){const n=this.getPoint(t),o=this.getPoint(i);if(n.equalsApprox(e)&&o.equalsApprox(s))return!0;const r=n.x,a=n.y,h=o.x,l=o.y;let u=h-r,c=l-a;const d=Math.sqrt(u*u+c*c);if(S.z(d,0))return!0;let f=0;S.z(u,0)?f=c<0?-Math.PI/2:Math.PI/2:(f=Math.atan(c/Math.abs(u)),u<0&&(f=Math.PI-f));const g=e.x,p=e.y,m=s.x,y=s.y,v=m-g,x=y-p,b=Math.sqrt(v*v+x*x);let w=0;S.z(v,0)?w=x<0?-Math.PI/2:Math.PI/2:(w=Math.atan(x/Math.abs(v)),v<0&&(w=Math.PI-w));const k=b/d,P=w-f;this.setPoint(t,e);for(let M=t+1;M<i;M++){const t=this.getPoint(M);u=t.x-r,c=t.y-a;const e=Math.sqrt(u*u+c*c);if(S.z(e,0))continue;let i=0;S.z(u,0)?i=c<0?-Math.PI/2:Math.PI/2:(i=Math.atan(c/Math.abs(u)),u<0&&(i=Math.PI-i));const s=i+P,n=e*k,o=g+n*Math.cos(s),h=p+n*Math.sin(s);this.setPointAt(M,o,h)}return this.setPoint(i,s),!0}bO(t,e,i,s){const n=this.getPoint(t),o=this.getPoint(i);if(n.equalsApprox(e)&&o.equalsApprox(s))return!0;const r=n.x,a=n.y,h=o.x,l=o.y,u=(h-r)**2+(l-a)**2,c=e.x,d=e.y,f=s.x,g=s.y;let p=0,m=1;f-c!==0?(p=(g-d)/(f-c),m=Math.sqrt(1+1/(p*p))):p=9e9,this.setPoint(t,e);for(let y=t+1;y<i;y++){const t=this.getPoint(y),e=t.x,i=t.y;let s=.5;0!==u&&(s=((r-e)*(r-h)+(a-i)*(a-l))/u);const n=r+s*(h-r),o=a+s*(l-a);let v=Math.sqrt((e-n)**2+(i-o)**2);i<p*(e-n)+o&&(v=-v),p>0&&(v=-v);const x=c+s*(f-c),b=d+s*(g-d);if(0!==p){const t=x+v/m,e=b-(t-x)/p;this.setPointAt(y,t,e)}else this.setPointAt(y,x,b+v)}return this.setPoint(i,s),!0}kO(t,e,i,s){if(this.isOrthogonal){let n=this.getPoint(t),o=this.getPoint(t+1),r=this.getPoint(t+2),a=o.x,h=o.y;const l=a,u=h;S.f(n.y,o.y)?S.f(o.x,r.x)?h=e.y:S.f(o.y,r.y)&&(a=e.x):S.f(n.x,o.x)&&(S.f(o.y,r.y)?a=e.x:S.f(o.x,r.x)&&(h=e.y)),this.setPointAt(t+1,a,h),n=this.getPoint(i),o=this.getPoint(i-1),r=this.getPoint(i-2);let c=o.x,d=o.y;const f=c,g=d;if(S.f(n.y,o.y)?S.f(o.x,r.x)?d=s.y:S.f(o.y,r.y)&&(c=s.x):S.f(n.x,o.x)&&(S.f(o.y,r.y)?c=s.x:S.f(o.x,r.x)&&(d=s.y)),this.setPointAt(i-1,c,d),this.WL())return this.setPointAt(t+1,l,u),this.setPointAt(i-1,f,g),!1}return this.setPoint(t,e),this.setPoint(i,s),!0}addOrthoPoints(t,e,i,s,n,o){e<0?e+=360:e>=360&&(e-=360),s<0?s+=360:s>=360&&(s-=360);const r=s;e=e>=315||e<45?0:45<=e&&e<135?90:135<=e&&e<225?180:270,s=s>=315||s<45?0:45<=s&&s<135?90:135<=s&&s<225?180:270;const a=t,h=i,l=n.actualBounds.copy(),u=o.actualBounds.copy();if(!l.isReal()||!u.isReal())return;l.inflate(De.Ba,De.Ba),u.inflate(De.Ba,De.Ba),l.unionPoint(t),u.unionPoint(i);const c=y.l(),d=y.l();0===e?h.x>a.x||270===s&&h.y<a.y&&u.right>a.x||90===s&&h.y>a.y&&u.right>a.x?(c.i(h.x,a.y),d.i(h.x,(a.y+h.y)/2),180===s?(c.x=this.computeMidOrthoPosition(a.x,a.y,h.x,h.y,!1),d.x=c.x,d.y=h.y):270===s&&h.y<a.y||90===s&&h.y>a.y?(a.x<u.left?c.x=this.computeMidOrthoPosition(a.x,a.y,u.left,h.y,!1):a.x<u.right&&(270===s&&a.y<u.top||90===s&&a.y>u.bottom)?c.x=this.computeMidOrthoPosition(a.x,a.y,h.x,h.y,!1):c.x=u.right,d.x=c.x,d.y=h.y):0===s&&a.x<u.left&&a.y>u.top&&a.y<u.bottom&&(c.x=a.x,a.y<h.y?c.y=Math.min(h.y,u.top):c.y=Math.max(h.y,u.bottom),d.y=c.y)):(c.i(a.x,h.y),d.i((a.x+h.x)/2,h.y),(180===s||90===s&&h.y<l.top||270===s&&h.y>l.bottom)&&(180===s&&(u.containsPoint(a)||l.containsPoint(h))?c.y=this.computeMidOrthoPosition(a.x,a.y,h.x,h.y,!0):h.y<a.y&&(180===s||90===s)?c.y=this.computeMidOrthoPosition(a.x,l.top,h.x,Math.max(h.y,u.bottom),!0):h.y>a.y&&(180===s||270===s)&&(c.y=this.computeMidOrthoPosition(a.x,l.bottom,h.x,Math.min(h.y,u.top),!0)),d.x=h.x,d.y=c.y),c.y>l.top&&c.y<l.bottom&&(h.x>=l.left&&h.x<=a.x||a.x<=u.right&&a.x>=h.x?(90===s||270===s)&&(c.i(Math.max((a.x+h.x)/2,a.x),a.y),d.i(c.x,h.y)):(270===s||(0===s||180===s)&&h.y<a.y?c.y=Math.min(h.y,0===s?l.top:Math.min(l.top,u.top)):c.y=Math.max(h.y,0===s?l.bottom:Math.max(l.bottom,u.bottom)),d.x=h.x,d.y=c.y))):180===e?h.x<a.x||270===s&&h.y<a.y&&u.left<a.x||90===s&&h.y>a.y&&u.left<a.x?(c.i(h.x,a.y),d.i(h.x,(a.y+h.y)/2),0===s?(c.x=this.computeMidOrthoPosition(a.x,a.y,h.x,h.y,!1),d.x=c.x,d.y=h.y):270===s&&h.y<a.y||90===s&&h.y>a.y?(a.x>u.right?c.x=this.computeMidOrthoPosition(a.x,a.y,u.right,h.y,!1):a.x>u.left&&(270===s&&a.y<u.top||90===s&&a.y>u.bottom)?c.x=this.computeMidOrthoPosition(a.x,a.y,h.x,h.y,!1):c.x=u.left,d.x=c.x,d.y=h.y):180===s&&a.x>u.right&&a.y>u.top&&a.y<u.bottom&&(c.x=a.x,a.y<h.y?c.y=Math.min(h.y,u.top):c.y=Math.max(h.y,u.bottom),d.y=c.y)):(c.i(a.x,h.y),d.i((a.x+h.x)/2,h.y),(0===s||90===s&&h.y<l.top||270===s&&h.y>l.bottom)&&(0===s&&(u.containsPoint(a)||l.containsPoint(h))?c.y=this.computeMidOrthoPosition(a.x,a.y,h.x,h.y,!0):h.y<a.y&&(0===s||90===s)?c.y=this.computeMidOrthoPosition(a.x,l.top,h.x,Math.max(h.y,u.bottom),!0):h.y>a.y&&(0===s||270===s)&&(c.y=this.computeMidOrthoPosition(a.x,l.bottom,h.x,Math.min(h.y,u.top),!0)),d.x=h.x,d.y=c.y),c.y>l.top&&c.y<l.bottom&&(h.x<=l.right&&h.x>=a.x||a.x>=u.left&&a.x<=h.x?(90===s||270===s)&&(c.i(Math.min((a.x+h.x)/2,a.x),a.y),d.i(c.x,h.y)):(270===s||(0===s||180===s)&&h.y<a.y?c.y=Math.min(h.y,180===s?l.top:Math.min(l.top,u.top)):c.y=Math.max(h.y,180===s?l.bottom:Math.max(l.bottom,u.bottom)),d.x=h.x,d.y=c.y))):90===e?h.y>a.y||180===s&&h.x<a.x&&u.bottom>a.y||0===s&&h.x>a.x&&u.bottom>a.y?(c.i(a.x,h.y),d.i((a.x+h.x)/2,h.y),270===s?(c.y=this.computeMidOrthoPosition(a.x,a.y,h.x,h.y,!0),d.x=h.x,d.y=c.y):180===s&&h.x<a.x||0===s&&h.x>a.x?(a.y<u.top?c.y=this.computeMidOrthoPosition(a.x,a.y,h.x,u.top,!0):a.y<u.bottom&&(180===s&&a.x<u.left||0===s&&a.x>u.right)?c.y=this.computeMidOrthoPosition(a.x,a.y,h.x,h.y,!0):c.y=u.bottom,d.x=h.x,d.y=c.y):90===s&&a.y<u.top&&a.x>u.left&&a.x<u.right&&(a.x<h.x?c.x=Math.min(h.x,u.left):c.x=Math.max(h.x,u.right),c.y=a.y,d.x=c.x)):(c.i(h.x,a.y),d.i(h.x,(a.y+h.y)/2),(270===s||0===s&&h.x<l.left||180===s&&h.x>l.right)&&(270===s&&(u.containsPoint(a)||l.containsPoint(h))?c.x=this.computeMidOrthoPosition(a.x,a.y,h.x,h.y,!1):h.x<a.x&&(270===s||0===s)?c.x=this.computeMidOrthoPosition(l.left,a.y,Math.max(h.x,u.right),h.y,!1):h.x>a.x&&(270===s||180===s)&&(c.x=this.computeMidOrthoPosition(l.right,a.y,Math.min(h.x,u.left),h.y,!1)),d.x=c.x,d.y=h.y),c.x>l.left&&c.x<l.right&&(h.y>=l.top&&h.y<=a.y||a.y<=u.bottom&&a.y>=h.y?(0===s||180===s)&&(c.i(a.x,Math.max((a.y+h.y)/2,a.y)),d.i(h.x,c.y)):(180===s||(90===s||270===s)&&h.x<a.x?c.x=Math.min(h.x,90===s?l.left:Math.min(l.left,u.left)):c.x=Math.max(h.x,90===s?l.right:Math.max(l.right,u.right)),d.x=c.x,d.y=h.y))):h.y<a.y||180===s&&h.x<a.x&&u.top<a.y||0===s&&h.x>a.x&&u.top<a.y?(c.i(a.x,h.y),d.i((a.x+h.x)/2,h.y),90===s?(c.y=this.computeMidOrthoPosition(a.x,a.y,h.x,h.y,!0),d.x=h.x,d.y=c.y):180===s&&h.x<a.x||0===s&&h.x>=a.x?(a.y>u.bottom?c.y=this.computeMidOrthoPosition(a.x,a.y,h.x,u.bottom,!0):a.y>u.top&&(180===s&&a.x<u.left||0===s&&a.x>u.right)?c.y=this.computeMidOrthoPosition(a.x,a.y,h.x,h.y,!0):c.y=u.top,d.x=h.x,d.y=c.y):270===s&&a.y>u.bottom&&a.x>u.left&&a.x<u.right&&(a.x<h.x?c.x=Math.min(h.x,u.left):c.x=Math.max(h.x,u.right),c.y=a.y,d.x=c.x)):(c.i(h.x,a.y),d.i(h.x,(a.y+h.y)/2),(90===s||0===s&&h.x<l.left||180===s&&h.x>l.right)&&(90===s&&(u.containsPoint(a)||l.containsPoint(h))?c.x=this.computeMidOrthoPosition(a.x,a.y,h.x,h.y,!1):h.x<a.x&&(90===s||0===s)?c.x=this.computeMidOrthoPosition(l.left,a.y,Math.max(h.x,u.right),h.y,!1):h.x>a.x&&(90===s||180===s)&&(c.x=this.computeMidOrthoPosition(l.right,a.y,Math.min(h.x,u.left),h.y,!1)),d.x=c.x,d.y=h.y),c.x>l.left&&c.x<l.right&&(h.y<=l.bottom&&h.y>=a.y||a.y>=u.top&&a.y<=h.y?(0===s||180===s)&&(c.i(a.x,Math.min((a.y+h.y)/2,a.y)),d.i(h.x,c.y)):(180===s||(90===s||270===s)&&h.x<a.x?c.x=Math.min(h.x,270===s?l.left:Math.min(l.left,u.left)):c.x=Math.max(h.x,270===s?l.right:Math.max(l.right,u.right)),d.x=c.x,d.y=h.y))),this.pN=s!==r,this.uN=e,this.dN=s,this.addPoint(c.copy()),this.addPoint(d.copy()),y.e(c),y.e(d)}computeMidOrthoPosition(t,e,i,s,n){let o=0;return this.hasCurviness()&&!this.computeSpot(!0,this.fromPort).isSide()&&!this.computeSpot(!1,this.toPort).isSide()&&(o=this.computeCurviness()),n?(e+s)/2+o:(t+i)/2+o}WL(){if(null===this.diagram||!this.isAvoiding||this.diagram.animationManager.isTicking)return!1;const t=this.points.r,e=t.length;if(e<4)return!1;const i=this.diagram.getPositions(!1,this.containingGroup,null);for(let s=1;s<e-2;s++){const e=t[s],n=t[s+1];if(!i.isUnoccupied(Math.min(e.x,n.x),Math.min(e.y,n.y),Math.abs(e.x-n.x),Math.abs(e.y-n.y)))return!0}return!1}findClosestSegment(t){const e=t.x,i=t.y;let s=this.getPoint(0),n=this.getPoint(1),o=y.distanceLineSegmentSquared(e,i,s.x,s.y,n.x,n.y),r=0;for(let a=1;a<this.pointsCount-1;a++){s=this.getPoint(a+1);const t=y.distanceLineSegmentSquared(e,i,n.x,n.y,s.x,s.y);n=s,t<o&&(r=a,o=t)}return r}ee(){this.bh=!1,this.c()}get bh(){return 0!==(128&this.Mt)}set bh(t){0!==(128&this.Mt)!==t&&(this.Mt=128^this.Mt)}get geometry(){if(!this.bh){if(this.updateRoute(),this.pointsCount<2)return this.bh=!0,this.ot;this.ot=this.makeGeometry()}return this.ot}sd(t){if(!t){if(!1===this.Se)return;const t=this.findMainElement();if(this.bh&&(null===t||null!==t.geometry))return}this.pointsCount<2?this.bh=!0:this.ot=this.makeGeometry();const e=this.path;if(null===e)return;e.ot=this.ot;const i=this.C.r,s=i.length;for(let n=0;n<s;n++){const t=i[n];t!==e&&t.isPanelMain&&t instanceof he&&(t.ot=this.ot)}}PO(t){return this.Ua()&&t.Jl.has(this)&&(0!==this.Sf.width||0!==this.Sf.height)&&(t.animationManager.isAnimating||t.currentTool!==t.toolManager)}makeGeometry(){const t=this.ot,e=this.pointsCount;let i=!1;const s=this.diagram;null!==s&&this.PO(s)&&(i=!0);let n=0,o=0,r=this.getPoint(0).copy();const a=r.copy(),h=this.xi.r,l=this.computeCurve();if(9===l&&e>=3&&!S.z(this.smoothness,0))if(3===e){let t=this.getPoint(1);n=Math.min(r.x,t.x),o=Math.min(r.y,t.y),t=this.getPoint(2),n=Math.min(n,t.x),o=Math.min(o,t.y)}else if(this.isOrthogonal){for(let t=0;t<e;t++){const e=h[t];a.x=Math.min(e.x,a.x),a.y=Math.min(e.y,a.y)}n=a.x,o=a.y}else{for(let t=3;t<e;t+=3){t+3>=e&&(t=e-1);const i=this.getPoint(t);a.x=Math.min(i.x,a.x),a.y=Math.min(i.y,a.y)}n=a.x,o=a.y}else{for(let t=0;t<e;t++){const e=h[t];a.x=Math.min(e.x,a.x),a.y=Math.min(e.y,a.y)}n=a.x,o=a.y}if(n-=this.b1.x,o-=this.b1.y,r.x-=n,r.y-=o,2!==e||this.Ua()){t.type=4;const s=be.RC(t);if(0!==this.computeShortLength(!0)&&(r=this.Nf(r,!0,a)),s.hu(r.x,r.y,!1,!1),9===l&&e>=3&&!S.z(this.smoothness,0))if(3===e){const t=this.getPoint(1),e=t.x-n,i=t.y-o;let r=this.getPoint(2).copy();r.x-=n,r.y-=o,0!==this.computeShortLength(!1)&&(r=this.Nf(r,!1,a)),s.lr(e,i,e,i,r.x,r.y)}else if(this.isOrthogonal){const t=y.V(n,o),e=y.l();e.a(this.getPoint(1));const i=y.V(n,o),r=y.V(n,o);let a=this.getPoint(0),h=null;const l=this.smoothness/3;for(let f=1;f<this.pointsCount-1;f++){h=this.getPoint(f);const u=a,c=h,d=this.getPoint(this.wN(h,f,!1));S.z(u.x,c.x)&&S.z(c.x,d.x)||S.z(u.y,c.y)&&S.z(c.y,d.y)||(this.SO(u,c,d,l,i,r),(1===f||2===f&&S.z(a.x,this.getPoint(0).x)&&S.z(a.y,this.getPoint(0).y))&&(e.x=.5*(a.x+h.x),e.y=.5*(a.y+h.y)),s.lr(e.x-n,e.y-o,i.x-n,i.y-o,h.x-n,h.y-o),t.set(i),e.set(r),a=h)}let u=a.x,c=a.y,d=this.getPoint(this.pointsCount-1);0!==this.computeShortLength(!1)&&(d=this.Nf(d.copy(),!1,y.wo)),u=.5*(u+d.x),c=.5*(c+d.y),s.lr(r.x-n,r.y-o,u-n,c-o,d.x-n,d.y-o),y.e(t),y.e(e),y.e(i),y.e(r)}else for(let t=3;t<e;t+=3){const i=this.getPoint(t-2);t+3>=e&&(t=e-1);const r=this.getPoint(t-1);let a=this.getPoint(t);t===e-1&&0!==this.computeShortLength(!1)&&(a=this.Nf(a.copy(),!1,y.wo)),s.lr(i.x-n,i.y-o,r.x-n,r.y-o,a.x-n,a.y-o)}else{const t=y.l();t.a(this.getPoint(0));const r=y.l();r.a(t);const a=this.computeCorner();let h=1,l=0;for(;h<e;){h=this.wN(t,h,h>1);let u=this.getPoint(h);if(h>=e-1){if(t.equals(u)){if(0===l)for(h=1;h<e;)r.a(t),u=this.getPoint(h++),this.xn(s,-n,-o,t,u,i),t.a(u)}else 0!==this.computeShortLength(!1)&&(u=this.Nf(u.copy(),!1,y.wo)),this.xn(s,-n,-o,t,u,i);break}l=this.wN(u,h+1,h<e-3);const c=this.getPoint(l);this.MO(s,-n,-o,t,u,c,t,r,a,i),r.a(u),h=l}y.e(t)}return be.vC(s),this.bh=!0,t}{let e=this.getPoint(1).copy();return e.x-=n,e.y-=o,0!==this.computeShortLength(!0)&&(r=this.Nf(r,!0,a)),0!==this.computeShortLength(!1)&&(e=this.Nf(e,!1,a)),t.type=1,t.startX=r.x,t.startY=r.y,t.endX=e.x,t.endY=e.y,this.bh=!0,t}}L1(t,e,i,s){let n=i-t;if(isNaN(n)||n===1/0||n===-1/0)return NaN;n<0&&(n=-n);let o=s-e;return isNaN(o)||o===1/0||o===-1/0?NaN:(o<0&&(o=-o),S.z(n,0)?o:S.z(o,0)?n:Math.sqrt(n*n+o*o))}SO(t,e,i,s,n,o){isNaN(s)&&(s=this.smoothness/3);const r=t.x,a=t.y,h=e.x,l=e.y,u=i.x,c=i.y,d=s*this.L1(r,a,h,l),f=s*this.L1(h,l,u,c);if(S.z(a,l)&&S.z(h,u)&&(h>r?c>l?(n.x=h-d,n.y=l-d,o.x=h+f,o.y=l+f):(n.x=h-d,n.y=l+d,o.x=h+f,o.y=l-f):c>l?(n.x=h+d,n.y=l-d,o.x=h-f,o.y=l+f):(n.x=h+d,n.y=l+d,o.x=h-f,o.y=l-f)),S.z(r,h)&&S.z(l,c)&&(l>a?u>h?(n.x=h-d,n.y=l-d,o.x=h+f,o.y=l+f):(n.x=h+d,n.y=l-d,o.x=h-f,o.y=l+f):u>h?(n.x=h-d,n.y=l+d,o.x=h+f,o.y=l-f):(n.x=h+d,n.y=l+d,o.x=h-f,o.y=l-f)),S.z(r,h)&&S.z(h,u)||S.z(a,l)&&S.z(l,c)){const t=.5*(r+u),e=.5*(a+c);n.x=t,n.y=e,o.x=t,o.y=e}}Nf(t,e,i){const s=this.pointsCount;if(s<2)return t;if(e){const e=this.getPoint(1),n=e.x-i.x,o=e.y-i.y,r=this.L1(t.x,t.y,n,o);if(0===r)return t;const a=2===s?.5*r:r;let h=this.computeShortLength(!0);h>a&&(h=a);const l=h*(n-t.x)/r,u=h*(o-t.y)/r;t.x+=l,t.y+=u}else{const e=this.getPoint(s-2),n=e.x-i.x,o=e.y-i.y,r=this.L1(t.x,t.y,n,o);if(0===r)return t;const a=2===s?.5*r:r;let h=this.computeShortLength(!1);h>a&&(h=a);const l=h*(t.x-n)/r,u=h*(t.y-o)/r;t.x-=l,t.y-=u}return t}wN(t,e,i){const s=this.pointsCount;let n=t;for(;S.z(t.x,n.x)&&S.z(t.y,n.y);){if(e>=s)return s-1;n=this.getPoint(e++)}if(!S.z(t.x,n.x)&&!S.z(t.y,n.y))return e-1;let o=n;for(;S.z(t.x,n.x)&&S.z(n.x,o.x)&&(!i||(t.y>=n.y?n.y>=o.y:n.y<=o.y))||S.z(t.y,n.y)&&S.z(n.y,o.y)&&(!i||(t.x>=n.x?n.x>=o.x:n.x<=o.x));){if(e>=s)return s-1;o=this.getPoint(e++)}return e-2}MO(t,e,i,s,n,o,r,a,h,l){if(S.f(s.y,n.y)&&S.f(n.x,o.x)){let u=Math.min(h,Math.abs(n.x-a.x)/2);const c=Math.min(u,Math.abs(o.y-n.y)/2);if(u=c,S.f(u,0))return this.xn(t,e,i,s,n,l),void r.a(n);let d=n.x;const f=n.y,g=d;let p=f;n.x>s.x?(d=n.x-u,p=o.y>n.y?n.y+c:n.y-c):(d=n.x+u,p=o.y>n.y?n.y+c:n.y-c);const m=y.V(d,f);this.xn(t,e,i,s,m,l),y.e(m),t.Mw(n.x+e,n.y+i,g+e,p+i),r.i(g,p)}else if(S.f(s.x,n.x)&&S.f(n.y,o.y)){let u=Math.min(h,Math.abs(n.y-a.y)/2);const c=Math.min(u,Math.abs(o.x-n.x)/2);if(u=c,S.f(c,0))return this.xn(t,e,i,s,n,l),void r.a(n);const d=n.x;let f=n.y,g=d;const p=f;n.y>s.y?(f=n.y-u,g=o.x>n.x?n.x+c:n.x-c):(f=n.y+u,g=o.x>n.x?n.x+c:n.x-c);const m=y.V(d,f);this.xn(t,e,i,s,m,l),y.e(m),t.Mw(n.x+e,n.y+i,g+e,p+i),r.i(g,p)}else this.xn(t,e,i,s,n,l),r.a(n)}computeJumpLength(){return 10}xn(t,e,i,s,n,o){if(o||!this.Ua())t.rr(n.x+e,n.y+i);else{const o=this.computeJumpLength(),r=o/2,a=[];let h=0;this.isVisible()&&(h=this.NO(s,n,a));let l=s.x,u=s.y;if(h>0)if(S.f(s.y,n.y))if(s.x<n.x){let c=0;for(;c<h;){const d=Math.max(s.x,Math.min(a[c++]-r,n.x-o));t.rr(d+e,n.y+i),l=d+e,u=n.y+i;let f=Math.min(d+o,n.x);for(;c<h;){const t=a[c];if(!(t<f+o))break;c++,f=Math.min(t+r,n.x)}const g=n.y-o+i,p=f+e,m=n.y+i;10===this.curve?t.hu(p,m,!1,!1):t.lr(l,g,p,g,p,m),l=p,u=m}}else{let c=h-1;for(;c>=0;){const h=Math.min(s.x,Math.max(a[c--]+r,n.x+o));t.rr(h+e,n.y+i),l=h+e,u=n.y+i;let d=Math.max(h-o,n.x);for(;c>=0;){const t=a[c];if(!(t>d-o))break;c--,d=Math.max(t-r,n.x)}const f=n.y-o+i,g=d+e,p=n.y+i;10===this.curve?t.hu(g,p,!1,!1):t.lr(l,f,g,f,g,p),l=g,u=p}}else if(S.f(s.x,n.x))if(s.y<n.y){let c=0;for(;c<h;){const d=Math.max(s.y,Math.min(a[c++]-r,n.y-o));t.rr(n.x+e,d+i),l=n.x+e,u=d+i;let f=Math.min(d+o,n.y);for(;c<h;){const t=a[c];if(!(t<f+o))break;c++,f=Math.min(t+r,n.y)}const g=n.x-o+e,p=n.x+e,m=f+i;10===this.curve?t.hu(p,m,!1,!1):t.lr(g,u,g,m,p,m),l=p,u=m}}else{let c=h-1;for(;c>=0;){const h=Math.min(s.y,Math.max(a[c--]+r,n.y+o));t.rr(n.x+e,h+i),l=n.x+e,u=h+i;let d=Math.max(h-o,n.y);for(;c>=0;){const t=a[c];if(!(t>d-o))break;c--,d=Math.max(t-r,n.y)}const f=n.x-o+e,g=n.x+e,p=d+i;10===this.curve?t.hu(g,p,!1,!1):t.lr(f,u,f,p,g,p),l=g,u=p}}t.rr(n.x+e,n.y+i)}}NO(t,e,i){const s=this.diagram;if(null===s||t.equals(e))return 0;const n=s.layers;for(;n.next();){const s=n.value;if(null!==s&&s.visible){const n=s.jS(),o=n.length;for(let s=0;s<o;s++){const o=n[s];if(!(o instanceof De))continue;if(o===this)return i.length>0&&i.sort(((t,e)=>t-e)),i.length;if(!o.isVisible()||!o.Ua())continue;const r=o.routeBounds;if(!r.isReal()||!this.routeBounds.intersectsRect(r)||this.usesSamePort(o))continue;const a=o.path;null!==a&&a.isVisibleObject()&&this.CO(t,e,i,o)}}}return i.length>0&&i.sort(((t,e)=>t-e)),i.length}CO(t,e,i,s){const n=S.f(t.y,e.y),o=s.pointsCount;let r=s.getPoint(0);const a=y.l();for(let h=1;h<o;h++){const l=s.getPoint(h);if(h<o-1){const t=s.getPoint(h+1);if(r.y===l.y&&l.y===t.y){if(l.x>r.x&&t.x>=l.x||l.x<r.x&&t.x<=l.x)continue}else if(r.x===l.x&&l.x===t.x&&(l.y>r.y&&t.y>=l.y||l.y<r.y&&t.y<=l.y))continue}this.LO(t,e,r,l,a)&&(n?i.push(a.x):i.push(a.y)),r=l}y.e(a)}LO(t,e,i,s,n){const o=t.x,r=t.y,a=e.x,h=e.y,l=i.x,u=i.y,c=s.x,d=s.y;if(S.f(o,a)){if(!S.f(r,h)&&S.f(u,d)&&Math.min(r,h)<u&&Math.max(r,h)>u&&Math.min(l,c)<o&&Math.max(l,c)>o&&!S.f(l,c))return n.x=o,n.y=u,!0}else if(S.f(r,h)&&S.f(l,c)&&Math.min(o,a)<l&&Math.max(o,a)>l&&Math.min(u,d)<r&&Math.max(u,d)>r&&!S.f(u,d))return n.x=l,n.y=r,!0;return n.x=0,n.y=0,!1}get firstPickIndex(){return this.pointsCount<=2?0:this.isOrthogonal||!this.Dd(this.computeSpot(!0))?1:0}get lastPickIndex(){const t=this.pointsCount;return 0===t?0:t<=2?t-1:this.isOrthogonal||!this.Dd(this.computeSpot(!1))?t-2:t-1}Ua(){const t=this.curve;return 11===t||10===t}S1(t){if(t||this.Ua()){const t=this.diagram;null!==t&&!t.animationManager.isTicking&&!t.Jl.has(this)&&(0!==this.Sf.width||0!==this.Sf.height)&&t.Jl.set(this,this.Sf.copy())}}invalidateOtherJumpOvers(t){const e=this.layer;if(null===e||!e.visible||e.isTemporary)return;const i=e.diagram;if(null===i||i.animationManager.isTicking)return;let s=!1;const n=i.layers;for(;n.next();){const i=n.value;if(i.visible)if(i===e){s=!0;let e=!1;const n=i.jS(),o=n.length;for(let i=0;i<o;i++){const s=n[i];s instanceof De&&(s===this?e=!0:e&&this.MT(s,t))}}else if(s){const e=i.jS(),s=e.length;for(let i=0;i<s;i++){const s=e[i];s instanceof De&&this.MT(s,t)}}}}MT(t,e){if(null===t||!t.bh||!t.Se||!t.Ua())return;const i=t.routeBounds;i.isReal()&&(!this.routeBounds.intersectsRect(i)&&!e.intersectsRect(i)||this.usesSamePort(t)||t.ee())}usesSamePort(t){const e=this.pointsCount,i=t.pointsCount;if(e>0&&i>0){const s=this.getPoint(0),n=t.getPoint(0);if(s.equalsApprox(n))return!0;const o=this.getPoint(e-1),r=t.getPoint(i-1);if(o.equalsApprox(r)||s.equalsApprox(r)||o.equalsApprox(n))return!0}else if(this.fromNode===t.fromNode||this.toNode===t.toNode||this.fromNode===t.toNode||this.toNode===t.fromNode)return!0;return!1}isVisible(){if(!super.isVisible())return!1;const t=this.containingGroup;let e=!0;const i=this.diagram;null!==i&&(e=i.isTreePathToChildren);const s=this.fromNode;if(null!==s){if(this.isTreeLink&&e&&!s.isTreeExpanded)return!1;if(s===t)return!0;let i=s;for(;null!==i;){if(i.labeledLink===this)return!0;i=i.containingGroup}const n=s.findVisibleNode();if(null===n||n===t)return!1}const n=this.toNode;if(null!==n){if(this.isTreeLink&&!e&&!n.isTreeExpanded)return!1;if(n===t)return!0;let i=n;for(;null!==i;){if(i.labeledLink===this)return!0;i=i.containingGroup}const s=n.findVisibleNode();if(null===s||s===t)return!1}return!0}Ei(t){if(super.Ei(t),t&&this.S1(!1),null!==this.Go&&this.Go.Sd(),null!==this.Hs){const e=this.Hs.iterator;for(;e.next();)e.value.Ei(t)}}get adjusting(){return this.Pf}set adjusting(t){const e=this.Pf;e!==t&&(this.Pf=t,this.t("adjusting",e,t))}computeAdjusting(){return this.isAvoiding&&null!==this.diagram&&this.diagram.animationManager.defaultAnimation.isAnimating?17:this.Pf}get corner(){return this.Cd}set corner(t){const e=this.Cd;e!==t&&(this.Cd=t,this.ee(),this.t("corner",e,t))}get curve(){return this.Ld}set curve(t){const e=this.Ld;e!==t&&(this.Ld=t,this.invalidateRoute(),this.ee(),this.S1(10===e||11===e||10===t||11===t),this.t("curve",e,t))}get curviness(){return this.Ad}set curviness(t){const e=this.Ad;e!==t&&(this.Ad=t,this.invalidateRoute(),this.ee(),this.t("curviness",e,t))}get routing(){return this.va}set routing(t){const e=this.va;e!==t&&(this.va=t,this.isAvoiding&&null!==this.diagram&&(this.diagram.Vm=!0),this.Ko=null,this.invalidateRoute(),this.S1(De.gN(e)||De.gN(t)),this.t("routing",e,t))}get smoothness(){return this.Td}set smoothness(t){const e=this.Td;e!==t&&(this.Td=t,this.ee(),this.t("smoothness",e,t))}yy(){const t=this.eo;if(null===t)return;const e=this.no;if(null===e||!isNaN(this.curviness))return;const i=this.so,s=this.oo;let n=null,o=null;const r=t.ti.r,a=r.length;for(let h=0;h<a;h++){const a=r[h];(a.eo!==t||a.so!==i||a.no!==e||a.oo!==s)&&(a.eo!==e||a.so!==s||a.no!==t||a.oo!==i)||(null===o?o=a:(null===n&&(n=[],n.push(o)),n.push(a)))}if(null!==n){let o=t.mT(e,i,s);null===o&&(o=new Oe(t,i,e,s),t.dT(o),e.dT(o)),o.js=n;for(let t=0;t<n.length;t++){const e=n[t];e.Go=o}o.Sd()}}my(){const t=this.Go;if(null!==t){if(!isNaN(this.curviness))return;this.Go=null;const e=t.js.indexOf(this);e>=0&&(t.js.splice(e,1),t.Sd())}}Nl(){return!0}get key(){const t=this.diagram;if(null!==t&&t.model.Ra())return t.model.getKeyForLinkData(this.data)}}class Oe{Do;Is;ey;rN;m1;lN;js;constructor(t,e,i,s){u.Gi(this),this.Do=!1,this.Is=!1,this.ey=t,this.rN=e,this.m1=i,this.lN=s,this.js=[]}Sd(){if(!this.Do){const t=this.js;if(t.length>0){const e=t[0].diagram;null!==e&&(e.yM.add(this),this.Is=e.undoManager.isUndoingRedoing)}}this.Do=!0}FM(){if(this.Do){this.Do=!1;const t=this.js;if(t.length>0){const e=t[0],i=e.diagram,s=null===i||i.Uh&&!this.Is;this.Is=!1,e.arrangeBundledLinks(t,s),1===t.length&&(e.Go=null,t.length=0)}0===t.length&&(this.ey.gT(this),this.m1.gT(this))}}}class Fe{oe;re;Va;za;di;gi;Vt;kh;Ph;fa;GM;Do;xy;Kc;HM;jM;constructor(t){u.Gi(this),this.fa=null,this.GM=null,this.Do=!0,this.xy=!1,this.oe=1,this.re=1,this.Va=-1,this.za=-1,this.di=t.width,this.gi=t.height,this.Vt=[],this.kh=0,this.Ph=0,this.Kc=11,this.HM=2*this.Kc,this.jM=2*this.Kc}static qs=0;static Xa=1;static Rd=999999;static xN=Fe.Rd+1;static bN=Fe.Rd+2;Cb(t){if(t.width<=0||t.height<=0)return;const e=t.x,i=t.y,s=t.x+t.width,n=t.y+t.height;this.oe=Math.floor((e-this.di)/this.di)*this.di,this.re=Math.floor((i-this.gi)/this.gi)*this.gi,this.Va=Math.ceil((s+2*this.di)/this.di)*this.di,this.za=Math.ceil((n+2*this.gi)/this.gi)*this.gi;const o=1+(0|Math.ceil((this.Va-this.oe)/this.di)),r=1+(0|Math.ceil((this.za-this.re)/this.gi));if(0===this.Vt.length||this.kh<o-1||this.Ph<r-1){const t=[];for(let e=0;e<=o;e++)t[e]=new Uint32Array(r);this.Vt=t,this.kh=o-1,this.Ph=r-1}this.AO(Fe.xN)}get bounds(){return new x(this.oe,this.re,this.Va-this.oe,this.za-this.re)}get cellWidth(){return this.di}set cellWidth(t){t>0&&t!==this.di&&(this.di=t,this.Cb(this.bounds))}get cellHeight(){return this.gi}set cellHeight(t){t>0&&t!==this.gi&&(this.gi=t,this.Cb(this.bounds))}vd(t,e){return this.oe<=t&&t<=this.Va&&this.re<=e&&e<=this.za}ro(t,e){if(!this.vd(t,e))return Fe.xN;t-=this.oe,t/=this.di,e-=this.re,e/=this.gi;const i=0|t,s=0|e;return this.Vt[i][s]}UR(t,e,i,s){if(!this.vd(t,e))return;const n=(t-this.oe)/this.di|0,o=(e-this.re)/this.gi|0,r=(t+i-this.oe)/this.di|0,a=(e+s-this.re)/this.gi|0,h=Math.min(r,this.kh),l=Math.min(a,this.Ph);for(let u=n;u<=h;u++){const t=this.Vt[u];if(t.fill)t.fill(Fe.qs,o,l+1);else for(let e=o;e<=l;e++)t[e]=Fe.qs}}AO(t){for(let e=0;e<=this.kh;e++){const i=this.Vt[e];if(i.fill)i.fill(t);else for(let e=0;e<=this.Ph;e++)i[e]=t}}rA(){for(let t=0;t<=this.kh;t++){const e=this.Vt[t];for(let t=0;t<=this.Ph;t++)e[t]>=Fe.Xa&&(e[t]=Fe.xN)}}TO(t,e){return this.ro(t,e)===Fe.qs}isUnoccupied(t,e,i,s){if(t>this.Va||t+i<this.oe||e>this.za||e+s<this.re)return!0;let n=(t-this.oe)/this.di|0,o=(e-this.re)/this.gi|0,r=Math.max(0,i)/this.di+1|0,a=Math.max(0,s)/this.gi+1|0;if(n<0&&(r+=n,n=0),o<0&&(a+=o,o=0),r<0||a<0)return!0;const h=0|Math.min(n+r-1,this.kh),l=0|Math.min(o+a-1,this.Ph);for(let u=n;u<=h;u++){const t=this.Vt[u];for(let e=o;e<=l;e++)if(t[e]===Fe.qs)return!1}return!0}maxAvoidsLinksSpaceH(t,e,i,s){if(t>this.Va||e<this.oe||i>this.za||i<this.re)return 0;const n=(t-this.oe)/this.di|0,o=(e-this.oe)/this.di|0,r=(i-this.re)/this.gi|0,a=s/this.gi+1|0;let h;for(h=0;h<a/2;h++){let t=!1;for(let e=n;e<=o;e++)if(this.Vt[e][r+h]===Fe.qs||this.Vt[e][r-h]===Fe.qs){t=!0;break}if(t)return Math.max(0,(2*h-1)*this.gi)}return s}maxAvoidsLinksSpaceV(t,e,i,s){if(t>this.za||e<this.re||i>this.Va||i<this.oe)return 0;const n=(t-this.re)/this.gi|0,o=(e-this.re)/this.gi|0,r=(i-this.oe)/this.di|0,a=s/this.di+1|0;let h;for(h=0;h<a/2;h++){let t=!1;for(let e=n;e<=o;e++)if(this.Vt[r+h][e]===Fe.qs||this.Vt[r-h][e]===Fe.qs){t=!0;break}if(t)return Math.max(0,(2*h-1)*this.di)}return s}DO(t,e,i,s,n,o,r,a){t|=0,e|=0;let h=this.Vt[t][e];if(h>=Fe.Xa&&h<Fe.Rd)for(s?e+=i:t+=i,h+=1;n<=t&&t<=o&&r<=e&&e<=a;){const n=this.Vt[t][e];if(h>=n)break;this.Vt[t][e]=h,h+=1,s?e+=i:t+=i}return s?e:t}lo(t,e,i,s,n,o,r,a){if(t<n||t>o||e<r||e>a)return;const h=this.DO(t,e,i,s,n,o,r,a);if(s)if(i>0)for(let l=e+i;l<h;l+=i)this.lo(t,l,1,!s,n,o,r,a),this.lo(t,l,-1,!s,n,o,r,a);else for(let l=e+i;l>h;l+=i)this.lo(t,l,1,!s,n,o,r,a),this.lo(t,l,-1,!s,n,o,r,a);else if(i>0)for(let l=t+i;l<h;l+=i)this.lo(l,e,1,!s,n,o,r,a),this.lo(l,e,-1,!s,n,o,r,a);else for(let l=t+i;l>h;l+=i)this.lo(l,e,1,!s,n,o,r,a),this.lo(l,e,-1,!s,n,o,r,a)}A1(t,e,i,s,n,o,r,a,h,l){let u=0|t,c=0|e,d=Fe.qs,f=Fe.Xa;for(this.Vt[u][c]=f;d===Fe.qs&&u>r&&u<a&&c>h&&c<l;)f+=1,this.Vt[u][c]=f,o?c+=n:u+=n,d=this.Vt[u][c];return o?c:u}T1(t,e,i,s,n,o,r,a,h,l){let u=0|i,c=0|s,d=Fe.qs;const f=Fe.Rd;for(this.Vt[u][c]=f;d===Fe.qs&&u>r&&u<a&&c>h&&c<l;)this.Vt[u][c]=f,o?c+=n:u+=n,d=this.Vt[u][c]}NT(t,i,s,n,o,r){this.xy=!1;let a=t.x,h=t.y;if(!this.vd(a,h))return;a-=this.oe,a/=this.di,h-=this.re,h/=this.gi;let l=s.x,u=s.y;if(!this.vd(l,u))return;if(l-=this.oe,l/=this.di,u-=this.re,u/=this.gi,Math.abs(a-l)<=1&&Math.abs(h-u)<=1)return void(this.xy=!0);let c=o.x,d=o.y,f=o.x+o.width,g=o.y+o.height;c-=this.oe,c/=this.di,d-=this.re,d/=this.gi,f-=this.oe,f/=this.di,g-=this.re,g/=this.gi;const p=Math.max(0,Math.min(this.kh,0|c)),m=Math.min(this.kh,Math.max(0,0|f)),y=Math.max(0,Math.min(this.Ph,0|d)),v=Math.min(this.Ph,Math.max(0,0|g)),x=0,b=90,w=270,k=this.Vt,S=0|a,P=0|h,M=0|l,C=0|u,A=i===x||i===b?1:-1,N=i===b||i===w;k[S][P]===Fe.qs?(this.A1(S,P,M,C,A,N,p,m,y,v),this.A1(S,P,M,C,1,!N,p,m,y,v),this.A1(S,P,M,C,-1,!N,p,m,y,v)):this.A1(S,P,M,C,A,N,S,P,S,P),k[M][C]===Fe.qs?(this.T1(S,P,M,C,n===x||n===b?1:-1,n===b||n===w,p,m,y,v),this.T1(S,P,M,C,1,!(n===b||n===w),p,m,y,v),this.T1(S,P,M,C,-1,!(n===b||n===w),p,m,y,v)):this.T1(S,P,M,C,A,N,M,C,M,C);const L=e.et();if(r&&this.CT(M,C,n,S,P,L)){(L[0]!==M||L[1]!==C)&&(L.unshift(C),L.unshift(M)),(L[L.length-2]!==S||L[L.length-1]!==P)&&(L.push(S),L.push(P));let t=Fe.Xa,e=L[L.length-2],i=L[L.length-1];k[e][i]=t++;for(let s=L.length-4;s>=0;s-=2){e=L[s+2],i=L[s+3];const n=L[s],o=L[s+1];for(;n>e?e++:n<e?e--:o>i?i++:o<i&&i--,k[e][i]=t++,e!==n||i!==o;);}}else this.lo(S,P,1,!1,p,m,y,v),this.lo(S,P,-1,!1,p,m,y,v),this.lo(S,P,1,!0,p,m,y,v),this.lo(S,P,-1,!0,p,m,y,v);e.J(L)}CT(t,e,i,s,n,o){const r=this.Vt;let a=t,h=e;for(;;){if(a===s&&h===n)return!0;let t=a,e=h;if(0===i){if(!(t<s))break;t++}else if(90===i){if(!(e<n))break;e++}else if(180===i){if(!(t>s))break;t--}else{if(!(e>n))break;e--}const o=r[t][e];if(0===o||o===Fe.bN)break;a=t,h=e}for(;;){let l=i,u=a,c=h;0===i?c<n?(l=90,c++):c>n&&(l=270,c--):90===i?u<s?(l=0,u++):u>s&&(l=180,u--):180===i?c<n?(l=90,c++):c>n&&(l=270,c--):u<s?(l=0,u++):u>s&&(l=180,u--);const d=r[u][c];if(l!==i&&0!==d&&d!==Fe.bN){if(o.push(a),o.push(h),this.CT(a,h,l,s,n,o))return!0;o.pop(),o.pop()}if(r[a][h]=Fe.bN,0===i){if(a===t)return!1;a--}else if(90===i){if(h===e)return!1;h--}else if(180===i){if(a===t)return!1;a++}else{if(h===e)return!1;h++}}}}class Re{Me;hl;os;Od;constructor(t,e){u.Gi(this),this.Me=t,this.hl=e,this.os=[],this.Od=!1}toString(){const t=this.os;let e=this.Me.toString()+" "+t.length.toString()+":";for(let i=0;i<t.length;i++){const s=t[i];null!==s&&(e+="\n  "+s.toString())}return e}FO(t,e,i,s){const n=e.offsetY;switch(n){case 8:return 90;case 2:return 180;case 1:return 270;case 4:return 0}let o=i;switch(n){case 9:return o>180?270:90;case 6:return o>90&&o<=270?180:0}const r=180*Math.atan2(t.height,t.width)/Math.PI;switch(n){case 3:return o>r&&o<=180+r?180:270;case 5:return o>180-r&&o<=360-r?270:0;case 12:return o>r&&o<=180+r?90:0;case 10:return o>180-r&&o<=360-r?180:90;case 7:return o>90&&o<=180+r?180:o>180+r&&o<=360-r?270:0;case 13:return o>180&&o<=360-r?270:o>r&&o<=180?90:0;case 14:return o>r&&o<=180-r?90:o>180-r&&o<=270?180:0;case 11:return o>180-r&&o<=180+r?180:o>180+r?270:90}return s&&15!==n&&(o-=15,o<0&&(o+=360)),o>r&&o<180-r?90:o>=180-r&&o<=180+r?180:o>180+r&&o<360-r?270:0}Sd(){this.os.length=0}ST(t){let e=this.os;0===e.length&&(this.RO(),e=this.os);for(let i=0;i<e.length;i++){const s=e[i];if(null!==s&&s.Ge===t)return s}return null}RO(){if(!this.Od){const t=this.Od;this.Od=!0;let e,i=null;const s=this.Me,n=s instanceof _e?s:null;if(null===n||n.isSubGraphExpanded)e=s.isTreeExpanded?s.findLinksConnected(this.hl.portId):s.findExternalTreeLinksConnected();else{if(!n.actualBounds.isReal())return this.Od=t,this.os;i=n,e=i.findExternalLinksConnected()}this.os.length=0;let o=0;const r=this.hl.getDocumentPoint(w.TopLeft,y.l()),a=this.hl.getDocumentPoint(w.BottomRight,y.l()),h=x.V(r.x,r.y,0,0);h.unionPoint(a),y.e(r),y.e(a);const l=y.V(h.x+h.width/2,h.y+h.height/2),u=this.hl.getDocumentAngle(),c=e.iterator;for(;c.next();){const t=c.value;if(!t.isVisible()||t.fromPort===t.toPort)continue;const e=t.fromPort===this.hl||null!==t.fromNode&&null!==i&&t.fromNode.isMemberOf(i),s=t.computeSpot(e,this.hl);if(!s.isSide())continue;let n;if(n=e?t.toPort:t.fromPort,null===n)continue;let r=n.part;if(null===r)continue;const a=r.findVisibleNode();null!==a&&a!==r&&(r=a,n=r.port);const d=t.computeOtherPoint(r,n);let f=l.directionPoint(d);f-=u,f<0?f+=360:f>=360&&(f-=360);const g=this.FO(h,s,f,t.isOrthogonal);let p=0;0===g?(p=4,f>180&&(f-=360)):90===g?(p=8,f>270&&(f-=360)):180===g?p=2:(p=1,f<90&&(f+=360));let m=this.os[o];void 0===m?(m=new Ee(t,f,p),this.os[o]=m):(m.Ge=t,m.Yt=f,m.me=p),m.D1.set(d),o++}y.e(l),this.vO();const d=this.os.length;let f=-1,g=0;for(o=0;o<d;o++){const t=this.os[o];void 0!==t&&(t.me!==f&&(f=t.me,g=0),t.Id=g,g++)}for(f=-1,g=0,o=d-1;o>=0;o--){const t=this.os[o];void 0!==t&&(t.me!==f&&(f=t.me,g=t.Id+1),t.Mf=g)}this.OO(this.os),this.IO(this.os),this.Od=t,x.e(h)}return this.os}EO(t,e){return t===e?0:null===t?-1:null===e?1:t.me<e.me?-1:t.me>e.me?1:t.Yt<e.Yt?-1:t.Yt>e.Yt?1:0}vO(){this.os.sort(Re.prototype.EO)}OO(t){const e=this.hl,i=this.Me.portSpreading,s=y.l(),n=y.l(),o=y.l(),r=y.l();e.getDocumentPoint(w.TopLeft,s),e.getDocumentPoint(w.TopRight,n),e.getDocumentPoint(w.BottomRight,o),e.getDocumentPoint(w.BottomLeft,r);let a=0,h=0,l=0,u=0;if(2===i)for(let y=0;y<t.length;y++){const e=t[y];if(null===e)continue;const i=e.Ge.computeThickness();switch(e.me){case 8:l+=i;break;case 2:u+=i;break;case 1:a+=i;break;default:case 4:h+=i;break}}let c=0,d=0,f=1,g=n,p=o,m=0,v=0;for(let y=0;y<t.length;y++){const e=t[y];if(null===e)continue;if(c!==e.me){switch(c=e.me,c){case 8:g=o,p=r;break;case 2:g=r,p=s;break;case 1:g=s,p=n;break;default:case 4:g=n,p=o;break}switch(m=p.x-g.x,v=p.y-g.y,c){case 8:l>Math.abs(m)?(f=Math.abs(m)/l,l=Math.abs(m)):f=1;break;case 2:u>Math.abs(v)?(f=Math.abs(v)/u,u=Math.abs(v)):f=1;break;case 1:a>Math.abs(m)?(f=Math.abs(m)/a,a=Math.abs(m)):f=1;break;default:case 4:h>Math.abs(v)?(f=Math.abs(v)/h,h=Math.abs(v)):f=1;break}d=0}const x=e.Fd;if(2===i){let t=e.Ge.computeThickness();switch(t*=f,x.set(g),c){case 8:x.x=g.x+m/2+l/2-d-t/2;break;case 2:x.y=g.y+v/2+u/2-d-t/2;break;case 1:x.x=g.x+m/2-a/2+d+t/2;break;default:case 4:x.y=g.y+v/2-h/2+d+t/2;break}d+=t}else{let t=.5;1===i&&(t=(e.Id+1)/(e.Mf+1)),x.x=g.x+m*t,x.y=g.y+v*t}}y.e(s),y.e(n),y.e(o),y.e(r)}IO(t){for(let e=0;e<t.length;e++){const i=t[e];null!==i&&(i.C1=this.BO(i))}}BO(t){const e=t.Ge,i=e.fromPort===this.hl,s=e.computeEndSegmentLength(this.Me,this.hl,w.None,i);let n=t.Id;if(n<0)return s;const o=t.Mf;if(o<=1||!e.isOrthogonal)return s;const r=t.D1,a=t.Fd;(2===t.me||8===t.me)&&(n=o-1-n);const h=De.lO,l=2===t.me||4===t.me;return(l?r.y<a.y:r.x<a.x)?s+n*h:(l?r.y===a.y:r.x===a.x)?s:s+(o-1-n)*h}}class Ee{Ge;Yt;me;D1;Id;Mf;Fd;C1;constructor(t,e,i){this.Ge=t,this.Yt=e,this.me=i,this.D1=new y,this.Id=0,this.Mf=0,this.Fd=new y,this.C1=0}toString(){return this.Ge.toString()+" "+this.Yt.toString()+" "+this.me.toString()+":"+this.Id.toString()+"/"+this.Mf.toString()+" "+this.Fd.toString()+" "+this.C1.toString()+" "+this.D1.toString()}}class Be{ga;ma;pa;ya;wa;xa;v0;F0;O0;R0;constructor(){this.ga=w.Default,this.ma=w.Default,this.pa=NaN,this.ya=NaN,this.wa=NaN,this.xa=NaN,this.v0=null,this.F0=null,this.O0=1/0,this.R0=1/0}copy(){const t=new Be;return t.ga=this.ga.P(),t.ma=this.ma.P(),t.pa=this.pa,t.ya=this.ya,t.wa=this.wa,t.xa=this.xa,t.v0=this.v0,t.F0=this.F0,t.O0=this.O0,t.R0=this.R0,t}}class Ie{M0;N0;C0;S0;mp;pp;constructor(){this.M0=-1/0,this.N0=0,this.C0=y.wo,this.S0=0,this.mp="None",this.pp="None"}copy(){const t=new Ie;return t.M0=this.M0,t.N0=this.N0,t.C0=this.C0.P(),t.S0=this.S0,t.mp=this.mp,t.pp=this.pp,t}}class _e extends Ce{Ed;Ft;aa;l0;si;ie;constructor(t,e){let i;void 0===t||t instanceof $t||"string"==typeof t?i=t:t&&(e=t),super(i),this.v=4608|this.v,this.Ed=new u,this.Ft=null,this.ie=new ze,this.ie.group=this,this.aa=new u,this.l0=null,this.si=null,e&&Object.assign(this,e)}cloneProtected(t){super.cloneProtected(t),this.v=-32769&this.v;const e=t.findInVisualTree((t=>t instanceof Ve));t.Ft=e instanceof Ve?e:null,null!==this.ie?(t.ie=this.ie.copy(),t.ie.group=t):(null!==t.ie&&(t.ie.group=null),t.ie=null),null!==this.si&&(t.si=this.si.copy())}Ro(t){super.Ro(t);const e=t.findSubGraphParts(),i=t.memberParts;for(;i.next();){const t=i.value;if(t.c(),t.invalidateLayout(8),t.clearAdornments(),t instanceof Ce)t.invalidateConnectedLinks(e);else if(t instanceof De){const i=t.labelNodes;for(;i.next();)i.value.invalidateConnectedLinks(e)}}}qc(t,i,s,n,o,r,a){if(3===t&&"elements"===i){if(o instanceof Ve)null===this.Ft?this.Ft=o:this.Ft!==o&&e.o("Cannot insert a second Placeholder into the visual tree of a Group.");else if(o instanceof ie){const t=o.findInVisualTree((t=>t instanceof Ve));t instanceof Ve&&(null===this.Ft?this.Ft=t:this.Ft!==t&&e.o("Cannot insert a second Placeholder into the visual tree of a Group."))}}else 4===t&&"elements"===i&&null!==this.Ft&&(n===this.Ft||n instanceof ie&&this.Ft.isContainedBy(n))&&(this.Ft=null);super.qc(t,i,s,n,o,r,a)}Ju(t,e){if(super.Ju(t,e),this.isClipping&&this.type!==ie.Spot&&this.isSubGraphExpanded){let t=this.resizeObject;t instanceof ie&&(t=t.findMainElement()),null===this.si&&(this.si=new x),t.getDocumentBounds(this.si),t instanceof he&&this.si.inflate(-t.strokeWidth,-t.strokeWidth)}}fh(t,e,i,s){this.hasPlaceholder()&&(this.Yo=this.placeholder),super.fh(t,e,i,s)}ensureBounds(){this.isSubGraphExpanded&&this.memberParts.each((t=>{t.ensureBounds()})),super.ensureBounds()}Xr(){if(!super.Xr())return!1;const t=this.memberParts;for(;t.next();){const e=t.value;if(e instanceof Ce){if(!e.isVisible())continue;if(e._e())return!1}else if(e instanceof De){if(!e.isVisible())continue;if(e._e()&&e.fromNode!==this&&e.toNode!==this)return!1}}return!0}hasPlaceholder(){return null!==this.Ft&&this.Ft.isVisibleObject()&&this.isSubGraphExpanded}get placeholder(){return this.Ft}get computesBoundsAfterDrag(){return 0!==(2048&this.v)}set computesBoundsAfterDrag(t){const e=0!==(2048&this.v);e!==t&&(this.v=2048^this.v,this.t("computesBoundsAfterDrag",e,t))}get computesBoundsIncludingLinks(){return 0!==(4096&this.v)}set computesBoundsIncludingLinks(t){const e=0!==(4096&this.v);e!==t&&(this.v=4096^this.v,this.t("computesBoundsIncludingLinks",e,t))}get computesBoundsIncludingLocation(){return 0!==(8192&this.v)}set computesBoundsIncludingLocation(t){const e=0!==(8192&this.v);e!==t&&(this.v=8192^this.v,this.t("computesBoundsIncludingLocation",e,t))}get handlesDragDropForMembers(){return 0!==(16384&this.v)}set handlesDragDropForMembers(t){const e=0!==(16384&this.v);e!==t&&(this.v=16384^this.v,this.t("handlesDragDropForMembers",e,t))}get avoidableMembers(){return 0!==(131072&this.v)}set avoidableMembers(t){const e=0!==(131072&this.v);e!==t&&(this.v=131072^this.v,this.t("avoidableMembers",e,t))}get memberParts(){return this.Ed.iterator}eN(t){if(this.Ed.add(t)){t instanceof _e&&this.aa.add(t);const e=this.memberAdded;if(null!==e){let i=!0;const s=this.diagram;null!==s&&(i=s.X,s.X=!0),e(this,t),null!==s&&(s.X=i)}(!this.isVisible()||!this.isSubGraphExpanded)&&t.Ei(!1)}if(t instanceof De&&!this.computesBoundsIncludingLinks)return;let e=this.Ft;null===e&&(e=this),e.c()}iN(t){if(this.Ed.delete(t)){t instanceof _e&&this.aa.delete(t);const e=this.memberRemoved;if(null!==e){let i=!0;const s=this.diagram;null!==s&&(i=s.X,s.X=!0),e(this,t),null!==s&&(s.X=i)}(!this.isVisible()||!this.isSubGraphExpanded)&&t.Ei(!0)}if(t instanceof De&&!this.computesBoundsIncludingLinks)return;let e=this.Ft;null===e&&(e=this),e.c()}Xc(){if(this.Ed.count>0){const t=this.diagram;if(null!==t){const e=this.Ed.copy().iterator;for(;e.next();){const i=e.value;t.remove(i)}}}super.Xc()}get layout(){return this.ie}set layout(t){const i=this.ie;if(i!==t){null!==t&&null!==t.diagram&&t.diagram.layout===t&&e.o("A layout cannot be both the Diagram.layout and a Group.layout: "+t),null!==i&&(i.diagram=null,i.group=null),this.ie=t;const s=this.diagram;null!==t&&(t.diagram=s,t.group=this),null!==s&&(s.Ur=!0),this.t("layout",i,t),null!==s&&s.requestUpdate()}}get memberAdded(){return null!==this.Rt?this.Rt.fy:null}set memberAdded(t){const i=this.memberAdded;i!==t&&(null!==t&&e.k(t,_e,"memberAdded"),this.rl().fy=t,this.t("memberAdded",i,t))}get memberRemoved(){return null!==this.Rt?this.Rt.uy:null}set memberRemoved(t){const i=this.memberRemoved;i!==t&&(null!==t&&e.k(t,_e,"memberRemoved"),this.rl().uy=t,this.t("memberRemoved",i,t))}get memberValidation(){return null!==this.Rt?this.Rt.eh:null}set memberValidation(t){const i=this.memberValidation;i!==t&&(null!==t&&e.k(t,_e,"memberValidation"),this.rl().eh=t,this.t("memberValidation",i,t))}canAddMembers(t){const e=this.diagram;if(null===e)return!1;const i=e.commandHandler,s=i.g2(t).iterator;for(;s.next();){const t=s.value;if(!i.isValidMember(this,t))return!1}return!0}addMembers(t,e){const i=this.diagram;if(null===i)return!1;const s=i.commandHandler,n=s.g2(t);let o=!0;const r=n.iterator;for(;r.next();){const t=r.value;!e||s.isValidMember(this,t)?t.containingGroup=this:o=!1}return o}get ungroupable(){return 0!==(256&this.v)}set ungroupable(t){const e=0!==(256&this.v);e!==t&&(this.v=256^this.v,this.t("ungroupable",e,t))}canUngroup(){if(!this.ungroupable)return!1;const t=this.layer;if(null===t||!t.allowUngroup)return!1;const e=t.diagram;return!(null!==e&&!e.allowUngroup)}invalidateConnectedLinks(t){const e=this.UO();if(super.invalidateConnectedLinks(t),e)return;this.XL(!0);const i=this.findExternalLinksConnected();for(;i.next();){const e=i.value;if(void 0!==t&&t.has(e))continue;const s=e.fromNode;if(null!==s&&s!==this&&s.isMemberOf(this)&&!s.isVisible())s.qi(e.fromPort),s.qi(e.toPort),e.invalidateRoute();else{const t=e.toNode;null!==t&&t!==this&&t.isMemberOf(this)&&!t.isVisible()&&(t.qi(e.fromPort),t.qi(e.toPort),e.invalidateRoute())}}}findExternalLinksConnected(){const t=null!==this.diagram&&this.diagram.SM;if(t&&null!==this.l0)return this.l0.iterator;const e=this.findSubGraphParts();e.add(this);const i=new u,s=e.iterator;for(;s.next();){const t=s.value;if(!(t instanceof Ce))continue;const n=t.linksConnected;for(;n.next();){const t=n.value;e.has(t)||i.add(t)}}return t&&(this.l0=i),i.iterator}findExternalNodesConnected(){const t=this.findSubGraphParts();t.add(this);const e=new u,i=t.iterator;for(;i.next();){const s=i.value;if(!(s instanceof Ce))continue;const n=s.linksConnected;for(;n.next();){const i=n.value,s=i.fromNode;null!==s&&(!t.has(s)||s===this)&&e.add(s);const o=i.toNode;null!==o&&(!t.has(o)||o===this)&&e.add(o)}}return e.iterator}RE(){function t(e,i){null!==e&&(i.add(e),t(e.containingGroup,i))}const e=new u;return t(this,e),e}findSubGraphParts(){const t=new u;return ke.nh(t,this,!0,0,!0),t.delete(this),t}Ei(t){super.Ei(t);const e=this.memberParts;for(;e.next();)e.value.Ei(t)}collapseSubGraph(){const t=this.diagram;if(null===t||t.isCollapsingExpanding)return;t.isCollapsingExpanding=!0;const e=this.findSubGraphParts();this.LT(e,t,this),t.isCollapsingExpanding=!1}LT(t,e,i){const s=this.memberParts;for(;s.next();){const n=s.value;if(n.Ei(!1),n instanceof _e&&n.isSubGraphExpanded&&(n.wasSubGraphExpanded=n.isSubGraphExpanded,n.LT(t,e,i)),n instanceof Ce)n.invalidateConnectedLinks(t),e.Lc(n,i);else if(n instanceof De){const e=n.labelNodes;for(;e.next();)e.value.invalidateConnectedLinks(t)}}this.isSubGraphExpanded=!1}expandSubGraph(){const t=this.diagram;if(null===t||t.isCollapsingExpanding)return;t.isCollapsingExpanding=!0;const e=this.findSubGraphParts();this.AT(e,t,this),t.isCollapsingExpanding=!1}AT(t,e,i){const s=this.memberParts;for(;s.next();){const n=s.value;if(n.Ei(!0),n instanceof _e&&n.wasSubGraphExpanded&&(n.wasSubGraphExpanded=!1,n.AT(t,e,i)),n instanceof Ce)n.invalidateConnectedLinks(t);else if(n instanceof De){const e=n.labelNodes;for(;e.next();)e.value.invalidateConnectedLinks(t)}}this.isSubGraphExpanded=!0}get isSubGraphExpanded(){return 0!==(512&this.v)}set isSubGraphExpanded(t){const e=0!==(512&this.v);if(e!==t){this.v=512^this.v;const i=this.diagram;this.t("isSubGraphExpanded",e,t);const s=this.subGraphExpandedChanged;if(null!==s){let t=!0;null!==i&&(t=i.X,i.X=!0),s(this),null!==i&&(i.X=t)}if(null!==i&&i.undoManager.isUndoingRedoing)return null!==this.Ft&&this.Ft.c(),void this.memberParts.each((t=>t.updateAdornments()));t?this.expandSubGraph():this.collapseSubGraph()}}get wasSubGraphExpanded(){return 0!==(1024&this.v)}set wasSubGraphExpanded(t){const e=0!==(1024&this.v);e!==t&&(this.v=1024^this.v,this.t("wasSubGraphExpanded",e,t))}get subGraphExpandedChanged(){return null!==this.Rt?this.Rt.gy:null}set subGraphExpandedChanged(t){const i=this.subGraphExpandedChanged;i!==t&&(null!==t&&e.k(t,_e,"subGraphExpandedChanged"),this.rl().gy=t,this.t("subGraphExpandedChanged",i,t))}move(t,e){void 0===e&&(e=!1);const i=e?this.location:this.position,s=i.x,n=i.y,o=t.x,r=t.y;if((s===o||isNaN(s)&&isNaN(o))&&(n===r||isNaN(n)&&isNaN(r)))return;const a=o-(isNaN(s)?0:s),h=r-(isNaN(n)?0:n),l=y.l();super.move(t,e);const c=new u,d=this.findSubGraphParts().iterator;for(;d.next();){const t=d.value;t instanceof De&&(t.suspendsRouting&&c.add(t),(t.Se||t.fromNode!==this&&t.toNode!==this)&&(t.suspendsRouting=!0))}for(d.reset();d.next();){const t=d.value;if(t.Nl()||t instanceof Ce&&t.isLinkLabel)continue;const e=t.position,i=t.location;e.isReal()?(l.x=e.x+a,l.y=e.y+h,t.position=l):i.isReal()&&(l.x=i.x+a,l.y=i.y+h,t.location=l)}for(d.reset();d.next();){const t=d.value;if(!(t instanceof De)||(t.suspendsRouting=c.has(t),!t.Se&&(t.fromNode===this||t.toNode===this)))continue;const e=t.position;l.x=e.x+a,l.y=e.y+h,l.isReal()?t.move(l):t.invalidateRoute()}y.e(l)}UO(){return 0!==(65536&this.v)}XL(t){0!==(65536&this.v)!==t&&(this.v=65536^this.v)}get ca(){return 0!==(32768&this.v)}set ca(t){0!==(32768&this.v)!==t&&(this.v=32768^this.v)}}class Ve extends Tt{Zt;Bd;constructor(t){super(),this.Zt=b.Rg,this.Bd=new x(NaN,NaN,NaN,NaN),t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.Zt=this.Zt.P(),t.Bd=this.Bd.copy()}ch(t){if(null===this.background)return!1;const e=this.naturalBounds;return x.contains(0,0,e.width,e.height,t.x,t.y)}Wu(t,i,s,n){const o=this.part;if((null===o||!(o instanceof _e)&&!(o instanceof Pe))&&e.o("Placeholder is not inside a Group or Adornment."),o instanceof _e){const t=this.computeBorder(this.Bd),e=this.minSize,i=isFinite(e.width)?Math.max(e.width,t.width):t.width,s=isFinite(e.height)?Math.max(e.height,t.height):t.height,n=this.zi;n.Fn(i||0,s||0),this.Wn(0,0,n.width,n.height);const r=o.memberParts;let a=!1;for(;r.next();)if(r.value.isVisible()){a=!0;break}const h=o.diagram;if(a&&null!==h&&!h.animationManager.ES(o)&&!isNaN(t.x)&&!isNaN(t.y)){const e=y.l();e.setRectSpot(t,o.locationSpot),o.location=e,y.e(e)}}else{const t=o,e=this.zi,i=this.Zt,s=i.left+i.right,n=i.top+i.bottom,r=t.adornedObject,a=r.getDocumentAngle();t.angle=a;let h=0;r instanceof he&&(h=r.strokeWidth);const l=r.getDocumentScale(),u=r.naturalBounds,c=(u.width+h)*l,d=(u.height+h)*l;if(t.type!==ie.Link){const e="Selection"===t.category?w.TopLeft:t.locationSpot,i=r.getDocumentPoint(e,y.l());t.location=i,y.e(i)}if(isNaN(c)||isNaN(d)){const t=r.getDocumentPoint(w.TopLeft,y.l()),o=x.V(t.x,t.y,0,0);o.unionPoint(r.getDocumentPoint(w.BottomRight,t)),o.unionPoint(r.getDocumentPoint(w.TopRight,t)),o.unionPoint(r.getDocumentPoint(w.BottomLeft,t)),e.Fn(o.width+s||0,o.height+n||0),this.Wn(-i.left,-i.top,e.width,e.height),y.e(t),x.e(o)}else e.Fn(c+s||0,d+n||0),this.Wn(-i.left,-i.top,e.width,e.height)}}fh(t,e,i,s){this.actualBounds.i(t,e,i,s)}computeBorder(t){const e=this.part,i=e.diagram,s=null===i||!i.animationManager.isAnimating;if(null!==i&&e instanceof _e&&!e.layer.isTemporary&&e.computesBoundsAfterDrag&&this.Bd.isReal()){const s=i.toolManager.findTool("Dragging");if(s===i.currentTool){const i=s.computeBorder(e,this.Bd,t);if(null!==i)return i}}const n=x.l(),o=this.computeMemberBounds(n),r=this.Zt;return e instanceof _e&&!e.isSubGraphExpanded?t.i(o.x-r.left,o.y-r.top,0,0):t.i(o.x-r.left,o.y-r.top,Math.max(o.width+r.left+r.right,0),Math.max(o.height+r.top+r.bottom,0)),x.e(n),s&&e instanceof _e&&e.computesBoundsIncludingLocation&&e.location.isReal()&&t.unionPoint(e.location),t}computeMemberBounds(t){if(!(this.part instanceof _e))return t.i(0,0,0,0),t;const e=this.part;let i=1/0,s=1/0,n=-1/0,o=-1/0;const r=e.memberParts;for(;r.next();){const t=r.value;if(!t.isVisible()||t instanceof De&&(!e.computesBoundsIncludingLinks||t.Ao()||t.fromNode===e||t.toNode===e))continue;const a=t.actualBounds;a.left<i&&(i=a.left),a.top<s&&(s=a.top),a.right>n&&(n=a.right),a.bottom>o&&(o=a.bottom)}if(isFinite(i)&&isFinite(s))t.i(i,s,n-i,o-s);else{const i=e.location;t.i(i.x,i.y,0,0)}return t}get padding(){return this.Zt}set padding(t){"number"==typeof t&&(t=new b(t));const e=this.Zt;e.equals(t)||(t=t.P(),this.Zt=t,this.t("padding",e,t),this.c())}}class ze{N;fa;Ud;yr;Vd;zd;No;al;Xd;Yd;ho;constructor(t){u.Gi(this),this.N=null,this.fa=null,this.Ud=!0,this.yr=!0,this.Vd=!1,this.zd=new y(0,0).u(),this.No=!0,this.al=null,this.Xd=null,this.Yd=!1,this.ho=null,t&&Object.assign(this,t)}cloneProtected(t){t.Ud=this.Ud,t.yr=this.yr,t.Vd=this.Vd,t.zd.a(this.zd),t.No=this.No,t.al=this.al,t.Xd=this.Xd,t.Yd=!0}copy(){const t=new this.constructor;return this.cloneProtected(t),t}oi(t){e.ir(this,t)}toString(){let t=e.Dn(this.constructor);return t+="(",null!==this.group&&(t+=" in "+this.group),null!==this.diagram&&(t+=" for "+this.diagram),t+=")",t}get diagram(){return this.N}set diagram(t){this.N=t}get group(){return this.fa}set group(t){this.fa!==t&&(this.fa=t,null!==t&&(this.N=t.diagram))}get isOngoing(){return this.Ud}set isOngoing(t){this.Ud!==t&&(e.s(t,"boolean",ze,"isOngoing"),this.Ud=t)}get isInitial(){return this.yr}set isInitial(t){e.s(t,"boolean",ze,"isInitial"),this.yr=t,t||(this.Yd=!0)}get isViewportSized(){return this.Vd}set isViewportSized(t){this.Vd!==t&&(e.s(t,"boolean",ze,"isViewportSized"),this.Vd=t,t&&this.invalidateLayout())}get isRouting(){return this.No}set isRouting(t){this.No!==t&&(e.s(t,"boolean",ze,"isRouting"),this.No=t)}get isRealtime(){return this.al}set isRealtime(t){this.al!==t&&(null!==t&&e.s(t,"boolean",ze,"isRealtime"),this.al=t)}get isValidLayout(){return this.Yd}set isValidLayout(t){if(this.Yd!==t&&(e.s(t,"boolean",ze,"isValidLayout"),this.Yd=t,!t)){const t=this.diagram;null!==t&&(t.Ur=!0)}}invalidateLayout(){if(this.isValidLayout){const t=this.diagram;if(null===t||t.undoManager.isUndoingRedoing)return;const e=t.animationManager;if(e.isTicking)return;e.defaultAnimation.isAnimating&&e.stopAnimation(),(this.isOngoing&&t.Uh||this.isInitial&&!t.Uh)&&(this.isValidLayout=!1,t.requestUpdate())}}get network(){return this.ho}set network(t){this.ho!==t&&(this.ho=t,null!==t&&(t.layout=this))}createNetwork(){return new je(this)}makeNetwork(t){const e=this.createNetwork();return t instanceof vt?(e.addParts(t.nodes,!0),e.addParts(t.links,!0)):t instanceof _e?e.addParts(t.memberParts):e.addParts(t.iterator),e}updateParts(){this.isValidLayout=!0;let t=this.diagram;if(null===t&&null!==this.network){const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value.node;if(null!==i&&(t=i.diagram,null!==t))break}}try{null!==t&&t.startTransaction("Layout"),this.commitLayout()}finally{null!==t&&t.commitTransaction("Layout")}}commitLayout(){if(null===this.network)return;const t=this.network.vertexes.iterator;for(;t.next();)t.value.commit();if(this.isRouting){const t=this.network.edges.iterator;for(;t.next();)t.value.commit()}}doLayout(t){const e=new u;if(t instanceof vt?(this.Sh(e,t.nodes,!0,this.ca,!0,!1,!0),this.Sh(e,t.parts,!0,this.ca,!0,!1,!0)):t instanceof _e?this.Sh(e,t.memberParts,!1,this.ca,!0,!1,!0):e.addAll(t.iterator),e.count>0){const t=this.diagram;null!==t&&t.startTransaction("Layout"),this.doMinimalNoNetworkLayout(e),null!==t&&t.commitTransaction("Layout")}this.isValidLayout=!0}doMinimalNoNetworkLayout(t){const e=t.count,i=Math.ceil(Math.sqrt(e));this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin);const s=this.arrangementOrigin.x,n=this.arrangementOrigin.y;let o=s,r=n,a=0,h=0;const l=t.iterator;for(;l.next();){const t=l.value;t.ensureBounds();const e=t.measuredBounds,n=e.width,u=e.height;t.moveTo(o,r),t instanceof _e&&(t.ca=!1),o+=Math.max(n,50)+20,h=Math.max(h,Math.max(u,50)),a>=i-1?(a=0,o=s,r+=h+20,h=0):a++}}ca(t){return!!(!t.location.isReal()&&!t.position.isReal()||t instanceof _e&&t.ca)}Sh(t,e,i,s,n,o,r){const a=e.iterator;for(;a.next();){const e=a.value;if((!i||e.isTopLevel)&&(null===s||s(e))&&e.canLayout())if(n&&e instanceof Ce){if(e.isLinkLabel)continue;e instanceof _e&&null===e.layout?this.Sh(t,e.memberParts,!1,s,n,o,r):(e.ensureBounds(),t.add(e))}else o&&e instanceof De?t.add(e):r&&e.ke()&&!(e instanceof Ce)&&(e.ensureBounds(),t.add(e))}}getLayoutBounds(t,e){const i=this.boundsComputation;return null!==i?(e||(e=new x),i(t,this,e)):!e&&t.margin.equalTo(0,0,0,0)?t.actualBounds:(e||(e=new x),e.set(t.actualBounds),e.addMargin(t.margin),e)}get boundsComputation(){return this.Xd}set boundsComputation(t){this.Xd!==t&&(null!==t&&e.k(t,ze,"boundsComputation"),this.Xd=t,this.invalidateLayout())}collectParts(t){const e=new u;return t instanceof vt?(this.Sh(e,t.nodes,!0,null,!0,!0,!0),this.Sh(e,t.links,!0,null,!0,!0,!0),this.Sh(e,t.parts,!0,null,!0,!0,!0)):t instanceof _e?this.Sh(e,t.memberParts,!1,null,!0,!0,!0):this.Sh(e,t.iterator,!1,null,!0,!0,!0),e}get arrangementOrigin(){return this.zd}set arrangementOrigin(t){this.zd.equals(t)||(this.zd.a(t),this.invalidateLayout())}initialOrigin(t){const e=this.group;if(null!==e){if(e.hasPlaceholder()){const i=e.placeholder,s=i.getDocumentPoint(w.TopLeft);(isNaN(s.x)||isNaN(s.y))&&s.set(t);const n=i.padding;return s.x+=n.left,s.y+=n.top,s}{const i=e.position.copy();return(isNaN(i.x)||isNaN(i.y))&&i.set(t),i}}return t}}class je{ie;ao;bn;by;ky;constructor(t){u.Gi(this),this.ie=t,this.ao=new u,this.bn=new u,this.by=new m,this.ky=new m}clear(){if(this.ao){const t=this.ao.iterator;for(;t.next();)t.value.clear()}if(this.bn){const t=this.bn.iterator;for(;t.next();)t.value.clear()}this.ao=new u,this.bn=new u,this.by=new m,this.ky=new m}toString(t){void 0===t&&(t=0);let e="LayoutNetwork"+(null!==this.layout?"("+this.layout.toString()+")":"");if(t<=0)return e;if(e+=" vertexes: "+this.ao.count+" edges: "+this.bn.count,t>1){const i=this.ao.iterator;for(;i.next();){const s=i.value;e+="\n    "+s.toString(t-1)}const s=this.bn.iterator;for(;s.next();){const i=s.value;e+="\n    "+i.toString(t-1)}}return e}get layout(){return this.ie}set layout(t){null!==t&&(this.ie=t)}get vertexes(){return this.ao}get edges(){return this.bn}createVertex(){return new $e(this)}createEdge(){return new Xe(this)}addParts(t,i,s){if(null===t)return;void 0===i&&(i=!1),e.s(i,"boolean",je,"addParts:toplevelonly"),void 0===s&&(s=null),null===s&&(s=t=>{if(t instanceof Ce)return!t.isLinkLabel;if(t instanceof De){const e=t.fromNode;if(null===e||e.isLinkLabel)return!1;const i=t.toNode;return!(null===i||i.isLinkLabel)}return!1});const n=t.iterator;for(;n.next();){const t=n.value;if(t instanceof Ce&&(!i||t.isTopLevel)&&t.canLayout()&&s(t))if(t instanceof _e&&null===t.layout)this.addParts(t.memberParts,!1);else{if(null!==this.findVertex(t))continue;const e=this.createVertex();e.node=t,this.addVertex(e)}}for(n.reset();n.next();){const t=n.value;if(!(t instanceof De)||i&&!t.isTopLevel||!t.canLayout()||!s(t)||null!==this.findEdge(t))continue;const e=t.fromNode,o=t.toNode;if(null===e||null===o||e===o)continue;const r=this.findGroupVertex(e),a=this.findGroupVertex(o);this.linkVertexes(r,a,t)}}findGroupVertex(t){const e=t.findVisibleNode();if(null===e)return null;let i=this.findVertex(e);if(null!==i)return i;let s=e.containingGroup;for(;null!==s;){if(i=this.findVertex(s),null!==i)return i;s=s.containingGroup}return null}addVertex(t){this.ao.add(t);const e=t.node;null!==e&&this.by.set(e,t),t.network=this}addNode(t){let e=this.findVertex(t);return null===e&&(e=this.createVertex(),e.node=t,this.addVertex(e)),e}deleteVertex(t){if(this.TT(t)){let e=t.Ho;for(let t=e.count-1;t>=0;t--){const i=e.elt(t);this.deleteEdge(i)}e=t.jo;for(let t=e.count-1;t>=0;t--){const i=e.elt(t);this.deleteEdge(i)}}}TT(t){const e=this.ao.delete(t);if(e){const e=t.node;null!==e&&this.by.delete(e)}return e}deleteNode(t){const e=this.findVertex(t);null!==e&&this.deleteVertex(e)}findVertex(t){return this.by.get(t)}addEdge(t){this.kN(t);const e=t.toVertex;null!==e&&e.addSourceEdge(t);const i=t.fromVertex;null!==i&&i.addDestinationEdge(t)}kN(t){this.bn.add(t);const e=t.link;null!==e&&null===this.findEdge(e)&&this.ky.set(e,t),t.network=this}addLink(t){const e=t.fromNode,i=t.toNode;let s=this.findEdge(t);return null===s?(s=this.createEdge(),s.link=t,null!==e&&(s.fromVertex=this.addNode(e)),null!==i&&(s.toVertex=this.addNode(i)),this.addEdge(s)):(s.fromVertex=null!==e?this.addNode(e):null,s.toVertex=null!==i?this.addNode(i):null),s}deleteEdge(t){const e=t.toVertex;null!==e&&e.deleteSourceEdge(t);const i=t.fromVertex;null!==i&&i.deleteDestinationEdge(t),this.PN(t)}PN(t){const e=this.bn.delete(t);if(e){const e=t.link;null!==e&&this.ky.delete(e)}return e}deleteLink(t){const e=this.findEdge(t);null!==e&&this.deleteEdge(e)}findEdge(t){return this.ky.get(t)}linkVertexes(t,e,i){if(null===t||null===e)return null;if(t.network===this&&e.network===this){const s=this.createEdge();return s.link=i,s.fromVertex=t,s.toVertex=e,this.addEdge(s),s}return null}reverseEdge(t){const e=t.fromVertex,i=t.toVertex;null===e||null===i||(e.deleteDestinationEdge(t),i.deleteSourceEdge(t),t.reverseEdge(),e.addSourceEdge(t),i.addDestinationEdge(t))}deleteSelfEdges(){const t=e.et(),i=this.bn.iterator;for(;i.next();){const e=i.value;e.fromVertex===e.toVertex&&t.push(e)}const s=t.length;for(let e=0;e<s;e++)this.deleteEdge(t[e]);e.J(t)}deleteArtificialVertexes(){const t=e.et(),i=this.ao.iterator;for(;i.next();){const e=i.value;null===e.node&&null===e.data&&t.push(e)}let s=t.length;for(let e=0;e<s;e++)this.deleteVertex(t[e]);const n=e.et(),o=this.bn.iterator;for(;o.next();){const t=o.value;null===t.link&&null===t.data&&n.push(t)}s=n.length;for(let e=0;e<s;e++)this.deleteEdge(n[e]);e.J(t),e.J(n)}deleteUselessEdges(){const t=e.et(),i=this.bn.iterator;for(;i.next();){const e=i.value;(null===e.fromVertex||null===e.toVertex)&&t.push(e)}const s=t.length;for(let e=0;e<s;e++)this.deleteEdge(t[e]);e.J(t)}isSingleton(t){return!(t.Ho.count>0||t.jo.count>0)}splitIntoSubNetworks(t){void 0===t&&(t=!0),t&&(this.deleteArtificialVertexes(),this.deleteUselessEdges(),this.deleteSelfEdges());const e=new h;let i=!0;for(;i;){i=!1;const t=this.ao.iterator;for(;t.next();){const s=t.value;if(this.isSingleton(s))continue;const n=this.layout.createNetwork();e.add(n),this.VO(n,s),i=!0;break}}return e.sort(((t,e)=>null===t||null===e||t===e?0:e.vertexes.count-t.vertexes.count)),e}VO(t,e){if(null===e)return;const i=new h;for(i.add(e);i.count>0;){const e=i.first();if(i.removeAt(0),!e||e.network===t)continue;this.TT(e),t.addVertex(e);let s=e.sourceEdges;for(;s.next();){const e=s.value;e.network!==t&&(this.PN(e),t.kN(e),e.fromVertex&&i.add(e.fromVertex))}for(s=e.destinationEdges;s.next();){const e=s.value;e.network!==t&&(this.PN(e),t.kN(e),e.toVertex&&i.add(e.toVertex))}}}findAllParts(){const t=new u,e=this.ao.iterator;for(;e.next();){const i=e.value;i.node&&t.add(i.node)}const i=this.bn.iterator;for(;i.next();){const e=i.value;e.link&&t.add(e.link)}return t}}class $e{ho;_t;Me;Le;He;Ho;jo;constructor(t){u.Gi(this),this.ho=t,this.Le=new x(0,0,10,10).u(),this.He=new y(5,5).u(),this._t=null,this.Me=null,this.Ho=new h,this.jo=new h}clear(){this._t=null,this.Me=null,this.Ho=new h,this.jo=new h}toString(t){void 0===t&&(t=0);let e="LayoutVertex#"+u.as(this);if(t>0&&(e+=null!==this.node?"("+this.node.toString()+")":"",t>1)){let t="",i=!0,s=this.Ho.iterator;for(;s.next();){const e=s.value;i?i=!1:t+=",",t+=e.toString(0)}let n="";for(i=!0,s=this.jo.iterator;s.next();){const t=s.value;i?i=!1:n+=",",n+=t.toString(0)}e+=" sources: "+t+" destinations: "+n}return e}get co(){return this.Ho.uC}get qo(){return this.jo.uC}get data(){return this._t}set data(t){if(this._t=t,null!==t&&t.bounds){const e=t.bounds,i=e.x,s=e.y,n=e.width,o=e.height;this.He.i(n/2,o/2),this.Le.i(i,s,n,o)}}get node(){return this.Me}set node(t){if(this.Me!==t){if(this.Me=t,null===t)return;t.ensureBounds();const e=this.network.layout,i=x.l(),s=e.getLayoutBounds(t,i);let n=s.x,o=s.y;const r=s.width,a=s.height;if(isNaN(n)&&(n=0),isNaN(o)&&(o=0),this.Le.i(n,o,r,a),x.e(i),!(t instanceof _e)){const e=t.locationObject.getDocumentPoint(w.Center);if(e.isReal())return void this.He.i(e.x-n,e.y-o)}this.He.i(r/2,a/2)}}get bounds(){return this.Le}set bounds(t){this.Le.equals(t)||this.Le.a(t)}get focus(){return this.He}set focus(t){this.He.equals(t)||this.He.a(t)}get centerX(){return this.Le.x+this.He.x}set centerX(t){const e=this.Le;e.x+this.He.x!==t&&(e.Nt(),e.x=t-this.He.x,e.u())}get centerY(){return this.Le.y+this.He.y}set centerY(t){const e=this.Le;e.y+this.He.y!==t&&(e.Nt(),e.y=t-this.He.y,e.u())}get focusX(){return this.He.x}set focusX(t){const e=this.He;e.x!==t&&(e.Nt(),e.x=t,e.u())}get focusY(){return this.He.y}set focusY(t){const e=this.He;e.y!==t&&(e.Nt(),e.y=t,e.u())}get x(){return this.Le.x}set x(t){const e=this.Le;e.x!==t&&(e.Nt(),e.x=t,e.u())}get y(){return this.Le.y}set y(t){const e=this.Le;e.y!==t&&(e.Nt(),e.y=t,e.u())}get width(){return this.Le.width}set width(t){const e=this.Le;e.width!==t&&(e.Nt(),e.width=t,e.u())}get height(){return this.Le.height}set height(t){const e=this.Le;e.height!==t&&(e.Nt(),e.height=t,e.u())}commit(){const t=this._t;if(null!==t){const i=this.bounds,s=t.bounds;return void(e.K(s)?(s.x=i.x,s.y=i.y,s.width=i.width,s.height=i.height):t.bounds=i.copy())}const i=this.node;if(null!==i){const t=this.bounds;if(!(i instanceof _e)){const e=x.l();i.ensureBounds();const s=this.network.layout.getLayoutBounds(i,e),n=i.locationObject.getDocumentPoint(w.Center);if(s.isReal()&&n.isReal())return i.moveTo(t.x+this.focusX-(n.x-s.x)+i.margin.left,t.y+this.focusY-(n.y-s.y+i.margin.top)),void x.e(e);x.e(e)}i.moveTo(t.x+i.margin.left,t.y+i.margin.top)}}addSourceEdge(t){null!==t&&(this.Ho.has(t)||this.Ho.add(t))}deleteSourceEdge(t){null!==t&&this.Ho.delete(t)}addDestinationEdge(t){null!==t&&(this.jo.has(t)||this.jo.add(t))}deleteDestinationEdge(t){null!==t&&this.jo.delete(t)}get network(){return this.ho}set network(t){this.ho=t}get sourceVertexes(){const t=new u,e=this.sourceEdges;for(;e.next();){const i=e.value;i.fromVertex&&t.add(i.fromVertex)}return t.iterator}get destinationVertexes(){const t=new u,e=this.destinationEdges;for(;e.next();){const i=e.value;i.toVertex&&t.add(i.toVertex)}return t.iterator}get vertexes(){const t=new u;let e=this.sourceEdges;for(;e.next();){const i=e.value;i.fromVertex&&t.add(i.fromVertex)}for(e=this.destinationEdges;e.next();){const i=e.value;i.toVertex&&t.add(i.toVertex)}return t.iterator}get sourceEdges(){return this.Ho.iterator}get destinationEdges(){return this.jo.iterator}get edges(){const t=new h;let e=this.sourceEdges;for(;e.next();){const i=e.value;t.add(i)}for(e=this.destinationEdges;e.next();){const i=e.value;t.add(i)}return t.iterator}get edgesCount(){return this.Ho.count+this.jo.count}static standardComparer(t,e){const i=t.Me,s=e.Me;if(i){if(s){const t=i.text,e=s.text;return t<e?-1:t>e?1:0}return 1}return null!==s?-1:0}static smartComparer(t,e){if(null!==t){if(null!==e){const i=t.Me,s=e.Me;if(null!==i){if(null!==s){const t=i.text.toLocaleLowerCase(),e=s.text.toLocaleLowerCase(),n=t.split(/([+-]?[.]?\d+(?:\.\d*)?(?:e[+-]?\d+)?)/),o=e.split(/([+-]?[.]?\d+(?:\.\d*)?(?:e[+-]?\d+)?)/);let r=0;for(;r<n.length;r++){if(""!==o[r]&&void 0!==o[r]){const t=parseFloat(n[r]),e=parseFloat(o[r]);if(isNaN(t)){if(isNaN(e)){if(0!==n[r].localeCompare(o[r]))return n[r].localeCompare(o[r]);continue}return 1}if(isNaN(e))return-1;if(t-e!==0)return t-e;continue}if(""===n[r])continue;return 1}return""!==o[r]&&void 0!==o[r]?-1:0}return 1}return null!==s?-1:0}return 1}return null!==e?-1:0}}class Xe{ho;_t;Ge;je;qe;constructor(t){u.Gi(this),this.ho=t,this._t=null,this.Ge=null,this.je=null,this.qe=null}clear(){this._t=null,this.Ge=null,this.je=null,this.qe=null}toString(t){void 0===t&&(t=0);let e="LayoutEdge#"+u.as(this);return t>0&&(e+=null!==this.Ge?"("+this.Ge.toString()+")":"",t>1&&(e+=" "+(this.je?this.je.toString():"null")+" --\x3e "+(this.qe?this.qe.toString():"null"))),e}reverseEdge(){const t=this.je;this.je=this.qe,this.qe=t}commit(){}getOtherVertex(t){return this.qe===t?this.je:this.je===t?this.qe:null}get network(){return this.ho}set network(t){this.ho=t}get data(){return this._t}set data(t){this._t!==t&&(this._t=t)}get link(){return this.Ge}set link(t){this.Ge!==t&&(this.Ge=t)}get fromVertex(){return this.je}set fromVertex(t){this.je!==t&&(this.je=t)}get toVertex(){return this.qe}set toVertex(t){this.qe!==t&&(this.qe=t)}}var Ge=(t=>(t[t.Position=0]="Position",t[t.Location=1]="Location",t))(Ge||{}),Ye=(t=>(t[t.LeftToRight=10]="LeftToRight",t[t.RightToLeft=11]="RightToLeft",t))(Ye||{}),Ke=(t=>(t[t.Forwards=20]="Forwards",t[t.Reverse=21]="Reverse",t[t.Ascending=22]="Ascending",t[t.Descending=23]="Descending",t))(Ke||{});class Ue extends ze{Kd;Gd;ko;kn;hi;Xi;pe;ye;constructor(t){super(),this.isViewportSized=!0,this.Kd=NaN,this.Gd=NaN,this.ko=new v(NaN,NaN).u(),this.kn=new v(10,10).u(),this.hi=1,this.Xi=10,this.pe=22,this.ye=Ue.standardComparer,t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.Kd=this.Kd,t.Gd=this.Gd,t.ko.a(this.ko),t.kn.a(this.kn),t.hi=this.hi,t.Xi=this.Xi,t.pe=this.pe,t.ye=this.ye}oi(t){t in Ke?this.sorting=t:t in Ye?this.arrangement=t:t in Ge?this.alignment=t:super.oi(t)}doLayout(t){this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin);const e=this.collectParts(t),i=this.diagram,s=e.copy().iterator;for(;s.next();){const t=s.value;if(!t.Nl()||null===t.fromNode&&null===t.toNode){if(t.ensureBounds(),t instanceof _e){const i=t.memberParts;for(;i.next();){const t=i.value;e.delete(t)}}}else e.delete(t)}const n=e.toArray();if(0===n.length)return;switch(this.sorting){case 20:break;case 21:n.reverse();break;case 22:n.sort(this.comparer);break;case 23:n.sort(this.comparer),n.reverse();break}let o=this.wrappingColumn;isNaN(o)&&(o=0);let r=this.wrappingWidth;if(isNaN(r)&&null!==i){const t=i.viewportBounds,e=i.padding;r=Math.max(t.width-e.left-e.right,0)}else r=Math.max(this.wrappingWidth,0);o<=0&&r<=0&&(o=1);let a=this.spacing.width;isFinite(a)||(a=0);let h=this.spacing.height;isFinite(h)||(h=0),null!==i&&i.startTransaction("Layout");const l=[];switch(this.alignment){case 0:this.zO(n,r,o,a,h,l);break;case 1:this.XO(n,r,o,a,h,l);break}let u=0,c=0,d=0;for(let f=0;f<l.length;f++){const t=l[f];u=Math.min(u,t.x),c=Math.min(c,t.y),d=Math.max(d,t.x+t.width)}11===this.arrangement?this.commitLayers(l,new y(u+a/2-(d+u),c-h/2)):this.commitLayers(l,new y(u-a/2,c-h/2)),null!==i&&i.commitTransaction("Layout"),this.isValidLayout=!0}zO(t,e,i,s,n,o){const r=x.l();let a=Math.max(this.cellSize.width,1);if(!isFinite(a)){a=0;for(let e=0;e<t.length;e++){const i=t[e],s=this.getLayoutBounds(i,r);a=Math.max(a,s.width)}}a+=s,a=Math.max(a,1);let h=Math.max(this.cellSize.height,1);if(!isFinite(h)){h=0;for(let e=0;e<t.length;e++){const i=t[e],s=this.getLayoutBounds(i,r);h=Math.max(h,s.height)}}h+=n,h=Math.max(h,1);const l=this.arrangement,u=this.arrangementOrigin.x,c=this.arrangementOrigin.y;let d=u,f=c,g=0,p=0;for(let m=0;m<t.length;m++){const c=t[m],y=this.getLayoutBounds(c,r),v=Math.ceil((y.width+s)/a),b=Math.ceil((y.height+n)/h),w=v*a,k=b*h;let S=0;switch(l){case 11:S=Math.abs(d-y.width);break;default:S=d+y.width;break}(i>0&&g>i-1||e>0&&g>0&&S-u>e)&&(o.push(new x(0,f,e+s,p)),g=0,d=u,f+=p,p=0),p=Math.max(p,k);let P=0;switch(l){case 11:P=-y.width;break;default:P=0;break}switch(c.moveTo(d+P+c.margin.left,f+c.margin.top),l){case 11:d-=w;break;default:d+=w;break}g++}o.push(new x(0,f,e+s,p)),x.e(r)}XO(t,e,i,s,n,o){const r=x.l();let a=Math.max(this.cellSize.width,1),h=0,l=0,u=0;const c=y.l();for(let y=0;y<t.length;y++){const e=t[y],i=this.getLayoutBounds(e,r),s=e.getRelativePoint(e.locationObject,e.locationSpot,c);h=Math.max(h,s.x),l=Math.max(l,i.width-s.x),u=Math.max(u,s.y)}const d=this.arrangement;switch(d){case 11:h+=s;break;default:l+=s;break}a=isFinite(a)?Math.max(a+s,1):Math.max(h+l,1);const f=this.arrangementOrigin.x,g=this.arrangementOrigin.y;let p=f,m=g,v=0;e>=h&&(e-=h);let b=0,w=0;const k=Math.max(this.cellSize.height,1);u=0;let P=0,M=!0;const C=y.l();for(let y=0;y<t.length;y++){const h=t[y],l=this.getLayoutBounds(h,r),g=h.getRelativePoint(h.locationObject,h.locationSpot,c);if(v>0)switch(d){case 11:{let t=(p-f-(l.width-g.x))/a;t=S.z(Math.round(t),t)?Math.round(t):Math.floor(t),p=t*a+f;break}default:{let t=(p-f+g.x)/a;t=S.z(Math.round(t),t)?Math.round(t):Math.ceil(t),p=t*a+f;break}}else switch(d){case 11:b=p+g.x+l.width;break;default:b=p-g.x;break}let A=0;switch(d){case 11:A=-(p+g.x)+b;break;default:A=p+l.width-g.x-b;break}if(i>0&&v>i-1||e>0&&v>0&&A>e){o.push(new x(0,M?m-u:m,e+s,P+u+n));for(let e=0;e<v&&y!==v;e++){const i=t[y-v+e],s=i.getRelativePoint(i.locationObject,i.locationSpot,C);i.moveTo(i.position.x,i.position.y+u-s.y)}P+=n,m+=M?P:P+u,u=0,P=0,v=0,p=f,M=!1}switch(p===f&&(w=11===d?Math.max(w,l.width-g.x):Math.min(w,-g.x)),u=Math.max(u,g.y),P=Math.max(P,l.height-g.y),isFinite(k)&&(P=Math.max(P,Math.max(l.height,k)-g.y)),M?h.moveTo(p-g.x,m-g.y):h.moveTo(p-g.x,m),d){case 11:p-=g.x+s;break;default:p+=l.width-g.x+s;break}v++}if(o.push(new x(0,m,e+s,(M?P:P+u)+n)),t.length!==v)for(let y=0;y<v;y++){const e=t[t.length-v+y],i=e.getRelativePoint(e.locationObject,e.locationSpot,c);e.moveTo(e.position.x,e.position.y+u-i.y)}if(y.e(c),y.e(C),11===d)for(let y=0;y<o.length;y++){const t=o[y];t.width+=w,t.x-=w}else for(let y=0;y<o.length;y++){const t=o[y];t.x>w&&(t.width+=t.x-w,t.x=w)}x.e(r)}commitLayers(t,e){}get wrappingWidth(){return this.Kd}set wrappingWidth(t){this.Kd!==t&&(e.s(t,"number",Ue,"wrappingWidth"),(t>0||isNaN(t))&&(this.Kd=t,this.isViewportSized=isNaN(t),this.invalidateLayout()))}get wrappingColumn(){return this.Gd}set wrappingColumn(t){this.Gd!==t&&(e.s(t,"number",Ue,"wrappingColumn"),(t>0||isNaN(t))&&(this.Gd=t,this.invalidateLayout()))}get cellSize(){return this.ko}set cellSize(t){this.ko.equals(t)||(this.ko.a(t),this.invalidateLayout())}get spacing(){return this.kn}set spacing(t){this.kn.equals(t)||(this.kn.a(t),this.invalidateLayout())}get alignment(){return this.hi}set alignment(t){this.hi!==t&&(1===t||0===t)&&(this.hi=t,this.invalidateLayout())}get arrangement(){return this.Xi}set arrangement(t){this.Xi!==t&&(10===t||11===t)&&(this.Xi=t,this.invalidateLayout())}get sorting(){return this.pe}set sorting(t){this.pe!==t&&(20===t||21===t||22===t||23===t)&&(this.pe=t,this.invalidateLayout())}get comparer(){return this.ye}set comparer(t){this.ye!==t&&(e.k(t,Ue,"comparer"),this.ye=t,this.invalidateLayout())}static standardComparer(t,e){const i=t.text,s=e.text;return i<s?-1:i>s?1:0}static smartComparer(t,e){if(null!==t){if(null!==e){const i=t.text.toLocaleLowerCase(),s=e.text.toLocaleLowerCase(),n=i.split(/([+-]?[.]?\d+(?:\.\d*)?(?:e[+-]?\d+)?)/),o=s.split(/([+-]?[.]?\d+(?:\.\d*)?(?:e[+-]?\d+)?)/);let r=0;for(;r<n.length;r++){if(""!==o[r]&&void 0!==o[r]){const t=parseFloat(n[r]),e=parseFloat(o[r]);if(isNaN(t)){if(isNaN(e)){if(0!==n[r].localeCompare(o[r]))return n[r].localeCompare(o[r]);continue}return 1}if(isNaN(e))return-1;if(t-e!==0)return t-e;continue}if(""===n[r])continue;return 1}return""!==o[r]&&void 0!==o[r]?-1:0}return 1}return null!==e?-1:0}static Position=0;static Location=1;static LeftToRight=10;static RightToLeft=11;static Forward=20;static Reverse=21;static Ascending=22;static Descending=23}class He{Hd;js;Ct;fo;jd;qd;N;SN;constructor(){this.Hd=new u,this.js=new u,this.Ct=new u,this.fo=new m,this.jd=new m,this.qd=new m,this.N=null,this.SN=!1}clear(){this.Hd.clear(),this.js.clear(),this.Ct.clear(),this.fo.clear(),this.jd.clear(),this.qd.clear()}So(t){this.N=t}Wh(t){if(t instanceof Ce){if(this.Hd.add(t),t instanceof _e){const e=t.containingGroup;null===e?this.diagram.Vr.add(t):e.aa.add(t);const i=t.layout;null!==i&&(i.diagram=this.diagram)}}else t instanceof De?(this.js.add(t),t.isAvoiding&&(this.diagram.Vm=!0)):t instanceof Pe||this.Ct.add(t);const e=t.data;null!==e&&(t instanceof Pe||(t instanceof De?this.DT(e,t):this.fo.set(e,t)))}te(t){if(t.clearAdornments(),t instanceof Ce){if(this.Hd.delete(t),t instanceof _e){const e=t.containingGroup;null===e?this.diagram.Vr.delete(t):e.aa.delete(t);const i=t.layout;null!==i&&(i.diagram=null)}}else t instanceof De?this.js.delete(t):t instanceof Pe||this.Ct.delete(t);const e=t.data;null!==e&&(t instanceof Pe||(t instanceof De?this.FT(e,t):this.fo.delete(e)))}DT(t,e){this.jd.set(t,e)}FT(t,e){this.jd.delete(t)}rebuildParts(){const t=this.diagram;if(null===t)return;const i=t.nodeTemplateMap.iterator;for(;i.next();){const t=i.value,s=i.key;(!t.ke()||t instanceof _e)&&e.o(`Invalid node template in Diagram.nodeTemplateMap: template for "${s}" must be a Node or a simple Part, not a Group or Link: ${t}`)}const s=t.groupTemplateMap.iterator;for(;s.next();){const t=s.value,i=s.key;t instanceof _e||e.o(`Invalid group template in Diagram.groupTemplateMap: template for "${i}" must be a Group, not a normal Node or Link: ${t}`)}const n=t.linkTemplateMap.iterator;for(;n.next();){const t=n.value,i=n.key;t instanceof De||e.o(`Invalid link template in Diagram.linkTemplateMap: template for "${i}" must be a Link, not a normal Node or simple Part: ${t}`)}const o=e.et(),r=t.selection.iterator;for(;r.next();){const t=r.value.data;t&&o.push(t)}const a=e.et(),h=t.highlighteds.iterator;for(;h.next();){const t=h.value.data;t&&a.push(t)}const l=e.et(),u=this.nodes.iterator;for(;u.next();){const t=u.value;null!==t.data&&(l.push(t.data),l.push(t.location))}const c=this.links.iterator;for(;c.next();){const t=c.value;null!==t.data&&(l.push(t.data),l.push(t.location))}const d=this.parts.iterator;for(;d.next();){const t=d.value;null!==t.data&&(l.push(t.data),l.push(t.location))}this.RT(),this.VM();for(let e=0;e<o.length;e++){const t=this.findPartForData(o[e]);null!==t&&(t.isSelected=!0)}for(let e=0;e<a.length;e++){const t=this.findPartForData(a[e]);null!==t&&(t.isHighlighted=!0)}for(let e=0;e<l.length;e+=2){const t=this.findPartForData(l[e]);null!==t&&(t.location=l[e+1])}e.J(o),e.J(a),e.J(l)}VM(){const t=this.diagram.model;this.Py(t.nodeDataArray)}Py(t,e){const i=this.diagram.model;t.forEach((t=>{i.containsNodeData(t)&&this.vT(t,!1)})),t.forEach((t=>{i.containsNodeData(t)&&this.F1(t)})),!1!==e&&this.diagram.Nb(!1)}vT(t,e){if(null==t||this.diagram.undoManager.isUndoingRedoing||this.fo.has(t))return null;void 0===e&&(e=!0);const i=this.YO(t);return null!==i&&e&&this.F1(t),i}YO(t){if(null==t||this.diagram.undoManager.isUndoingRedoing||this.fo.has(t))return null;const e=this.KO(t),i=this.findTemplateForNodeData(t,e);if(null!==i){i.Et();const s=i.copy();if(null!==s){const i=this.diagram.fe;return this.diagram.fe=!0,s.Vo=e,s._t=t,this.addsToTemporaryLayer&&(s.sl="Tool"),this.diagram.add(s),s._t=null,s.data=t,this.diagram.fe=i,s}}return null}insertLink(t,e,i,s){return null}F1(t){}KO(t){return this.diagram.model.getCategoryForNodeData(t)}static OT=!1;static IT=!1;findTemplateForNodeData(t,i){const s=this.diagram,n=s.model,o=n.jc()&&n.isGroupForData(t);let r=null;return o?(r=s.groupTemplateMap.get(i),null===r&&(r=s.groupTemplateMap.get(""),null===r&&(He.IT||(He.IT=!0,e.ni('No Group template found for category "'+i+'"'),e.ni("  Using default group template")),r=s.pM))):(r=s.nodeTemplateMap.get(i),null===r&&(r=s.nodeTemplateMap.get(""),null===r&&(He.OT||(He.OT=!0,e.ni('No Node template found for category "'+i+'"'),e.ni("  Using default node template")),r=s.dM))),r}getLinkCategoryForData(t){return""}setLinkCategoryForData(t,e){}setFromNodeForLink(t,e,i){}setToNodeForLink(t,e,i){}static ET=!1;findLinkTemplateForCategory(t){const i=this.diagram;let s=i.linkTemplateMap.get(t);return null===s&&(s=i.linkTemplateMap.get(""),null===s&&(He.ET||(He.ET=!0,e.ni('No Link template found for category "'+t+'"'),e.ni("  Using default link template")),s=i.gM)),s}Rv(t,e,i){t instanceof De?(null!==e&&this.FT(e,t),null!==i&&this.DT(i,t)):t instanceof ke&&(null!==e&&this.fo.delete(e),null!==i&&this.fo.set(i,t))}RT(){const t=this.diagram.model;this.MN(t.nodeDataArray)}MN(t){t.forEach((t=>{this.R1(t)}))}R1(t){const e=this.findPartForData(t);null!==e&&(this.diagram.EM(e,!1),this.NN(e))}NN(t){}mN(t){}findPartForKey(t){if(null==t)return null;const e=this.diagram.model.findNodeDataForKey(t);return null!==e?this.fo.get(e):null}findNodeForKey(t){if(null==t)return null;const e=this.diagram.model.findNodeDataForKey(t);if(null===e)return null;const i=this.fo.get(e);return i instanceof Ce?i:null}findLinkForKey(t){return null}findPartForData(t){if(null===t)return null;let e=this.fo.get(t);return null!==e||(e=this.jd.get(t)),e}findNodeForData(t){if(null===t)return null;const e=this.fo.get(t);return e instanceof Ce?e:null}findLinkForData(t,e){return null===t?null:this.jd.get(t)}findNodesByExample(...t){const i=new u,s=this.Hd.iterator;for(;s.next();){const t=s.value,n=t.data;if(null!==n)for(let s=0;s<arguments.length;s++){const o=arguments[s];if(e.K(o)&&this.CN(n,o)){i.add(t);break}}}return i.iterator}findLinksByExample(...t){const i=new u,s=this.js.iterator;for(;s.next();){const t=s.value,n=t.data;if(null!==n)for(let s=0;s<arguments.length;s++){const o=arguments[s];if(e.K(o)&&this.CN(n,o)){i.add(t);break}}}return i.iterator}CN(t,e){for(const i in e){const s=t[i],n=e[i];if(Array.isArray(n)){if(!Array.isArray(s))return!1;const t=s,e=n;if(t.length<e.length)return!1;for(let i=0;i<t.length;i++){const s=t[i],n=e[i];if(void 0!==n&&!this.BT(s,n))return!1}}else if(!this.BT(s,n))return!1}return!0}BT(t,i){if(e.it(i)){if(!i(t))return!1}else if(i instanceof RegExp){if(!t||!i.test(t.toString()))return!1}else if(e.K(t)&&e.K(i)){if(!this.CN(t,i))return!1}else if(t!==i)return!1;return!0}doModelDataChanged(t){if(t.model===this.diagram.model&&this.diagram.X){this.diagram.X=!1;try{const e=t.change;""===t.modelChange&&null!==t.object&&2===e&&this.Sy(t.object,t.propertyName)}finally{this.diagram.X=!0}}}doModelChanged(t){const i=this.diagram;if(!i||t.model!==i.model)return;const s=t.change;if(i.OR(t),i.X){i.X=!1;try{const n=t.modelChange;if(""!==n)if(2===s){if("nodeCategory"===n){const e=t.object;if(null!==e){const i=this.findPartForData(e),s=t.newValue;null!==i&&"string"==typeof s&&(i.category=s)}}else if("nodeDataArray"===n){const e=t.oldValue;this.MN(e);const i=t.newValue;this.Py(i)}i.isModified=!0}else if(3===s){const s=t.newValue;"nodeDataArray"===n&&e.K(s)&&this.vT(s),i.isModified=!0}else if(4===s){const s=t.oldValue;"nodeDataArray"===n&&e.K(s)&&this.R1(s),i.isModified=!0}else 1===s&&("SourceChanged"===n?null!==t.object?this.Sy(t.object,t.propertyName):(this.updateAllRelationshipsFromData(),this.updateAllTargetBindings()):"ModelDisplaced"===n&&this.rebuildParts());else if(2===s){const e=t.propertyName,s=t.object,n=i.model;s===n?("nodeKeyProperty"===e||"nodeCategoryProperty"===e)&&(i.undoManager.isUndoingRedoing||this.rebuildParts()):null!==s&&this.Sy(s,e),i.isModified=!0}else(3===s||4===s)&&(this.GO(t,i.model),i.isModified=!0)}finally{i.X=!0}}}updateAllTargetBindings(t){void 0===t&&(t="");let e=this.parts.iterator;for(;e.next();)e.value.updateTargetBindings(t);for(e=this.nodes.iterator;e.next();)e.value.updateTargetBindings(t);for(e=this.links.iterator;e.next();)e.value.updateTargetBindings(t)}updateAllThemeBindings(){let t=this.parts.iterator;for(;t.next();)t.value.To();for(t=this.nodes.iterator;t.next();)t.value.To();for(t=this.links.iterator;t.next();)t.value.To()}updateAllRelationshipsFromData(){const t=this.diagram.model,e=new u,i=t.nodeDataArray;for(let o=0;o<i.length;o++){const t=i[o];e.add(t)}const s=[];this.nodes.each((t=>{null!==t.data&&!e.has(t.data)&&s.push(t.data)})),this.parts.each((t=>{null!==t.data&&!e.has(t.data)&&s.push(t.data)})),s.forEach((e=>t.UT(e,!1)));for(let o=0;o<i.length;o++){const e=i[o];null===this.findPartForData(e)&&t.VT(e,!1)}this.zT();let n=this.parts.iterator;for(;n.next();)n.value.updateRelationshipsFromData();for(n=this.nodes.iterator;n.next();)n.value.updateRelationshipsFromData();for(n=this.links.iterator;n.next();)n.value.updateRelationshipsFromData()}zT(){}updateRelationshipsFromData(t){}Sy(t,i){if("string"==typeof i){const s=this.findPartForData(t);if(null!==s)s.updateTargetBindings(i);else{const s=this.HO(t);if(null!==s&&s.length>0){for(let e=0;e<s.length;e++)s[e].updateTargetBindings(i);const t=s[0].part;if(null!==t){const e=t.adornments;for(;e.next();)e.value.updateTargetBindings(i)}e.J(s)}}t===this.diagram.model.modelData&&this.updateAllTargetBindings(i)}}HO(t){let i=null;const s=this.qd.iterator;for(;s.next();){const n=s.value;for(let s=0;s<n.length;s++){const o=n[s].findItemPanelForData(t);null!==o&&(null===i&&(i=e.et()),i.push(o))}if(null!==i)break}return i}LN(t){return this.qd.get(t)}GO(t,e){const i=t.object;if(!Array.isArray(i))return;const s=3===t.change,n=s?t.newParam:t.oldParam,o=s?t.newValue:t.oldValue,r=this.LN(i);if(Array.isArray(r))for(let a=0;a<r.length;a++){const t=r[a];s?t.i1(o,n,!0):t.Ov(n)}}OM(t,e){null!==e&&t.Yr((t=>e.KL(t)));const i=t.yh;if(Array.isArray(i)){const e=this.LN(i);if(null===e)this.qd.set(i,[t]);else{for(let i=0;i<e.length;i++)if(e[i]===t)return;e.push(t)}}}IM(t,e){t.Yr((t=>e.ER(t)));const i=t.yh;if(Array.isArray(i)){const e=this.LN(i);if(null!==e)for(let s=0;s<e.length;s++)if(e[s]===t)return e.splice(s,1),void(0===e.length&&this.qd.delete(i))}}copyParts(t,e,i){void 0===i&&(i=!1);const s=new m;if(Array.isArray(t))for(let o=0;o<t.length;o++)this.v1(t[o],e,s,i);else{const n=t.iterator;for(;n.next();)this.v1(n.value,e,s,i)}if(null!==e){const t=e.model,i=e.s0().dragsLink,n=new u,o=new m,r=s.iterator;for(;r.next();){const a=r.value;if(a instanceof De)!i&&(null===a.fromNode||null===a.toNode)&&n.add(a);else if(a instanceof Ce&&null!==a.data)if(t.pm()){const i=a,n=r.key,h=n.findTreeParentNode();if(null!==h){const r=s.get(h);if(null!==r){t.setParentKeyForNodeData(i.data,t.getKeyForNodeData(r.data));const s=e.findLinkForData(i.data),a=n.findTreeParentLink();null!==a&&null!==s&&o.set(a,s)}}}else if(t.Sb()){const i=a,n=r.key,h=t.isRelatedKeysPathTo?n.findNodesOutOf():n.findNodesInto();for(;h.next();){const r=h.value,a=s.get(r);if(null!==a){t.addRelatedKeyForNodeData(i.data,a.key);const s=e.partManager.findLinkForData(i.data,a.key),h=this.findLinkForData(n.data,r.key);null!==h&&null!==s&&o.set(h,s)}else t.removeRelatedKeyForNodeData(i.data,r.key)}}}if(n.count>0&&e.removeParts(n,!1),o.count>0){const t=o.iterator;for(;t.next();){const e=t.key,i=t.value;s.set(e,i)}}}if(null!==e&&null!==this.diagram){const t=e.model,i=t.afterCopyFunction;if(null!==i){const e=new m;s.each((t=>{null!==t.key.data&&e.set(t.key.data,t.value.data)}));const n=this.diagram.model;i(e,t,n)}}const n=s.iterator;for(;n.next();)n.value.updateTargetBindings();return s}v1(t,e,i,s){if(null===t||s&&!t.canCopy())return null;if(i.has(t))return i.get(t);const n=this.AN(t,e);if(!(n instanceof ke))return null;if(n.isSelected=!1,n.isHighlighted=!1,i.set(t,n),t instanceof Ce){const o=t.linksConnected;for(;o.next();){const e=o.value;if(e.fromNode===t){const t=i.get(e);null!==t&&(t.fromNode=n)}if(e.toNode===t){const t=i.get(e);null!==t&&(t.toNode=n)}}if(t instanceof _e&&n instanceof _e){const o=t.memberParts;for(;o.next();){const t=o.value,r=this.v1(t,e,i,s);r instanceof De||null!==r&&(r.containingGroup=n)}}}else if(t instanceof De&&n instanceof De){const o=t.fromNode;if(null!==o){const t=i.get(o);null!==t&&(n.fromNode=t)}const r=t.toNode;if(null!==r){const t=i.get(r);null!==t&&(n.toNode=t)}const a=t.labelNodes;for(;a.next();){const t=a.value,o=this.v1(t,e,i,s);null!==o&&o instanceof Ce&&(o.labeledLink=n)}}return n}AN(t,i){let s=null;const n=t.data;if(null!==n&&null!==i){const o=i.model;if(!(t instanceof De)){const t=o.copyNodeData(n);e.K(t)&&(o.addNodeData(t),s=i.findPartForData(t))}}else if(t.Et(),s=t.copy(),null!==s){const t=this.diagram;if(null!==i)i.add(s);else if(null!==n&&null!==t&&null!==t.commandHandler&&t.commandHandler.copiesClipboardData){const i=t.model;let o=null;s instanceof De||(o=i.copyNodeData(n)),e.K(o)&&(s.data=o)}}return s}get nodes(){return this.Hd}get links(){return this.js}get parts(){return this.Ct}get diagram(){return this.N}get addsToTemporaryLayer(){return this.SN}set addsToTemporaryLayer(t){this.SN=t}}class qe extends He{VM(){const t=this.diagram.model;this.Py(t.nodeDataArray),this.XT(t.linkDataArray)}Py(t){super.Py(t,!1);const e=this.links.iterator;for(;e.next();)e.value.Pd();this.diagram.Nb(!1)}XT(t){t.forEach((t=>{this.YT(t)})),this.diagram.Nb(!1)}YT(t){if(null==t||this.diagram.undoManager.isUndoingRedoing||this.findLinkForData(t))return null;const e=this.getLinkCategoryForData(t),i=this.findLinkTemplateForCategory(e);if(null!==i){i.Et();const s=i.copy();if(null!==s){const i=this.diagram.fe;this.diagram.fe=!0,s.Vo=e,s._t=t;const n=this.diagram.model,o=n.O1(t,!0);""!==o&&(s.fromPortId=o);const r=n.Ae(t,!0);if(void 0!==r){const t=this.findNodeForKey(r);t instanceof Ce&&(s.fromNode=t)}const a=n.O1(t,!1);""!==a&&(s.toPortId=a);const h=n.Ae(t,!1);if(void 0!==h){const t=this.findNodeForKey(h);t instanceof Ce&&(s.toNode=t)}const l=n.getLabelKeysForLinkData(t);return Array.isArray(l)&&l.forEach((t=>{const e=this.findNodeForKey(t);null!==e&&(e.labeledLink=s)})),this.addsToTemporaryLayer&&(s.sl="Tool"),this.diagram.add(s),s._t=null,s.data=t,this.diagram.fe=i,s}}return null}RT(){const t=this.diagram.model;this.KT(t.linkDataArray),this.MN(t.nodeDataArray)}KT(t){t.forEach((t=>{this.R1(t)}))}getLinkCategoryForData(t){return this.diagram.model.getCategoryForLinkData(t)}setLinkCategoryForData(t,e){return this.diagram.model.setCategoryForLinkData(t,e)}setFromNodeForLink(t,e){const i=this.diagram.model,s=null!==e?e.data:null;i.setFromKeyForLinkData(t.data,i.getKeyForNodeData(s))}setToNodeForLink(t,e){const i=this.diagram.model,s=null!==e?e.data:null;i.setToKeyForLinkData(t.data,i.getKeyForNodeData(s))}mN(t){this.diagram.model.removeLinkData(t.data)}findPartForKey(t){const e=super.findPartForKey(t);if(null===e){const e=this.diagram.model.findLinkDataForKey(t);if(null!==e)return this.findLinkForData(e)}return e}findLinkForKey(t){if(null==t)return null;const e=this.diagram.model.findLinkDataForKey(t);return null!==e?this.findLinkForData(e):null}doModelChanged(t){if(super.doModelChanged(t),!this.diagram)return;const i=this.diagram;if(t.model!==i.model)return;const s=t.change;if(i.X){i.X=!1;try{const n=t.modelChange;if(""!==n){if(2===s){if("linkFromKey"===n){const e=t.object,i=this.findLinkForData(e);if(null!==i){const e=t.newValue,s=this.findNodeForKey(e);i.fromNode=s}}else if("linkToKey"===n){const e=t.object,i=this.findLinkForData(e);if(null!==i){const e=t.newValue,s=this.findNodeForKey(e);i.toNode=s}}else if("linkFromPortId"===n){const e=t.object,i=this.findLinkForData(e);if(null!==i){const e=t.newValue;"string"==typeof e&&(i.fromPortId=e)}}else if("linkToPortId"===n){const e=t.object,i=this.findLinkForData(e);if(null!==i){const e=t.newValue;"string"==typeof e&&(i.toPortId=e)}}else if("nodeGroupKey"===n){const e=t.object,i=this.findPartForData(e);if(null!==i){const e=t.newValue;if(void 0!==e){const t=this.findNodeForKey(e);i.containingGroup=t instanceof _e?t:null}else i.containingGroup=null}}else if("linkLabelKeys"===n){const e=t.object,i=this.findLinkForData(e);if(null!==i){const e=t.oldValue,s=t.newValue;Array.isArray(e)&&e.forEach((t=>{if(s.indexOf(t)>=0)return;const e=this.findNodeForKey(t);null!==e&&(e.labeledLink=null)})),Array.isArray(s)&&s.forEach((t=>{const e=this.findNodeForKey(t);null!==e&&(e.labeledLink=i)}))}}else if("linkCategory"===n){const e=t.object,i=this.findLinkForData(e),s=t.newValue;null!==i&&"string"==typeof s&&(i.category=s)}else if("linkDataArray"===n){const e=t.oldValue;this.KT(e);const i=t.newValue;this.XT(i)}i.isModified=!0}else if(3===s){const s=t.newValue;if("linkDataArray"===n&&e.K(s))this.YT(s);else if("linkLabelKeys"===n&&t.model.isKeyType(s)){const e=t.object,i=this.findLinkForData(e),n=this.findNodeForKey(s);null!==i&&null!==n&&(n.labeledLink=i)}i.isModified=!0}else if(4===s){const s=t.oldValue;if("linkDataArray"===n&&e.K(s))this.R1(s);else if("linkLabelKeys"===n&&t.model.isKeyType(s)){const t=this.findNodeForKey(s);null!==t&&(t.labeledLink=null)}i.isModified=!0}}else if(2===s){const e=t.propertyName,s=t.object,n=i.model;s===n&&("linkFromKeyProperty"===e||"linkToKeyProperty"===e||"linkFromPortIdProperty"===e||"linkToPortIdProperty"===e||"linkLabelKeysProperty"===e||"nodeIsGroupProperty"===e||"nodeGroupKeyProperty"===e||"linkCategoryProperty"===e)&&(i.undoManager.isUndoingRedoing||this.rebuildParts()),i.isModified=!0}}finally{i.X=!0}}}zT(){const t=this.diagram.model,e=new u,i=t.linkDataArray;i.forEach((t=>{e.add(t)}));const s=[];this.links.each((t=>{null!==t.data&&!e.has(t.data)&&s.push(t.data)})),s.forEach((e=>{t.GT(e,!1)})),i.forEach((e=>{null===this.findLinkForData(e)&&t.HT(e,!1)}))}updateRelationshipsFromData(t){const e=t.data;if(null===e)return;const i=t.diagram;if(null===i)return;const s=i.model;if(t instanceof De){let n=s.Ae(e,!0),o=i.findNodeForKey(n);t.fromNode=o,n=s.Ae(e,!1),o=i.findNodeForKey(n),t.toNode=o;const r=s.getLabelKeysForLinkData(e);if(r.length>0||t.labelNodes.count>0){if(1===r.length&&1===t.labelNodes.count){const e=r[0],i=t.labelNodes.first();if(s.getKeyForNodeData(i.data)===e)return}const e=(new u).addAll(r),n=new u;t.labelNodes.each((t=>{if(null!==t.data){const e=s.getKeyForNodeData(t.data);void 0!==e&&n.add(e)}}));const o=n.copy();o.removeAll(e);const a=e.copy();if(a.removeAll(n),o.count>0||a.count>0){const e=t;o.each((t=>{const s=i.findNodeForKey(t);null!==s&&s.labeledLink===e&&(s.labeledLink=null)})),a.each((t=>{const s=i.findNodeForKey(t);null!==s&&s.labeledLink!==e&&(s.labeledLink=e)}))}}}else if(!(t instanceof Pe)){const n=s.getGroupKeyForNodeData(e),o=i.findPartForKey(n);(null===o||o instanceof _e)&&(t.containingGroup=o)}}F1(t){const e=this.diagram.model,i=e.getKeyForNodeData(t);if(void 0!==i){const s=e.My(i),n=this.findPartForData(t);if(null!==s&&null!==n){const t=s.iterator;for(;t.next();){const s=t.value;if(e.containsNodeData(s)){if(n instanceof _e&&e.getGroupKeyForNodeData(s)===i){const t=this.findPartForData(s);null!==t&&(t.containingGroup=n)}}else{const t=this.findLinkForData(s);if(null!==t&&n instanceof Ce){e.Ae(s,!0)===i&&(t.fromNode=n),e.Ae(s,!1)===i&&(t.toNode=n);const o=e.getLabelKeysForLinkData(s);Array.isArray(o)&&o.some((e=>e===i&&(n.labeledLink=t,!0)))}}}e.Ws(i)}const o=e.getGroupKeyForNodeData(t);if(void 0!==o){const t=this.findNodeForKey(o);t instanceof _e&&(n.containingGroup=t)}}}NN(t){const e=this.diagram.model;if(t instanceof Ce){const i=e.getKeyForNodeData(t.data);if(void 0!==i){const s=t.linksConnected;for(;s.next();){const t=s.value;e.Js(i,t.data)}if(t.isLinkLabel){const s=t.labeledLink;null!==s&&e.Js(i,s.data)}if(t instanceof _e){const s=t.memberParts;for(;s.next();){const t=s.value.data;e.containsNodeData(t)&&e.Js(i,t)}}}}}AN(t,i){let s=super.AN(t,i);if(t instanceof De){const n=t.data;if(null!==n&&null!==i){const t=i.model,o=t.copyLinkData(n);e.K(o)&&(t.addLinkData(o),s=i.findLinkForData(o))}else if(null!==s){const t=this.diagram;if(null!==n&&null!==t&&null!==t.commandHandler&&t.commandHandler.copiesClipboardData){const i=t.model.copyLinkData(n);e.K(i)&&(s.data=i)}}}return s}insertLink(t,i,s,n){const o=this.diagram,r=o.model,a=o.toolManager.findTool("Linking");let h="";null!==t&&(null===i&&(i=t),h=i.portId,null===h&&(h=""));let l="";null!==s&&(null===n&&(n=s),l=n.portId,null===l&&(l=""));const u=a.archetypeLinkData;if(u instanceof De){u.Et();const e=u.copy();if(null!==e){e.fromNode=t,e.fromPortId=h,e.toNode=s,e.toPortId=l,o.add(e);const i=a.archetypeLabelNodeData;if(i instanceof Ce){i.Et();const t=i.copy();null!==t&&(t.labeledLink=e,o.add(t))}return e}}else if(null!==u){const i=r.copyLinkData(u);if(e.K(i)){null!==t&&r.Wd(i,r.getKeyForNodeData(t.data),!0),r.Jd(i,h,!0),null!==s&&r.Wd(i,r.getKeyForNodeData(s.data),!1),r.Jd(i,l,!1),r.addLinkData(i);const n=a.archetypeLabelNodeData;if(null!==n&&!(n instanceof Ce)){const t=r.copyNodeData(n);if(e.K(t)){r.addNodeData(t);const e=r.getKeyForNodeData(t);void 0!==e&&r.addLabelKeyForLinkData(i,e)}}return o.findLinkForData(i)}}return null}}class We extends He{Mh=null;I1(t,e){if(null===t||null===e||null!==e.findTreeParentLink())return null;const i=this.diagram.toolManager.findTool("Linking");let s=t,n=e;if(this.diagram.isTreePathToChildren){if(null!==i&&i.yu(s,n,null,!0))return null}else if(s=e,n=t,null!==i&&i.yu(s,n,null,!0))return null;const o=this.getLinkCategoryForData(e.data),r=this.findLinkTemplateForCategory(o);if(null!==r){r.Et();const t=r.copy();if(null!==t){const i=this.diagram.fe;return this.diagram.fe=!0,t.Vo=o,t._t=e.data,t.fromNode=s,t.toNode=n,this.diagram.add(t),t._t=null,t.data=e.data,this.diagram.fe=i,t}}return null}getLinkCategoryForData(t){return this.diagram.model.getParentLinkCategoryForNodeData(t)}setLinkCategoryForData(t,e){this.diagram.model.setParentLinkCategoryForNodeData(t,e)}setFromNodeForLink(t,e,i){const s=this.diagram.model;void 0===i&&(i=null);const n=null!==e?e.data:null;if(this.diagram.isTreePathToChildren)s.setParentKeyForNodeData(t.data,s.getKeyForNodeData(n));else{const e=this.Mh;this.Mh=t,null!==i&&s.setParentKeyForNodeData(i.data,void 0);const o=null!==t.toNode?t.toNode.data:null;s.setParentKeyForNodeData(n,s.getKeyForNodeData(o)),this.Mh=e}}setToNodeForLink(t,e,i){const s=this.diagram.model;void 0===i&&(i=null);const n=null!==e?e.data:null;if(this.diagram.isTreePathToChildren){const e=this.Mh;this.Mh=t,null!==i&&s.setParentKeyForNodeData(i.data,void 0);const o=null!==t.fromNode?t.fromNode.data:null;s.setParentKeyForNodeData(n,s.getKeyForNodeData(o)),this.Mh=e}else s.setParentKeyForNodeData(t.data,s.getKeyForNodeData(n))}mN(t){this.diagram.model.setParentKeyForNodeData(t.data,void 0)}findLinkForKey(t){if(null==t)return null;const e=this.diagram.model.findNodeDataForKey(t);return null!==e?this.findLinkForData(e):null}doModelChanged(t){if(super.doModelChanged(t),!this.diagram)return;const e=this.diagram;if(t.model!==e.model)return;const i=t.change;if(e.X){e.X=!1;try{const s=t.modelChange;if(""!==s){if(2===i){if("nodeParentKey"===s){const i=t.object,s=t.newValue,n=this.findNodeForKey(s),o=this.findNodeForData(i);if(null!==this.Mh)null!==n&&(this.Mh.data=i,this.Mh.category=this.getLinkCategoryForData(i));else if(null!==o){const t=o.findTreeParentLink();null!==t?null===n?e.remove(t):e.isTreePathToChildren?t.fromNode=n:t.toNode=n:this.I1(n,o)}}else if("parentLinkCategory"===s){const e=t.object,i=this.findNodeForData(e),s=t.newValue;if(null!==i&&"string"==typeof s){const t=i.findTreeParentLink();null!==t&&(t.category=s)}}e.isModified=!0}}else if(2===i){const i=t.propertyName,s=t.object,n=e.model;s===n&&"nodeParentKeyProperty"===i&&(e.undoManager.isUndoingRedoing||this.rebuildParts()),e.isModified=!0}}finally{e.X=!0}}}updateRelationshipsFromData(t){const e=t.data;if(null===e)return;const i=t.diagram;if(null===i)return;const s=i.model;if(t instanceof Ce){const n=s.getParentKeyForNodeData(e),o=i.findNodeForKey(n),r=t.findTreeParentNode();if(o!==r){const e=t.findTreeParentLink();null!==o?null!==e?i.isTreePathToChildren?e.fromNode=o:e.toNode=o:this.I1(o,t):null!==e&&i.EM(e,!1)}}}Sy(t,e){if(super.Sy(t,e),"string"==typeof e&&null!==this.findPartForData(t)){const i=this.findLinkForData(t);null!==i&&i.updateTargetBindings(e)}}F1(t){const e=this.diagram.model,i=e.getKeyForNodeData(t);if(void 0!==i){const s=e.My(i),n=this.findPartForData(t);if(null!==s&&null!==n){const t=s.iterator;for(;t.next();){const s=t.value;if(e.containsNodeData(s)&&n instanceof Ce&&e.getParentKeyForNodeData(s)===i){const t=this.findNodeForData(s);this.I1(n,t)}}e.Ws(i)}const o=e.getParentKeyForNodeData(t);if(void 0!==o&&n instanceof Ce){const t=this.findNodeForKey(o);this.I1(t,n)}}}NN(t){const e=this.diagram.model;if(t instanceof Ce){const i=e.getKeyForNodeData(t.data),s=this.findLinkForData(t.data);if(null!==s){s.isSelected=!1,s.isHighlighted=!1;const t=s.layer;if(null!==t){const e=t.te(-1,s,!1);e>=0&&this.diagram.raiseChangedEvent(4,"parts",t,s,null,e,null);const i=s.layerChanged;null!==i&&i(s,t,null)}}const n=this.diagram.isTreePathToChildren,o=t.linksConnected;for(;o.next();){const t=o.value,s=(n?t.toNode:t.fromNode).data;e.containsNodeData(s)&&e.Js(i,s)}}}insertLink(t,e,i,s){const n=this.diagram.model;let o=t,r=i;if(this.diagram.isTreePathToChildren||(o=i,r=t),null!==o&&null!==r){const t=o.data,e=r.data;return n.setParentKeyForNodeData(e,n.getKeyForNodeData(t)),r.findTreeParentLink()}return null}}var Ze=(t=>(t[t.OneWay=1]="OneWay",t[t.TwoWay=2]="TwoWay",t))(Ze||{});class Je{n;TN;Ya;Cf;Nh;Lf;Af;Tf;E1;be;ad;ff;constructor(t,i,s,n){u.Gi(this),void 0===t?t="":e.s(t,"string",Je,"constructor:targetprop"),void 0===i?i=t:e.s(i,"string",Je,"constructor:sourceprop"),void 0===s?s=null:null!==s&&e.k(s,Je,"constructor:conv"),this.TN=-1,this.be=null,this.Ya=t,this.ad=0,this.ff=0,this.Cf=null,this.Nh=i,this.Lf=s,void 0===n?(this.Af=1,this.Tf=null):(this.Af=2,this.Tf=n),this.E1=new u,this.n=2}copy(){const t=new this.constructor;return this.cloneProtected(t),t}cloneProtected(t){t.Ya=this.Ya,t.ad=this.ad,t.ff=this.ff,t.Cf=this.Cf,t.Nh=this.Nh,t.Lf=this.Lf,t.Af=this.Af,t.Tf=this.Tf,t.n=-2&this.n}static OneWay=1;static TwoWay=2;static parseEnum(t,i){return e.k(t,Je,"parseEnum:ctor"),s=>{let n=parseInt(s);return isNaN(n)&&(n=e.Eh(t,s),null===n)?i:n}}oi(t){t in Ze?this.mode=t:e.ir(this,t)}static toString(t){return e.toString(t)}toString(){return"Binding("+this.targetProperty+":"+this.sourceProperty+(-1!==this.targetId?" "+this.targetId:"")+" "+Ze[this.mode]+")"}u(){return this.n=1|this.n,this}get targetId(){return this.TN}set targetId(t){this.h&&e.L(this),this.TN=t}get targetProperty(){return this.Ya}set targetProperty(t){this.h&&e.L(this),e.s(t,"string",Je,"targetProperty"),this.Ya=t}get sourceProperty(){return this.Nh}set sourceProperty(t){this.h&&e.L(this),e.s(t,"string",Je,"sourceProperty"),this.Nh=t}get h(){return 0!==(1&this.n)}get isToData(){return 0!==(2&this.n)}get isToObject(){return 0!==(4&this.n)}get isToModel(){return 0!==(8&this.n)}get isToTheme(){return 0!==(16&this.n)}get DN(){return this.isToTheme&&!(this.isToData||this.isToObject||this.isToModel)}qu(){return!1}get sourceName(){return this.Cf}set sourceName(t){this.h&&e.L(this),null!==t&&e.s(t,"string",Je,"sourceName"),this.Cf=t,this.n=null!==t?-3&this.n|4:2|this.n}get converter(){return this.Lf}set converter(t){this.h&&e.L(this),null!==t&&e.k(t,Je,"converter"),this.Lf=t}get backConverter(){return this.Tf}set backConverter(t){this.h&&e.L(this),null!==t&&e.k(t,Je,"backConverter"),this.Tf=t}get mode(){return this.Af}set mode(t){this.h&&e.L(this),this.isToTheme&&2===t&&e.o("Theme Bindings cannot be TwoWay."),this.Af=t}makeTwoWay(t){return this.isToTheme&&e.o("Theme Bindings cannot be TwoWay."),this.mode=2,t&&(e.k(t,Je,"makeTwoWay"),this.backConverter=t),this}ofObject(t){return this.h&&e.L(this),void 0===t&&(t=""),this.sourceName=t,this}ofModel(){return this.h&&e.L(this),this.n=-3&this.n&-5|8,this.Cf=null,this}yA(t,e){const i=this.sourceName;let s=null;return s=null===i||""===i?t:"/"===i?e.part:"."===i?e:".."===i?e.panel:t.findObject(i),s}check(t){const i=this.Ya,s=this.Nh,n=this.Lf;(this.qu()&&null===n&&null===this.Ch&&""===i||null===n&&""===i)&&e.ni("Binding error: target property is the empty string: "+this.toString()),this.qu()&&this.DN&&""===s&&null===n&&null===this.Ch&&e.ni("Binding error: theme bindings require a source property when not using a converter: "+this.toString()),t&&"string"==typeof i&&(!e.it(["setAttribute"])&&i.length>0&&"_"!==i[0]&&!e.uw(t,i)?e.ni("Binding error: undefined target property: "+i+" on "+t.toString()):"name"===i&&t instanceof Tt&&e.ni("Binding error: cannot modify GraphObject.name on "+t.toString()))}updateTarget(t,e,i,s){const n=this.Nh;if(void 0!==i&&""!==n&&n!==i)return;const o=this.Ya,r=this.Lf;let a=e;if(""!==n&&!this.DN&&(a=s?s.yt(e,n):ti.yt(e,n)),void 0===a)return;const h=t.diagram?.themeManager;if(null===r){if(""!==o){if(this.qu()&&(a=this.jT(h,a,t,o),void 0===a))return;s?s.Z(t,o,a):(e instanceof Tt||e instanceof ae)&&ti.Z(t,o,a)}}else try{if(""!==o){let i=r(a,t);if(this.qu()&&(i=this.jT(h,i,t,o),void 0===i))return;s?s.Z(t,o,i):(e instanceof Tt||e instanceof ae)&&ti.Z(t,o,i)}else r(a,t)}catch{}}updateSource(t,e,i,s){if(2!==this.Af)return;const n=this.Ya;if(void 0!==i&&n!==i)return;const o=this.Nh,r=this.Tf,a=null!==s?s.diagram:null,h=null!==a?a.model:null;let l=t;if(""!==n&&(l=h?h.yt(t,n):ti.yt(t,n)),void 0!==l&&!this.E1.has(t))try{if(this.E1.add(t),null===r){if(""!==o)null!==h?h.setDataProperty(e,o,l):(e instanceof Tt||e instanceof ae)&&(e[o]=l);else if(null!==h&&null!==s&&s.itemIndex>=0&&null!==s.panel&&Array.isArray(s.panel.itemArray)){const t=s.itemIndex,e=s.panel.itemArray;h.removeArrayItem(e,t),h.insertArrayItem(e,t,l)}}else try{if(""!==o){const t=r(l,e,h);null!==h?h.setDataProperty(e,o,t):(e instanceof Tt||e instanceof ae)&&(e[o]=t)}else{const t=r(l,e,h);if(void 0!==t&&null!==h&&null!==s&&s.itemIndex>=0&&null!==s.panel&&Array.isArray(s.panel.itemArray)){const e=s.itemIndex,i=s.panel.itemArray;h.removeArrayItem(i,e),h.insertArrayItem(i,e,t)}}}catch{}}finally{this.E1.delete(t)}}}class Qe extends Je{Ny;Ch;Ka;constructor(t,e,i,s,n){super(t,e,s),null==i&&(i=""),void 0===n&&(n=null),this.Ny=i,this.Ch=n,this.Ka=null,this.n=16}cloneProtected(t){super.cloneProtected(t),t.Ny=this.Ny,t.Ch=this.Ch,t.Ka=this.Ka}qu(){return!0}get themeSource(){return this.Ny}set themeSource(t){this.h&&e.L(this),null!==t&&e.s(t,"string",Qe,"themeSource"),this.Ny=t,this.Ka=null,this.n=null!==t?16|this.n:-17&this.n}get themeConverter(){return this.Ch}set themeConverter(t){this.h&&e.L(this),null!==t&&e.k(t,Qe,"themeConverter"),this.Ch=t}ofData(){return this.h&&e.L(this),this.n=2|this.n,this.Cf=null,this}jT(t,i,s,n){if(!t||(this.DN&&(i=this.Nh),!i&&0!==i))return;let o=this.themeSource;null!==this.Ka?o=this.Ka:"string"==typeof o&&o.includes(".")&&(this.Ka=o.split("."),o=this.Ka);let r=t.findValue(i,o,n);return void 0===r&&e.ni(`Theme warning: ${i} could not be found when setting target property ${n}.`),e.it(this.Ch)&&(r=this.Ch(r,s)),r}}class ti{Pt;$d;Lo;FN;Te;mi;Lh;Df;Ff;Zd;Qd;_d;tg;Cy;Ga;Wo;Ly;Co;B1;constructor(t,e){if(u.Gi(this),this.Pt="",this.$d="",this.Lo=!1,this.FN={},this.Te=[],this.mi=new m,this.Lh="key",this.Df=null,this.Ff=null,this.Zd=!1,this.Qd=!1,this._d=!1,this.tg=null,this.Cy=100,this.Ga="category",this.Wo=new m,this.Ly=[],this.Co=!1,this.B1=null,this.undoManager=new E,void 0!==t&&(Array.isArray(t)?this.nodeDataArray=t:e=t),e){Object.assign(this,e);const t=e.Changed;t&&(delete this.Changed,this.addChangedListener(t))}}cloneProtected(t){t.Pt=this.Pt,t.$d=this.$d,t.Lo=this.Lo,t.Lh=this.Lh,t.Df=this.Df,t.Ff=this.Ff,t.Zd=this.Zd,t.Qd=this.Qd,t._d=this._d,t.tg=this.tg,t.Cy=this.Cy,t.Ga=this.Ga}copy(){const t=new this.constructor;return this.cloneProtected(t),t}clear(){this.Te=[],this.mi.clear(),this.Wo.clear(),this.undoManager.clear()}toString(t){if(void 0===t&&(t=0),t>1)return this.toJson();{let i=(""!==this.name?this.name:"")+" Model";if(t>0){i+="\n node data:";const t=this.nodeDataArray,s=t.length;for(let n=0;n<s;n++){const s=t[n];i+=" "+this.getKeyForNodeData(s)+":"+e.toString(s)}}return i}}toIncrementalData(t){1!==t.change&&e.o("Model.toIncrementalData argument is not a Transaction ChangedEvent:"+t.toString());const i=t.object;if(!t.isTransactionFinished||!(i instanceof R))return null;const s=this.qT(i);return this.RN(i,"FinishedUndo"===t.propertyName,s)}RN(t,e,i){const s=this;let n=!1;const o=new u,r=new u,a=new u;t.changes.each((t=>{if(t.model===s)if("nodeDataArray"===t.modelChange)3===t.change?o.add(t.newValue):4===t.change&&a.add(t.oldValue);else if(s.containsNodeData(t.object))r.add(t.object);else if(2!==t.change||s.modelData!==t.object&&"modelData"!==t.propertyName){if(null!==t.object)if(i.has(t.object))i.get(t.object).each((t=>{s.containsNodeData(t)&&r.add(t)}));else{if(t.object instanceof ti||s.Ra()&&s.containsLinkData(t.object))return;s.WT(t.object).each((t=>{r.add(t)}))}}else n=!0}));const h=new u;o.each((t=>{h.add(s.getKeyForNodeData(t)),e||r.add(t)}));const l=new u;a.each((t=>{l.add(s.getKeyForNodeData(t)),e&&r.add(t)}));const c=s.cloneDeep(r.toArray());let d=null;return n&&(null===d&&(d={}),d.modelData=this.cloneDeep(this.modelData)),h.count>0&&(null===d&&(d={}),e?d.removedNodeKeys=h.toArray():d.insertedNodeKeys=h.toArray()),c.length>0&&(null===d&&(d={}),d.modifiedNodeData=c),l.count>0&&(null===d&&(d={}),e?d.insertedNodeKeys=l.toArray():d.removedNodeKeys=l.toArray()),d}cloneDeep(t){return this.ig(t,!0)}ig(t,i,s,n){if(!e.K(t))return t;s||(s=new m);const o=s.get(t);if(o)return o;let r;if(Array.isArray(t)){r=[],s.set(t,r);for(let e=0;e<t.length;e++){const i=t[e];r.push(this.ig(i,!1,s,n))}}else if(t instanceof y||t instanceof v||t instanceof x||t instanceof b||t instanceof w)r=t.copy(),s.set(t,r);else{if(t instanceof jt||t instanceof C)return t;if(t instanceof h)r=(new h).addAll(this.ig(t.toArray(),!1,s,n)),s.set(t,r);else if(t instanceof u)r=(new u).addAll(this.ig(t.toArray(),!1,s,n)),s.set(t,r);else if(t instanceof m)r=(new m).addAll(this.ig(t.toArray(),!1,s,n)),s.set(t,r);else if(t instanceof Date)r=new Date(t),s.set(t,r);else if(t instanceof RegExp)r=new RegExp(t),s.set(t,r),r.lastIndex=t.lastIndex;else if(ti.vN(null,"",t))r=t;else if(e.it(t.copy))r=t.copy(),s.set(t,r);else{r={},s.set(t,r);for(const e in t){if("__gohashid"===e)continue;const i=t[e];r[e]=this.ig(i,!1,s,n)}}}return r}De(t){return JSON.stringify(t).replace(/[\u007F-\uFFFF]/g,(t=>{const e="0000"+t.charCodeAt(0).toString(16);return"\\u"+e.substring(e.length-4)}))}eg(){let t="";return""!==this.name&&(t+=',\n  "name": '+this.De(this.name)),""!==this.dataFormat&&(t+=',\n  "dataFormat": '+this.De(this.dataFormat)),this.isReadOnly&&(t+=',\n  "isReadOnly": '+this.isReadOnly),"key"!==this.nodeKeyProperty&&"string"==typeof this.nodeKeyProperty&&(t+=',\n  "nodeKeyProperty": '+this.De(this.nodeKeyProperty)),this.copiesArrays&&(t+=',\n  "copiesArrays": true'),this.copiesArrayObjects&&(t+=',\n  "copiesArrayObjects": true'),this.copiesKey&&(t+=',\n  "copiesKey": true'),100!==this.pointsDigits&&(t+=',\n  "pointsDigits": '+this.pointsDigits.toString()),"category"!==this.nodeCategoryProperty&&"string"==typeof this.nodeCategoryProperty&&(t+=',\n  "nodeCategoryProperty": '+this.De(this.nodeCategoryProperty)),t}Ay(t){t.name&&(this.name=t.name),t.dataFormat&&(this.dataFormat=t.dataFormat),t.isReadOnly&&(this.isReadOnly=!0),t.nodeKeyProperty&&(this.nodeKeyProperty=t.nodeKeyProperty),t.copiesArrays&&(this.copiesArrays=!0),t.copiesArrayObjects&&(this.copiesArrayObjects=!0),void 0!==t.copiesKey&&(this.copiesKey=t.copiesKey),void 0!==t.pointsDigits&&(this.pointsDigits=parseInt(t.pointsDigits)),t.nodeCategoryProperty&&(this.nodeCategoryProperty=t.nodeCategoryProperty)}JT(){const t=this.modelData;return',\n  "modelData": '+this.$T(t)}ZT(t){const i=t.modelData;e.K(i)&&(this.replaceJsonObjects(i),this.modelData=i)}ON(){const t=this.modelData;let e=!1;for(const s in t)if(!this.U1(t,s,t[s])){e=!0;break}let i="";return e&&(i=this.JT()),i+',\n  "nodeDataArray": '+this.Ah(this.nodeDataArray,!0)}IN(t){this.ZT(t);const e=t.nodeDataArray;Array.isArray(e)&&(this.replaceJsonObjects(e),this.nodeDataArray=e)}EN(t,i,s){if(t===i)return!0;if(typeof t!=typeof i||e.it(t)||e.it(i))return!1;if(Array.isArray(t)&&Array.isArray(i)){if(s.get(t)===i)return!0;if(s.set(t,i),t.length!==i.length)return!1;for(let e=0;e<t.length;e++)if(!this.EN(t[e],i[e],s))return!1;return!0}if(e.K(t)&&e.K(i)){if(s.get(t)===i)return!0;s.set(t,i);for(const e in t){const n=t[e];if(this.U1(t,e,n))continue;const o=i[e];if(void 0===o||!this.EN(n,o,s))return!1}for(const e in i){const n=i[e];if(this.U1(i,e,n))continue;const o=t[e];if(void 0===o||!this.EN(o,n,s))return!1}return!0}return!1}static QT=',\n  "insertedNodeKeys": ';static jO=',\n  "modifiedNodeData": ';static _T=',\n  "removedNodeKeys": ';qT(t){let e=new m;const i=(t,i)=>{const s=i.part;if(!s)return;const n=s.data;if(t===n)return;let o=e.get(t);null===o?(o=new u,o.add(n),e.set(t,o)):o.add(n)};return t.changes.each((t=>{if(null!==t.diagram){const e=t.change;if(2===e){const e=t.object.panel;if(e){const t=e.data;t&&i(t,e)}}else if(3===e||4===e){const e=t.object,s=e.itemArray;s&&i(s,e)}}})),e}WT(t){const e=new u;for(let i=0;i<this.nodeDataArray.length;i++){const s=this.nodeDataArray[i];this.V1(t,s,s,e)}return e}V1(t,i,s,n){if(Array.isArray(i))for(let e=0;e<i.length;e++){const o=i[e];if(o===t)return n.add(s),!0;if(this.V1(t,o,s,n))return!0}else if(e.K(i)&&Object.getPrototypeOf(i)===Object.prototype)for(const e in i){const o=i[e];if(o===t)return n.add(s),!0;if(this.V1(t,o,s,n))return!0}return!1}BN(t,e,i){const s=this;let n=!1;const o=new u,r=new u,a=new u;t.changes.each((t=>{if(t.model===s)if("nodeDataArray"===t.modelChange)3===t.change?o.add(t.newValue):4===t.change&&a.add(t.oldValue);else if(s.containsNodeData(t.object))r.add(t.object);else if(2!==t.change||s.modelData!==t.object&&"modelData"!==t.propertyName){if(null!==t.object)if(i.has(t.object))i.get(t.object).each((t=>{s.containsNodeData(t)&&r.add(t)}));else{if(t.object instanceof ti||s.Ra()&&s.containsLinkData(t.object))return;s.WT(t.object).each((t=>{r.add(t)}))}}else n=!0}));const h=new u;o.each((t=>{h.add(s.getKeyForNodeData(t)),e||r.add(t)}));const l=new u;a.each((t=>{l.add(s.getKeyForNodeData(t)),e&&r.add(t)}));let c="";return n&&(c+=this.JT()),h.count>0&&(c+=(e?ti._T:ti.QT)+this.Ah(h.toArray(),!0)),r.count>0&&(c+=ti.jO+this.Ah(r.toArray(),!0)),l.count>0&&(c+=(e?ti.QT:ti._T)+this.Ah(l.toArray(),!0)),c}Ty(t){(void 0!==t.name&&t.name!==this.name||void 0!==t.dataFormat&&t.dataFormat!==this.dataFormat||void 0!==t.isReadOnly&&t.isReadOnly!==this.isReadOnly||void 0!==t.nodeKeyProperty&&t.nodeKeyProperty!==this.nodeKeyProperty||void 0!==t.copiesArrays&&t.copiesArrays!==this.copiesArrays||void 0!==t.copiesArrayObjects&&t.copiesArrayObjects!==this.copiesArrayObjects||void 0!==t.copiesKey&&t.copiesKey!==this.copiesKey||void 0!==t.nodeCategoryProperty&&t.nodeCategoryProperty!==this.nodeCategoryProperty)&&e.o("applyIncrementalJson cannot change Model properties"),this.ZT(t);const i=t.insertedNodeKeys,s=t.modifiedNodeData,n=new m;if(Array.isArray(s))for(let e=0;e<s.length;e++){const t=s[e],i=this.getKeyForNodeData(t);null!=i&&n.set(i,t)}if(Array.isArray(i)){const t=i.length;for(let e=0;e<t;e++){const t=i[e];let s=this.findNodeDataForKey(t);if(null===s){const e=n.get(t);s=e||this.copyNodeData({}),this.setKeyForNodeData(s,t),this.addNodeData(s)}}}if(Array.isArray(s)){const t=s.length;for(let e=0;e<t;e++){const t=s[e],i=this.getKeyForNodeData(t),n=this.findNodeDataForKey(i);if(null!==n){for(const e in t)"__gohashid"===e||e===this.nodeKeyProperty||(this.mm()||this.Sb())&&e===this.nodeIsGroupProperty||this.setDataProperty(n,e,t[e]);this.sg(t,n)}}}const o=t.removedNodeKeys;if(Array.isArray(o)){const t=o.length;for(let e=0;e<t;e++){const t=o[e],i=this.findNodeDataForKey(t);null!==i&&this.removeNodeData(i)}}}toIncrementalJson(t,i){1!==t.change&&e.o("Model.toIncrementalJson argument is not a Transaction ChangedEvent:"+t.toString());const s=t.object;if(!t.isTransactionFinished||!(s instanceof R))return'{ "incremental": 0 }';void 0===i&&(i=e.Dn(this));const n=this.qT(s),o=this.BN(s,"FinishedUndo"===t.propertyName,n);return'{ "class": '+this.De(i)+', "incremental": 1'+this.eg()+o+"}"}toIncrementalJSON(t,e){return this.toIncrementalJson(t,e)}toJson(t){return void 0===t&&(t=e.Dn(this)),'{ "class": '+this.De(t)+this.eg()+this.ON()+"}"}toJSON(t){return this.toJson(t)}applyIncrementalJson(i){let s=null;if("string"==typeof i)try{s=t.JSON.parse(i)}catch{}else e.K(i)?s=i:e.o("Unable to modify a Model from: "+i);const n=s.incremental;"number"!=typeof n&&e.o("Unable to apply non-incremental changes to Model: "+i),0!==n&&(this.startTransaction("applyIncrementalJson"),this.Ty(s),this.commitTransaction("applyIncrementalJson"))}applyIncrementalJSON(t){return this.applyIncrementalJson(t)}static fromJson(i,s){void 0===s&&(s=null);let n=null;if("string"==typeof i)try{n=t.JSON.parse(i)}catch{}else e.K(i)?n=i:e.o("Unable to construct a Model from: "+i);if(null===s){const t=ti.qO(n);null===t||t instanceof ti?s=t:e.o("Unable to construct a Model of declared class: "+n.class)}return null===s&&(s=ti.tD()),s.Ay(n),s.IN(n),s}static fromJSON(t,e){return this.fromJson(t,e)}static tD(){return new ti}static qO(i){let s=null,n=i.class;if("string"==typeof n)try{let i=null;0===n.indexOf("go.")?i=ti.UN(n.substring(3)):(i=ti.UN(n),null===i&&(i=t[n])),e.it(i)&&(s=new i)}catch{}return s}replaceJsonObjects(t){if(Array.isArray(t)){const i=t.length;for(let s=0;s<i;s++){const i=t[s];e.K(i)&&this.iD(t,s,this.replaceJsonObjects(i))}}else if(e.K(t)){for(const i in t){const s=t[i];if(e.K(s)){const e=this.replaceJsonObjects(s);if(t[i]=e,"points"===i&&Array.isArray(e)){let s=e.length%2===0;for(let t=0;t<e.length;t++)if("number"!=typeof e[t]){s=!1;break}if(s){const s=new h;for(let t=0;t<e.length/2;t++)s.add(new y(e[2*t],e[2*t+1]));s.u(),t[i]=s}}}}return this.WO(t)}return t}writeJsonValue(t){return void 0===t?"undefined":null===t?"null":!0===t?"true":!1===t?"false":"string"==typeof t?this.De(t):"number"==typeof t?t===1/0?"9e9999":t===-1/0?"-9e9999":isNaN(t)?'{"class":"NaN"}':t.toString():t instanceof Boolean||t instanceof String||t instanceof Number?this.writeJsonValue(t.valueOf()):t instanceof Date?'{"class":"Date", "value":"'+t.toJSON()+'"}':Array.isArray(t)?this.Ah(t):e.K(t)?this.$T(t):e.it(t)?"null":'"'+t.toString()+'"'}Ah(t,e){void 0===e&&(e=!1);const s=t.length;if(s<=0)return"[]";const n=new i;n.add("["),e&&s>1&&n.add("\n");for(let i=0;i<s;i++){const s=t[i];void 0!==s&&(i>0&&(n.add(","),e&&n.add("\n")),n.add(this.writeJsonValue(s)))}return e&&s>1&&n.add("\n"),n.add("]"),n.toString()}U1(t,i,s){return!(void 0!==s&&"__gohashid"!==i&&"_"!==i[0]&&!e.it(s))}Yi(t){return isNaN(t)?"NaN":t===1/0?"9e9999":t===-1/0?"-9e9999":t}$T(t){const e=t;if(e instanceof y)t={class:"go.Point",x:this.Yi(e.x),y:this.Yi(e.y)};else if(e instanceof v)t={class:"go.Size",width:this.Yi(e.width),height:this.Yi(e.height)};else if(e instanceof x)t={class:"go.Rect",x:this.Yi(e.x),y:this.Yi(e.y),width:this.Yi(e.width),height:this.Yi(e.height)};else if(e instanceof b)t={class:"go.Margin",top:this.Yi(e.top),right:this.Yi(e.right),bottom:this.Yi(e.bottom),left:this.Yi(e.left)};else if(e instanceof w)t=e.isSpot()?{class:"go.Spot",x:this.Yi(e.x),y:this.Yi(e.y),offsetX:this.Yi(e.offsetX),offsetY:this.Yi(e.offsetY)}:{class:"go.Spot",enum:e.toString()};else if(e instanceof jt){if(t={class:"go.Brush",type:_t[e.type]},1===e.type?t.color=e.color:(2===e.type||3===e.type)&&(t.start=e.start,t.end=e.end,3===e.type&&(0!==e.startRadius&&(t.startRadius=this.Yi(e.startRadius)),isNaN(e.endRadius)||(t.endRadius=this.Yi(e.endRadius)))),null!==e.colorStops){const i={},s=e.colorStops.iterator;for(;s.next();){const t=s.key,e=s.value;i[t]=e}t.colorStops=i}}else if(e instanceof C)t={class:"go.Geometry",type:P[e.type]},0!==e.startX&&(t.startX=this.Yi(e.startX)),0!==e.startY&&(t.startY=this.Yi(e.startY)),0!==e.endX&&(t.endX=this.Yi(e.endX)),0!==e.endY&&(t.endY=this.Yi(e.endY)),e.spot1.equals(w.TopLeft)||(t.spot1=e.spot1),e.spot2.equals(w.BottomRight)||(t.spot2=e.spot2),4===e.type&&(t.path=C.stringify(e));else if(ti.vN(null,"",e))return"{}";let i="{",s=!0;for(const n in t){const e=this.yt(t,n);if(!this.U1(t,n,e))if(s?s=!1:i+=",",i+=this.De(n)+":","points"===n&&e instanceof h){const t=e;let s="[";const n=t.iterator;for(;n.next();){const t=n.value;s.length>1&&(s+=","),s+=this.eD(t.x),s+=",",s+=this.eD(t.y)}s+="]",i+=s}else i+=this.writeJsonValue(e)}return i+="}",i}eD(t){if(t===1/0)return"9e9999";if(t===-1/0)return"-9e9999";if(isNaN(t))return"0";const e=this.pointsDigits;return e>16?t.toString():t.toFixed(e)}get pointsDigits(){return this.Cy}set pointsDigits(t){t<0?t=0:t>100&&(t=100),this.Cy=t}Ki(t){return"number"==typeof t?t:"NaN"===t?NaN:"9e9999"===t?1/0:"-9e9999"===t?-1/0:parseFloat(t)}WO(t){if(!e.K(t))return t;let i=t.class||"";if("string"!=typeof i||""===i)return t;if("NaN"===i)return NaN;if("Date"===i)return new Date(t.value);if(0!==i.indexOf("go."))return t;i=i.substring(3);let s=t;if("Point"===i)s=new y(this.Ki(t.x),this.Ki(t.y));else if("Size"===i)s=new v(this.Ki(t.width),this.Ki(t.height));else if("Rect"===i)s=new x(this.Ki(t.x),this.Ki(t.y),this.Ki(t.width),this.Ki(t.height));else if("Margin"===i)s=new b(this.Ki(t.top),this.Ki(t.right),this.Ki(t.bottom),this.Ki(t.left));else if("Spot"===i)s="string"==typeof t.enum?w.parse(t.enum):new w(this.Ki(t.x),this.Ki(t.y),this.Ki(t.offsetX),this.Ki(t.offsetY));else if("Brush"===i){const i=new jt;i.type=e.Eh(_t,t.type)??1,"string"==typeof t.color&&(i.color=t.color),t.start instanceof w&&(i.start=t.start),t.end instanceof w&&(i.end=t.end),"number"==typeof t.startRadius&&(i.startRadius=this.Ki(t.startRadius)),"number"==typeof t.endRadius&&(i.endRadius=this.Ki(t.endRadius));const n=t.colorStops;if(e.K(n))for(const t in n){const e=parseFloat(t);i.addColorStop(e,n[t])}s=i}else if("Geometry"===i){let i=null;i="string"==typeof t.path?C.parse(t.path):new C,i.type=e.Eh(P,t.type)??1,"number"==typeof t.startX&&(i.startX=this.Ki(t.startX)),"number"==typeof t.startY&&(i.startY=this.Ki(t.startY)),"number"==typeof t.endX&&(i.endX=this.Ki(t.endX)),"number"==typeof t.endY&&(i.endY=this.Ki(t.endY)),t.spot1 instanceof w&&(i.spot1=t.spot1),t.spot2 instanceof w&&(i.spot2=t.spot2),s=i}else if("EnumValue"===i){let i=t.classType;0===i.indexOf("go.")&&(i=i.substring(3));const n=ti.UN(i);e.it(n)&&(s=e.Eh(n,t.name))}return s}get name(){return this.Pt}set name(t){const i=this.Pt;i!==t&&(e.s(t,"string",ti,"name"),this.Pt=t,this.t("name",i,t))}get dataFormat(){return this.$d}set dataFormat(t){const i=this.$d;i!==t&&(e.s(t,"string",ti,"dataFormat"),this.$d=t,this.t("dataFormat",i,t))}get isReadOnly(){return this.Lo}set isReadOnly(t){const i=this.Lo;i!==t&&(e.s(t,"boolean",ti,"isReadOnly"),this.Lo=t,this.t("isReadOnly",i,t))}get modelData(){return this.FN}set modelData(t){const i=this.modelData;i!==t&&(e.ec(t,ti,"modelData"),this.containsNodeData(t)&&e.o("Model.modelData Object must not be used by the rest of the model: "+t),this.FN=t,this.t("modelData",i,t),this.updateTargetBindings(t))}addChangedListener(t){return e.k(t,ti,"addChangedListener:listener"),this.Ly.push(t),this}removeChangedListener(t){e.k(t,ti,"removeChangedListener:listener");const i=this.Ly.indexOf(t);i>=0&&this.Ly.splice(i,1)}UM(t){this.skipsUndoManager||this.undoManager.handleChanged(t),this.sD(t)}sD(t){this.Ly.forEach((e=>e(t)))}uF(t){this.sD(t)}raiseChangedEvent(t,e,i,s,n,o,r){this.vt("",t,e,i,s,n,o,r)}raiseChanged(t,e,i,s,n){this.vt("",2,t,this,e,i,s,n)}t(t,e,i,s,n){this.vt("",2,t,this,e,i,s,n)}raiseDataChanged(t,e,i,s,n,o){this.vt("",2,e,t,i,s,n,o)}vt(t,e,i,s,n,o,r,a){void 0===r&&(r=null),void 0===a&&(a=null);const h=new F;h.model=this,h.change=e,h.modelChange=t,h.propertyName=i,h.object=s,h.oldValue=n,h.oldParam=r,h.newValue=o,h.newParam=a,this.UM(h)}get undoManager(){return this.B1}set undoManager(t){const e=this.B1;e!==t&&(null!==e&&e.removeModel(this),this.B1=t,null!==t&&t.addModel(this))}get skipsUndoManager(){return this.Co}set skipsUndoManager(t){e.s(t,"boolean",ti,"skipsUndoManager"),this.Co=t}changeState(t,i){if(null!==t&&t.model===this)if(2===t.change){const e=t.object,s=t.propertyName,n=t.getValue(i);if(s===this.nodeKeyProperty&&this.containsNodeData(e)){const s=t.getValue(!i);void 0!==s&&this.mi.delete(s),void 0!==n&&this.mi.set(n,e)}this.Z(e,s,n)}else if(3===t.change){const s=t.newParam;if("nodeDataArray"===t.modelChange){const n=t.newValue;if(e.K(n)&&"number"==typeof s){const t=this.getKeyForNodeData(n);i?(this.Te[s]===n&&this.uo(this.Te,s),void 0!==t&&this.mi.delete(t)):(this.Te[s]!==n&&this.Jo(this.Te,s,n),void 0!==t&&this.mi.set(t,n))}}else if(""===t.modelChange){let e=t.object;if(e&&!Array.isArray(e)&&t.propertyName&&(e=this.yt(e,t.propertyName)),Array.isArray(e)&&"number"==typeof s){const n=t.newValue;i?this.uo(e,s):this.Jo(e,s,n)}}else e.o("unknown ChangeType.Insert modelChange: "+t.toString())}else if(4===t.change){const s=t.oldParam;if("nodeDataArray"===t.modelChange){const n=t.oldValue;if(e.K(n)&&"number"==typeof s){const t=this.getKeyForNodeData(n);i?(this.Te[s]!==n&&this.Jo(this.Te,s,n),void 0!==t&&this.mi.set(t,n)):(this.Te[s]===n&&this.uo(this.Te,s),void 0!==t&&this.mi.delete(t))}}else if(""===t.modelChange){let e=t.object;if(e&&!Array.isArray(e)&&t.propertyName&&(e=this.yt(e,t.propertyName)),Array.isArray(e)&&"number"==typeof s){const n=t.oldValue;i?this.Jo(e,s,n):this.uo(e,s)}}else e.o("unknown ChangeType.Remove modelChange: "+t.toString())}else 1===t.change||e.o("unknown ChangedEvent: "+t.toString())}startTransaction(t){return this.undoManager.startTransaction(t)}commitTransaction(t){return this.undoManager.commitTransaction(t)}rollbackTransaction(){return this.undoManager.rollbackTransaction()}commit(t,e){let i=e;void 0===i&&(i="");const s=this.skipsUndoManager;null===i&&(this.skipsUndoManager=!0,i=""),this.undoManager.startTransaction(i);let n=!1;try{t(this),n=!0}finally{n?this.undoManager.commitTransaction(i):this.undoManager.rollbackTransaction(),this.skipsUndoManager=s}}updateTargetBindings(t,e){void 0===e&&(e=""),this.vt("SourceChanged",1,e,t,null,null)}get nodeKeyProperty(){return this.Lh}set nodeKeyProperty(t){const i=this.Lh;i!==t&&(this.Pn(t,ti,"nodeKeyProperty"),""===t&&e.o("Model.nodeKeyProperty may not be the empty string"),this.mi.count>0&&e.o("Cannot set Model.nodeKeyProperty when there is existing node data"),this.Lh=t,this.t("nodeKeyProperty",i,t))}Pn(t,i,s){"string"!=typeof t&&!e.it(t)&&e.Zi(t,"string or function",i,s)}getKeyForNodeData(t){if(null===t)return;const i=this.Lh;if(""===i)return;const s=this.yt(t,i);if(void 0!==s){if(this.isKeyType(s))return s;e.o("Key value for node data "+t+" is not a number or a string: "+s)}}setKeyForNodeData(t,i){if((null==i||!this.isKeyType(i))&&e.Zi(i,"number or string",ti,"setKeyForNodeData:key"),null===t)return;const s=this.Lh;if(""===s)return;if(!this.containsNodeData(t))return void this.Z(t,s,i);const n=this.yt(t,s);if(n!==i){if(null!==this.findNodeDataForKey(i))return;this.Z(t,s,i),void 0!==n&&this.mi.delete(n),this.mi.set(i,t),this.vt("nodeKey",2,s,t,n,i),"string"==typeof s&&this.updateTargetBindings(t,s),this.Dy(n,i)}}get makeUniqueKeyFunction(){return this.Df}set makeUniqueKeyFunction(t){const i=this.Df;i!==t&&(null!==t&&e.k(t,ti,"makeUniqueKeyFunction"),this.Df=t,this.t("makeUniqueKeyFunction",i,t))}isKeyType(t){return"number"==typeof t||"string"==typeof t}containsNodeData(t){if(null===t)return!1;const e=this.getKeyForNodeData(t);return void 0!==e&&this.mi.get(e)===t}findNodeDataForKey(t){return null===t&&e.o("Model.findNodeDataForKey:key must not be null"),void 0!==t&&this.isKeyType(t)?this.mi.get(t):null}get nodeDataArray(){return this.Te}set nodeDataArray(t){const i=this.Te;if(i!==t){this.VN(t,ti,"nodeDataArray"),this.mi.clear(),this.zN();const s=t.length;for(let i=0;i<s;i++){const s=t[i];e.K(s)||e.o("Model.nodeDataArray must only contain Objects, not: "+s),s===this.modelData&&e.o("nodeDataArray Objects must not be the shared Model.modelData")}this.Te=t;const n=new h;for(let e=0;e<s;e++){const i=t[e],s=this.getKeyForNodeData(i);void 0===s||null!==this.mi.get(s)?n.add(i):this.mi.set(s,i)}const o=n.iterator;for(;o.next();){const t=o.value;this.makeNodeDataKeyUnique(t);const e=this.getKeyForNodeData(t);void 0!==e&&this.mi.set(e,t)}this.vt("nodeDataArray",2,"nodeDataArray",this,i,t);for(let e=0;e<s;e++){const i=t[e];this.ng(i),this.og(i)}}}z1(t){return void 0!==t&&this.mi.has(t)}makeNodeDataKeyUnique(t){if(null===t)return;const e=this.Lh;if(""===e)return;let i=this.getKeyForNodeData(t);if(void 0!==i&&!this.z1(i))return;const s=this.Df;if(null===s||(i=s(this,t),null==i||this.z1(i))){if("string"==typeof i){let s=2;for(;this.z1(i+s);)s++;this.Z(t,e,i+s)}else if(void 0===i||"number"==typeof i){let i=-this.mi.count-1;for(;this.z1(i);)i--;this.Z(t,e,i)}}else this.Z(t,e,i)}addNodeData(t){null!==t&&(t===this.modelData&&e.o("Model.addNodeData cannot add the shared Model.modelData Object"),this.containsNodeData(t)||this.VT(t,!0))}VT(t,i){let s=this.getKeyForNodeData(t);if(void 0===s)this.makeNodeDataKeyUnique(t),s=this.getKeyForNodeData(t);else{if(this.mi.get(s)===t)return;this.makeNodeDataKeyUnique(t),s=this.getKeyForNodeData(t)}void 0===s&&e.o("Model.makeNodeDataKeyUnique failed on "+t+".  Data not added to Model."),this.mi.set(s,t);let n=null;i&&(n=this.Te.length,this.Jo(this.Te,n,t)),this.vt("nodeDataArray",3,"nodeDataArray",this,null,t,null,n),this.ng(t),this.og(t)}addNodeDataCollection(t){if(Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++)this.addNodeData(t[i])}else{const e=t.iterator;for(;e.next();){const t=e.value;this.addNodeData(t)}}}removeNodeData(t){null!==t&&this.UT(t,!0)}UT(t,e){const i=this.getKeyForNodeData(t);void 0!==i&&this.mi.delete(i);let s=null;if(e){if(s=this.Te.indexOf(t),s<0)return;this.uo(this.Te,s)}this.vt("nodeDataArray",4,"nodeDataArray",this,t,null,s,null),this.Fy(t)}removeNodeDataCollection(t){if(Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++)this.removeNodeData(t[i])}else{const e=t.iterator;for(;e.next();){const t=e.value;this.removeNodeData(t)}}}mergeNodeDataArray(t){if(t===this.nodeDataArray||!Array.isArray(t))return;const e=new u;e.addAll(this.mi.iteratorKeys);const i=new u,s=t.length;for(let o=0;o<s;o++){const e=t[o],s=this.getKeyForNodeData(e);if(void 0!==s){i.add(s);const t=this.findNodeDataForKey(s);if(t===e)continue;if(null!==t)this.assignAllDataProperties(t,e),this.sg(e,t);else{const t=this.cloneDeep(e);this.setKeyForNodeData(t,s),this.addNodeData(t)}}else{const t=this.cloneDeep(e);this.addNodeData(t),i.add(this.getKeyForNodeData(t))}}const n=e.iterator;for(;n.next();){const t=n.value;if(!i.has(t)){const e=this.findNodeDataForKey(t);e&&this.removeNodeData(e)}}}Dy(t,e){if(void 0===e)return;const i=this.My(t);i instanceof u&&this.Wo.set(e,i)}zN(){}ng(t){}og(t){}Fy(t){}Js(t,e){if(void 0===t)return;let i=this.Wo.get(t);null===i&&(i=new u,this.Wo.set(t,i)),i.add(e)}Ws(t,e){if(void 0===t)return;const i=this.Wo.get(t);i instanceof u&&(null==e?this.Wo.delete(t):(i.delete(e),0===i.count&&this.Wo.delete(t)))}My(t){if(void 0===t)return null;const e=this.Wo.get(t);return e instanceof u?e:null}vE(t){void 0===t?this.Wo.clear():this.Wo.delete(t)}get copyNodeDataFunction(){return this.Ff}set copyNodeDataFunction(t){const i=this.Ff;i!==t&&(null!==t&&e.k(t,ti,"copyNodeDataFunction"),this.Ff=t,this.t("copyNodeDataFunction",i,t))}get copiesArrays(){return this.Zd}set copiesArrays(t){const i=this.Zd;i!==t&&(null!==t&&e.s(t,"boolean",ti,"copiesArrays"),this.Zd=t,this.t("copiesArrays",i,t))}get copiesArrayObjects(){return this.Qd}set copiesArrayObjects(t){const i=this.Qd;i!==t&&(null!==t&&e.s(t,"boolean",ti,"copiesArrayObjects"),this.Qd=t,this.t("copiesArrayObjects",i,t))}get copiesKey(){return this._d}set copiesKey(t){const i=this._d;i!==t&&(null!==t&&e.s(t,"boolean",ti,"copiesKey"),this._d=t,this.t("copiesKey",i,t))}copyNodeData(t){if(null===t)return null;let i=null;const s=this.Ff;return i=null!==s?s(t,this):this.X1(t,!0),e.K(i),i}X1(t,i){if(e.K(t)){if(Array.isArray(t)){if(this.copiesArrays){const e=t,i=[];for(let t=0;t<e.length;t++){const s=e[t],n=this.X1(s,this.copiesArrayObjects);i.push(n)}return i}return t}if(t instanceof y||t instanceof v||t instanceof x||t instanceof b||t instanceof w)return t.copy();if(i){const i=t,s=i.constructor,n=s?new s:{},o=this.copiesKey||"string"!=typeof this.nodeKeyProperty?null:this.nodeKeyProperty;for(const t in i){if("__gohashid"===t){n.__gohashid=void 0;continue}if(t===o){n[o]=void 0;continue}const s=this.yt(i,t);if(e.K(s))if(ti.vN(i,t,s))this.Z(n,t,s);else{const e=this.X1(s,!1);this.Z(n,t,e)}else n[t]=s}return n}return t}return t}get afterCopyFunction(){return this.tg}set afterCopyFunction(t){const i=this.tg;i!==t&&(null!==t&&e.k(t,ti,"afterCopyFunction"),this.tg=t,this.t("afterCopyFunction",i,t))}static vN(t,i,s){const n=e.Dn(s);return s instanceof ti||s instanceof E||s instanceof R||s instanceof F||s instanceof Tt||s instanceof ae||s instanceof vt||s instanceof EventTarget||"Layer"===n||"RowColumnDefinition"===n||n.indexOf("Animation")>=0||n.indexOf("Tool")>=0||n.indexOf("CommandHandler")>=0||n.indexOf("Layout")>=0}static nD=!1;setDataProperty(t,i,s){if(this.containsNodeData(t)){if(i===this.nodeKeyProperty)return void this.setKeyForNodeData(t,s);if(i===this.nodeCategoryProperty)return void this.setCategoryForNodeData(t,s)}else!ti.nD&&t instanceof Tt&&(ti.nD=!0,e.ni('Model.setDataProperty is modifying a GraphObject, "'+t.toString()+'"'),e.ni("  Is that really your intent?"));const n=this.yt(t,i);n!==s&&(this.Z(t,i,s),this.raiseDataChanged(t,i,n,s))}set(t,e,i){this.setDataProperty(t,e,i)}assignAllDataProperties(t,e){if(!e)return;const i=this.containsNodeData(t);for(const s in e)"__gohashid"!==s&&(i&&s===this.nodeKeyProperty||this.setDataProperty(t,s,e[s]))}addArrayItem(t,e){this.insertArrayItem(t,-1,e)}insertArrayItem(t,e,i){e<0&&(e=t.length),t=this.Jo(t,e,i),this.vt("",3,"",t,null,i,null,e)}removeArrayItem(t,i){void 0===i&&(i=-1),t===this.Te&&e.o("Model.removeArrayItem should not be called on the Model.nodeDataArray"),-1===i&&(i=t.length-1);const s=t[i];t=this.uo(t,i),this.vt("",4,"",t,s,null,i,null)}get nodeCategoryProperty(){return this.Ga}set nodeCategoryProperty(t){const e=this.Ga;e!==t&&(this.Pn(t,ti,"nodeCategoryProperty"),this.Ga=t,this.t("nodeCategoryProperty",e,t))}getCategoryForNodeData(t){if(null===t)return"";const i=this.Ga;if(""===i)return"";const s=this.yt(t,i);return void 0===s?"":"string"==typeof s?s:void e.o("getCategoryForNodeData found a non-string category for "+t+": "+s)}setCategoryForNodeData(t,i){if(e.s(i,"string",ti,"setCategoryForNodeData:cat"),null===t)return;const s=this.Ga;if(""===s)return;if(!this.containsNodeData(t))return void this.Z(t,s,i);let n=this.yt(t,s);void 0===n&&(n=""),n!==i&&(this.Z(t,s,i),this.vt("nodeCategory",2,s,t,n,i))}sg(t,e){this.setCategoryForNodeData(e,this.getCategoryForNodeData(t))}get type(){return"Model"}pm(){return!1}mm(){return!1}Sb(){return!1}Ra(){return!1}Vw(){return!1}jc(){return!1}static CM(){return new ti}yt(t,e){return ti.yt(t,e)}static yt(t,i){if(!t||!i)return null;let s;try{e.it(i)?s=i(t):e.it(t.getAttribute)?(s=t.getAttribute(i),null===s&&(s=void 0)):s=t[i]}catch{}return s}Z(t,e,i){ti.Z(t,e,i)}static Z(t,i,s){if(t&&i){try{e.it(i)?i(t,s):e.it(t.setAttribute)?t.setAttribute(i,s):t[i]=s}catch{}return t}}VN(t,i,s){Array.isArray(t)||e.Zi(t,"Array",i,s)}iD(t,e,i){return t[e]=i,t}Jo(t,e,i){return e>=t.length?t.push(i):t.splice(e,0,i),t}uo(t,e){return e>=t.length?t.pop():t.splice(e,1),t}static UN(e){return ti.XN[e]?ti.XN[e]:void 0!==t.go&&t.go[e]?t.go[e]:null}static cl(t,e){ti.XN[e]=t}static XN={};static{ti.cl(jt,"Brush"),ti.cl(C,"Geometry"),ti.cl(b,"Margin"),ti.cl(y,"Point"),ti.cl(x,"Rect"),ti.cl(v,"Size"),ti.cl(w,"Spot"),ti.cl(ti,"Model")}}ti.fromJSON=ti.fromJson=ti.fromJson;class ei extends ti{Ps;$o;Di;Th;Rf;vf;Cl;go;mo;Ha;ja;qa;$s;Of;Sn;rg;constructor(t,e,i){if(super(),this.Ps=[],this.$o=new u,this.Di=new m,this.Th="",this.Rf=null,this.vf=null,this.Cl=null,this.go="from",this.mo="to",this.Ha="",this.ja="",this.qa="category",this.$s="",this.Of="isGroup",this.Sn="group",this.rg=!1,void 0!==e&&(this.linkDataArray=e),void 0!==t&&(Array.isArray(t)?this.nodeDataArray=t:i=t),i){Object.assign(this,i);const t=i.Changed;t&&(delete this.Changed,this.addChangedListener(t))}}cloneProtected(t){super.cloneProtected(t),t.Th=this.Th,t.Rf=this.Rf,t.vf=this.vf,t.go=this.go,t.mo=this.mo,t.Ha=this.Ha,t.ja=this.ja,t.qa=this.qa,t.$s=this.$s,t.Of=this.Of,t.Sn=this.Sn,t.rg=this.rg}clear(){this.Ps=[],this.Di.clear(),this.$o.clear(),super.clear()}toString(t){if(void 0===t&&(t=0),t>=2)return this.toJson();{let e=(""!==this.name?this.name:"")+" GraphLinksModel";if(t>0){e+="\n node data:";let t=this.nodeDataArray,i=t.length,s=0;for(s=0;s<i;s++){const i=t[s];e+=" "+this.getKeyForNodeData(i)+":"+Je.toString(i)}for(e+="\n link data:",t=this.linkDataArray,i=t.length,s=0;s<i;s++){const i=t[s];e+=" "+this.Ae(i,!0)+"--\x3e"+this.Ae(i,!1)}}return e}}RN(t,e,i){if(""===this.linkKeyProperty){const t=this.skipsUndoManager;this.skipsUndoManager=!0,this.linkKeyProperty="key",this.skipsUndoManager=t}let s=super.RN(t,e,i);const n=this,o=new u,r=new u,a=new u;t.changes.each((t=>{if(t.model===n)if("linkDataArray"===t.modelChange)3===t.change?o.add(t.newValue):4===t.change&&a.add(t.oldValue);else if(n.containsLinkData(t.object))r.add(t.object);else if(null!==t.object)if(null!==t.object&&i.has(t.object))i.get(t.object).each((t=>{n.containsLinkData(t)&&r.add(t)}));else{if(t.object instanceof ti||n.containsNodeData(t.object))return;n.oD(t.object).each((t=>r.add(t)))}}));const h=new u;o.each((t=>{h.add(n.getKeyForLinkData(t)),e||r.add(t)}));const l=new u;a.each((t=>{l.add(n.getKeyForLinkData(t)),e&&r.add(t)}));const c=n.cloneDeep(r.toArray());return h.count>0&&(null===s&&(s={}),e?s.removedLinkKeys=h.toArray():s.insertedLinkKeys=h.toArray()),c.length>0&&(null===s&&(s={}),s.modifiedLinkData=c),l.count>0&&(null===s&&(s={}),e?s.insertedLinkKeys=l.toArray():s.removedLinkKeys=l.toArray()),s}eg(){const t=super.eg();let e="";return"category"!==this.linkCategoryProperty&&"string"==typeof this.linkCategoryProperty&&(e+=',\n  "linkCategoryProperty": '+this.De(this.linkCategoryProperty)),""!==this.linkKeyProperty&&"string"==typeof this.linkKeyProperty&&(e+=',\n  "linkKeyProperty": '+this.De(this.linkKeyProperty)),"from"!==this.linkFromKeyProperty&&"string"==typeof this.linkFromKeyProperty&&(e+=',\n  "linkFromKeyProperty": '+this.De(this.linkFromKeyProperty)),"to"!==this.linkToKeyProperty&&"string"==typeof this.linkToKeyProperty&&(e+=',\n  "linkToKeyProperty": '+this.De(this.linkToKeyProperty)),""!==this.linkFromPortIdProperty&&"string"==typeof this.linkFromPortIdProperty&&(e+=',\n  "linkFromPortIdProperty": '+this.De(this.linkFromPortIdProperty)),""!==this.linkToPortIdProperty&&"string"==typeof this.linkToPortIdProperty&&(e+=',\n  "linkToPortIdProperty": '+this.De(this.linkToPortIdProperty)),""!==this.linkLabelKeysProperty&&"string"==typeof this.linkLabelKeysProperty&&(e+=',\n  "linkLabelKeysProperty": '+this.De(this.linkLabelKeysProperty)),"isGroup"!==this.nodeIsGroupProperty&&"string"==typeof this.nodeIsGroupProperty&&(e+=',\n  "nodeIsGroupProperty": '+this.De(this.nodeIsGroupProperty)),"group"!==this.nodeGroupKeyProperty&&"string"==typeof this.nodeGroupKeyProperty&&(e+=',\n  "nodeGroupKeyProperty": '+this.De(this.nodeGroupKeyProperty)),t+e}Ay(t){super.Ay(t),t.linkKeyProperty&&(this.linkKeyProperty=t.linkKeyProperty),t.linkFromKeyProperty&&(this.linkFromKeyProperty=t.linkFromKeyProperty),t.linkToKeyProperty&&(this.linkToKeyProperty=t.linkToKeyProperty),t.linkFromPortIdProperty&&(this.linkFromPortIdProperty=t.linkFromPortIdProperty),t.linkToPortIdProperty&&(this.linkToPortIdProperty=t.linkToPortIdProperty),t.linkCategoryProperty&&(this.linkCategoryProperty=t.linkCategoryProperty),t.linkLabelKeysProperty&&(this.linkLabelKeysProperty=t.linkLabelKeysProperty),t.nodeIsGroupProperty&&(this.nodeIsGroupProperty=t.nodeIsGroupProperty),t.nodeGroupKeyProperty&&(this.nodeGroupKeyProperty=t.nodeGroupKeyProperty)}ON(){const t=super.ON(),e=',\n  "linkDataArray": '+this.Ah(this.linkDataArray,!0);return t+e}IN(t){super.IN(t);const e=t.linkDataArray;Array.isArray(e)&&(this.replaceJsonObjects(e),this.linkDataArray=e)}rD=',\n  "insertedLinkKeys": ';JO=',\n  "modifiedLinkData": ';lD=',\n  "removedLinkKeys": ';oD(t){const e=new u;for(let i=0;i<this.linkDataArray.length;i++){const s=this.linkDataArray[i];this.V1(t,s,s,e)}return e}BN(t,e,i){if(""===this.linkKeyProperty){const t=this.skipsUndoManager;this.skipsUndoManager=!0,this.linkKeyProperty="key",this.skipsUndoManager=t}const s=super.BN(t,e,i),n=this,o=new u,r=new u,a=new u;t.changes.each((t=>{if(t.model===n)if("linkDataArray"===t.modelChange)3===t.change?o.add(t.newValue):4===t.change&&a.add(t.oldValue);else if(n.containsLinkData(t.object))r.add(t.object);else if(null!==t.object)if(null!==t.object&&i.has(t.object))i.get(t.object).each((t=>{n.containsLinkData(t)&&r.add(t)}));else{if(t.object instanceof ti||n.containsNodeData(t.object))return;n.oD(t.object).each((t=>r.add(t)))}}));const h=new u;o.each((t=>{h.add(n.getKeyForLinkData(t)),e||r.add(t)}));const l=new u;a.each((t=>{l.add(n.getKeyForLinkData(t)),e&&r.add(t)}));let c=s;return h.count>0&&(c+=(e?this.lD:this.rD)+this.Ah(h.toArray(),!0)),r.count>0&&(c+=this.JO+this.Ah(r.toArray(),!0)),l.count>0&&(c+=(e?this.rD:this.lD)+this.Ah(l.toArray(),!0)),c}Ty(t){(void 0!==t.linkCategoryProperty&&t.linkCategoryProperty!==this.linkCategoryProperty||void 0!==t.linkKeyProperty&&t.linkKeyProperty!==this.linkKeyProperty||void 0!==t.linkFromKeyProperty&&t.linkFromKeyProperty!==this.linkFromKeyProperty||void 0!==t.linkToKeyProperty&&t.linkToKeyProperty!==this.linkToKeyProperty||void 0!==t.linkFromPortIdProperty&&t.linkFromPortIdProperty!==this.linkFromPortIdProperty||void 0!==t.linkToPortIdProperty&&t.linkToPortIdProperty!==this.linkToPortIdProperty||void 0!==t.linkLabelKeysProperty&&t.linkLabelKeysProperty!==this.linkLabelKeysProperty||void 0!==t.nodeIsGroupProperty&&t.nodeIsGroupProperty!==this.nodeIsGroupProperty||void 0!==t.nodeGroupKeyProperty&&t.nodeGroupKeyProperty!==this.nodeGroupKeyProperty)&&e.o("applyIncrementalJson cannot change Model properties"),super.Ty(t);const i=t.insertedLinkKeys;if(Array.isArray(i)){const t=i.length;for(let e=0;e<t;e++){const t=i[e];let s=this.findLinkDataForKey(t);null===s&&(s=this.copyLinkData({}),this.setKeyForLinkData(s,t),this.addLinkData(s))}}const s=t.modifiedLinkData;if(Array.isArray(s)){const t=s.length;for(let e=0;e<t;e++){const t=s[e],i=this.getKeyForLinkData(t),n=this.findLinkDataForKey(i);if(null!==n){for(const e in t)"__gohashid"===e||e===this.linkKeyProperty||this.setDataProperty(n,e,t[e]);this.hD(t,n)}}}const n=t.removedLinkKeys;if(Array.isArray(n)){const t=n.length;for(let e=0;e<t;e++){const t=n[e],i=this.findLinkDataForKey(t);null!==i&&this.removeLinkData(i)}}}changeState(t,i){if(null!==t&&t.model===this){if(2===t.change){const e=t.object,s=t.propertyName;if(s===this.linkKeyProperty&&this.containsLinkData(e)){const n=t.getValue(i),o=t.getValue(!i);return void 0!==o&&this.Di.delete(o),void 0!==n&&this.Di.set(n,e),void this.Z(e,s,n)}}else if(3===t.change){let s=t.newParam;if("linkDataArray"===t.modelChange){const n=t.newValue;if(e.K(n)&&"number"==typeof s){const t=this.getKeyForLinkData(n);i?(this.$o.delete(n),this.Ps[s]===n&&this.uo(this.linkDataArray,s),void 0!==t&&this.Di.delete(t)):(this.$o.add(n),this.Ps[s]!==n&&this.Jo(this.Ps,s,n),void 0!==t&&this.Di.set(t,n))}return}if("linkLabelKeys"===t.modelChange){const e=t.object,n=this.getLabelKeysForLinkData(e);return void(Array.isArray(n)&&"number"==typeof s&&(i?(s=n.indexOf(t.newValue),s>=0&&this.uo(n,s)):n.indexOf(t.newValue)<0&&this.Jo(n,s,t.newValue)))}}else if(4===t.change){let s=t.oldParam;if("linkDataArray"===t.modelChange){const n=t.oldValue;if(e.K(n)&&"number"==typeof s){const t=this.getKeyForLinkData(n);i?(this.$o.add(n),this.Ps[s]!==n&&this.Jo(this.Ps,s,n),void 0!==t&&this.Di.set(t,n)):(this.$o.delete(n),this.Ps[s]===n&&this.uo(this.linkDataArray,s),void 0!==t&&this.Di.delete(t))}return}if("linkLabelKeys"===t.modelChange){const e=t.object,n=this.getLabelKeysForLinkData(e);return void(Array.isArray(n)&&"number"==typeof s&&(i?n.indexOf(t.oldValue)<0&&this.Jo(n,s,t.oldValue):(s=n.indexOf(t.oldValue),s>=0&&this.uo(n,s))))}}super.changeState(t,i)}}get archetypeNodeData(){return this.Cl}set archetypeNodeData(t){const i=this.Cl;i!==t&&(null!==t&&e.ec(t,ei,"archetypeNodeData"),this.Cl=t,this.t("archetypeNodeData",i,t))}YN(t){if(void 0===t)return;const e=this.Cl;if(null!==e){let i=this.findNodeDataForKey(t);null===i&&(i=this.copyNodeData(e),this.Z(i,this.nodeKeyProperty,t),this.addNodeData(i))}return t}get linkFromKeyProperty(){return this.go}set linkFromKeyProperty(t){const e=this.go;e!==t&&(this.Pn(t,ei,"linkFromKeyProperty"),this.go=t,this.t("linkFromKeyProperty",e,t))}getFromKeyForLinkData(t){return this.Ae(t,!0)}setFromKeyForLinkData(t,e){this.Wd(t,e,!0)}get linkToKeyProperty(){return this.mo}set linkToKeyProperty(t){const e=this.mo;e!==t&&(this.Pn(t,ei,"linkToKeyProperty"),this.mo=t,this.t("linkToKeyProperty",e,t))}getToKeyForLinkData(t){return this.Ae(t,!1)}setToKeyForLinkData(t,e){this.Wd(t,e,!1)}Ae(t,i){if(null===t)return;const s=i?this.go:this.mo;if(""===s)return;const n=this.yt(t,s);if(void 0!==n){if(this.isKeyType(n))return n;e.o((i?"FromKey":"ToKey")+" value for link data "+t+" is not a number or a string: "+n)}}Wd(t,i,s){if(null===i&&(i=void 0),void 0!==i&&!this.isKeyType(i)&&e.Zi(i,"number or string",ei,s?"setFromKeyForLinkData:key":"setToKeyForLinkData:key"),null===t)return;const n=s?this.go:this.mo;if(""===n)return;if(i=this.YN(i),!this.containsLinkData(t))return void this.Z(t,n,i);const o=this.yt(t,n);o!==i&&(this.Ws(o,t),this.Z(t,n,i),null===this.findNodeDataForKey(i)&&this.Js(i,t),this.vt(s?"linkFromKey":"linkToKey",2,n,t,o,i),"string"==typeof n&&this.updateTargetBindings(t,n))}get linkFromPortIdProperty(){return this.Ha}set linkFromPortIdProperty(t){const e=this.Ha;e!==t&&(this.Pn(t,ei,"linkFromPortIdProperty"),this.Ha=t,this.t("linkFromPortIdProperty",e,t))}getFromPortIdForLinkData(t){return this.O1(t,!0)}setFromPortIdForLinkData(t,e){this.Jd(t,e,!0)}get linkToPortIdProperty(){return this.ja}set linkToPortIdProperty(t){const e=this.ja;e!==t&&(this.Pn(t,ei,"linkToPortIdProperty"),this.ja=t,this.t("linkToPortIdProperty",e,t))}getToPortIdForLinkData(t){return this.O1(t,!1)}setToPortIdForLinkData(t,e){this.Jd(t,e,!1)}O1(t,e){if(null===t)return"";const i=e?this.Ha:this.ja;if(""===i)return"";const s=this.yt(t,i);return void 0===s?"":s}Jd(t,i,s){if(e.s(i,"string",ei,s?"setFromPortIdForLinkData:portname":"setToPortIdForLinkData:portname"),null===t)return;const n=s?this.Ha:this.ja;if(""===n)return;if(!this.containsLinkData(t))return void this.Z(t,n,i);let o=this.yt(t,n);void 0===o&&(o=""),o!==i&&(this.Z(t,n,i),this.vt(s?"linkFromPortId":"linkToPortId",2,n,t,o,i),"string"==typeof n&&this.updateTargetBindings(t,n))}get linkLabelKeysProperty(){return this.$s}set linkLabelKeysProperty(t){const e=this.$s;e!==t&&(this.Pn(t,ei,"linkLabelKeysProperty"),this.$s=t,this.t("linkLabelKeysProperty",e,t))}getLabelKeysForLinkData(t){if(null===t)return ei.EmptyArray;const e=this.$s;if(""===e)return ei.EmptyArray;const i=this.yt(t,e);return void 0===i?ei.EmptyArray:i}setLabelKeysForLinkData(t,e){if(this.VN(e,ei,"setLabelKeysForLinkData:arr"),null===t)return;const i=this.$s;if(""===i)return;if(!this.containsLinkData(t))return void this.Z(t,i,e);let s=this.yt(t,i);if(void 0===s&&(s=ei.EmptyArray),s!==e){if(Array.isArray(s)){const e=s.length;for(let i=0;i<e;i++){const e=s[i];this.Ws(e,t)}}this.Z(t,i,e);const n=e.length;for(let i=0;i<n;i++){const s=e[i];null===this.findNodeDataForKey(s)&&this.Js(s,t)}this.vt("linkLabelKeys",2,i,t,s,e),"string"==typeof i&&this.updateTargetBindings(t,i)}}addLabelKeyForLinkData(t,i){if(null==i||(this.isKeyType(i)||e.Zi(i,"number or string",ei,"addLabelKeyForLinkData:key"),null===t))return;const s=this.$s;if(""===s)return;const n=this.yt(t,s);if(void 0===n){const e=[];e.push(i),this.setLabelKeysForLinkData(t,e)}else if(Array.isArray(n)){let e=n.indexOf(i);if(e>=0)return;e=n.length,n.push(i),this.containsLinkData(t)&&(null===this.findNodeDataForKey(i)&&this.Js(i,t),this.vt("linkLabelKeys",3,s,t,null,i,null,e))}else e.o(s+" property is not an Array; cannot addLabelKeyForLinkData: "+t)}removeLabelKeyForLinkData(t,i){if(null==i||(this.isKeyType(i)||e.Zi(i,"number or string",ei,"removeLabelKeyForLinkData:key"),null===t))return;const s=this.$s;if(""===s)return;const n=this.yt(t,s);if(Array.isArray(n)){const e=n.indexOf(i);if(e<0)return;this.uo(n,e),this.containsLinkData(t)&&(this.Ws(i,t),this.vt("linkLabelKeys",4,s,t,i,null,e,null))}else void 0!==n&&e.o(s+" property is not an Array; cannot removeLabelKeyforLinkData: "+t)}get linkDataArray(){return this.Ps}set linkDataArray(t){const i=this.Ps;if(i!==t){this.VN(t,ei,"linkDataArray"),this.Di.clear();const s=t.length;for(let i=0;i<s;i++){const s=t[i];e.K(s)||e.o("GraphLinksModel.linkDataArray must only contain Objects, not: "+s)}if(this.Ps=t,""!==this.linkKeyProperty){const e=new h;for(let n=0;n<s;n++){const i=t[n],s=this.getKeyForLinkData(i);void 0===s||null!==this.Di.get(s)?e.add(i):this.Di.set(s,i)}const i=e.iterator;for(;i.next();){const t=i.value;this.makeLinkDataKeyUnique(t);const e=this.getKeyForLinkData(t);void 0!==e&&this.Di.set(e,t)}}const n=new u;for(let e=0;e<s;e++){const i=t[e];n.add(i)}this.$o=n,this.vt("linkDataArray",2,"linkDataArray",this,i,t);for(let e=0;e<s;e++){const i=t[e];this.KN(i)}}}get linkKeyProperty(){return this.Th}set linkKeyProperty(t){const e=this.Th;if(e!==t){this.Pn(t,ei,"linkKeyProperty"),this.Th=t,this.Di.clear();const i=this.linkDataArray.length;for(let t=0;t<i;t++){const e=this.linkDataArray[t];let i=this.getKeyForLinkData(e);void 0===i&&(this.makeLinkDataKeyUnique(e),i=this.getKeyForLinkData(e)),void 0!==i&&this.Di.set(i,e)}this.t("linkKeyProperty",e,t)}}getKeyForLinkData(t){if(null===t)return;const i=this.Th;if(""===i)return;const s=this.yt(t,i);if(void 0!==s){if(this.isKeyType(s))return s;e.o("Key value for link data "+t+" is not a number or a string: "+s)}}setKeyForLinkData(t,i){if((null==i||!this.isKeyType(i))&&e.Zi(i,"number or string",ei,"setKeyForLinkData:key"),null===t)return;const s=this.Th;if(""===s)return;if(!this.containsLinkData(t))return void this.Z(t,s,i);const n=this.yt(t,s);if(n!==i){if(null!==this.findLinkDataForKey(i))return;this.Z(t,s,i),void 0!==n&&this.Di.delete(n),this.Di.set(i,t),this.vt("linkKey",2,s,t,n,i),"string"==typeof s&&this.updateTargetBindings(t,s)}}get makeUniqueLinkKeyFunction(){return this.Rf}set makeUniqueLinkKeyFunction(t){const i=this.Rf;i!==t&&(null!==t&&e.k(t,ei,"makeUniqueLinkKeyFunction"),this.Rf=t,this.t("makeUniqueLinkKeyFunction",i,t))}findLinkDataForKey(t){return null===t&&e.o("GraphLinksModel.findLinkDataForKey:key must not be null"),void 0!==t&&this.isKeyType(t)?this.Di.get(t):null}Y1(t){return void 0!==t&&this.Di.has(t)}makeLinkDataKeyUnique(t){if(null===t)return;const e=this.Th;if(""===e)return;let i=this.getKeyForLinkData(t);if(void 0!==i&&!this.Y1(i))return;const s=this.Rf;if(null===s||(i=s(this,t),null==i||this.Y1(i))){if("string"==typeof i){let s=2;for(;this.Y1(i+s);)s++;this.Z(t,e,i+s)}else if(void 0===i||"number"==typeof i){let i=-this.Di.count-1;for(;this.Y1(i);)i--;this.Z(t,e,i)}}else this.Z(t,e,i)}containsLinkData(t){return null!==t&&this.$o.has(t)}addLinkData(t){null!==t&&(this.containsLinkData(t)||this.HT(t,!0))}HT(t,i){if(""!==this.linkKeyProperty){let i=this.getKeyForLinkData(t);if(void 0===i)this.makeLinkDataKeyUnique(t),i=this.getKeyForLinkData(t);else{if(this.Di.get(i)===t)return;this.makeLinkDataKeyUnique(t),i=this.getKeyForLinkData(t)}void 0===i&&e.o("GraphLinksModel.makeLinkDataKeyUnique failed on "+t+". Data not added to model."),this.Di.set(i,t)}this.$o.add(t);let s=null;i&&(s=this.Ps.length,this.Jo(this.Ps,s,t)),this.vt("linkDataArray",3,"linkDataArray",this,null,t,null,s),this.KN(t)}addLinkDataCollection(t){if(Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++)this.addLinkData(t[i])}else{const e=t.iterator;for(;e.next();){const t=e.value;this.addLinkData(t)}}}removeLinkData(t){null!==t&&this.GT(t,!0)}GT(t,e){this.$o.delete(t);const i=this.getKeyForLinkData(t);void 0!==i&&this.Di.delete(i);let s=null;if(e){if(s=this.Ps.indexOf(t),s<0)return;this.uo(this.Ps,s)}this.vt("linkDataArray",4,"linkDataArray",this,t,null,s,null),this.$O(t)}removeLinkDataCollection(t){if(Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++)this.removeLinkData(t[i])}else{const e=t.iterator;for(;e.next();){const t=e.value;this.removeLinkData(t)}}}mergeLinkDataArray(t){if(""===this.linkKeyProperty&&e.o("GraphLinksModel.linkKeyProperty must not be an empty string for .mergeLinkDataArray() to succeed."),t===this.linkDataArray||!Array.isArray(t))return;const i=new u;i.addAll(this.Di.iteratorKeys);const s=new u,n=t.length;for(let e=0;e<n;e++){const i=t[e],n=this.getKeyForLinkData(i);if(void 0!==n){s.add(n);const t=this.findLinkDataForKey(n);if(t===i)continue;if(null!==t)this.assignAllDataProperties(t,i),this.hD(i,t);else{const t=this.cloneDeep(i);this.setKeyForLinkData(t,n),this.addLinkData(t)}}else{const t=this.cloneDeep(i);this.addLinkData(t),s.add(this.getKeyForLinkData(t))}}const o=i.iterator;for(;o.next();){const t=o.value;if(!s.has(t)){const e=this.findLinkDataForKey(t);e&&this.removeLinkData(e)}}}KN(t){let e=this.Ae(t,!0);e=this.YN(e),null===this.findNodeDataForKey(e)&&this.Js(e,t),e=this.Ae(t,!1),e=this.YN(e),null===this.findNodeDataForKey(e)&&this.Js(e,t);const i=this.getLabelKeysForLinkData(t);if(Array.isArray(i)){const s=i.length;for(let n=0;n<s;n++)e=i[n],null===this.findNodeDataForKey(e)&&this.Js(e,t)}}$O(t){let e=this.Ae(t,!0);this.Ws(e,t),e=this.Ae(t,!1),this.Ws(e,t);const i=this.getLabelKeysForLinkData(t);if(Array.isArray(i)){const s=i.length;for(let n=0;n<s;n++)e=i[n],this.Ws(e,t)}}get copyLinkDataFunction(){return this.vf}set copyLinkDataFunction(t){const i=this.vf;i!==t&&(null!==t&&e.k(t,ei,"copyLinkDataFunction"),this.vf=t,this.t("copyLinkDataFunction",i,t))}copyLinkData(t){if(null===t)return null;let i=null;const s=this.vf;return i=null!==s?s(t,this):this.X1(t,!0),e.K(i)&&(""!==this.go&&this.Z(i,this.go,void 0),""!==this.mo&&this.Z(i,this.mo,void 0),""!==this.$s&&this.Z(i,this.$s,[])),i}get nodeIsGroupProperty(){return this.Of}set nodeIsGroupProperty(t){const e=this.Of;e!==t&&(this.Pn(t,ei,"nodeIsGroupProperty"),this.Of=t,this.t("nodeIsGroupProperty",e,t))}isGroupForNodeData(t){if(null===t)return!1;const e=this.Of;return""!==e&&!!this.yt(t,e)}isGroupForData(t){return this.isGroupForNodeData(t)}get nodeGroupKeyProperty(){return this.Sn}set nodeGroupKeyProperty(t){const e=this.Sn;e!==t&&(this.Pn(t,ei,"nodeGroupKeyProperty"),this.Sn=t,this.t("nodeGroupKeyProperty",e,t))}get copiesGroupKeyOfNodeData(){return this.rg}set copiesGroupKeyOfNodeData(t){this.rg!==t&&(e.s(t,"boolean",ei,"copiesGroupKeyOfNodeData"),this.rg=t)}getGroupKeyForNodeData(t){if(null===t)return;const i=this.Sn;if(""===i)return;const s=this.yt(t,i);if(void 0!==s){if(this.isKeyType(s))return s;e.o("GroupKey value for node data "+t+" is not a number or a string: "+s)}}getGroupForData(t){return this.getGroupKeyForNodeData(t)}setGroupKeyForNodeData(t,i){if(null===i&&(i=void 0),void 0!==i&&!this.isKeyType(i)&&e.Zi(i,"number or string",ei,"setGroupKeyForNodeData:key"),null===t)return;const s=this.Sn;if(""===s)return;if(!this.containsNodeData(t))return void this.Z(t,s,i);const n=this.yt(t,s);n!==i&&(this.Ws(n,t),this.Z(t,s,i),null===this.findNodeDataForKey(i)&&this.Js(i,t),this.vt("nodeGroupKey",2,s,t,n,i),"string"==typeof s&&this.updateTargetBindings(t,s))}setGroupForData(t,e){this.setGroupKeyForNodeData(t,e)}copyNodeData(t){if(null===t)return null;const e=super.copyNodeData(t);return!this.copiesGroupKeyOfNodeData&&""!==this.Sn&&void 0!==this.yt(e,this.Sn)&&this.Z(e,this.Sn,void 0),e}setDataProperty(t,e,i){if(this.containsNodeData(t)){if(e===this.nodeKeyProperty)return void this.setKeyForNodeData(t,i);if(e===this.nodeCategoryProperty)return void this.setCategoryForNodeData(t,i);if(e===this.nodeGroupKeyProperty)return void this.setGroupKeyForNodeData(t,i)}else if(this.containsLinkData(t)){if(e===this.linkFromKeyProperty)return void this.Wd(t,i,!0);if(e===this.linkToKeyProperty)return void this.Wd(t,i,!1);if(e===this.linkFromPortIdProperty)return void this.Jd(t,i,!0);if(e===this.linkToPortIdProperty)return void this.Jd(t,i,!1);if(e===this.linkKeyProperty)return void this.setKeyForLinkData(t,i);if(e===this.linkCategoryProperty)return void this.setCategoryForLinkData(t,i);if(e===this.linkLabelKeysProperty)return void this.setLabelKeysForLinkData(t,i)}const s=this.yt(t,e);s!==i&&(this.Z(t,e,i),this.raiseDataChanged(t,e,s,i))}assignAllDataProperties(t,e){if(!e)return;const i=this.containsNodeData(t),s=this.containsLinkData(t);for(const n in e)if("__gohashid"!==n&&(!i||n!==this.nodeKeyProperty)){if(i&&n===this.nodeIsGroupProperty&&this.yt(t,n)===e[n])continue;if(s&&n===this.linkKeyProperty)continue;this.setDataProperty(t,n,e[n])}}Dy(t,e){super.Dy(t,e);const i=this.mi.iterator;for(;i.next();){const s=i.value;this.GN(s,t,e)}const s=this.$o.iterator;for(;s.next();){const i=s.value;this.ZO(i,t,e)}}GN(t,e,i){if(this.getGroupKeyForNodeData(t)===e){const s=this.Sn;this.Z(t,s,i),this.vt("nodeGroupKey",2,s,t,e,i),"string"==typeof s&&this.updateTargetBindings(t,s)}}ZO(t,e,i){if(this.Ae(t,!0)===e){const s=this.go;this.Z(t,s,i),this.vt("linkFromKey",2,s,t,e,i),"string"==typeof s&&this.updateTargetBindings(t,s)}if(this.Ae(t,!1)===e){const s=this.mo;this.Z(t,s,i),this.vt("linkToKey",2,s,t,e,i),"string"==typeof s&&this.updateTargetBindings(t,s)}const s=this.getLabelKeysForLinkData(t);if(Array.isArray(s)){const n=s.length,o=this.$s;for(let r=0;r<n;r++)s[r]===e&&(this.iD(s,r,i),this.vt("linkLabelKeys",3,o,t,e,i,r,r))}}zN(){super.zN();const t=this.linkDataArray,e=t.length;for(let i=0;i<e;i++){const e=t[i];this.KN(e)}}ng(t){super.ng(t);const i=this.getKeyForNodeData(t),s=this.My(i);if(null!==s){const t=e.et(),n=s.iterator;for(;n.next();){const e=n.value;if(this.containsNodeData(e)){if(this.getGroupKeyForNodeData(e)===i){const s=this.Sn;this.vt("nodeGroupKey",2,s,e,i,i),"string"==typeof s&&this.updateTargetBindings(e,s),t.push(e)}}else{if(this.Ae(e,!0)===i){const s=this.go;this.vt("linkFromKey",2,s,e,i,i),"string"==typeof s&&this.updateTargetBindings(e,s),t.push(e)}if(this.Ae(e,!1)===i){const s=this.mo;this.vt("linkToKey",2,s,e,i,i),"string"==typeof s&&this.updateTargetBindings(e,s),t.push(e)}const s=this.getLabelKeysForLinkData(e);if(Array.isArray(s)){const n=s.length,o=this.$s;for(let r=0;r<n;r++)s[r]===i&&(this.vt("linkLabelKeys",3,o,e,i,i,r,r),t.push(e))}}}for(let e=0;e<t.length;e++)this.Ws(i,t[e]);e.J(t)}}og(t){super.og(t);const e=this.getGroupKeyForNodeData(t);null===this.findNodeDataForKey(e)&&this.Js(e,t)}Fy(t){super.Fy(t);const e=this.getGroupKeyForNodeData(t);this.Ws(e,t)}get linkCategoryProperty(){return this.qa}set linkCategoryProperty(t){const e=this.qa;e!==t&&(this.Pn(t,ei,"linkCategoryProperty"),this.qa=t,this.t("linkCategoryProperty",e,t))}getCategoryForLinkData(t){if(null===t)return"";const i=this.qa;if(""===i)return"";const s=this.yt(t,i);return void 0===s?"":"string"==typeof s?s:void e.o("getCategoryForLinkData found a non-string category for "+t+": "+s)}getLinkCategoryForData(t){return this.getCategoryForLinkData(t)}setCategoryForLinkData(t,i){if(e.s(i,"string",ei,"setCategoryForLinkData:cat"),null===t)return;const s=this.qa;if(""===s)return;if(!this.containsLinkData(t))return void this.Z(t,s,i);let n=this.yt(t,s);void 0===n&&(n=""),n!==i&&(this.Z(t,s,i),this.vt("linkCategory",2,s,t,n,i),"string"==typeof s&&this.updateTargetBindings(t,s))}setLinkCategoryForData(t,e){this.setCategoryForLinkData(t,e)}sg(t,e){super.sg(t,e),this.setGroupKeyForNodeData(e,this.getGroupKeyForNodeData(t))}hD(t,e){this.setCategoryForLinkData(e,this.getCategoryForLinkData(t)),this.setFromKeyForLinkData(e,this.getFromKeyForLinkData(t)),this.setToKeyForLinkData(e,this.getToKeyForLinkData(t)),this.setLabelKeysForLinkData(e,this.getLabelKeysForLinkData(t)),this.setFromPortIdForLinkData(e,this.getFromPortIdForLinkData(t)),this.setToPortIdForLinkData(e,this.getToPortIdForLinkData(t))}get type(){return"GraphLinksModel"}mm(){return!0}Ra(){return!0}Vw(){return!0}jc(){return!0}static EmptyArray=Object.freeze([])}ti.cl(ei,"GraphLinksModel"),ti.tD=()=>new ei,ti.CM=()=>new ei;class ii extends ti{Mn;lg;Wa;constructor(t,e){if(super(),this.Mn="parent",this.lg=!1,this.Wa="parentLinkCategory",void 0!==t&&(Array.isArray(t)?this.nodeDataArray=t:e=t),e){Object.assign(this,e);const t=e.Changed;t&&(delete this.Changed,this.addChangedListener(t))}}cloneProtected(t){super.cloneProtected(t),t.Mn=this.Mn,t.lg=this.lg,t.Wa=this.Wa}toString(t){if(void 0===t&&(t=0),t>=2)return this.toJson();{let e=(""!==this.name?this.name:"")+" TreeModel";if(t>0){e+="\n node data:";const t=this.nodeDataArray,i=t.length;for(let s=0;s<i;s++){const i=t[s];e+=" "+this.getKeyForNodeData(i)+":"+Je.toString(i)}}return e}}eg(){const t=super.eg();let e="";return"parent"!==this.nodeParentKeyProperty&&"string"==typeof this.nodeParentKeyProperty&&(e+=',\n  "nodeParentKeyProperty": '+this.De(this.nodeParentKeyProperty)),t+e}Ay(t){super.Ay(t),t.nodeParentKeyProperty&&(this.nodeParentKeyProperty=t.nodeParentKeyProperty)}Ty(t){void 0!==t.nodeParentKeyProperty&&t.nodeParentKeyProperty!==this.nodeParentKeyProperty&&e.o("applyIncrementalJson cannot change Model properties"),super.Ty(t)}maybeEnsureLinkReference(t){return t}get nodeParentKeyProperty(){return this.Mn}set nodeParentKeyProperty(t){const e=this.Mn;e!==t&&(this.Pn(t,ii,"nodeParentKeyProperty"),this.Mn=t,this.t("nodeParentKeyProperty",e,t))}get copiesParentKeyOfNodeData(){return this.lg}set copiesParentKeyOfNodeData(t){this.lg!==t&&(e.s(t,"boolean",ii,"copiesParentKeyOfNodeData"),this.lg=t)}getParentKeyForNodeData(t){if(null===t)return;const i=this.Mn;if(""===i)return;const s=this.yt(t,i);if(void 0!==s){if(this.isKeyType(s))return s;e.o("ParentKey value for node data "+t+" is not a number or a string: "+s)}}setParentKeyForNodeData(t,i){if(null===i&&(i=void 0),void 0!==i&&!this.isKeyType(i)&&e.Zi(i,"number or string",ii,"setParentKeyForNodeData:key"),null===t)return;const s=this.Mn;if(""===s)return;if(i=this.maybeEnsureLinkReference(i),!this.containsNodeData(t))return void this.Z(t,s,i);const n=this.yt(t,s);n!==i&&(this.Ws(n,t),this.Z(t,s,i),null===this.findNodeDataForKey(i)&&this.Js(i,t),this.vt("nodeParentKey",2,s,t,n,i),"string"==typeof s&&this.updateTargetBindings(t,s))}get parentLinkCategoryProperty(){return this.Wa}set parentLinkCategoryProperty(t){const e=this.Wa;e!==t&&(this.Pn(t,ii,"parentLinkCategoryProperty"),this.Wa=t,this.t("parentLinkCategoryProperty",e,t))}get linkCategoryProperty(){return this.parentLinkCategoryProperty}set linkCategoryProperty(t){this.parentLinkCategoryProperty=t}getParentLinkCategoryForNodeData(t){if(null===t)return"";const i=this.Wa;if(""===i)return"";const s=this.yt(t,i);return void 0===s?"":"string"==typeof s?s:void e.o("getParentLinkCategoryForNodeData found a non-string category for "+t+": "+s)}getLinkCategoryForData(t){return this.getParentLinkCategoryForNodeData(t)}setParentLinkCategoryForNodeData(t,i){if(e.s(i,"string",ii,"setParentLinkCategoryForNodeData:cat"),null===t)return;const s=this.Wa;if(""===s)return;if(!this.containsNodeData(t))return void this.Z(t,s,i);let n=this.yt(t,s);void 0===n&&(n=""),n!==i&&(this.Z(t,s,i),this.vt("parentLinkCategory",2,s,t,n,i),"string"==typeof s&&this.updateTargetBindings(t,s))}setLinkCategoryForData(t,e){this.setParentLinkCategoryForNodeData(t,e)}copyNodeData(t){if(null===t)return null;const e=super.copyNodeData(t);return!this.copiesParentKeyOfNodeData&&""!==this.Mn&&void 0!==this.yt(e,this.Mn)&&this.Z(e,this.Mn,void 0),e}setDataProperty(t,e,i){if(this.containsNodeData(t)){if(e===this.nodeKeyProperty)return void this.setKeyForNodeData(t,i);if(e===this.nodeCategoryProperty)return void this.setCategoryForNodeData(t,i);if(e===this.nodeParentKeyProperty)return void this.setParentKeyForNodeData(t,i);if(e===this.parentLinkCategoryProperty)return void this.setParentLinkCategoryForNodeData(t,i)}const s=this.yt(t,e);s!==i&&(this.Z(t,e,i),this.raiseDataChanged(t,e,s,i))}Dy(t,e){super.Dy(t,e);const i=this.mi.iterator;for(;i.next();){const s=i.value;this.GN(s,t,e)}}GN(t,e,i){if(this.getParentKeyForNodeData(t)===e){const s=this.Mn;this.Z(t,s,i),this.vt("nodeParentKey",2,s,t,e,i),"string"==typeof s&&this.updateTargetBindings(t,s)}}ng(t){super.ng(t);const i=this.getKeyForNodeData(t),s=this.My(i);if(null!==s){const t=e.et(),n=s.iterator;for(;n.next();){const e=n.value;if(this.containsNodeData(e)&&this.getParentKeyForNodeData(e)===i){const s=this.Mn;this.vt("nodeParentKey",2,s,e,i,i),"string"==typeof s&&this.updateTargetBindings(e,s),t.push(e)}}for(let e=0;e<t.length;e++)this.Ws(i,t[e]);e.J(t)}}og(t){super.og(t);let e=this.getParentKeyForNodeData(t);e=this.maybeEnsureLinkReference(e),null===this.findNodeDataForKey(e)&&this.Js(e,t)}Fy(t){super.Fy(t);const e=this.getParentKeyForNodeData(t);this.Ws(e,t)}sg(t,e){super.sg(t,e),this.setParentLinkCategoryForNodeData(e,this.getParentLinkCategoryForNodeData(t)),this.setParentKeyForNodeData(e,this.getParentKeyForNodeData(t))}get type(){return"TreeModel"}pm(){return!0}Vw(){return!0}}ti.cl(ii,"TreeModel");var si=(t=>(t[t.ConstantSpacing=0]="ConstantSpacing",t[t.ConstantDistance=1]="ConstantDistance",t[t.ConstantAngle=2]="ConstantAngle",t[t.Packed=3]="Packed",t))(si||{}),ni=(t=>(t[t.Clockwise=10]="Clockwise",t[t.Counterclockwise=11]="Counterclockwise",t[t.BidirectionalLeft=12]="BidirectionalLeft",t[t.BidirectionalRight=13]="BidirectionalRight",t))(ni||{}),oi=(t=>(t[t.Forwards=20]="Forwards",t[t.Reverse=21]="Reverse",t[t.Ascending=22]="Ascending",t[t.Descending=23]="Descending",t[t.Optimized=24]="Optimized",t))(oi||{}),ri=(t=>(t[t.Pythagorean=30]="Pythagorean",t[t.Circular=31]="Circular",t))(ri||{});class ai extends ze{le;If;K1;hg;G1;Dh;HN;jN;qN;Ss;Ry;vy;Ja;Oy;aD;ag;cg;fg;Ef;Xi;b;pe;ye;kn;ug;constructor(t){super(),this.le=0,this.If=0,this.K1=0,this.hg=360,this.G1=0,this.Dh=0,this.HN=new y,this.jN=30,this.qN=0,this.Ss=0,this.Ry=0,this.vy=new hi,this.Ja=0,this.Oy=0,this.aD=600,this.ag=NaN,this.cg=1,this.fg=0,this.Ef=360,this.Xi=0,this.b=10,this.pe=24,this.ye=$e.standardComparer,this.kn=6,this.ug=30,t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.ag=this.ag,t.cg=this.cg,t.fg=this.fg,t.Ef=this.Ef,t.Xi=this.Xi,t.b=this.b,t.pe=this.pe,t.ye=this.ye,t.kn=this.kn,t.ug=this.ug}oi(t){t in oi?this.sorting=t:t in ni?this.direction=t:t in si?this.arrangement=t:t in ri?this.nodeDiameterFormula=t:super.oi(t)}createNetwork(){return new li(this)}QO(t,e,i){t=this._O(t);let s=this.G1,n=this.jN,o=this.le,r=this.If,a=this.K1,l=this.hg,u=this.Dh,c=this.qN,d=this.Ss,f=this.Ry;if(s=this.arrangement,n=this.nodeDiameterFormula,o=this.radius,(!isFinite(o)||o<=0)&&(o=NaN),r=this.aspectRatio,(!isFinite(r)||r<=0)&&(r=1),a=this.startAngle,isFinite(a)||(a=0),l=this.sweepAngle,(!isFinite(l)||l>360||l<1)&&(l=360),u=this.spacing,isFinite(u)||(u=NaN),3===s&&31===n?s=0:3===s&&31!==n&&(n=31,s=this.arrangement),(12===this.direction||13===this.direction)&&24!==this.sorting){for(let s=0;!(s>=t.length||(e.add(t.elt(s)),s+1>=t.length));s+=2)i.add(t.elt(s+1));12===this.direction?(3===this.arrangement&&e.reverse(),t=new h,t.addAll(e),t.addAll(i)):(3===this.arrangement&&i.reverse(),t=new h,t.addAll(i),t.addAll(e))}const g=t.length;c=0;let p=0;for(let h=0;h<t.length;h++){const e=a+l*p*(10===this.direction?1:-1)/g;let i=t.elt(h).diameter;isNaN(i)&&(i=t.elt(h).Fh(e)),l<360&&(0===h||h===t.length-1)&&(i/=2),c+=i,p++}if(isNaN(o)||3===s){if(isNaN(u)&&(u=6),0!==s&&3!==s){let e=-1/0;for(let i=0;i<g;i++){const s=t.elt(i),n=t.elt(i===g-1?0:i+1);isNaN(s.diameter)&&s.Fh(0),isNaN(n.diameter)&&n.Fh(0),e=Math.max(e,(s.diameter+n.diameter)/2)}if(f=e+u,2===s){const t=2*Math.PI/g,i=(e+u)/t;r>1?(o=i,d=o*r):(d=i,o=d)}else o=this.H1(f*(l>=360?g:g-1),r,a*Math.PI/180,l*Math.PI/180)}else o=this.H1(c+(l>=360?g:g-1)*(3!==s?u:1.6*u),r,a*Math.PI/180,l*Math.PI/180);d=o*r}else{d=o*r;const e=this.WN(o,d,a*Math.PI/180,l*Math.PI/180);if(isNaN(u))0===s&&(u=(e-c)/(l>=360?g:g-1));else if(0===s){const t=(e-c)/(l>=360?g:g-1);t<u?(o=this.H1(c+u*(l>=360?g:g-1),r,a*Math.PI/180,l*Math.PI/180),d=o*r):u=t}else{let i=-1/0;for(let e=0;e<g;e++){const s=t.elt(e),n=t.elt(e===g-1?0:e+1);isNaN(s.diameter)&&s.Fh(0),isNaN(n.diameter)&&n.Fh(0),i=Math.max(i,(s.diameter+n.diameter)/2)}const s=i+u,n=this.H1(s*(l>=360?g:g-1),r,a*Math.PI/180,l*Math.PI/180);n>o?(o=n,d=o*r,f=s):f=e/(l>=360?g:g-1)}}return this.G1=s,this.jN=n,this.le=o,this.If=r,this.K1=a,this.hg=l,this.Dh=u,this.qN=c,this.Ss=d,this.Ry=f,t}doLayout(t){null===this.network&&(this.network=this.makeNetwork(t)),this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin);const e=this.network.vertexes;if(e.count<=1){if(1===e.count){const t=e.first();t.centerX=0,t.centerY=0}return this.updateParts(),this.network=null,void(this.isValidLayout=!0)}let i=new h;i.addAll(e.iterator);const s=new h,n=new h;i=this.QO(i,s,n);const o=this.G1,r=this.le,a=this.K1,l=this.hg,u=this.Dh,c=this.Ss,d=this.Ry;if(12!==this.direction&&13!==this.direction||3!==o)if(12===this.direction||13===this.direction){let t=0;switch(o){case 1:t=180*this.j1(r,c,a,d)/Math.PI;break;case 0:{let e=0,i=0;const o=s.first();null!==o&&(e=o.Fh(Math.PI/2));const h=n.first();null!==h&&(i=h.Fh(Math.PI/2)),t=180*this.j1(r,c,a,u+(e+i)/2)/Math.PI;break}case 2:t=l/i.length;break}if(12===this.direction){switch(o){case 1:this.Iy(s,l/2,a,11);break;case 0:this.Ey(s,l/2,a,11);break;case 2:this.By(s,l/2,a,11);break}switch(o){case 1:this.Iy(n,l/2,a+t,10);break;case 0:this.Ey(n,l/2,a+t,10);break;case 2:this.By(n,l/2,a+t,10);break}}else{switch(o){case 1:this.Iy(n,l/2,a,11);break;case 0:this.Ey(n,l/2,a,11);break;case 2:this.By(n,l/2,a,11);break}switch(o){case 1:this.Iy(s,l/2,a+t,10);break;case 0:this.Ey(s,l/2,a+t,10);break;case 2:this.By(s,l/2,a+t,10);break}}}else switch(o){case 1:this.Iy(i,l,a,this.direction);break;case 0:this.Ey(i,l,a,this.direction);break;case 2:this.By(i,l,a,this.direction);break;case 3:this.cD(i,l,a,this.direction);break}else this.cD(i,l,a-l/2,10);this.updateParts(),this.network=null,this.isValidLayout=!0}By(t,e,i,s){const n=this.hg,o=this.le,r=this.Ss,a=i*Math.PI/180,h=e*Math.PI/180,l=t.length;for(let u=0;u<l;u++){const e=a+(10===s?u*h/(n>=360?l:l-1):-u*h/l),i=t.elt(u),c=o*Math.tan(e)/r,d=Math.sqrt((o*o+r*r*c*c)/(1+c*c));i.centerX=d*Math.cos(e),i.centerY=d*Math.sin(e),i.actualAngle=180*e/Math.PI}}Ey(t,e,i,s){const n=this.le,o=this.Ss,r=this.Dh;let a=i*Math.PI/180;const h=t.length;for(let l=0;l<h;l++){const e=t.elt(l),i=t.elt(l===h-1?0:l+1),u=n*Math.cos(a),c=o*Math.sin(a);e.centerX=u,e.centerY=c,e.actualAngle=180*a/Math.PI,isNaN(e.diameter)&&e.Fh(0),isNaN(i.diameter)&&i.Fh(0);const d=(e.diameter+i.diameter)/2,f=this.j1(n,o,10===s?a:-a,d+r);a+=10===s?f:-f}}Iy(t,e,i,s){const n=this.le,o=this.Ss,r=this.Ry;let a=i*Math.PI/180;const h=t.length;for(let l=0;l<h;l++){const e=t.elt(l);e.centerX=n*Math.cos(a),e.centerY=o*Math.sin(a),e.actualAngle=180*a/Math.PI;const i=this.j1(n,o,10===s?a:-a,r);a+=10===s?i:-i}}cD(t,e,i,s){let n=this.Oy;const o=this.hg;if(this.Ja=0,this.vy=new hi,e<360){for(n=i+(10===s?o:-o);n<0;)n+=360;n%=360,n>180&&(n-=360),n*=Math.PI/180,this.Oy=n,this.fD(t,e,i,s)}else this.uD(t,e,i,s);this.vy.commit(t)}uD(t,e,i,s){const n=this.le,o=this.Ss,r=this.Dh,a=this.If;let h=n*Math.cos(i*Math.PI/180),l=o*Math.sin(i*Math.PI/180);const u=t.toArray();if(3===u.length)return u[0].centerX=n,u[0].centerY=0,u[1].centerX=u[0].centerX-u[0].width/2-u[1].width/2-r,u[1].y=u[0].y,u[2].centerX=(u[0].centerX+u[1].centerX)/2,void(u[2].y=u[0].y-u[2].height-r);if(4===u.length)return u[0].centerX=n,u[0].centerY=0,u[2].centerX=-u[0].centerX,u[2].centerY=u[0].centerY,u[1].centerX=0,u[1].y=Math.min(u[0].y,u[2].y)-u[1].height-r,u[3].centerX=0,void(u[3].y=Math.max(u[0].y+u[0].height+r,u[2].y+u[2].height+r));const c=y.l();for(let y=0;y<u.length&&(u[y].centerX=h,u[y].centerY=l,!(y>=u.length-1));y++)this.dD(h,l,u,y,s,c)||this.gD(h,l,u,y,s,c),h=c.x,l=c.y;if(y.e(c),this.Ja++,this.Ja>23)return;const d=u[0].centerX,f=u[0].centerY,g=u[u.length-1].centerX,p=u[u.length-1].centerY;let m=Math.abs(d-g)-((u[0].width+u[u.length-1].width)/2+r);const v=Math.abs(f-p)-((u[0].height+u[u.length-1].height)/2+r);let x=0;if(Math.abs(v)<1){const t=Math.abs(d-g),e=(u[0].width+u[u.length-1].width)/2;t<e&&(x=0),m=t-e}else x=v>0?v:Math.abs(m)<1?0:m;let b=!1;b=Math.abs(g)>Math.abs(p)?g>0!=f>p:p>0!=d<g,b=10===s?b:!b,b&&(x=-Math.abs(x),x=Math.min(x,-u[u.length-1].width),x=Math.min(x,-u[u.length-1].height)),this.vy.tI(x,u),Math.abs(x)>1&&(this.Ja<8?this.le-=x/(2*Math.PI):u.length<5&&x>10?this.le/=2:this.le-=x>0?1.7:-2.3,this.Ss=this.le*a,this.uD(t,e,i,s))}fD(t,e,i,s){const n=this.le,o=this.Ss,r=this.If;let a=n*Math.cos(i*Math.PI/180),h=o*Math.sin(i*Math.PI/180);const l=y.l(),u=t.toArray();for(let g=0;g<u.length&&(u[g].centerX=a,u[g].centerY=h,!(g>=u.length-1));g++)this.dD(a,h,u,g,s,l)||this.gD(a,h,u,g,s,l),a=l.x,h=l.y;if(y.e(l),this.Ja++,this.Ja>23)return;const c=Math.atan2(h,a);let d=10===s?this.Oy-c:c-this.Oy;d=Math.abs(d)<Math.abs(d-2*Math.PI)?d:d-2*Math.PI;const f=d*(n+o)/2;this.vy.iI(f,u),Math.abs(f)>1&&(this.Ja<8?this.le-=f/(2*Math.PI):this.le-=f>0?1.7:-2.3,this.Ss=this.le*r,this.fD(t,e,i,s))}dD(t,e,i,s,n,o){const r=this.Dh,a=this.le,h=this.Ss;let l=0,u=0;const c=(i[s].width+i[s+1].width)/2+r;let d=!1;if(e>=0!=(10===n)){if(l=t+c,l>a){if(l=t-c,l<-a)return o.x=l,o.y=u,!1;d=!0}}else if(l=t-c,l<-a){if(l=t+c,l>a)return o.x=l,o.y=u,!1;d=!0}return u=Math.sqrt(1-Math.min(1,l*l/(a*a)))*h,e<0!==d&&(u=-u),Math.abs(e-u)>(i[s].height+i[s+1].height)/2?(o.x=l,o.y=u,!1):(o.x=l,o.y=u,!0)}gD(t,e,i,s,n,o){const r=this.Dh,a=this.le,h=this.Ss;let l=0,u=0;const c=(i[s].height+i[s+1].height)/2+r;let d=!1;if(t>=0!=(10===n)){if(u=e-c,u<-h){if(u=e+c,u>h)return o.x=l,o.y=u,!1;d=!0}}else if(u=e+c,u>h){if(u=e-c,u<-h)return o.x=l,o.y=u,!1;d=!0}return l=Math.sqrt(1-Math.min(1,u*u/(h*h)))*a,t<0!==d&&(l=-l),Math.abs(t-l)>(i[s].width+i[s+1].width)/2?(o.x=l,o.y=u,!1):(o.x=l,o.y=u,!0)}commitLayout(){this.commitNodes(),this.isRouting&&this.commitLinks()}commitNodes(){const t=null!==this.group&&this.group.hasPlaceholder(),e=t?this.group.location.copy():null;let i=this.actualCenter;t?i=new y(0,0):(i.x=this.arrangementOrigin.x+this.le,i.y=this.arrangementOrigin.y+this.Ss);const s=this.network.vertexes.iterator;for(;s.next();){const t=s.value;t.x+=i.x,t.y+=i.y,t.commit()}if(t){this.group.ensureBounds();const t=this.group.position.copy(),i=this.group.location.copy(),s=e.subtract(i.subtract(t));this.group.move(s),this.HN=s.subtract(t)}}commitLinks(){const t=this.network.edges.iterator;for(;t.next();)t.value.commit()}WN(t,e,i,s){const n=this.aD;if(Math.abs(this.If-1)<.001)return void 0!==i&&void 0!==s?s*t:2*Math.PI*t;const o=t>e?Math.sqrt(t*t-e*e)/t:Math.sqrt(e*e-t*t)/e;let r=0,a=0;a=void 0!==i&&void 0!==s?s/(n+1):Math.PI/(2*(n+1));let h=0;for(let l=0;l<=n;l++){h=void 0!==i&&void 0!==s?i+l*s/n:l*Math.PI/(2*n);const t=Math.sin(h);r+=Math.sqrt(1-o*o*t*t)*a}return void 0!==i&&void 0!==s?(t>e?t:e)*r:4*(t>e?t:e)*r}H1(t,e,i,s){let n=0;return n=void 0!==i&&void 0!==s?this.WN(1,e,i,s):this.WN(1,e),t/n}j1(t,e,i,s){if(Math.abs(this.If-1)<.001)return s/t;const n=t>e?Math.sqrt(t*t-e*e)/t:Math.sqrt(e*e-t*t)/e;let o=0;const r=2*Math.PI/(700*this.network.vertexes.count);t>e&&(i+=Math.PI/2);for(let a=0;;a++){const h=i+a*r,l=Math.sin(h);if(o+=(t>e?t:e)*Math.sqrt(1-n*n*l*l)*r,o>=s)return a*r}}_O(t){switch(this.sorting){case 20:break;case 21:t.reverse();break;case 22:t.sort(this.comparer);break;case 23:t.sort(this.comparer),t.reverse();break;case 24:return this.eI(this.sI(t));default:e.o("Invalid sorting type.")}return t}sI(t){const e=[];for(let s=0;s<t.length;s++)e.push(0);const i=new h;for(let s=0;s<t.length;s++){let n=-1,o=-1;if(0===s)for(let e=0;e<t.length;e++){const i=t.elt(e).edgesCount;i>n&&(n=i,o=e)}else for(let i=0;i<t.length;i++){const t=e[i];t>n&&(n=t,o=i)}i.add(t.elt(o)),e[o]=-1;const r=t.elt(o);let a=0;const h=r.sourceEdges;for(;h.next();){const i=h.value.fromVertex;a=t.indexOf(i),!(a<0)&&e[a]>=0&&e[a]++}const l=r.destinationEdges;for(;l.next();){const i=l.value.toVertex;a=t.indexOf(i),!(a<0)&&e[a]>=0&&e[a]++}}return i}eI(t){const e=[];for(let h=0;h<t.length;h++){const i=t.elt(h);e[h]=[];let s=0;const n=i.destinationEdges;for(;n.next();){const i=n.value.toVertex;s=t.indexOf(i),s!==h&&e[h].indexOf(s)<0&&e[h].push(s)}const o=i.sourceEdges;for(;o.next();){const i=o.value.fromVertex;s=t.indexOf(i),s!==h&&e[h].indexOf(s)<0&&e[h].push(s)}}const i=[];for(let h=0;h<e.length;h++)i[h]=0;const s=[],n=[],o=[],r=[],a=new h;let l=0;for(let h=0;h<e.length;h++){const u=e[h].length;if(1===u){r.push(h);continue}if(0===u){a.add(t.elt(h));continue}if(0===l){s.push(h),l++;continue}let c=1/0,d=1/0,f=-1;const g=[];for(let t=0;t<s.length;t++)e[s[t]].indexOf(s[t===s.length-1?0:t+1])<0&&g.push(t===s.length-1?0:t+1);if(0===g.length)for(let t=0;t<s.length;t++)g.push(t);for(let t=0;t<g.length;t++){const r=g[t],a=this.nI(e[h],n,o,i,r,s);let l=0;for(let t=0;t<e[h].length;t++){const i=e[h][t],n=s.indexOf(i);if(n>=0){const t=Math.abs(r-(n>=r?n+1:n));l+=t<s.length+1-t?t:s.length+1-t}}for(let t=0;t<n.length;t++){let e=i[n[t]],a=i[o[t]];if(e>=r&&e++,a>=r&&a++,e>a){const t=a;a=e,e=t}a-e<(s.length+2)/2==(e<r&&r<=a)&&l++}(a<c||a===c&&l<d)&&(c=a,d=l,f=r)}s.splice(f,0,h);for(let t=0;t<s.length;t++)i[s[t]]=t;for(let t=0;t<e[h].length;t++){const i=e[h][t];s.indexOf(i)>=0&&(n.push(h),o.push(i))}l++}let u=!1;const c=s.length;for(;;){u=!0;for(let t=0;t<r.length;t++){const i=r[t],n=e[i][0],o=s.indexOf(n);if(o>=0){let a=0;for(let t=0;t<e[n].length;t++){const i=e[n][t],r=s.indexOf(i);if(r<0||r===o)continue;const h=r>o?r-o:o-r,l=c-h;a+=r<o!=h>l?1:-1}s.splice(a<0?o:o+1,0,i),r.splice(t,1),t--}else u=!1}if(u)break;s.push(r[0]),r.splice(0,1)}for(let h=0;h<s.length;h++){const e=s[h];a.add(t.elt(e))}return a}nI(t,e,i,s,n,o){let r=0;for(let a=0;a<e.length;a++){const h=e[a],l=i[a],u=s[h],c=s[l];let d=0,f=0;if(u<c?(d=u,f=c):(d=c,f=u),d<n&&n<=f)for(let e=0;e<t.length;e++){const i=t[e];o.indexOf(i)<0||d<s[i]&&s[i]<f||d===s[i]||f===s[i]||r++}else for(let e=0;e<t.length;e++){const i=t[e];o.indexOf(i)<0||!(d<s[i]&&s[i]<f)||d===s[i]||f===s[i]||r++}}return r}get radius(){return this.ag}set radius(t){this.ag!==t&&(e.s(t,"number",ai,"radius"),(t>0||isNaN(t))&&(this.ag=t,this.invalidateLayout()))}get aspectRatio(){return this.cg}set aspectRatio(t){this.cg!==t&&(e.s(t,"number",ai,"aspectRatio"),t>0&&(this.cg=t,this.invalidateLayout()))}get startAngle(){return this.fg}set startAngle(t){this.fg!==t&&(e.s(t,"number",ai,"startAngle"),this.fg=t,this.invalidateLayout())}get sweepAngle(){return this.Ef}set sweepAngle(t){this.Ef!==t&&(e.s(t,"number",ai,"sweepAngle"),this.Ef=t>0&&t<=360?t:360,this.invalidateLayout())}get arrangement(){return this.Xi}set arrangement(t){this.Xi!==t&&(3===t||0===t||1===t||2===t)&&(this.Xi=t,this.invalidateLayout())}get direction(){return this.b}set direction(t){this.b!==t&&(10===t||11===t||12===t||13===t)&&(this.b=t,this.invalidateLayout())}get sorting(){return this.pe}set sorting(t){this.pe!==t&&(this.pe=t,this.invalidateLayout())}get comparer(){return this.ye}set comparer(t){this.ye!==t&&(e.k(t,ai,"comparer"),this.ye=t,this.invalidateLayout())}get spacing(){return this.kn}set spacing(t){this.kn!==t&&(e.s(t,"number",ai,"spacing"),this.kn=t,this.invalidateLayout())}get nodeDiameterFormula(){return this.ug}set nodeDiameterFormula(t){this.ug!==t&&(30===t||31===t)&&(this.ug=t,this.invalidateLayout())}get actualXRadius(){return this.le}get actualYRadius(){return this.Ss}get actualSpacing(){return this.Dh}get actualCenter(){return this.HN}static ConstantSpacing=0;static ConstantDistance=1;static ConstantAngle=2;static Packed=3;static Clockwise=10;static Counterclockwise=11;static BidirectionalLeft=12;static BidirectionalRight=13;static Forwards=20;static Reverse=21;static Ascending=22;static Descending=23;static Optimized=24;static Pythagorean=30;static Circular=31}class hi{Bf;$a;Uf;constructor(){this.Bf=-1/0,this.$a=null,this.Uf=null}tI(t,e){if(t>0&&this.Bf<0||Math.abs(t)<Math.abs(this.Bf)&&!(t<0&&this.Bf>0)){this.Bf=t,this.$a=[],this.Uf=[];for(let t=0;t<e.length;t++)this.$a[t]=e[t].bounds.x,this.Uf[t]=e[t].bounds.y}}iI(t,e){if(Math.abs(t)<Math.abs(this.Bf)){this.Bf=t,this.$a=[],this.Uf=[];for(let t=0;t<e.length;t++)this.$a[t]=e[t].bounds.x,this.Uf[t]=e[t].bounds.y}}commit(t){if(null!==this.$a&&null!==this.Uf)for(let e=0;e<this.$a.length;e++){const i=t.elt(e);i.x=this.$a[e],i.y=this.Uf[e]}}}class li extends je{constructor(t){super(t)}createVertex(){return new ui(this)}createEdge(){return new ci(this)}}class ui extends $e{po;q1;constructor(t){super(t),this.po=NaN,this.q1=NaN}Fh(t){const e=this.network;if(null===e)return NaN;const i=e.layout;if(null===i)return NaN;if(3===i.arrangement){if(31===i.nodeDiameterFormula)return this.po=Math.max(this.width,this.height),this.po;{const e=Math.abs(Math.sin(t)),i=Math.abs(Math.cos(t));return 0===e?this.width:0===i?this.height:(this.po=Math.min(this.height/e,this.width/i),this.po)}}return 31===i.nodeDiameterFormula?(this.po=Math.max(this.width,this.height),this.po):(this.po=Math.sqrt(this.width*this.width+this.height*this.height),this.po)}get diameter(){return this.po}set diameter(t){this.po!==t&&(e.s(t,"number",ui,"diameter"),this.po=t)}get actualAngle(){return this.q1}set actualAngle(t){this.q1!==t&&(e.s(t,"number",ui,"actualAngle"),this.q1=t)}}class ci extends Xe{constructor(t){super(t)}}class di extends ze{Uy;Rh;Ms;dg;Nn;Fe;gg;mg;pg;Vf;yg;wg;zf;Xf;Yf;Kf;xg;bg;Gf;Za;constructor(t){super(),this.Uy=0,this.Rh=0,this.Ms=new v(100,100).u(),this.dg=!1,this.Nn=!0,this.Fe=!1,this.gg=100,this.mg=300,this.pg=1,this.Vf=1e3,this.yg=10,this.wg=Math,this.zf=.05,this.Xf=50,this.Yf=150,this.Kf=0,this.xg=10,this.bg=5,this.Gf=NaN,this.Za=10,t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.Ms.a(this.Ms),t.dg=this.dg,t.Nn=this.Nn,t.Fe=this.Fe,t.gg=this.gg,t.mg=this.mg,t.pg=this.pg,t.Vf=this.Vf,t.yg=this.yg,t.wg=this.wg,t.zf=this.zf,t.Xf=this.Xf,t.Yf=this.Yf,t.Kf=this.Kf,t.xg=this.xg,t.bg=this.bg,t.Gf=this.Gf,t.Za=this.Za}createNetwork(){return new fi(this)}doLayout(t){this.network=this.makeNetwork(t);let e=this.network.vertexes.iterator;const i=this.maxIterations;if(this.network.vertexes.count>0){for(this.network.deleteSelfEdges(),e=this.network.vertexes.iterator;e.next();){const t=e.value;t.charge=this.electricalCharge(t),t.mass=this.gravitationalMass(t)}const t=this.network.edges.iterator;for(;t.next();){const e=t.value;e.stiffness=this.springStiffness(e),e.length=this.springLength(e)}if(this.JN(),this.Rh=0,this.needsPrelayout()){const t=this.network,e=t.splitIntoSubNetworks(!1);let i=e.iterator;for(;i.next();){const t=i.value;this.doConnectedSubnetLayout(t)}for(i=e.iterator,this.oI(i,t),i=e.iterator;i.next();){const e=i.value,s=e.vertexes.iterator;for(;s.next();){const e=s.value;t.addVertex(e)}const n=e.edges.iterator;for(;n.next();){const e=n.value;t.addEdge(e)}}}else this.mD(this.network,this.maxIterations);this.updateParts()}this.maxIterations=i,this.isValidLayout=!0}needsPrelayout(){if(null===this.network||this.network.vertexes.count<3)return!1;let t=0,e=0;const i=this.network.vertexes.first().bounds,s=this.network.vertexes.iterator;for(;s.next();){const n=s.value,o=n.bounds;if(isNaN(n.x)||isNaN(n.y)||o.intersectsRect(i)&&(t++,t>2))return!0;if(e>10)return!1;e++}return!1}doConnectedSubnetLayout(t){let e=t.vertexes.iterator;for(;e.next();){const t=e.value;t.hierarchicalVertexes.add(t)}let i=t,s=this.Gf;if(isNaN(s)&&(s=t.edges.count/t.vertexes.count),s<t.vertexes.count)for(;i.vertexes.count>Math.max(100,Math.sqrt(s*t.vertexes.count));)i=this.coarsenNetwork(i);let n=0;e=i.vertexes.iterator;let o=this.randomNumberGenerator;for(null===o&&(this.randomNumberGenerator=o=new mi(0));e.next();){e.value.idInCluster=n++;const t=10*(o.random()-.5),i=10*(o.random()-.5);this.isFixed(e.value)||(e.value.x=t,e.value.y=i);const s=e.value.hierarchicalVertexes.iterator;for(;s.next();)this.isFixed(s.value)||(s.value.x=t,s.value.y=i)}const r=this.computePairwiseDistances(i);this.rI(i,r,this.maxPrelayoutIterations,t.vertexes.count),this.mD(t,this.maxIterations)}computePairwiseDistances(t){const e=t.vertexes.count,i=new Array(e);for(let r=0;r<e;r++)i[r]=new Array(e).fill(-1),i[r][r]=0;const s=t.vertexes.iterator;let n=new Map,o=[];for(;s.next();){const t=s.value;for(o=[t],n=new Map,n.set(t.idInCluster,0);o.length>0;){const t=o.shift(),e=t.vertexes.iterator;for(;e.next();){const i=e.value;n.has(i.idInCluster)||(n.set(i.idInCluster,n.get(t.idInCluster)+1),o.push(i))}}for(let s=0;s<e;s++){const e=Math.min(i[t.idInCluster][s],i[s][t.idInCluster]),o=n.get(s);(e<0||o<e)&&(i[t.idInCluster][s]=o,i[s][t.idInCluster]=o)}}return i}coarsenNetwork(t){const e=this.createNetwork(),i=new Map;let s=0,n=t.vertexes.iterator;for(;n.next();)n.value.idInCluster=s++;for(n=t.vertexes.iterator;n.next();){const t=n.value;if(i.has(t.idInCluster))continue;let s=Number.MAX_SAFE_INTEGER,o=null;const r=t.vertexes.iterator;for(;r.next();){const t=r.value;i.has(t.idInCluster)||t.hierarchicalVertexes.length<s&&(s=t.hierarchicalVertexes.length,o=t)}const a=e.createVertex();a.hierarchicalVertexes.addAll(t.hierarchicalVertexes),null!=o&&a.hierarchicalVertexes.addAll(o.hierarchicalVertexes),i.set(t.idInCluster,a),null!=o&&i.set(o.idInCluster,a),e.addVertex(a)}const o=t.edges.iterator;for(;o.next();){const t=o.value,s=i.get(t.fromVertex.idInCluster),n=i.get(t.toVertex.idInCluster);if(s===n)continue;const r=e.createEdge();r.fromVertex=s||null,r.toVertex=n||null,e.addEdge(r)}return e}Nw(t,e){let i=!0;const s=t.vertexes.iterator;for(;s.next();){const t=s.value;i?(i=!1,e.set(t.bounds)):e.unionRect(t.bounds)}return e}oI(t,i){const s=this.arrangementSpacing,n=t.count;let o=!0,r=0,a=0;const h=e.et();for(let e=0;e<n+i.vertexes.count+2;e++)h[e]=null;let l=0;t.reset();const u=x.l();let c;for(;t.next();){const e=t.value;if(this.Nw(e,u),o)o=!1,r=u.x+u.width/2,a=u.y+u.height/2,h[0]=new y(u.x+u.width+s.width,u.y),h[1]=new y(u.x,u.y+u.height+s.height),l=2;else{const t=this.pD(h,l,r,a,u.width,u.height,s),i=h[t],n=new y(i.x+u.width+s.width,i.y),o=new y(i.x,i.y+u.height+s.height);t+1<l&&h.splice(t+1,0,null),h[t]=n,h[t+1]=o,l++;const d=i.x-u.x,f=i.y-u.y;for(c=e.vertexes.iterator;c.next();){const t=c.value;this.isFixed(t)||(t.centerX+=d,t.centerY+=f)}}}for(x.e(u),c=i.vertexes.iterator;c.next();){const t=c.value,e=t.bounds;if(l<2){r=e.x+e.width/2,a=e.y+e.height/2,h[0]=new y(e.x+e.width+s.width,e.y),h[1]=new y(e.x,e.y+e.height+s.height),l=2;continue}const i=this.pD(h,l,r,a,e.width,e.height,s),n=h[i],o=new y(n.x+e.width+s.width,n.y),u=new y(n.x,n.y+e.height+s.height);i+1<l&&h.splice(i+1,0,null),h[i]=o,h[i+1]=u,l++,this.isFixed(t)||(t.centerX=n.x+t.width/2,t.centerY=n.y+t.height/2)}e.J(h)}pD(t,e,i,s,n,o,r){let a=9e19,h=-1;t:for(let l=0;l<e;l++){const u=t[l],c=u.x-i,d=u.y-s,f=c*c+d*d;if(f<a){for(let e=l-1;e>=0;e--)if(t[e].y>u.y&&t[e].x-u.x<n+r.width)continue t;for(let i=l+1;i<e;i++)if(t[i].x>u.x&&t[i].y-u.y<o+r.height)continue t;h=l,a=f}}return h}JN(){if(!this.comments)return;const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value;this.addComments(e)}}addComments(t){const e=t.node;if(null!==e){const i=e.findNodesConnected();for(;i.next();){const e=i.value;if("Comment"!==e.category||!e.isVisible())continue;let s=this.network.findVertex(e);null===s&&(s=this.network.addNode(e)),s.charge=this.defaultCommentElectricalCharge;let n=null;const o=s.destinationEdges;for(;o.next();){const e=o.value;if(e.toVertex===t){n=e;break}}if(null===n){const e=s.sourceEdges;for(;e.next();){const i=e.value;if(i.fromVertex===t){n=i;break}}}null===n&&(n=this.network.linkVertexes(t,s,null)),n.length=this.defaultCommentSpringLength}}}$N(t,e){const i=t.bounds,s=i.x,n=i.y,o=i.width,r=i.height,a=e.bounds,h=a.x,l=a.y,u=a.width,c=a.height;if(s+o<h){if(n>l+c){const t=s+o-h,e=n-l-c;return S.bw(t*t+e*e)}if(n+r<l){const t=s+o-h,e=n+r-l;return S.bw(t*t+e*e)}return h-(s+o)}if(s>h+u){if(n>l+c){const t=s-h-u,e=n-l-c;return S.bw(t*t+e*e)}if(n+r<l){const t=s-h-u,e=n+r-l;return S.bw(t*t+e*e)}return s-(h+u)}return n>l+c?n-(l+c):n+r<l?l-(n+r):.1}mD(t,e){const i=this.Rh+e;for(;this.Rh<i&&(this.Rh++,this.lI(t)););}lI(t){const e=t.vertexes.toArray();if(e.length<=0)return!1;const i=e[0];i.forceX=0,i.forceY=0;let s=i.centerX,n=s,o=i.centerY,r=o;for(let g=1;g<e.length;g++){const t=e[g];t.forceX=0,t.forceY=0;const i=t.centerX,a=t.centerY;s=Math.min(s,i),n=Math.max(n,i),o=Math.min(o,a),r=Math.max(r,a)}const a=n-s>r-o;a?e.sort(((t,e)=>null===t||null===e||t===e?0:t.centerX-e.centerX)):e.sort(((t,e)=>null===t||null===e||t===e?0:t.centerY-e.centerY));const h=this.Vf;let l=0,u=0,c=0;for(let g=0;g<e.length;g++){const t=e[g],i=t.bounds,s=t.focus,n=i.x+s.x,o=i.y+s.y;u=t.charge*this.electricalFieldX(n,o),c=t.charge*this.electricalFieldY(n,o),u+=t.mass*this.gravitationalFieldX(n,o),c+=t.mass*this.gravitationalFieldY(n,o),t.forceX+=u,t.forceY+=c;for(let r=g+1;r<e.length;r++){const i=e[r];if(!this.shouldInteract(t,i)||r===g)continue;const s=i.bounds,d=i.focus,f=s.x+d.x,p=s.y+d.y;if(n-f>h||f-n>h){if(a)break;continue}if(o-p>h||p-o>h){if(!a)break;continue}const m=this.$N(t,i),y=2*t.charge,v=2*i.charge;if(m>1)l=y*v/(m*m),u=l*(n-f)/m,c=l*(o-p)/m;else{let e=this.randomNumberGenerator;null===e&&(this.randomNumberGenerator=e=new mi(0));const s=e.random(),r=e.random();if(n>f)u=Math.abs(i.bounds.right-t.bounds.x),u=y*v*(1+u)*s;else if(n<f)u=Math.abs(i.bounds.x-t.bounds.right),u=-y*v*(1+u)*s;else{const e=Math.max(i.width,t.width);u=y*v*((1+e)*s-e/2)}if(o>p)c=Math.abs(i.bounds.bottom-t.bounds.y),c=y*v*(1+c)*r;else if(n<f)c=Math.abs(i.bounds.y-t.bounds.bottom),c=-y*v*(1+c)*r;else{const e=Math.max(i.height,t.height);c=y*v*((1+e)*r-e/2)}}t.forceX+=u,t.forceY+=c,i.forceX-=u,i.forceY-=c}}const d=t.edges.iterator;for(;d.next();){const t=d.value,e=t.fromVertex,i=t.toVertex,s=e.bounds,n=e.focus,o=s.x+n.x,r=s.y+n.y,a=i.bounds,h=i.focus,f=a.x+h.x,g=a.y+h.y,p=this.$N(e,i);p>1&&(l=.1*t.stiffness*(p-t.length),u=.5*l*(e.width+i.height)*(o-f)/p,c=.5*l*(e.width+i.height)*(r-g)/p),e.forceX-=u,e.forceY-=c,i.forceX+=u,i.forceY+=c}let f=0;for(let g=0;g<e.length;g++){const t=e[g];this.isFixed(t)?this.moveFixedVertex(t):f=Math.max(f,this.moveVertex(t)||0)}return f>this.epsilonDistance*this.epsilonDistance}rI(t,e,i,s){const n=this.Rh+i,o=Math.sqrt(s);this.Uy=this.Za*t.vertexes.count;const r=t.vertexes.toArray();let a=0,h=0,l=0;for(;this.Rh<n;){this.Rh++,h=a,a=0;for(let t=0;t<r.length;t++){r[t].forceX=0,r[t].forceY=0;for(let s=0;s<r.length;s++){if(t===s)continue;const i=this.$N(r[t],r[s]),n=e[r[t].idInCluster][r[s].idInCluster],a=(i-this.Za*o*n)/i;r[t].forceX+=a*(r[s].x-r[t].x),r[t].forceY+=a*(r[s].y-r[t].y)}const i=Math.sqrt(r[t].forceX*r[t].forceX+r[t].forceY*r[t].forceY);if(i>0){r[t].forceX=this.Uy*r[t].forceX/i,r[t].forceY=this.Uy*r[t].forceY/i,this.isFixed(r[t])||(r[t].x+=r[t].forceX,r[t].y+=r[t].forceY);const e=r[t].hierarchicalVertexes.iterator;for(;e.next();){const i=e.value;this.isFixed(i)||(i.centerX+=r[t].forceX,i.centerY+=r[t].forceY)}}a+=i*i}if(a>=h){if(l++,l>=5)break}else l=0;this.Uy*=.95}}moveVertex(t){let e=t.forceX,i=t.forceY;const s=this.moveLimit;return e<-s?e=-s:e>s&&(e=s),i<-s?i=-s:i>s&&(i=s),t.centerX+=e,t.centerY+=i,e*e+i*i}shouldInteract(t,e){return!0}moveFixedVertex(t){}commitLayout(){this.Vy(),this.commitNodes(),this.isRouting&&this.commitLinks()}Vy(){if(!this.setsPortSpots)return;const t=this.network.edges.iterator;for(;t.next();){const e=t.value.link;null!==e&&(e.fromSpot=w.Default,e.toSpot=w.Default)}}commitNodes(){let t=0,e=0;if(this.arrangesToOrigin){const i=x.l();this.Nw(this.network,i);const s=this.arrangementOrigin;t=s.x-i.x,e=s.y-i.y,x.e(i)}const i=x.l(),s=this.network.vertexes.iterator;for(;s.next();){const n=s.value;(0!==t||0!==e)&&(i.a(n.bounds),i.x+=t,i.y+=e,n.bounds=i),n.commit()}x.e(i)}commitLinks(){const t=this.network.edges.iterator;for(;t.next();)t.value.commit()}springStiffness(t){const e=t.stiffness;return isNaN(e)?this.zf:e}springLength(t){const e=t.length;return isNaN(e)?this.Xf:e}electricalCharge(t){const e=t.charge;return isNaN(e)?this.Yf:e}electricalFieldX(t,e){return 0}electricalFieldY(t,e){return 0}gravitationalMass(t){const e=t.mass;return isNaN(e)?this.Kf:e}gravitationalFieldX(t,e){return 0}gravitationalFieldY(t,e){return 0}isFixed(t){return t.isFixed}get currentIteration(){return this.Rh}get arrangementSpacing(){return this.Ms}set arrangementSpacing(t){this.Ms.equals(t)||(this.Ms.a(t),this.invalidateLayout())}get arrangesToOrigin(){return this.dg}set arrangesToOrigin(t){this.dg!==t&&(e.s(t,"boolean",di,"arrangesToOrigin"),this.dg=t,this.invalidateLayout())}get setsPortSpots(){return this.Nn}set setsPortSpots(t){this.Nn!==t&&(e.s(t,"boolean",di,"setsPortSpots"),this.Nn=t,this.invalidateLayout())}get comments(){return this.Fe}set comments(t){this.Fe!==t&&(e.s(t,"boolean",di,"comments"),this.Fe=t,this.invalidateLayout())}get maxPrelayoutIterations(){return this.gg}set maxPrelayoutIterations(t){this.gg!==t&&(e.s(t,"number",di,"maxPrelayoutIterations"),t>=0&&(this.gg=t,this.invalidateLayout()))}get maxIterations(){return this.mg}set maxIterations(t){this.mg!==t&&(e.s(t,"number",di,"maxIterations"),t>=0&&(this.mg=t,this.invalidateLayout()))}get epsilonDistance(){return this.pg}set epsilonDistance(t){this.pg!==t&&(e.s(t,"number",di,"epsilonDistance"),t>0&&(this.pg=t,this.invalidateLayout()))}get infinityDistance(){return this.Vf}set infinityDistance(t){this.Vf!==t&&(e.s(t,"number",di,"infinityDistance"),t>1&&(this.Vf=t,this.invalidateLayout()))}get moveLimit(){return this.yg}set moveLimit(t){this.yg!==t&&(e.s(t,"number",di,"moveLimit"),this.yg=t,this.invalidateLayout())}get randomNumberGenerator(){return this.wg}set randomNumberGenerator(t){this.wg!==t&&(null!==t&&!e.it(t.random)&&e.o('ForceDirectedLayout.randomNumberGenerator must have a "random()" function on it: '+t),this.wg=t)}get defaultSpringStiffness(){return this.zf}set defaultSpringStiffness(t){this.zf!==t&&(e.s(t,"number",di,"defaultSpringStiffness"),this.zf=t,this.invalidateLayout())}get defaultSpringLength(){return this.Xf}set defaultSpringLength(t){this.Xf!==t&&(e.s(t,"number",di,"defaultSpringLength"),this.Xf=t,this.invalidateLayout())}get defaultElectricalCharge(){return this.Yf}set defaultElectricalCharge(t){this.Yf!==t&&(e.s(t,"number",di,"defaultElectricalCharge"),this.Yf=t,this.invalidateLayout())}get defaultGravitationalMass(){return this.Kf}set defaultGravitationalMass(t){this.Kf!==t&&(e.s(t,"number",di,"defaultGravitationalMass"),this.Kf=t,this.invalidateLayout())}get defaultCommentSpringLength(){return this.xg}set defaultCommentSpringLength(t){this.xg!==t&&(e.s(t,"number",di,"defaultCommentSpringLength"),this.xg=t,this.invalidateLayout())}get defaultCommentElectricalCharge(){return this.bg}set defaultCommentElectricalCharge(t){this.bg!==t&&(e.s(t,"number",di,"defaultCommentElectricalCharge"),this.bg=t,this.invalidateLayout())}get prelayoutQuality(){return this.Gf}set prelayoutQuality(t){this.Gf!==t&&(e.s(t,"number",di,"prelayoutQuality"),this.Gf=t,this.invalidateLayout())}get prelayoutSpread(){return this.Za}set prelayoutSpread(t){this.Za!==t&&(e.s(t,"number",di,"prelayoutSpread"),this.Za=t,this.invalidateLayout())}}class fi extends je{constructor(t){super(t)}createVertex(){return new gi(this)}createEdge(){return new pi(this)}}class gi extends $e{W1;J1;$1;Z1;Q1;hierarchicalVertexes;idInCluster;constructor(t){super(t),this.W1=!1,this.J1=NaN,this.$1=NaN,this.Z1=0,this.Q1=0,this.hierarchicalVertexes=new h,this.idInCluster=-1}get isFixed(){return this.W1}set isFixed(t){this.W1!==t&&(e.s(t,"boolean",gi,"isFixed"),this.W1=t)}get charge(){return this.J1}set charge(t){this.J1!==t&&(e.s(t,"number",gi,"charge"),this.J1=t)}get mass(){return this.$1}set mass(t){this.$1!==t&&(e.s(t,"number",gi,"mass"),this.$1=t)}get forceX(){return this.Z1}set forceX(t){this.Z1!==t&&(e.s(t,"number",gi,"forceX"),this.Z1=t)}get forceY(){return this.Q1}set forceY(t){this.Q1!==t&&(e.s(t,"number",gi,"forceY"),this.Q1=t)}}class pi extends Xe{_1;tk;constructor(t){super(t),this._1=NaN,this.tk=NaN}get stiffness(){return this._1}set stiffness(t){this._1!==t&&(e.s(t,"number",pi,"stiffness"),this._1=t)}get length(){return this.tk}set length(t){this.tk!==t&&(e.s(t,"number",pi,"length"),this.tk=t)}}class mi{I;R;Q;M;A;seed;constructor(t){void 0===t&&(t=42),this.seed=t,this.A=48271,this.M=2147483647,this.Q=this.M/this.A,this.R=this.M%this.A,this.I=1/this.M,this.random()}random(){const t=this.seed/this.Q,e=this.seed%this.Q,i=this.A*e-this.R*t;return this.seed=i>0?i:i+this.M,this.seed*this.I}}var yi=(t=>(t[t.DepthFirst=0]="DepthFirst",t[t.Greedy=1]="Greedy",t[t.FromLayers=2]="FromLayers",t))(yi||{}),vi=(t=>(t[t.OptimalLinkLength=10]="OptimalLinkLength",t[t.LongestPathSink=11]="LongestPathSink",t[t.LongestPathSource=12]="LongestPathSource",t))(vi||{}),xi=(t=>(t[t.DepthFirstOut=20]="DepthFirstOut",t[t.DepthFirstIn=21]="DepthFirstIn",t[t.Naive=22]="Naive",t))(xi||{}),bi=(t=>(t[t.None=30]="None",t[t.Less=31]="Less",t[t.More=32]="More",t))(bi||{}),wi=(t=>(t[t.None=0]="None",t[t.Expand=1]="Expand",t[t.Straighten=2]="Straighten",t[t.Median=4]="Median",t[t.MaybeExpand=8]="MaybeExpand",t[t.All=15]="All",t))(wi||{}),ki=(t=>(t[t.None=0]="None",t[t.UpperLeft=1]="UpperLeft",t[t.UpperRight=2]="UpperRight",t[t.LowerLeft=4]="LowerLeft",t[t.LowerRight=8]="LowerRight",t[t.All=15]="All",t))(ki||{});class Si extends ze{Ns;Wi;b;Hf;jf;qf;Qa;Wf;Zo;Jf;Nn;kt;zy;zt;kg;Cs;ci;Zs;Ls;As;It;Pg;_a;Sg;Qs;$f;Qo;Cn;Ln;ZN;constructor(t){super(),this.Ns=25,this.Wi=25,this.b=0,this.Hf=0,this.jf=10,this.qf=20,this.Qa=4,this.Wf=31,this.Zo=15,this.Jf=10,this.Nn=!0,this.kt=-1,this.zy=-1,this.zt=-1,this.kg=0,this.Cs=0,this.ci=null,this.Zs=null,this.Ls=null,this.As=null,this.It=null,this.Pg=0,this._a=null,this.Sg=null,this.Qs=0,this.$f=null,this.Qo=new y,this.Cn=[],this.Cn.length=100,this.Ln=15,this.ZN=0,t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.Ns=this.Ns,t.Wi=this.Wi,t.b=this.b,t.Hf=this.Hf,t.jf=this.jf,t.qf=this.qf,t.Qa=this.Qa,t.Wf=this.Wf,t.Zo=this.Zo,t.Jf=this.Jf,t.Nn=this.Nn,t.Ln=this.Ln}oi(t){t in bi?this.aggressiveOption=t:t in yi?this.cycleRemoveOption=t:t in xi?this.initializeOption=t:t in vi?this.layeringOption=t:super.oi(t)}createNetwork(){return new Pi(this)}doLayout(t){null===this.network&&(this.network=this.makeNetwork(t)),this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin),this.hI(),this.network.vertexes.count>0&&(this.network.deleteSelfEdges(),2!==this.cycleRemoveOption&&this.removeCycles(),this.aI(),2===this.cycleRemoveOption&&this.removeCycles(),this.cI(),this.fI(),this.uI(),this.reduceCrossings(),this.straightenAndPack(),this.updateParts()),this.network=null,this.isValidLayout=!0}linkMinLength(t){return 1}linkLengthWeight(t){return 1}linkStraightenWeight(t){const e=t.fromVertex.node||t.fromVertex.data,i=t.toVertex.node||t.toVertex.data;return null===e&&null===i?8:null===e||null===i?4:1}nodeMinLayerSpace(t,e){return null===t.node&&null===t.data?0:90===this.b||270===this.b?e?t.focus.y+10:t.bounds.height-t.focus.y+10:e?t.focus.x+10:t.bounds.width-t.focus.x+10}nodeMinColumnSpace(t,e){if(null===t.node&&null===t.data)return 0;const i=e?t.ik:t.ek;if(null!==i)return i;const s=this.b;return 90===s||270===s?e?t.ik=t.focus.x/this.Wi+1|0:t.ek=(t.bounds.width-t.focus.x)/this.Wi+1|0:e?t.ik=t.focus.y/this.Wi+1|0:t.ek=(t.bounds.height-t.focus.y)/this.Wi+1|0}Ji(){null===this._a&&(this._a=[]);let t=0;const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;this._a[t]=i.layer,t++,this._a[t]=i.column,t++,this._a[t]=i.index,t++}return this._a}We(t){let e=0;const i=this.network.vertexes.iterator;for(;i.next();){const s=i.value;s.layer=t[e],e++,s.column=t[e],e++,s.index=t[e],e++}}yD(t,e){const i=this.vh(t),s=this.ci[t];(null===this.Sg||this.Sg.length<s*s)&&(this.Sg=[]);const n=this.Sg;for(let o=0;o<s;o++){let r=0;const a=i[o],h=a.near;let l=0;null!==h&&h!==a&&h.layer===a.layer&&(r+=Math.max(0,Math.abs(h.index-a.index)-1));let u,c,d,f,g,p=0,m=0,y=0,v=0,x=0,b=0,w=0,k=0;if(e>=0)for(u=i[o].co,p=0;p<u.length;p++)if(c=u[p],c.valid&&c.fromVertex.layer!==t)for(m=c.fromVertex.index,y=c.portToPos,v=c.portFromPos,x=p+1;x<u.length;x++)f=u[x],f.valid&&f.fromVertex.layer!==t&&(b=f.fromVertex.index,w=f.portToPos,k=f.portFromPos,y<w&&(m>b||m===b&&v>k)&&r++,w<y&&(b>m||b===m&&k>v)&&r++);if(e<=0)for(u=i[o].qo,p=0;p<u.length;p++)if(c=u[p],c.valid&&c.toVertex.layer!==t)for(m=c.toVertex.index,y=c.portToPos,v=c.portFromPos,x=p+1;x<u.length;x++)f=u[x],f.valid&&f.toVertex.layer!==t&&(b=f.toVertex.index,w=f.portToPos,k=f.portFromPos,v<k&&(m>b||m===b&&y>w)&&r++,k<v&&(b>m||b===m&&w>y)&&r++);for(n[o*s+o]=r,l=o+1;l<s;l++){let r=0,a=0;if(e>=0)for(d=i[o].co,g=i[l].co,p=0;p<d.length;p++)if(c=d[p],c.valid&&c.fromVertex.layer!==t)for(m=c.fromVertex.index,y=c.portToPos,v=c.portFromPos,x=0;x<g.length;x++)f=g[x],f.valid&&f.fromVertex.layer!==t&&(b=f.fromVertex.index,w=f.portToPos,k=f.portFromPos,(m<b||m===b&&v<k)&&a++,(b<m||b===m&&k<v)&&r++);if(e<=0)for(d=i[o].qo,g=i[l].qo,p=0;p<d.length;p++)if(c=d[p],c.valid&&c.toVertex.layer!==t)for(m=c.toVertex.index,y=c.portToPos,v=c.portFromPos,x=0;x<g.length;x++)f=g[x],f.valid&&f.toVertex.layer!==t&&(b=f.toVertex.index,w=f.portToPos,k=f.portFromPos,(m<b||m===b&&y<w)&&a++,(b<m||b===m&&w<y)&&r++);n[o*s+l]=r,n[l*s+o]=a}}return this.Oh(t,i),n}countCrossings(){let t=0;for(let e=0;e<=this.kt;e++){const i=this.yD(e,1),s=this.ci[e];for(let e=0;e<s;e++)for(let n=e;n<s;n++)t+=i[e*s+n]}return t}dI(t,e,i){const s=this.vh(t),n=this.ci[t];let o=0;for(let r=0;r<n;r++){let n=null;e<=0&&(n=s[r].co);let a=null;e>=0&&(a=s[r].qo);let h,l=0,u=0;if(null!==n)for(let e=0;e<n.length;e++)h=n[e],h.valid&&h.fromVertex.layer!==t&&(l=h.fromVertex.column+h.portFromColOffset,u=h.toVertex.column+h.portToColOffset,o+=i?Math.abs(l-u)*this.linkStraightenWeight(h):Math.abs(l-u));if(null!==a)for(let e=0;e<a.length;e++)h=a[e],h.valid&&h.toVertex.layer!==t&&(l=h.fromVertex.column+h.portFromColOffset,u=h.toVertex.column+h.portToColOffset,o+=i?(Math.abs(l-u)+1)*this.linkStraightenWeight(h):Math.abs(l-u))}return this.Oh(t,s),o}sk(t){let e=0;for(let i=0;i<=this.kt;i++)e+=this.dI(i,1,t);return e}Xy(){let t=1/0;this.zt=-1;const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;t=Math.min(t,i.column-this.nodeMinColumnSpace(i,!0)),this.zt=Math.max(this.zt,i.column+this.nodeMinColumnSpace(i,!1))}for(e.reset();e.next();){const i=e.value;i.column-=t}this.zt-=t}Yy(t,e){const i=this.vh(t),s=this.ci[t],n=[];for(let o=0;o<s;o++){const s=i[o];let r=null;e<=0&&(r=s.co);let a=null;e>=0&&(a=s.qo);let h=0,l=0;const u=s.near;let c;if(null!==u&&u.layer===s.layer&&(h+=u.column-1,l++),null!==r)for(let e=0;e<r.length;e++){c=r[e];const i=c.fromVertex;c.valid&&!c.rev&&i.layer!==t&&(h+=i.column,l++)}if(null!==a)for(let e=0;e<a.length;e++){c=a[e];const i=c.toVertex;c.valid&&!c.rev&&i.layer!==t&&(h+=i.column,l++)}n[o]=0===l?-1:h/l}return this.Oh(t,i),n}wD(t,e){const i=this.vh(t),s=this.ci[t],n=[];for(let o=0;o<s;o++){const s=i[o];let r=null;e<=0&&(r=s.co);let a=null;e>=0&&(a=s.qo);let h=0;const l=[],u=s.near;let c;if(null!==u&&u.layer===s.layer&&(l[h]=u.column-1,h++),null!==r)for(let e=0;e<r.length;e++){c=r[e];const i=c.fromVertex;c.valid&&!c.rev&&i.layer!==t&&(l[h]=i.column+c.portFromColOffset,h++)}if(null!==a)for(let e=0;e<a.length;e++){c=a[e];const i=c.toVertex;c.valid&&!c.rev&&i.layer!==t&&(l[h]=i.column+c.portToColOffset,h++)}if(0===h)n[o]=-1;else{l.sort(((t,e)=>t-e));const t=h>>1;n[o]=1&h?l[t]:l[t-1]+l[t]>>1}}return this.Oh(t,i),n}Ky(t,e,i,s,n){if(t.component===i){t.component=e;let o=0,r=0;if(s){const a=t.destinationEdges;for(;a.next();){const h=a.value,l=h.toVertex;o=t.layer-l.layer,r=this.linkMinLength(h),o===r&&this.Ky(l,e,i,s,n)}}if(n){const a=t.sourceEdges;for(;a.next();){const h=a.value,l=h.fromVertex;o=l.layer-t.layer,r=this.linkMinLength(h),o===r&&this.Ky(l,e,i,s,n)}}}}QN(t,e,i,s,n){if(t.component===i){if(t.component=e,s){const o=t.destinationEdges;for(;o.next();){const t=o.value.toVertex;this.QN(t,e,i,s,n)}}if(n){const o=t.sourceEdges;for(;o.next();){const t=o.value.fromVertex;this.QN(t,e,i,s,n)}}}}removeCycles(){const t=this.network.edges.iterator;for(;t.next();){const e=t.value;e.rev=!1}switch(this.Hf){default:case 1:this.gI();break;case 0:this.mI();break;case 2:this.pI();break}}pI(){const t=this.network,e=t.vertexes.iterator;let i=1/0;for(;e.next();){const t=e.value;i=Math.min(i,t.layer)}if(i<1/0){if(i<0)for(e.reset();e.next();){const t=e.value;t.layer-=i}const s=[];for(e.reset();e.next();){const t=e.value,i=s[t.layer];void 0===i?s[t.layer]=[t]:i.push(t)}let n=0;for(let t=0;t<s.length;t++){const e=s[t];if(e&&0!==e.length){if(t>0)for(let t=0;t<e.length;t++){const i=e[t];i.layer-=n}}else n++}const o=t.edges.iterator;for(;o.next();){const e=o.value,i=e.fromVertex,s=e.toVertex;i.layer<s.layer&&(t.reverseEdge(e),e.rev=!0)}}}gI(){const t=this.network;let e=0,i=t.vertexes.count-1;const s=[];s.length=i+1;const n=t.vertexes.iterator;for(;n.next();){const t=n.value;t.$i=!0}for(;null!==this.yI(t);){let n;for(n=this.xD(t);null!==n;)s[i]=n,i--,n.$i=!1,n=this.xD(t);for(n=this.bD(t);null!==n;)s[e]=n,e++,n.$i=!1,n=this.bD(t);n=this.wI(t),null!==n&&(s[e]=n,e++,n.$i=!1)}for(let r=0;r<t.vertexes.count;r++)s[r].index=r;const o=t.edges.iterator;for(;o.next();){const e=o.value,i=e.fromVertex,s=e.toVertex;i.index>s.index&&(t.reverseEdge(e),e.rev=!0)}}yI(t){const e=t.vertexes.iterator;for(;e.next();){const t=e.value;if(t.$i)return t}return null}xD(t){const e=t.vertexes.iterator;for(;e.next();){const t=e.value;if(t.$i){let e=!0;const i=t.destinationEdges;for(;i.next();)if(i.value.toVertex.$i){e=!1;break}if(e)return t}}return null}bD(t){const e=t.vertexes.iterator;for(;e.next();){const t=e.value;if(t.$i){let e=!0;const i=t.sourceEdges;for(;i.next();)if(i.value.fromVertex.$i){e=!1;break}if(e)return t}}return null}wI(t){let e=null,i=0;const s=this.network.vertexes.iterator;for(;s.next();){const t=s.value;if(t.$i){let s=0;const n=t.destinationEdges;for(;n.next();)n.value.toVertex.$i&&s++;let o=0;const r=t.sourceEdges;for(;r.next();)r.value.fromVertex.$i&&o++;(null===e||i<s-o)&&(e=t,i=s-o)}}return e}mI(){const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value;e.Zf=-1,e.Xn=-1}const e=this.network.edges.iterator;for(;e.next();){const t=e.value;t.forest=!1}for(this.Pg=0,t.reset();t.next();){const e=t.value;0===e.sourceEdges.count&&this._N(e)}for(t.reset();t.next();){const e=t.value;-1===e.Zf&&this._N(e)}for(e.reset();e.next();){const t=e.value;if(!t.forest){const e=t.fromVertex,i=e.Zf,s=e.Xn,n=t.toVertex,o=n.Zf,r=n.Xn;o<i&&s<r&&(this.network.reverseEdge(t),t.rev=!0)}}}_N(t){t.Zf=this.Pg,this.Pg++;const e=t.destinationEdges;for(;e.next();){const t=e.value,i=t.toVertex;-1===i.Zf&&(t.forest=!0,this._N(i))}t.Xn=this.Pg,this.Pg++}aI(){const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value;e.layer=-1}for(this.kt=-1,this.assignLayers(),t.reset();t.next();){const e=t.value;this.kt=Math.max(this.kt,e.layer)}}assignLayers(){switch(this.jf){case 11:this.kD();break;case 12:this.xI();break;default:case 10:this.bI();break}}kD(){const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value,i=this.PD(e);this.kt=Math.max(i,this.kt)}}PD(t){let e=0;if(-1===t.layer){const i=t.destinationEdges;for(;i.next();){const t=i.value,s=t.toVertex,n=this.linkMinLength(t);e=Math.max(e,this.PD(s)+n)}t.layer=e}else e=t.layer;return e}xI(){let t=0;const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;t=this.SD(i),this.kt=Math.max(t,this.kt)}for(e.reset();e.next();){const t=e.value;t.layer=this.kt-t.layer}}SD(t){let e=0;if(-1===t.layer){const i=t.sourceEdges;for(;i.next();){const t=i.value,s=t.fromVertex,n=this.linkMinLength(t);e=Math.max(e,this.SD(s)+n)}t.layer=e}else e=t.layer;return e}bI(){this.kD();const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value;e.$i=!1}for(t.reset();t.next();){const e=t.value;0===e.sourceEdges.count&&this.MD(e)}let e=1/0;for(t.reset();t.next();){const i=t.value;e=Math.min(e,i.layer)}for(this.kt=-1,t.reset();t.next();){const i=t.value;i.layer-=e,this.kt=Math.max(this.kt,i.layer)}}MD(t){if(!t.$i){t.$i=!0;const e=t.destinationEdges;for(;e.next();){const t=e.value.toVertex;this.MD(t)}this.kI(t),this.SI(t)}}kI(t){const e=this.network.vertexes.iterator;for(;e.next();){const t=e.value;t.component=-1}const i=0,s=1,n=t.co;let o=n.length;for(let r=0;r<o;r++){const t=n[r],e=t.fromVertex,s=t.toVertex,o=this.linkMinLength(t);e.layer-s.layer>o&&this.Ky(e,i,-1,!0,!1)}for(this.Ky(t,s,-1,!0,!0);t.component!==i;){let n=0,r=1/0,a=0,h=null;const l=this.network.vertexes.iterator;for(;l.next();){const t=l.value;if(t.component===s){let e=0,i=!1;const l=t.co;o=l.length;for(let a=0;a<o;a++){const i=l[a],o=i.fromVertex;if(e+=this.linkLengthWeight(i),o.component!==s){n+=this.linkLengthWeight(i);const e=o.layer-t.layer,s=this.linkMinLength(i);r=Math.min(r,e-s)}}const u=t.qo;o=u.length;for(let t=0;t<o;t++){const o=u[t],r=o.toVertex;e-=this.linkLengthWeight(o),r.component!==s?n-=this.linkLengthWeight(o):i=!0}(null===h||e<a)&&!i&&(h=t,a=e)}}if(n>0){for(e.reset();e.next();){const t=e.value;t.component===s&&(t.layer+=r)}t.component=i}else h.component=i}}SI(t){const e=this.network.vertexes.iterator;for(;e.next();){const t=e.value;t.component=-1}const i=0,s=1;for(this.Ky(t,s,-1,!0,!1);t.component!==i;){let n=0,o=1/0,r=0,a=null;const h=this.network.vertexes.iterator;for(;h.next();){const t=h.value;if(t.component===s){let e=0,i=!1;const h=t.co;let l=h.length;for(let t=0;t<l;t++){const o=h[t],r=o.fromVertex;e+=this.linkLengthWeight(o),r.component!==s?n+=this.linkLengthWeight(o):i=!0}const u=t.qo;l=u.length;for(let r=0;r<l;r++){const i=u[r],a=i.toVertex;if(e-=this.linkLengthWeight(i),a.component!==s){n-=this.linkLengthWeight(i);const e=t.layer-a.layer,s=this.linkMinLength(i);o=Math.min(o,e-s)}}(null===a||e>r)&&!i&&(a=t,r=e)}}if(n<0){for(e.reset();e.next();){const t=e.value;t.component===s&&(t.layer-=o)}t.component=i}else a.component=i}}cI(){const t=this.network,e=[],i=t.edges.iterator;for(;i.next();){const t=i.value;t.valid=!1,e.push(t)}for(let s=0;s<e.length;s++){const i=e[s];let n=i.fromVertex;const o=i.toVertex;if(i.valid||(null===n.node&&null===n.data||null===o.node&&null===o.data)&&n.layer===o.layer)continue;let r=0,a=0,h=0,l=0;if(null!==i.link){const t=i.link;if(null===t)continue;const e=n.node,s=o.node;if(null===e||null===s)continue;let u=t.fromNode,c=t.toNode,d=t.fromPort;for(;null!==d&&!d.isVisibleObject();)d=d.panel;let f=t.toPort;for(;null!==f&&!f.isVisibleObject();)f=f.panel;if(i.rev){const t=u,e=d;u=c,d=f,c=t,f=e}const g=n.focus,p=o.focus,m=i.rev?o.bounds:n.bounds,v=y.l();e!==u?m.isReal()&&u.isVisible()?u.actualBounds.isReal()?(u.getRelativePoint(d,w.Center,v),v.x+=u.actualBounds.x-m.x,v.y+=u.actualBounds.y-m.y):(u.getRelativePoint(d,w.Center,v),v.isReal()||v.a(g)):v.a(g):m.isReal()?(u.getRelativePoint(d,w.Center,v),v.isReal()||v.a(g)):v.a(g);const x=i.rev?n.bounds:o.bounds,b=y.l();s!==c?x.isReal()&&c.isVisible()?c.actualBounds.isReal()?(c.getRelativePoint(f,w.Center,b),b.x+=c.actualBounds.x-x.x,b.y+=c.actualBounds.y-x.y):(c.getRelativePoint(f,w.Center,b),b.isReal()||b.a(p)):b.a(p):x.isReal()?(c.getRelativePoint(f,w.Center,b),b.isReal()||b.a(p)):b.a(p),90===this.b||270===this.b?(r=Math.round((v.x-g.x)/this.Wi),h=v.x,a=Math.round((b.x-p.x)/this.Wi),l=b.x):(r=Math.round((v.y-g.y)/this.Wi),h=v.y,a=Math.round((b.y-p.y)/this.Wi),l=b.y),y.e(v),y.e(b),i.portFromColOffset=r,i.portFromPos=h,i.portToColOffset=a,i.portToPos=l}else i.portFromColOffset=0,i.portFromPos=0,i.portToColOffset=0,i.portToPos=0;let u=n.layer;const c=o.layer,d=this.MI(i),f=1===d||3===d,g=2===d||3===d;let p,m,v,x=null;g&&(x=this.NI(n,o),v=1,m=t.createVertex(),m.node=null,m.nk=1,m.layer=u,m.near=n,t.addVertex(m),p=t.linkVertexes(n,m,i.link),p.valid=!1,p.rev=i.rev,p.portFromColOffset=r,p.portToColOffset=0,p.portFromPos=h,p.portToPos=0,n=m);let b=1;if(f&&b--,u-c>b&&u>0){for(i.valid=!1,m=t.createVertex(),m.node=null,m.nk=2,m.layer=u-1,x&&v<x.length&&m.layer===x[v].layer&&(m.near=x[v++]),t.addVertex(m),p=t.linkVertexes(n,m,i.link),p.valid=!0,p.rev=i.rev,p.portFromColOffset=g?0:r,p.portToColOffset=0,p.portFromPos=g?0:h,p.portToPos=0,n=m,u--;u-c>b&&u>0;)m=t.createVertex(),m.node=null,m.nk=3,m.layer=u-1,x&&v<x.length&&m.layer===x[v].layer&&(m.near=x[v++]),t.addVertex(m),p=t.linkVertexes(n,m,i.link),p.valid=!0,p.rev=i.rev,p.portFromColOffset=0,p.portToColOffset=0,p.portFromPos=0,p.portToPos=0,n=m,u--;p=t.linkVertexes(m,o,i.link),p.valid=!f,f&&(m.near=o),p.rev=i.rev,p.portFromColOffset=0,p.portToColOffset=a,p.portFromPos=0,p.portToPos=l}else i.valid=!0}}MI(t){let e=0;const i=t.link;if(null!==i){const s=i.fromPort,n=i.toPort;if(null!==s&&null!==n){const o=i.fromNode,r=i.toNode;if(null!==o&&null!==r){const a=this.ok(!0),h=this.ok(!1),l=this.setsPortSpots?a:i.computeSpot(!0,s),u=this.setsPortSpots?h:i.computeSpot(!1,n),c=i.isOrthogonal;if(l.isSide()&&l.includesSide(h)&&u.isSide()&&u.includesSide(a))return 0;const d=i.getLinkPoint(o,s,l,!0,c,r,n,y.l()),f=i.getLinkDirection(o,s,d,l,!0,c,r,n);y.e(d),(!l.isNone()&&f===this.ND(t,!0)||this.setsPortSpots&&null!==o&&1===o.ports.count&&t.rev)&&(e+=1);const g=i.getLinkPoint(r,n,u,!1,c,o,s,y.l()),p=i.getLinkDirection(r,n,g,u,!1,c,o,s);y.e(g),(!u.isNone()&&p===this.ND(t,!1)||this.setsPortSpots&&null!==r&&1===r.ports.count&&t.rev)&&(e+=2)}}}return e}ND(t,e){return 90===this.b?e&&!t.rev||!e&&t.rev?270:90:180===this.b?e&&!t.rev||!e&&t.rev?0:180:270===this.b?e&&!t.rev||!e&&t.rev?90:270:e&&!t.rev||!e&&t.rev?180:0}NI(t,e){const i=[];return i.push(e),this.CD(t,i)?i.reverse():[]}CD(t,e){const i=e[e.length-1].sourceEdges.iterator;for(;i.next();){const s=i.value;if(s.rev||!s.valid)continue;const n=s.fromVertex;if(e.push(n),n===t||this.CD(t,e))return!0;e.pop()}return!1}fI(){const t=this.ci=[];for(let i=0;i<=this.kt;i++)t[i]=0;const e=this.network.vertexes.iterator;for(;e.next();){const t=e.value;t.index=-1}this.initializeIndices(),this.zy=-1,this.kg=0,this.Cs=0;for(let i=0;i<=this.kt;i++)t[i]>t[this.Cs]&&(this.zy=t[i]-1,this.Cs=i),t[i]<t[this.kg]&&(this.kg=i);this.$f=[];for(let i=0;i<t.length;i++)this.$f[i]=[];for(e.reset();e.next();){const t=e.value,i=t.layer,s=this.$f[i];s[t.index]=t}}initializeIndices(){switch(this.qf){default:case 22:this.CI();break;case 20:this.LI();break;case 21:this.AI();break}}CI(){let t=null;const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;if(i.near&&(null===t&&(t=new Map),i.layer===i.near.layer)){const e=t.get(i.near)||[];e.push(i),t.set(i.near,e)}}for(e.reset();e.next();){const i=e.value;if(i.near)continue;const s=i.layer;if(i.index=this.ci[s],this.ci[s]++,!t)continue;const n=t.get(i);Array.isArray(n)&&n.forEach((t=>{t.index=this.ci[s],this.ci[s]++}))}}LI(){let t=null;const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;if(i.near&&(null===t&&(t=new Map),i.layer===i.near.layer)){const e=t.get(i.near)||[];e.push(i),t.set(i.near,e)}}for(let i=this.kt;i>=0;i--)for(e.reset();e.next();){const s=e.value;s.layer===i&&-1===s.index&&this.LD(s,t)}}LD(t,e){if(t.near)return;const i=t.layer;if(t.index=this.ci[i],this.ci[i]++,e){const s=e.get(t);Array.isArray(s)&&s.forEach((t=>{t.index=this.ci[i],this.ci[i]++}))}const s=t.qo;let n=!0;for(;n;){n=!1;for(let t=0;t<s.length-1;t++){const e=s[t],i=s[t+1];e.portFromColOffset>i.portFromColOffset&&(n=!0,s[t]=i,s[t+1]=e)}}for(let o=0;o<s.length;o++){const t=s[o];if(t.valid){const i=t.toVertex;-1===i.index&&this.LD(i,e)}}}AI(){let t=null;const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;if(i.near&&(null===t&&(t=new Map),i.layer===i.near.layer)){const e=t.get(i.near)||[];e.push(i),t.set(i.near,e)}}for(let i=0;i<=this.kt;i++)for(e.reset();e.next();){const s=e.value;s.layer===i&&-1===s.index&&this.AD(s,t)}}AD(t,e){if(t.near)return;const i=t.layer;if(t.index=this.ci[i],this.ci[i]++,e){const s=e.get(t);Array.isArray(s)&&s.forEach((t=>{t.index=this.ci[i],this.ci[i]++}))}const s=t.co;let n,o,r=!0,a=0;for(;r;)for(r=!1,a=0;a<s.length-1;a++){const t=s[a],e=s[a+1];t.portToColOffset>e.portToColOffset&&(r=!0,s[a]=e,s[a+1]=t)}for(a=0;a<s.length;a++)o=s[a],o.valid&&(n=o.fromVertex,-1===n.index&&this.AD(n,e))}uI(){this.zt=-1;for(let t=0;t<=this.kt;t++){const e=this.vh(t);let i=0;const s=this.ci[t];for(let t=0;t<s;t++){const s=e[t];i+=this.nodeMinColumnSpace(s,!0),s.column=i,i+=1,i+=this.nodeMinColumnSpace(s,!1)}this.zt=Math.max(this.zt,i-1),this.Oh(t,e)}}reduceCrossings(){let t=this.countCrossings(),e=this.Ji(),i=0,s=0,n=0;for(i=0;i<this.Qa;i++){for(s=0;s<=this.kt;s++)this.rk(s,1),this.rs(s,1,!1,1);for(n=this.countCrossings(),n<t&&(t=n,e=this.Ji()),s=this.kt;s>=0;s--)this.rk(s,-1),this.rs(s,-1,!1,-1);n=this.countCrossings(),n<t&&(t=n,e=this.Ji())}for(this.We(e),i=0;i<this.Qa;i++){for(s=0;s<=this.kt;s++)this.rk(s,0),this.rs(s,0,!1,0);for(n=this.countCrossings(),n<t&&(t=n,e=this.Ji()),s=this.kt;s>=0;s--)this.rk(s,0),this.rs(s,0,!1,0);n=this.countCrossings(),n<t&&(t=n,e=this.Ji())}this.We(e);let o=!1,r=0,a=0,h=0,l=0;switch(this.Wf){case 30:break;case 32:for(h=t+1;(l=this.countCrossings())<h;)for(h=l,r=this.kt;r>=0;r--)for(a=0;a<=r;a++){for(o=!0;o;)for(o=!1,s=r;s>=a;s--)o=this.rs(s,-1,!1,-1)||o;for(n=this.countCrossings(),n>=t?this.We(e):(t=n,e=this.Ji()),o=!0;o;)for(o=!1,s=r;s>=a;s--)o=this.rs(s,1,!1,1)||o;for(n=this.countCrossings(),n>=t?this.We(e):(t=n,e=this.Ji()),o=!0;o;)for(o=!1,s=a;s<=r;s++)o=this.rs(s,1,!1,1)||o;for(n>=t?this.We(e):(t=n,e=this.Ji()),o=!0;o;)for(o=!1,s=a;s<=r;s++)o=this.rs(s,-1,!1,-1)||o;for(n>=t?this.We(e):(t=n,e=this.Ji()),o=!0;o;)for(o=!1,s=r;s>=a;s--)o=this.rs(s,0,!1,0)||o;for(n>=t?this.We(e):(t=n,e=this.Ji()),o=!0;o;)for(o=!1,s=a;s<=r;s++)o=this.rs(s,0,!1,0)||o;n>=t?this.We(e):(t=n,e=this.Ji())}break;default:case 31:for(r=this.kt,a=0,h=t+1;(l=this.countCrossings())<h;){for(h=l,o=!0;o;)for(o=!1,s=r;s>=a;s--)o=this.rs(s,-1,!1,-1)||o;for(n=this.countCrossings(),n>=t?this.We(e):(t=n,e=this.Ji()),o=!0;o;)for(o=!1,s=r;s>=a;s--)o=this.rs(s,1,!1,1)||o;for(n=this.countCrossings(),n>=t?this.We(e):(t=n,e=this.Ji()),o=!0;o;)for(o=!1,s=a;s<=r;s++)o=this.rs(s,1,!1,1)||o;for(n>=t?this.We(e):(t=n,e=this.Ji()),o=!0;o;)for(o=!1,s=a;s<=r;s++)o=this.rs(s,-1,!1,-1)||o;for(n>=t?this.We(e):(t=n,e=this.Ji()),o=!0;o;)for(o=!1,s=r;s>=a;s--)o=this.rs(s,0,!1,0)||o;for(n>=t?this.We(e):(t=n,e=this.Ji()),o=!0;o;)for(o=!1,s=a;s<=r;s++)o=this.rs(s,0,!1,0)||o;n>=t?this.We(e):(t=n,e=this.Ji())}break}this.We(e)}rk(t,e){let i=0,s=!1;const n=this.vh(t),o=this.ci[t],r=this.wD(t,e),a=this.Yy(t,e);for(i=0;i<o;i++)-1===a[i]&&(a[i]=n[i].column),-1===r[i]&&(r[i]=n[i].column);let h,l=!0;for(;l;)for(l=!1,i=0;i<o-1;i++)if(r[i+1]<r[i]||r[i+1]===r[i]&&a[i+1]<a[i]){s=!0,l=!0;const t=r[i];r[i]=r[i+1],r[i+1]=t;const e=a[i];a[i]=a[i+1],a[i+1]=e,h=n[i],n[i]=n[i+1],n[i+1]=h}let u=0;for(i=0;i<o;i++)h=n[i],h.index=i,u+=this.nodeMinColumnSpace(h,!0),h.column=u,u+=1,u+=this.nodeMinColumnSpace(h,!1);return this.Oh(t,n),s}rs(t,e,i,s){const n=this.vh(t),o=this.ci[t],r=this.yD(t,e);let a,h,l=0;if(!i||s>0)for(a=[],l=0;l<o;l++)a[l]=-1;else a=this.Yy(t,-1);if(!i||s<0)for(h=[],l=0;l<o;l++)h[l]=-1;else h=this.Yy(t,1);let u=!1,c=!0;for(;c;)for(c=!1,l=0;l<o-1;l++){const e=r[n[l].index*o+n[l+1].index],d=r[n[l+1].index*o+n[l].index];let f=0,g=0;const p=n[l].column,m=n[l+1].column,y=this.nodeMinColumnSpace(n[l],!0),v=this.nodeMinColumnSpace(n[l],!1),x=this.nodeMinColumnSpace(n[l+1],!0),b=this.nodeMinColumnSpace(n[l+1],!1),w=p-y+x,k=m-v+b;let S,P,M=0,C=0,A=0,N=0,L=0,T=0,D=0,O=0,F=0;const R=n[l].sourceEdges.iterator;if(i&&s<=0)for(;R.next();){const e=R.value;S=e.fromVertex,e.valid&&S.layer!==t&&(A=this.linkStraightenWeight(e),N=e.portFromColOffset,L=e.portToColOffset,T=S.column,M+=(Math.abs(p+L-(T+N))+1)*A,C+=(Math.abs(k+L-(T+N))+1)*A)}for(R.reset();R.next();){const e=R.value;if(S=e.fromVertex,e.valid&&S.layer===t){for(O=0;O<n.length&&n[O]!==S;)O++;O<l&&(f+=2*(l-O),g+=2*(l+1-O)),O===l+1&&(f+=1),O>l+1&&(f+=4*(O-l),g+=4*(O-(l+1)))}}const E=n[l].destinationEdges.iterator;if(i&&s>=0)for(;E.next();){const e=E.value;P=e.toVertex,e.valid&&P.layer!==t&&(A=this.linkStraightenWeight(e),N=e.portFromColOffset,L=e.portToColOffset,D=P.column,M+=(Math.abs(p+N-(D+L))+1)*A,C+=(Math.abs(k+N-(D+L))+1)*A)}for(E.reset();E.next();){const e=E.value;if(P=e.toVertex,e.valid&&P.layer===t){for(F=0;F<n.length&&n[F]!==P;)F++;F===l+1&&(g+=1)}}const B=n[l+1].sourceEdges.iterator;if(i&&s<=0)for(;B.next();){const e=B.value;S=e.fromVertex,e.valid&&S.layer!==t&&(A=this.linkStraightenWeight(e),N=e.portFromColOffset,L=e.portToColOffset,T=S.column,M+=(Math.abs(m+L-(T+N))+1)*A,C+=(Math.abs(w+L-(T+N))+1)*A)}for(B.reset();B.next();){const e=B.value;if(S=e.fromVertex,e.valid&&S.layer===t){for(O=0;O<n.length&&n[O]!==S;)O++;O<l&&(f+=2*(l+1-O),g+=2*(l-O)),O===l&&(g+=1),O>l+1&&(f+=4*(O-(l+1)),g+=4*(O-l))}}const I=n[l+1].destinationEdges.iterator;if(i&&s>=0)for(;I.next();){const e=I.value;P=e.toVertex,e.valid&&P.layer!==t&&(A=this.linkStraightenWeight(e),N=e.portFromColOffset,L=e.portToColOffset,D=P.column,M+=(Math.abs(m+N-(D+L))+1)*A,C+=(Math.abs(w+N-(D+L))+1)*A)}for(I.reset();I.next();){const e=I.value;if(P=e.toVertex,e.valid&&P.layer===t){for(F=0;F<n.length&&n[F]!==P;)F++;F===l&&(f+=1)}}let _=0,V=0;const z=a[n[l].index],j=h[n[l].index],$=a[n[l+1].index],X=h[n[l+1].index];if(-1!==z&&(_+=Math.abs(z-p),V+=Math.abs(z-k)),-1!==j&&(_+=Math.abs(j-p),V+=Math.abs(j-k)),-1!==$&&(_+=Math.abs($-m),V+=Math.abs($-w)),-1!==X&&(_+=Math.abs(X-m),V+=Math.abs(X-w)),g<f-.5||g===f&&d<e-.5||g===f&&d===e&&C<M-.5||g===f&&d===e&&C===M&&V<_-.5){u=!0,c=!0,n[l].column=k,n[l+1].column=w;const t=n[l];n[l]=n[l+1],n[l+1]=t}}for(l=0;l<o;l++)n[l].index=l;return this.Oh(t,n),u}straightenAndPack(){if(0!==this.Ln)return void this.TI();let t=0,e=!1,i=0!==(1&this.Zo);const s=0!==(8&this.Zo);if(this.network.edges.count>1e3&&s&&(i=!1),i){const e=[];let i=0;for(i=0;i<=this.kt;i++)e[i]=0;let s=0;const n=this.network.vertexes.iterator;for(;n.next();){const i=n.value;t=i.layer,s=i.column;const o=this.nodeMinColumnSpace(i,!1);e[t]=Math.max(e[t],s+o)}const o=8;for(n.reset();n.next();){const i=n.value;t=i.layer,s=i.column,i.column=((this.zt-e[t])*o>>1)+s*o}this.zt*=o}if(2&this.Zo){e=!0;let i=0;for(;e&&i<this.Jf;){for(e=!1,t=this.Cs+1;t<=this.kt;t++)e=this.Mg(t,1)||e;for(t=this.Cs-1;t>=0;t--)e=this.Mg(t,-1)||e;e=this.Mg(this.Cs,0)||e,i++}}if(4&this.Zo){for(t=this.Cs+1;t<=this.kt;t++)this.tC(t,1);for(t=this.Cs-1;t>=0;t--)this.tC(t,-1);this.tC(this.Cs,0)}if(i&&(this.TD(-1),this.TD(1)),2&this.Zo){e=!0;let i=0;for(;e&&i<this.Jf;){for(e=!1,e=this.Mg(this.Cs,0)||e,t=this.Cs+1;t<=this.kt;t++)e=this.Mg(t,0)||e;for(t=this.Cs-1;t>=0;t--)e=this.Mg(t,0)||e;i++}}}Mg(t,e){let i=!1;for(;this.DI(t,e);)i=!0;return i}DI(t,e){let i=0;const s=this.vh(t),n=this.ci[t],o=this.Yy(t,-1);if(e>0)for(i=0;i<n;i++)o[i]=-1;const r=this.Yy(t,1);if(e<0)for(i=0;i<n;i++)r[i]=-1;let a=!1,h=!0;for(;h;)for(h=!1,i=0;i<n;i++){const l=s[i].column,u=this.nodeMinColumnSpace(s[i],!0),c=this.nodeMinColumnSpace(s[i],!1);let d=0;d=i-1<0||l-s[i-1].column-1>u+this.nodeMinColumnSpace(s[i-1],!1)?l-1:l;let f=0;f=i+1>=n||s[i+1].column-l-1>c+this.nodeMinColumnSpace(s[i+1],!0)?l+1:l;let g=0,p=0,m=0,y=0,v=0,x=0;if(e<=0){const e=s[i].sourceEdges.iterator;for(;e.next();){const i=e.value,s=i.fromVertex;if(i.valid&&s.layer!==t){y=this.linkStraightenWeight(i),v=i.portFromColOffset,x=i.portToColOffset;const t=s.column;g+=(Math.abs(l+x-(t+v))+1)*y,p+=(Math.abs(d+x-(t+v))+1)*y,m+=(Math.abs(f+x-(t+v))+1)*y}}}if(e>=0){const e=s[i].destinationEdges.iterator;for(;e.next();){const i=e.value,s=i.toVertex;if(i.valid&&s.layer!==t){y=this.linkStraightenWeight(i),v=i.portFromColOffset,x=i.portToColOffset;const t=s.column;g+=(Math.abs(l+v-(t+x))+1)*y,p+=(Math.abs(d+v-(t+x))+1)*y,m+=(Math.abs(f+v-(t+x))+1)*y}}}let b=0,w=0,k=0;const S=o[s[i].index],P=r[s[i].index];-1!==S&&(b+=Math.abs(S-l),w+=Math.abs(S-d),k+=Math.abs(S-f)),-1!==P&&(b+=Math.abs(P-l),w+=Math.abs(P-d),k+=Math.abs(P-f)),p<g||p===g&&w<b?(a=!0,h=!0,s[i].column=d):(m<g||m===g&&k<b)&&(a=!0,h=!0,s[i].column=f)}return this.Oh(t,s),this.Xy(),a}tC(t,e){let i=0;const s=this.vh(t),n=this.ci[t],o=this.wD(t,e),r=[];for(i=0;i<n;i++)r[i]=o[i];let a=!1,h=!0;for(;h;)for(h=!1,i=0;i<n;i++){const t=s[i].column,e=this.nodeMinColumnSpace(s[i],!0),o=this.nodeMinColumnSpace(s[i],!1);let l=0,u=0,c=0,d=0,f=0;-1===r[i]?0===i&&i===n-1?l=t:0===i?(u=s[i+1].column,l=u-t===o+this.nodeMinColumnSpace(s[i+1],!0)?t-1:t):i===n-1?(c=s[i-1].column,l=t-c===e+this.nodeMinColumnSpace(s[i-1],!1)?t+1:t):(c=s[i-1].column,f=c+this.nodeMinColumnSpace(s[i-1],!1)+e+1,u=s[i+1].column,d=u-this.nodeMinColumnSpace(s[i+1],!0)-o-1,l=(f+d)/2|0):0===i&&i===n-1?l=r[i]:0===i?(u=s[i+1].column,d=u-this.nodeMinColumnSpace(s[i+1],!0)-o-1,l=Math.min(r[i],d)):i===n-1?(c=s[i-1].column,f=c+this.nodeMinColumnSpace(s[i-1],!1)+e+1,l=Math.max(r[i],f)):(c=s[i-1].column,f=c+this.nodeMinColumnSpace(s[i-1],!1)+e+1,u=s[i+1].column,d=u-this.nodeMinColumnSpace(s[i+1],!0)-o-1,f<r[i]&&r[i]<d?l=r[i]:f>=r[i]?l=f:d<=r[i]&&(l=d)),l!==t&&(a=!0,h=!0,s[i].column=l)}return this.Oh(t,s),this.Xy(),a}FI(){for(let t=0;t<=this.zt;t++)for(;this.RI(t,1););this.Xy()}RI(t,e){let i=!0;const s=this.network.vertexes.iterator;for(;s.next();){const e=s.value,n=this.nodeMinColumnSpace(e,!0),o=this.nodeMinColumnSpace(e,!1);if(e.column-n<=t&&e.column+o>=t){i=!1;break}}let n=!1;if(i){if(e>0)for(s.reset();s.next();){const e=s.value;e.column>t&&(e.column-=1,n=!0)}if(e<0)for(s.reset();s.next();){const e=s.value;e.column<t&&(e.column+=1,n=!0)}}return n}vI(){this.FI();for(let t=0;t<this.zt;t++)for(;this.OI(t,1););this.Xy()}OI(t,e){let i=t;e>0&&(i=t+1),e<0&&(i=t-1);let s=0;const n=[],o=[];for(s=0;s<=this.kt;s++)n[s]=!1,o[s]=!1;const r=this.network.vertexes.iterator;for(;r.next();){const e=r.value,s=e.column-this.nodeMinColumnSpace(e,!0),a=e.column+this.nodeMinColumnSpace(e,!1);s<=t&&a>=t&&(n[e.layer]=!0),s<=i&&a>=i&&(o[e.layer]=!0)}let a=!0,h=!1;for(s=0;s<=this.kt;s++)a=a&&!(n[s]&&o[s]);if(a){if(e>0)for(r.reset();r.next();){const e=r.value;e.column>t&&(e.column-=1,h=!0)}if(e<0)for(r.reset();r.next();){const e=r.value;e.column<t&&(e.column+=1,h=!0)}}return h}TD(t){this.vI();let e,i=0,s=0,n=0,o=0;if(t>0)for(i=0;i<=this.zt;i++)for(e=this.Ji(),s=this.sk(!0),n=s+1;s<n;)n=s,this.DD(i,1),o=this.sk(!0),o>s?this.We(e):o<s&&(s=o,e=this.Ji());if(t<0)for(i=this.zt;i>=0;i--)for(e=this.Ji(),s=this.sk(!0),n=s+1;s<n;)n=s,this.DD(i,-1),o=this.sk(!0),o>s?this.We(e):o<s&&(s=o,e=this.Ji());this.Xy()}DD(t,e){this.Qs=0;const i=this.network.vertexes.iterator;for(;i.next();){const t=i.value;t.component=-1}if(e>0)for(i.reset();i.next();){const e=i.value;e.column-this.nodeMinColumnSpace(e,!0)<=t&&(e.component=this.Qs)}if(e<0)for(i.reset();i.next();){const e=i.value;e.column+this.nodeMinColumnSpace(e,!1)>=t&&(e.component=this.Qs)}for(this.Qs++,i.reset();i.next();){const t=i.value;-1===t.component&&(this.QN(t,this.Qs,-1,!0,!0),this.Qs++)}let s=0;const n=[];for(s=0;s<this.Qs*this.Qs;s++)n[s]=!1;const o=[];for(s=0;s<(this.kt+1)*(this.zt+1);s++)o[s]=-1;for(i.reset();i.next();){const t=i.value,e=t.layer,s=Math.max(0,t.column-this.nodeMinColumnSpace(t,!0)),n=Math.min(this.zt,t.column+this.nodeMinColumnSpace(t,!1));for(let i=s;i<=n;i++)o[e*(this.zt+1)+i]=t.component}for(let u=0;u<=this.kt;u++){if(e>0)for(let t=0;t<this.zt;t++)-1!==o[u*(this.zt+1)+t]&&-1!==o[u*(this.zt+1)+t+1]&&o[u*(this.zt+1)+t]!==o[u*(this.zt+1)+t+1]&&(n[o[u*(this.zt+1)+t]*this.Qs+o[u*(this.zt+1)+t+1]]=!0);if(e<0)for(let t=this.zt;t>0;t--)-1!==o[u*(this.zt+1)+t]&&-1!==o[u*(this.zt+1)+t-1]&&o[u*(this.zt+1)+t]!==o[u*(this.zt+1)+t-1]&&(n[o[u*(this.zt+1)+t]*this.Qs+o[u*(this.zt+1)+t-1]]=!0)}const r=[];for(s=0;s<this.Qs;s++)r[s]=!0;const a=[];a.push(0);let h=0;for(;0!==a.length;)if(h=a[a.length-1],a.pop(),r[h])for(r[h]=!1,s=0;s<this.Qs;s++)n[h*this.Qs+s]&&a.splice(0,0,s);let l=!1;if(e>0)for(i.reset();i.next();){const t=i.value;r[t.component]&&(t.column-=1,l=!0)}if(e<0)for(i.reset();i.next();){const t=i.value;r[t.component]&&(t.column+=1,l=!0)}return l}TI(){const t=e.et(),i=this.$f.length;for(let e=0;e<=i;e++)t[e]=[];const s=this.network.vertexes.iterator;for(;s.next();){const e=s.value,n=i-e.layer,o=t[n];o[e.index]=e}const n=new u;this.II(t,n);let o=null,r=null,a=null,h=null;const l=0!==(1&this.Ln),c=0!==(2&this.Ln),d=0!==(4&this.Ln),f=0!==(8&this.Ln);l&&(this._r(t,n,!0),o=this.lk(t,!0,!1)),t.reverse(),d&&(this._r(t,n,!1),a=this.lk(t,!1,!1));for(const e of t)e.reverse();f&&(this._r(t,n,!1),h=this.lk(t,!1,!0)),t.reverse(),c&&(this._r(t,n,!0),r=this.lk(t,!0,!0)),e.J(t),this.EI(o,r,a,h),this.network.vertexes.each((t=>{const i=t,s=e.et();l&&s.push(o.get(i)),c&&s.push(r.get(i)),d&&s.push(a.get(i)),f&&s.push(h.get(i)),s.sort(((t,e)=>t-e));const n=s.length,u=Math.floor((n-1)/2),g=Math.ceil((n-1)/2),p=(s[u]+s[g])/2;e.J(s),i.he=p}))}II(t,e){const i=t.length;for(let s=1;s<i-1;s++){let i=0,n=0;const o=t[s],r=t[s+1];for(let t=0;n<r.length;t++){const s=r[t],a=this.BI(s);if(t===r.length-1||a){let h=o.length-1;for(a&&(h=s.getProperSourceVertexes()[0].index);n<=t;){const t=r[n].getProperSourceEdges();for(const s of t){const t=s.fromVertex.index;(t<i||t>h)&&e.add(s)}n++}i=h}}}}BI(t){if(null===t.node){const e=t.getProperSourceVertexes();if(e.length>0)return null===e[0].node}return!1}_r(t,e,i){this.UI(t);for(const s of t){let t=-1;for(const n of s){const s=i?n.getProperSourceVertexes():n.getProperDestinationVertexes(),o=s.length;if(o>0){s.sort(((t,e)=>t.Ih-e.Ih));const r=(o-1)/2;for(let o=Math.floor(r),a=Math.ceil(r);o<=a;o++)if(n.An===n){const r=s[o];let a;a=i?r.getDestinationEdge(n):n.getDestinationEdge(r),!e.has(a)&&t<r.Ih&&(r.An=n,n.tc=r.tc,n.An=r.tc,t=r.Ih)}}}}}UI(t){for(let e=0;e<t.length;e++){const i=t[e];for(let t=0;t<i.length;t++){const s=i[t];s.tc=s,s.An=s,s.FD=e,s.Ih=t}}}lk(t,e,i){const s=90===this.b||270===this.b;for(const o of t)for(const t of o)t.Je=t,t.Qf=1/0,t.he=NaN,t.Tn=0;this.VI(t,e,i);for(const o of t)for(const e of o)e.tc===e&&this.RD(e,t);for(let o=0;o<t.length;o++){if(t[o].length<=0)continue;const e=t[o][0];if(e.Je===e){e.Je.Qf===1/0&&(e.Je.Qf=0);let i,n=o,r=0;do{for(i=t[n][r];i.An!==i.tc;)if(i=i.An,n++,i.Ih>0){const e=this.vD(i,t),n=s?e.width:e.height,o=i.Je.Qf+i.he+i.Tn-(e.he+e.Tn+n+this.columnSpacing);e.Je.Qf=Math.min(e.Je.Qf,o)}r=i.Ih+1}while(n<t.length&&r<t[n].length&&i.Je===t[n][r].Je)}}const n=new m;for(const o of t)for(const t of o){t.he=t.he+t.Je.Qf+t.Tn;const e=s?t.width:t.height;n.set(t,i?-t.he-e:t.he)}return n}VI(t,e,i){const s=90===this.b||270===this.b;for(const n of t)for(const t of n)if(t.tc===t){let n=0,o=t;for(;o.An!==t;){const t=o.An,r=s?o.width:o.height,a=s?t.width:t.height;let h,l,u,c;e?(u=o.getDestinationEdge(t),h=u.portFromPos,l=u.portToPos,null!==u.link&&(o.node&&o.node!==u.link.fromNode&&(h=s?o.focusX:o.focusY),t.node&&t.node!==u.link.toNode&&(l=s?t.focusX:t.focusY)),c=i?o.Tn+(r-h)-(a-l):o.Tn+h-l):(u=t.getDestinationEdge(o),h=u.portToPos,l=u.portFromPos,null!==u.link&&(o.node&&o.node!==u.link.toNode&&(h=s?o.focusX:o.focusY),t.node&&t.node!==u.link.fromNode&&(l=s?t.focusX:t.focusY)),c=i?o.Tn+(r-h)-(a-l):o.Tn+h-l),t.Tn=c,n=Math.min(n,c),o=o.An}o=t;do{o.Tn=o.Tn-n,o=o.An}while(o!==t)}}RD(t,e){if(!isNaN(t.he))return;t.he=0;let i=t;do{if(i.Ih>0){const s=this.vD(i,e),n=s.tc;this.RD(n,e),t.Je===t&&(t.Je=n.Je);const o=90===this.b||270===this.b?s.width:s.height;if(t.Je===n.Je){const e=n.he+s.Tn+o-i.Tn+this.columnSpacing;t.he=Math.max(t.he,e)}}i=i.An}while(i!==t);for(;i.An!==t;)i=i.An,i.he=t.he,i.Je=t.Je}vD(t,i){const s=t.FD,n=t.Ih;return n<1&&e.o("Could not determine previous vertex in layer"),i[s][n-1]}EI(...t){let i=-1;const s=e.et(),n=e.et();let o=1/0;for(let e=0;e<4;e++){if(!t[e])continue;const r=this.zI(t[e],s,n,e);r<o&&(i=e,o=r)}for(let e=0;e<4;e++){const o=t[e];if(!o)continue;const r=0===e||2===e?s[i]-s[e]:n[i]-n[e];0!==r&&o.each((t=>{o.set(t.key,t.value+r)}))}e.J(s),e.J(n)}zI(t,e,i,s){if(!t||0===t.count)return e[s]=0,i[s]=0,1/0;let n=1/0,o=-1/0;return t.each((t=>{const e=t.key,i=t.value,s=90===this.b||270===this.b?e.width:e.height;i<n&&(n=i),i+s>o&&(o=i+s)})),e[s]=n,i[s]=o,o-n}commitLayout(){this.Vy(),this.commitNodes(),this.iC(),this.isRouting&&this.commitLinks()}Vy(){if(!this.setsPortSpots)return;const t=this.ok(!0),e=this.ok(!1),i=this.network.edges.iterator;for(;i.next();){const s=i.value.link;null!==s&&(s.fromSpot=t,s.toSpot=e)}}ok(t){return 270===this.b?t?w.MiddleTop:w.MiddleBottom:90===this.b?t?w.MiddleBottom:w.MiddleTop:180===this.b?t?w.MiddleLeft:w.MiddleRight:t?w.MiddleRight:w.MiddleLeft}commitNodes(){this.Zs=[],this.Ls=[],this.As=[],this.It=[];for(let f=0;f<=this.kt;f++)this.Zs[f]=0,this.Ls[f]=0,this.As[f]=0,this.It[f]=0;const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value,i=e.layer;this.Zs[i]=Math.max(this.Zs[i],this.nodeMinLayerSpace(e,!0)),this.Ls[i]=Math.max(this.Ls[i],this.nodeMinLayerSpace(e,!1))}let e=0;const i=this.Ns;for(let f=0;f<=this.kt;f++){let t=i;this.Zs[f]+this.Ls[f]<=0&&(t=0),f>0&&(e+=t/2),90===this.b||0===this.b?(e+=this.Ls[f],this.As[f]=e,e+=this.Zs[f]):(e+=this.Zs[f],this.As[f]=e,e+=this.Ls[f]),f<this.kt&&(e+=t/2),this.It[f]=e}const s=e,n=this.arrangementOrigin;for(let f=0;f<=this.kt;f++)270===this.b?this.As[f]=n.y+this.As[f]:90===this.b?(this.As[f]=n.y+s-this.As[f],this.It[f]=s-this.It[f]):180===this.b?this.As[f]=n.x+this.As[f]:(this.As[f]=n.x+s-this.As[f],this.It[f]=s-this.It[f]);const o=0!==this.Ln;t.reset();const r=270===this.b||90===this.b;let a=1/0,h=1/0,l=1/0,u=-1/0;for(;t.next();){const e=t.value,i=e.layer,s=0|e.column;let c=0,d=0;r?(c=n.x+this.Wi*s,d=this.As[i]):(c=this.As[i],d=n.y+this.Wi*s),e.centerX=c,e.centerY=d,o&&isFinite(e.he)&&(r?e.node?e.x=n.x+e.he:e.centerX=n.x+e.he:e.node?e.y=n.y+e.he:e.centerY=n.y+e.he),a=Math.min(e.x,a),h=Math.min(e.y,h),r?(l=a,u=Math.max(u,e.bounds.right)):(l=h,u=Math.max(u,e.bounds.bottom))}this.ZN=u-l;const c=n.x-a,d=n.y-h;for(this.Qo=new y(o&&r?0:c,o&&!r?0:d),t.reset();t.next();){const e=t.value;e.x+=c,e.y+=d,e.commit()}}iC(){let t=0;const e=this.Ns;for(let n=0;n<=this.kt;n++)t+=this.Zs[n],t+=this.Ls[n];t+=this.kt*e;const i=[],s=0!==this.Ln?this.ZN:this.Wi*this.zt;for(let n=this.maxLayer;n>=0;n--)270===this.b?0===n?i.push(new x(0,0,s,Math.abs(this.It[0]))):i.push(new x(0,this.It[n-1],s,Math.abs(this.It[n-1]-this.It[n]))):90===this.b?0===n?i.push(new x(0,this.It[0],s,Math.abs(this.It[0]-t))):i.push(new x(0,this.It[n],s,Math.abs(this.It[n-1]-this.It[n]))):180===this.b?0===n?i.push(new x(0,0,Math.abs(this.It[0]),s)):i.push(new x(this.It[n-1],0,Math.abs(this.It[n-1]-this.It[n]),s)):0===n?i.push(new x(this.It[0],0,Math.abs(this.It[0]-t),s)):i.push(new x(this.It[n],0,Math.abs(this.It[n-1]-this.It[n]),s));this.commitLayers(i,this.Qo)}commitLayers(t,e){}commitLinks(){const t=this.network.edges.iterator;let e;for(;t.next();)e=t.value.link,null!==e&&(e.startRoute(),e.clearPoints(),e.commitRoute());for(t.reset();t.next();)e=t.value.link,null!==e&&e.updateRoute();for(t.reset();t.next();){const i=t.value;if(e=i.link,null===e||0===e.pointsCount)continue;e.startRoute();const s=e;let n=s.fromNode,o=s.toNode,r=s.fromPort,a=s.toPort;if(null!==n){const t=n.findVisibleNode();null!==t&&t!==n&&(n=t,r=t.port)}if(null!==o){const t=o.findVisibleNode();null!==t&&t!==o&&(o=t,a=t.port)}const h=e.computeSpot(!0,r),l=e.computeSpot(!1,a);let u=i.fromVertex,c=i.toVertex;if(i.valid){if(9===e.curve&&4===e.pointsCount)if(u.column===c.column&&0===this.alignOption){const t=e.getLinkPoint(n,r,h,!0,!1,o,a),i=e.getLinkPoint(o,a,l,!1,!1,n,r);t.isReal()||t.set(n.actualBounds.center),i.isReal()||i.set(o.actualBounds.center),e.clearPoints(),e.addPointAt(t.x,t.y),e.addPointAt((2*t.x+i.x)/3,(2*t.y+i.y)/3),e.addPointAt((t.x+2*i.x)/3,(t.y+2*i.y)/3),e.addPointAt(i.x,i.y)}else{let t=!1,i=!1;if(null!==r&&h===w.None&&(t=!0),null!==a&&l===w.None&&(i=!0),t||i){let s=null;t&&(s=e.getLinkPointFromPoint(n,r,r.getDocumentPoint(w.Center),e.getPoint(3),!0),s.isReal()||s.set(n.actualBounds.center),e.setPointAt(0,s.x,s.y));let h=null;if(i&&(h=e.getLinkPointFromPoint(o,a,a.getDocumentPoint(w.Center),e.getPoint(0),!1),h.isReal()||h.set(o.actualBounds.center),e.setPointAt(3,h.x,h.y)),s){const t=e.getPoint(2);e.setPointAt(1,(2*s.x+t.x)/3,(2*s.y+t.y)/3)}if(h){const t=e.getPoint(1);e.setPointAt(2,(2*h.x+t.x)/3,(2*h.y+t.y)/3)}}}e.commitRoute();continue}if(u.layer===c.layer){e.commitRoute();continue}let d=!1,f=!1;const g=this.Ns;let p=0,m=e.firstPickIndex+1;if(e.isOrthogonal)f=!0,p=e.pointsCount,p>4&&e.points.removeRange(2,p-3);else if(9===e.curve)d=!0,p=e.pointsCount,p>4&&e.points.removeRange(2,p-3),4===p&&(m=2);else{p=e.pointsCount;const t=h===w.None,i=l===w.None;p>2&&t&&i?e.points.removeRange(1,p-2):p>3&&t&&!i?e.points.removeRange(1,p-3):p>3&&!t&&i?e.points.removeRange(2,p-2):p>4&&!t&&!i&&e.points.removeRange(2,p-3)}let y,v,x=0,b=0,k=0,S=0,P=0,M=0,C=0;if(i.rev){let t=0;for(;null!==c&&u!==c;){y=null,v=null;const s=c.sourceEdges.iterator;for(;s.next();){const t=s.value;if(t.link===i.link&&(y=t.fromVertex,v=t.toVertex,null===y.node))break}if(null===y)break;if(y!==u)if(x=e.getPoint(m-1).x,b=e.getPoint(m-1).y,k=y.centerX,S=y.centerY,f)180===this.b||0===this.b?m===e.firstPickIndex+1?(e.insertPointAt(m++,x,b),e.insertPointAt(m++,x,S)):(null!==v?v.centerY:b)!==S&&(P=this.It[y.layer-1]+this.Qo.x,e.insertPointAt(m++,P,b),e.insertPointAt(m++,P,S)):m===e.firstPickIndex+1?(e.insertPointAt(m++,x,b),e.insertPointAt(m++,k,b)):(null!==v?v.centerX:x)!==k&&(P=this.It[y.layer-1]+this.Qo.y,e.insertPointAt(m++,x,P),e.insertPointAt(m++,k,P));else if(m===e.firstPickIndex+1)if(M=Math.max(10,this.Zs[c.layer]),C=Math.max(10,this.Ls[c.layer]),d)180===this.b?k<=c.bounds.x?(t=c.bounds.x,e.insertPointAt(m++,t-M,S),e.insertPointAt(m++,t,S),e.insertPointAt(m++,t+C,S)):(e.insertPointAt(m++,k-M,S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k+C,S)):90===this.b?S>=c.bounds.bottom?(t=c.bounds.y+c.bounds.height,e.insertPointAt(m++,k,t+C),e.insertPointAt(m++,k,t),e.insertPointAt(m++,k,t-M)):(e.insertPointAt(m++,k,S+C),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,S-M)):270===this.b?S<=c.bounds.y?(t=c.bounds.y,e.insertPointAt(m++,k,t-M),e.insertPointAt(m++,k,t),e.insertPointAt(m++,k,t+C)):(e.insertPointAt(m++,k,S-M),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,S+C)):0===this.b&&(k>=c.bounds.right?(t=c.bounds.x+c.bounds.width,e.insertPointAt(m++,t+C,S),e.insertPointAt(m++,t,S),e.insertPointAt(m++,t-M,S)):(e.insertPointAt(m++,k+C,S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k-M,S)));else{e.insertPointAt(m++,x,b);let t=0;180===this.b||0===this.b?((180===this.b?k>=c.bounds.right:k<=c.bounds.x)&&(t=(0===this.b?-M:C)/2),e.insertPointAt(m++,x+t,S)):((270===this.b?S>=c.bounds.bottom:S<=c.bounds.y)&&(t=(90===this.b?-M:C)/2),e.insertPointAt(m++,k,b+t)),e.insertPointAt(m++,k,S)}else M=Math.max(10,this.Zs[y.layer]),C=Math.max(10,this.Ls[y.layer]),d?180===this.b?(e.insertPointAt(m++,k-M-g,S),e.insertPointAt(m++,Math.min(k-M+g/2,k),S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,Math.max(k+C-g/2,k),S),e.insertPointAt(m++,k+C+g,S)):90===this.b?(e.insertPointAt(m++,k,S+C+g),e.insertPointAt(m++,k,Math.max(S+C-g/2,S)),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,Math.min(S-M+g/2,S)),e.insertPointAt(m++,k,S-M-g)):270===this.b?(e.insertPointAt(m++,k,S-M-g),e.insertPointAt(m++,k,Math.min(S-M+g/2,S)),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,Math.max(S+C-g/2,S)),e.insertPointAt(m++,k,S+C+g)):(e.insertPointAt(m++,k+C+g,S),e.insertPointAt(m++,Math.max(k+C-g/2,k),S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,Math.min(k-M+g/2,k),S),e.insertPointAt(m++,k-M-g,S)):(180===this.b||90===this.b||this.b,e.insertPointAt(m++,k,S));c=y}if(null===a||h!==w.None||f)if(x=e.getPoint(m-1).x,b=e.getPoint(m-1).y,k=e.getPoint(m).x,S=e.getPoint(m).y,f){const i=this.Ls[u.layer];let s=0;180===this.b||0===this.b?(s=b,s>=u.bounds.y&&s<=u.bounds.bottom&&(180===this.b?k>=u.bounds.x:k<=u.bounds.right)&&(t=u.centerX+(180===this.b?-i:i),s=s<u.bounds.y+u.bounds.height/2?u.bounds.y-this.Wi/2:u.bounds.bottom+this.Wi/2,e.insertPointAt(m++,t,b),e.insertPointAt(m++,t,s)),e.insertPointAt(m++,k,s),e.insertPointAt(m++,k,S)):(s=x,s>=u.bounds.x&&s<=u.bounds.right&&(270===this.b?S>=u.bounds.y:S<=u.bounds.bottom)&&(t=u.centerY+(270===this.b?-i:i),s=s<u.bounds.x+u.bounds.width/2?u.bounds.x-this.Wi/2:u.bounds.right+this.Wi/2,e.insertPointAt(m++,x,t),e.insertPointAt(m++,s,t)),e.insertPointAt(m++,s,S),e.insertPointAt(m++,k,S))}else if(d)M=Math.max(10,this.Zs[u.layer]),C=Math.max(10,this.Ls[u.layer]),180===this.b&&k>=u.bounds.x?(t=u.bounds.x+u.bounds.width,e.setPointAt(m-2,t,b),e.setPointAt(m-1,t+C,b)):90===this.b&&S<=u.bounds.bottom?(t=u.bounds.y,e.setPointAt(m-2,x,t),e.setPointAt(m-1,x,t-M)):270===this.b&&S>=u.bounds.y?(t=u.bounds.y+u.bounds.height,e.setPointAt(m-2,x,t),e.setPointAt(m-1,x,t+C)):0===this.b&&k<=u.bounds.right&&(t=u.bounds.x,e.setPointAt(m-2,t,b),e.setPointAt(m-1,t-M,b));else{M=Math.max(10,this.Zs[u.layer]),C=Math.max(10,this.Ls[u.layer]);let t=0;180===this.b||0===this.b?((180===this.b?k<=u.bounds.x:k>=u.bounds.right)&&(t=(0===this.b?C:-M)/2),e.insertPointAt(m++,k+t,b)):((270===this.b?S<=u.bounds.y:S>=u.bounds.bottom)&&(t=(90===this.b?C:-M)/2),e.insertPointAt(m++,x,S+t)),e.insertPointAt(m++,k,S)}}else{for(;null!==u&&u!==c;){y=null,v=null;const t=u.destinationEdges.iterator;for(;t.next();){const e=t.value;if(e.link===i.link&&(y=e.toVertex,v=e.fromVertex,null!==v.node&&(v=null),null===y.node))break}if(null===y)break;y!==c&&(x=e.getPoint(m-1).x,b=e.getPoint(m-1).y,k=y.centerX,S=y.centerY,f?180===this.b||0===this.b?(null!==v?v.centerY:b)!==S&&(P=this.It[y.layer]+this.Qo.x,m===e.firstPickIndex+1&&(P=0===this.b?Math.max(P,x):Math.min(P,x)),e.insertPointAt(m++,P,b),e.insertPointAt(m++,P,S)):(null!==v?v.centerX:x)!==k&&(P=this.It[y.layer]+this.Qo.y,m===e.firstPickIndex+1&&(P=90===this.b?Math.max(P,b):Math.min(P,b)),e.insertPointAt(m++,x,P),e.insertPointAt(m++,k,P)):(M=Math.max(10,this.Zs[y.layer]),C=Math.max(10,this.Ls[y.layer]),d?180===this.b?(e.insertPointAt(m++,k+C+g,S),e.insertPointAt(m++,Math.max(k+C-g/2,k),S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,Math.min(k-M+g/2,k),S),e.insertPointAt(m++,k-M-g,S)):90===this.b?(e.insertPointAt(m++,k,S-M-g),e.insertPointAt(m++,k,Math.min(S-M+g/2,S)),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,Math.max(S+C-g/2,S)),e.insertPointAt(m++,k,S+C+g)):270===this.b?(e.insertPointAt(m++,k,S+C+g),e.insertPointAt(m++,k,Math.max(S+C-g/2,S)),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,Math.min(S-M+g/2,S)),e.insertPointAt(m++,k,S-M-g)):(e.insertPointAt(m++,k-M-g,S),e.insertPointAt(m++,Math.min(k-M+g/2,k),S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,Math.max(k+C-g/2,k),S),e.insertPointAt(m++,k+C+g,S)):180===this.b?(e.insertPointAt(m++,k+C,S),e.insertPointAt(m++,k-M,S)):90===this.b?(e.insertPointAt(m++,k,S-M),e.insertPointAt(m++,k,S+C)):270===this.b?(e.insertPointAt(m++,k,S+C),e.insertPointAt(m++,k,S-M)):(e.insertPointAt(m++,k-M,S),e.insertPointAt(m++,k+C,S)))),u=y}f&&(x=e.getPoint(m-1).x,b=e.getPoint(m-1).y,k=e.getPoint(m).x,S=e.getPoint(m).y,180===this.b||0===this.b?b!==S&&(P=0===this.b?Math.min(Math.max((k+x)/2,this.It[c.layer]+this.Qo.x),k):Math.max(Math.min((k+x)/2,this.It[c.layer]+this.Qo.x),k),e.insertPointAt(m++,P,b),e.insertPointAt(m++,P,S)):x!==k&&(P=90===this.b?Math.min(Math.max((S+b)/2,this.It[c.layer]+this.Qo.y),S):Math.max(Math.min((S+b)/2,this.It[c.layer]+this.Qo.y),S),e.insertPointAt(m++,x,P),e.insertPointAt(m++,k,P)))}if(null!==s&&d&&e.pointsCount>=4){if(null!==r){const t=h===w.None?e.getLinkPointFromPoint(n,r,r.getDocumentPoint(w.Center),e.getPoint(3),!0):e.getPoint(0);if(h===w.None){const i=e.getPoint(2),s=e.getPoint(3);90===this.direction||270===this.direction?(e.setPointAt(1,(t.x+i.x)/2,i.y),e.setPointAt(2,s.x,(i.y+s.y)/2)):(e.setPointAt(1,i.x,(t.y+i.y)/2),e.setPointAt(2,(i.x+s.x)/2,s.y))}t.isReal()||t.set(n.actualBounds.center),e.setPointAt(0,t.x,t.y)}if(null!==a){const t=l===w.None?e.getLinkPointFromPoint(o,a,a.getDocumentPoint(w.Center),e.getPoint(e.pointsCount-4),!1):e.getPoint(e.pointsCount-1);if(l===w.None){const i=e.getPoint(e.pointsCount-3),s=e.getPoint(e.pointsCount-4);90===this.direction||270===this.direction?(e.setPointAt(e.pointsCount-2,(t.x+i.x)/2,i.y),e.setPointAt(e.pointsCount-2,s.x,(i.y+s.y)/2)):(e.setPointAt(e.pointsCount-2,i.x,(t.y+i.y)/2),e.setPointAt(e.pointsCount-3,(i.x+s.x)/2,s.y))}t.isReal()||t.set(o.actualBounds.center),e.setPointAt(e.pointsCount-1,t.x,t.y)}}e.commitRoute(),i.commit()}}hI(){this.zy=-1,this.kg=0,this.Cs=0,this._a=null,this.Sg=null,this.$f=null;for(let t=0;t<this.Cn.length;t++)this.Cn[t]=null}vh(t){let e;const i=this.ci[t];if(i>=this.Cn.length){const t=[];for(let e=0;e<this.Cn.length;e++)t[e]=this.Cn[e];this.Cn=t}void 0===this.Cn[i]||null===this.Cn[i]?e=[]:(e=this.Cn[i],this.Cn[i]=null);const s=this.$f[t];for(let n=0;n<s.length;n++){const t=s[n];e[t.index]=t}return e}Oh(t,e){this.Cn[this.ci[t]]=e}get layerSpacing(){return this.Ns}set layerSpacing(t){this.Ns!==t&&(e.s(t,"number",Si,"layerSpacing"),t>=0&&(this.Ns=t,this.invalidateLayout()))}get columnSpacing(){return this.Wi}set columnSpacing(t){this.Wi!==t&&(e.s(t,"number",Si,"columnSpacing"),t>0&&(this.Wi=t,this.invalidateLayout()))}get direction(){return this.b}set direction(t){this.b!==t&&(e.s(t,"number",Si,"direction"),0===t||90===t||180===t||270===t?(this.b=t,this.invalidateLayout()):e.o("LayeredDigraphLayout.direction must be 0, 90, 180, or 270"))}get cycleRemoveOption(){return this.Hf}set cycleRemoveOption(t){this.Hf!==t&&(1===t||0===t||2===t)&&(this.Hf=t,this.invalidateLayout())}get layeringOption(){return this.jf}set layeringOption(t){this.jf!==t&&(10===t||11===t||12===t)&&(this.jf=t,this.invalidateLayout())}get initializeOption(){return this.qf}set initializeOption(t){this.qf!==t&&(20===t||21===t||22===t)&&(this.qf=t,this.invalidateLayout())}get iterations(){return this.Qa}set iterations(t){this.Qa!==t&&t>=0&&(this.Qa=t,this.invalidateLayout())}get aggressiveOption(){return this.Wf}set aggressiveOption(t){this.Wf!==t&&(30===t||31===t||32===t)&&(this.Wf=t,this.invalidateLayout())}get packOption(){return this.Zo}set packOption(t){this.Zo!==t&&(e.s(t,"number",Si,"packOption"),t>=0&&t<8&&(this.Zo=t,this.invalidateLayout()))}get packIterations(){return this.Jf}set packIterations(t){this.Jf=t}get alignOption(){return this.Ln}set alignOption(t){this.Ln!==t&&(e.s(t,"number",Si,"align"),t>=0&&t<16&&(this.Ln=t,this.invalidateLayout()))}get setsPortSpots(){return this.Nn}set setsPortSpots(t){this.Nn!==t&&(e.s(t,"boolean",Si,"setsPortSpots"),this.Nn=t,this.invalidateLayout())}get maxLayer(){return this.kt}get maxIndex(){return this.zy}get maxColumn(){return this.zt}get minIndexLayer(){return this.kg}get maxIndexLayer(){return this.Cs}static CycleDepthFirst=0;static CycleGreedy=1;static CycleFromLayers=2;static LayerOptimalLinkLength=10;static LayerLongestPathSink=11;static LayerLongestPathSource=12;static InitDepthFirstOut=20;static InitDepthFirstIn=21;static InitNaive=22;static AggressiveNone=30;static AggressiveLess=31;static AggressiveMore=32;static PackNone=0;static PackExpand=1;static PackStraighten=2;static PackMedian=4;static PackAll=15;static AlignNone=0;static AlignUpperLeft=1;static AlignUpperRight=2;static AlignLowerLeft=4;static AlignLowerRight=8;static AlignAll=15}class Pi extends je{constructor(t){super(t)}createVertex(){return new Mi(this)}createEdge(){return new Ci(this)}}class Mi extends $e{Xo;Gr;At;hk;ak;$i;Zf;Xn;nk;ik;ek;tc;An;FD;Ih;Je;Qf;he;Tn;Gy=null;Hy=null;jy=null;qy=null;constructor(t){super(t),this.Xo=-1,this.Gr=-1,this.At=-1,this.hk=NaN,this.ak=null,this.$i=!1,this.Zf=NaN,this.Xn=NaN,this.nk=0,this.ik=null,this.ek=null}static OD(t,e){return t.index-e.index}getProperSourceEdges(){if(!this.jy){const t=[];for(const e of this.co){const i=e;i.valid&&t.push(i)}this.jy=t}return this.jy}getProperDestinationEdges(){if(!this.qy){const t=[];for(const e of this.qo){const i=e;i.valid&&t.push(i)}this.qy=t}return this.qy}getDestinationEdge(t){const i=this.getProperDestinationEdges();for(const e of i)if(e.toVertex===t)return e;e.o("Unable to find destination edge to given vertex")}getProperSourceVertexes(){if(!this.Gy){const t=[];for(const e of this.co){const i=e;!i.valid||i.fromVertex.layer<=i.toVertex.layer||t.push(i.fromVertex)}t.sort(Mi.OD),this.Gy=t}return this.Gy}getProperDestinationVertexes(){if(!this.Hy){const t=[];for(const e of this.qo){const i=e;!i.valid||i.fromVertex.layer<=i.toVertex.layer||t.push(i.toVertex)}t.sort(Mi.OD),this.Hy=t}return this.Hy}addSourceEdge(t){super.addSourceEdge(t),this.Gy=null,this.jy=null}deleteSourceEdge(t){super.deleteSourceEdge(t),this.Gy=null,this.jy=null}addDestinationEdge(t){super.addDestinationEdge(t),this.Hy=null,this.qy=null}deleteDestinationEdge(t){super.deleteDestinationEdge(t),this.Hy=null,this.qy=null}get layer(){return this.Xo}set layer(t){this.Xo!==t&&(e.s(t,"number",Mi,"layer"),this.Xo=t)}get column(){return this.Gr}set column(t){this.Gr!==t&&(e.s(t,"number",Mi,"column"),this.Gr=t)}get index(){return this.At}set index(t){this.At!==t&&(e.s(t,"number",Mi,"index"),this.At=t)}get component(){return this.hk}set component(t){this.hk!==t&&(e.s(t,"number",Mi,"component"),this.hk=t)}get near(){return this.ak}set near(t){this.ak!==t&&(this.ak=t)}}class Ci extends Xe{$i;ck;fk;uk;dk;gk;mk;constructor(t){super(t),this.$i=!1,this.ck=!1,this.fk=!1,this.uk=NaN,this.dk=NaN,this.gk=0,this.mk=0}get fromVertex(){return this.je}set fromVertex(t){this.je!==t&&(this.je=t)}get toVertex(){return this.qe}set toVertex(t){this.qe!==t&&(this.qe=t)}get valid(){return this.$i}set valid(t){this.$i!==t&&(e.s(t,"boolean",Ci,"valid"),this.$i=t)}get rev(){return this.ck}set rev(t){this.ck!==t&&(e.s(t,"boolean",Ci,"rev"),this.ck=t)}get forest(){return this.fk}set forest(t){this.fk!==t&&(e.s(t,"boolean",Ci,"forest"),this.fk=t)}get portFromPos(){return this.uk}set portFromPos(t){this.uk!==t&&(e.s(t,"number",Ci,"portFromPos"),this.uk=t)}get portToPos(){return this.dk}set portToPos(t){this.dk!==t&&(e.s(t,"number",Ci,"portToPos"),this.dk=t)}get portFromColOffset(){return this.gk}set portFromColOffset(t){this.gk!==t&&(e.s(t,"number",Ci,"portFromColOffset"),this.gk=t)}get portToColOffset(){return this.mk}set portToColOffset(t){this.mk!==t&&(e.s(t,"number",Ci,"portToColOffset"),this.mk=t)}}var Ai=(t=>(t[t.Default=0]="Default",t[t.Destination=1]="Destination",t[t.Source=2]="Source",t))(Ai||{}),Ni=(t=>(t[t.Forwards=10]="Forwards",t[t.Reverse=11]="Reverse",t[t.Ascending=12]="Ascending",t[t.Descending=13]="Descending",t))(Ni||{}),Li=(t=>(t[t.CenterSubtrees=20]="CenterSubtrees",t[t.CenterChildren=21]="CenterChildren",t[t.Start=22]="Start",t[t.End=23]="End",t[t.Bus=24]="Bus",t[t.BusBranching=25]="BusBranching",t[t.TopLeftBus=26]="TopLeftBus",t[t.BottomRightBus=27]="BottomRightBus",t[t.Custom=28]="Custom",t))(Li||{}),Ti=(t=>(t[t.None=30]="None",t[t.Block=31]="Block",t))(Ti||{}),Di=(t=>(t[t.Layered=40]="Layered",t[t.LastParents=41]="LastParents",t[t.Alternating=42]="Alternating",t[t.RootOnly=43]="RootOnly",t))(Di||{}),Oi=(t=>(t[t.Vertical=50]="Vertical",t[t.Horizontal=51]="Horizontal",t[t.FixedRoots=52]="FixedRoots",t))(Oi||{}),Fi=(t=>(t[t.Individual=60]="Individual",t[t.Siblings=61]="Siblings",t[t.Uniform=62]="Uniform",t))(Fi||{});class Ri extends ze{Fi;Li;_f;Ng;eC;Fe;Xi;Ms;B;U;pk;ls;constructor(t){super(),this.Fi=new u,this.Li=0,this.ls=1,this._f=40,this.Ng=60,this.eC=[],this.Fe=!0,this.Xi=50,this.Ms=new v(10,10).u();const e=new Ei(this);this.B=new Bi(e),this.U=new Bi(e),this.pk=[],t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.Li=this.Li,t._f=this._f,t.Ng=this.Ng,t.Fe=this.Fe,t.Xi=this.Xi,t.Ms.a(this.Ms),t.B.copyInheritedPropertiesFrom(this.B),t.U.copyInheritedPropertiesFrom(this.U)}oi(t){t in Li?this.alignment=t:t in Oi?this.arrangement=t:t in Ti?this.compaction=t:t in Ai?this.path=t:t in Ni?this.sorting=t:t in Di?this.treeStyle=t:super.oi(t)}createNetwork(){return new Ei(this)}makeNetwork(t){const e=this.createNetwork(),i=t=>{if(t instanceof Ce)return!t.isLinkLabel&&"Comment"!==t.category;if(t instanceof De){const e=t.fromNode;if(null===e||e.isLinkLabel||"Comment"===e.category)return!1;const i=t.toNode;return!(null===i||i.isLinkLabel||"Comment"===i.category)}return!1};return t instanceof vt?(e.addParts(t.nodes,!0,i),e.addParts(t.links,!0,i)):t instanceof _e?e.addParts(t.memberParts,!1,i):e.addParts(t.iterator,!1,i),e}doLayout(t){null===this.network&&(this.network=this.makeNetwork(t)),52!==this.arrangement&&(this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin));let e=this.diagram;null===e&&t instanceof vt&&(e=t),0===this.path&&null!==e?this.ls=e.isTreePathToChildren?1:2:this.ls=0===this.path?1:this.path,this.network.vertexes.count>0&&(this.HI(),this.jI(),this.qI(),this.WI(),this.JN(),this.JI(),this.arrangeTrees(),this.updateParts()),this.network=null,this.Fi=new u,this.isValidLayout=!0}HI(){this.network.deleteSelfEdges();const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value;e.initialized=!1,e.level=0,e.parent=null,e.children=[]}if(this.Fi.count>0){const t=new u,e=this.Fi.iterator;for(;e.next();){const i=e.value;if(i instanceof Ce){const e=this.network.findVertex(i);null!==e&&t.add(e)}else i instanceof Bi&&t.add(i)}this.Fi=t}0===this.Fi.count&&this.findRoots();const e=this.Fi.copy().iterator;for(;e.next();){const t=e.value;t.initialized||(t.initialized=!0,this.sC(t))}let i=this.network.vertexes,s=null;for(;s=this.$I(i),s.count>0;){const t=this.ID(s);null!==t&&this.Fi.add(t),t.initialized=!0,this.sC(t),i=s}}$I(t){const e=new u,i=t.iterator;for(;i.next();){const t=i.value;t.initialized||e.add(t)}return e}findRoots(){const t=this.network.vertexes,i=t.iterator;for(;i.next();){const t=i.value;switch(this.ls){case 1:0===t.sourceEdges.count&&this.Fi.add(t);break;case 2:0===t.destinationEdges.count&&this.Fi.add(t);break;default:e.o("Unhandled path value "+this.ls.toString())}}if(0===this.Fi.count){const e=this.ID(t);null!==e&&this.Fi.add(e)}}ID(t){let i=999999,s=null;const n=t.iterator;for(;n.next();){const t=n.value;switch(this.ls){case 1:t.sourceEdges.count<i&&(i=t.sourceEdges.count,s=t);break;case 2:t.destinationEdges.count<i&&(i=t.destinationEdges.count,s=t);break;default:e.o("Unhandled path value "+this.ls.toString())}}return s}sC(t){if(null===t)return;switch(this.ls){case 1:if(t.destinationEdges.count>0){const e=new h,i=t.destinationVertexes;for(;i.next();){const s=i.value;this.ED(t,s)&&e.add(s)}e.count>0&&(t.children=e.toArray())}break;case 2:if(t.sourceEdges.count>0){const e=new h,i=t.sourceVertexes;for(;i.next();){const s=i.value;this.ED(t,s)&&e.add(s)}e.count>0&&(t.children=e.toArray())}break;default:e.o("Unhandled path value"+this.ls.toString())}const i=t.children,s=i.length;for(let e=0;e<s;e++){const s=i[e];s.initialized=!0,s.level=t.level+1,s.parent=t,this.Fi.delete(s)}for(let e=0;e<s;e++){const t=i[e];this.sC(t)}}ED(t,e){return!e.initialized||!(this.ZI(e,t)||e.level>t.level)&&(this.QI(e.parent,e),!0)}ZI(t,e){if(null===e)return!1;let i=e.parent;for(;null!==i&&i!==t;)i=i.parent;return i===t}QI(t,e){if(null===t||null===e)return;const i=t.children;let s=0;for(let n=0;n<i.length;n++)i[n]===e&&s++;if(s>0){const n=new Array(i.length-s);let o=0;for(let t=0;t<i.length;t++)i[t]!==e&&(n[o++]=i[t]);t.children=n}}jI(){const t=this.Fi.iterator;for(;t.next();){const e=t.value;e instanceof Bi&&this.BD(e)}}BD(t){if(null===t)return;this.initializeTreeVertexValues(t),25===t.alignment&&this.sortTreeVertexChildren(t);let e=0,i=t.childrenCount,s=0;const n=t.children,o=n.length;for(let r=0;r<o;r++){const t=n[r];this.BD(t),e+=t.descendantCount+1,i=Math.max(i,t.maxChildrenCount),s=Math.max(s,t.maxGenerationCount)}t.descendantCount=e,t.maxChildrenCount=i,t.maxGenerationCount=i>0?s+1:0}_I(t){switch(this._f){default:case 40:return null!==t.parent?t.parent:this.B;case 43:return null===t.parent?this.B:null===t.parent.parent?this.U:t.parent;case 42:return null!==t.parent?null!==t.parent.parent?t.parent.parent:this.U:this.B;case 41:{let e=!0;if(0===t.childrenCount)e=!1;else{const i=t.children,s=i.length;for(let t=0;t<s;t++)if(i[t].childrenCount>0){e=!1;break}}return e&&null!==t.parent?this.U:null!==t.parent?t.parent:this.B}}}initializeTreeVertexValues(t){const e=this._I(t);if(t.copyInheritedPropertiesFrom(e),null!==t.parent&&25===t.parent.alignment){let e=t.angle;const i=t.parent.children;let s=0;for(;s<i.length&&t!==i[s];)s++;s%2===0?s!==i.length-1&&(e=90===e?180:180===e?270:270===e?180:270):e=90===e?0:180===e?90:270===e?0:90,t.angle=e}t.initialized=!0}qI(){const t=this.Fi.iterator;for(;t.next();){const e=t.value;e instanceof Bi&&this.UD(e)}}UD(t){if(null===t)return;this.assignTreeVertexValues(t);const e=t.children,i=e.length;for(let s=0;s<i;s++){const t=e[s];this.UD(t)}}assignTreeVertexValues(t){}WI(){const t=this.Fi.iterator;for(;t.next();){const e=t.value;e instanceof Bi&&this.VD(e)}}VD(t){if(null===t)return;25!==t.alignment&&this.sortTreeVertexChildren(t);const e=t.children,i=e.length;for(let s=0;s<i;s++){const t=e[s];this.VD(t)}}sortTreeVertexChildren(t){switch(t.sorting){default:case 10:break;case 11:t.children.reverse();break;case 12:t.children.sort(t.comparer);break;case 13:t.children.sort(t.comparer),t.children.reverse();break}}JN(){if(!this.comments)return;const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value;this.addComments(e)}}addComments(t){const e=t.angle,i=t.parent;let s=0,n=21,o=!1;null!==i&&(s=i.angle,n=i.alignment,o=this.isBusAlignment(n));const r=90===e||270===e,a=90===s||270===s,h=0===t.childrenCount;let l=0,u=0,c=0;const d=t.commentSpacing;if(null!==t.node){const e=t.node.findNodesConnected();for(;e.next();){const i=e.value;if("Comment"!==i.category||!i.canLayout())continue;null===t.comments&&(t.comments=[]),t.comments.push(i),i.ensureBounds();const s=i.measuredBounds;r&&!h||!o&&!a&&h||o&&a&&h?(l=Math.max(l,s.width),u+=s.height+Math.abs(c)):(l+=s.width+Math.abs(c),u=Math.max(u,s.height)),c=d}}if(null!==t.comments){r&&!h||!o&&!a&&h||o&&a&&h?(l+=Math.abs(t.commentMargin),u=Math.max(0,u-t.height)):(u+=Math.abs(t.commentMargin),l=Math.max(0,l-t.width));const e=x.V(0,0,t.bounds.width+l,t.bounds.height+u);t.bounds=e,x.e(e)}}isBusAlignment(t){return 24===t||25===t||26===t||27===t}Wy(t){return 24===t||25===t}nC(t){const e=t.parent;if(null!==e){const i=e.alignment;if(this.isBusAlignment(i)){if(this.Wy(i)){const i=e.children;let s=0;for(;s<i.length&&t!==i[s];)s++;return s%2===0}return 26===i}}return!1}layoutComments(t){if(null!==t.comments){const e=t.node.measuredBounds,i=t.parent,s=t.angle;let n=0,o=21,r=!1;null!==i&&(n=i.angle,o=i.alignment,r=this.isBusAlignment(o));const a=90===s||270===s,h=90===n||270===n,l=0===t.childrenCount,u=this.nC(t);let c=0;const d=t.comments,f=d.length,g=y.l();for(let m=0;m<f;m++){const e=d[m],i=e.measuredBounds;if(a&&!l||!r&&!h&&l||r&&h&&l){if(n>135&&!r||h&&u)if(t.commentMargin>=0){g.i(t.bounds.x-t.commentMargin-i.width,t.bounds.y+c),e.move(g);const s=e.findLinksInto();for(;s.next();){const t=s.value;t.fromSpot=w.MiddleLeft,t.toSpot=w.MiddleRight}}else{g.i(t.bounds.x+2*t.focus.x-t.commentMargin,t.bounds.y+c),e.move(g);const i=e.findLinksInto();for(;i.next();){const t=i.value;t.fromSpot=w.MiddleRight,t.toSpot=w.MiddleLeft}}else if(t.commentMargin>=0){g.i(t.bounds.x+2*t.focus.x+t.commentMargin,t.bounds.y+c),e.move(g);const i=e.findLinksInto();for(;i.next();){const t=i.value;t.fromSpot=w.MiddleRight,t.toSpot=w.MiddleLeft}}else{g.i(t.bounds.x+t.commentMargin-i.width,t.bounds.y+c),e.move(g);const s=e.findLinksInto();for(;s.next();){const t=s.value;t.fromSpot=w.MiddleLeft,t.toSpot=w.MiddleRight}}t.commentSpacing>=0?c+=i.height+t.commentSpacing:c+=t.commentSpacing-i.height}else{if(n>135&&!r||!h&&u)if(t.commentMargin>=0){g.i(t.bounds.x+c,t.bounds.y-t.commentMargin-i.height),e.move(g);const s=e.findLinksInto();for(;s.next();){const t=s.value;t.fromSpot=w.MiddleTop,t.toSpot=w.MiddleBottom}}else{g.i(t.bounds.x+c,t.bounds.y+2*t.focus.y-t.commentMargin),e.move(g);const i=e.findLinksInto();for(;i.next();){const t=i.value;t.fromSpot=w.MiddleBottom,t.toSpot=w.MiddleTop}}else if(t.commentMargin>=0){g.i(t.bounds.x+c,t.bounds.y+2*t.focus.y+t.commentMargin),e.move(g);const i=e.findLinksInto();for(;i.next();){const t=i.value;t.fromSpot=w.MiddleBottom,t.toSpot=w.MiddleTop}}else{g.i(t.bounds.x+c,t.bounds.y+t.commentMargin-i.height),e.move(g);const s=e.findLinksInto();for(;s.next();){const t=s.value;t.fromSpot=w.MiddleTop,t.toSpot=w.MiddleBottom}}t.commentSpacing>=0?c+=i.width+t.commentSpacing:c+=t.commentSpacing-i.width}}y.e(g);const p=c-t.commentSpacing-(a?e.height:e.width);if(1===this.ls){const e=t.destinationEdges;for(;e.next();){const t=e.value.link;null!==t&&!t.isAvoiding&&(t.fromEndSegmentLength=p>0?p:NaN)}}else{const e=t.sourceEdges;for(;e.next();){const t=e.value.link;null!==t&&!t.isAvoiding&&(t.toEndSegmentLength=p>0?p:NaN)}}}}JI(){if(62===this.layerStyle){const t=[];let e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;let s=i.parent;null===s&&(s=i);const n=0===s.angle||180===s.angle;let o=t[i.level];void 0===o&&(o=0),t[i.level]=Math.max(o,n?i.width:i.height)}for(let i=0;i<t.length;i++)void 0===t[i]&&(t[i]=0);for(this.eC=t,e=this.network.vertexes.iterator;e.next();){const i=e.value;let s=i.parent;null===s&&(s=i),0===s.angle||180===s.angle?(180===s.angle&&(i.focusX+=t[i.level]-i.width),i.width=t[i.level]):(270===s.angle&&(i.focusY+=t[i.level]-i.height),i.height=t[i.level])}}else if(61===this.layerStyle){const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value,i=0===e.angle||180===e.angle;let s=-1;for(let t=0;t<e.children.length;t++){const n=e.children[t];s=Math.max(s,i?n.width:n.height)}if(s>=0)for(let t=0;t<e.children.length;t++){const n=e.children[t];i?(180===e.angle&&(n.focusX+=s-n.width),n.width=s):(270===e.angle&&(n.focusY+=s-n.height),n.height=s)}}}const t=this.Fi.iterator;for(;t.next();){const e=t.value;e instanceof Bi&&this.layoutTree(e)}}layoutTree(t){if(null===t)return;const e=t.children,i=e.length;for(let s=0;s<i;s++){const t=e[s];this.layoutTree(t)}switch(t.compaction){case 30:this.zD(t);break;default:case 31:25===t.alignment?this.zD(t):this.tE(t);break}}zD(t){if(0===t.childrenCount){let e=!1,i=0,s=21;null!==t.parent&&(i=t.parent.angle,s=t.parent.alignment,e=this.isBusAlignment(s));const n=this.nC(t);return t.O.i(0,0),t.ut.i(t.width,t.height),void(null===t.parent||null===t.comments||(180!==i&&270!==i||e)&&!n?t.lt.i(0,0):180===i&&!e||(90===i||270===i)&&n?t.lt.i(t.width-2*t.focus.x,0):t.lt.i(0,t.height-2*t.focus.y))}const e=this.orthoAngle(t),i=90===e||270===e;let s=0;const n=t.children,o=n.length;for(let D=0;D<o;D++){const t=n[D];s=Math.max(s,i?t.ut.width:t.ut.height)}const r=t.alignment,a=22===r,h=23===r,l=this.isBusAlignment(r),u=Math.max(0,t.breadthLimit),c=this.computeLayerSpacing(t),d=t.nodeSpacing,f=this.computeNodeIndent(t),g=a||h?0:f/2,p=t.rowSpacing;let m=0;(a||h)&&(m=Math.max(0,t.rowIndent));const y=t.width,v=t.height;let x=0,b=0,w=0,k=0,S=0,P=0,M=0,C=0,A=0,N=0;if(l&&!this.Wy(r)&&e>135&&n.reverse(),this.Wy(r))if(o>1)for(let D=0;D<o;D++){const t=n[D],e=t.ut;D%2===0&&D!==o-1?A=Math.max(A,(i?e.width:e.height)+this.computeBusNodeSpacing(t)-d):D%2!==0&&(N=Math.max(N,(i?e.width:e.height)+this.computeBusNodeSpacing(t)-d))}else 1===o&&(A=i?n[0].ut.width:n[0].ut.height);if(l)switch(r){case 24:case 25:let r;r=e<135?this.XD(t,n,A,N,x,b):this.YD(t,n,A,N,x,b),A=r.x,x=r.width,b=r.height;break;case 26:for(let t=0;t<o;t++){const e=n[t],o=e.ut,r=0===M?0:p;i?(e.O.i(s-o.width,S+r),x=Math.max(x,o.width),b=Math.max(b,S+r+o.height),S+=r+o.height):(e.O.i(k+r,s-o.height),x=Math.max(x,k+r+o.width),b=Math.max(b,o.height),k+=r+o.width),M++}break;case 27:for(let e=0;e<o;e++){const s=n[e],o=s.ut,r=0===M?0:p;i?(s.O.i(d/2+t.focus.x,S+r),x=Math.max(x,o.width),b=Math.max(b,S+r+o.height),S+=r+o.height):(s.O.i(k+r,d/2+t.focus.y),x=Math.max(x,k+r+o.width),b=Math.max(b,o.height),k+=r+o.width),M++}break}else for(let D=0;D<o;D++){const o=n[D],a=o.ut;if(i){u>0&&M>0&&k+d+a.width>u&&(k<s&&this.ic(t,r,s-k,0,C,D-1),P++,M=0,C=D,w=b,k=0,S=e>135?-b-p:b+p);const i=0===M?g:d;this.yk(o,0,S),o.O.i(k+i,S),x=Math.max(x,k+i+a.width),b=Math.max(b,w+(0===P?0:p)+a.height),k+=i+a.width}else{u>0&&M>0&&S+d+a.height>u&&(S<s&&this.ic(t,r,0,s-S,C,D-1),P++,M=0,C=D,w=x,S=0,k=e>135?-x-p:x+p);const i=0===M?g:d;this.yk(o,k,0),o.O.i(k,S+i),b=Math.max(b,S+i+a.height),x=Math.max(x,w+(0===P?0:p)+a.width),S+=i+a.height}M++}P>0&&(i?(b+=Math.max(0,c),k<x&&this.ic(t,r,x-k,0,C,o-1),m>0&&(h||this.tu(t,m,0,0,o-1),x+=m)):(x+=Math.max(0,c),S<b&&this.ic(t,r,0,b-S,C,o-1),m>0&&(h||this.tu(t,0,m,0,o-1),b+=m)));let L=0,T=0;switch(r){case 20:i?L+=x/2-t.focus.x-f/2:T+=b/2-t.focus.y-f/2;break;default:case 21:if(P>0)i?L+=x/2-t.focus.x-f/2:T+=b/2-t.focus.y-f/2;else{const e=o;if(i){const i=n[0].O.x+n[0].lt.x,s=n[e-1].O.x+n[e-1].lt.x+2*n[e-1].focus.x;L+=i+(s-i)/2-t.focus.x-f/2}else{const i=n[0].O.y+n[0].lt.y,s=n[e-1].O.y+n[e-1].lt.y+2*n[e-1].focus.y;T+=i+(s-i)/2-t.focus.y-f/2}}break;case 22:i?(L-=f,x+=f):(T-=f,b+=f);break;case 23:i?(L+=x-t.width+f,x+=f):(T+=b-t.height+f,b+=f);break;case 24:case 25:i?L+=o>1?A+d/2-t.focus.x:n[0].focus.x-t.focus.x+n[0].lt.x:T+=o>1?A+d/2-t.focus.y:n[0].focus.y-t.focus.y+n[0].lt.y;break;case 26:i?L+=x+d/2-t.focus.x:T+=b+d/2-t.focus.y;break;case 27:break;case 28:const e=this.customAlignment(t,L,T,x,b);L=e[0],T=e[1],x=e[2],b=e[3];break}for(let D=0;D<o;D++){const t=n[D];i?t.O.i(t.O.x+t.lt.x-L,t.O.y+(e>135?(l?-b:-t.ut.height)+t.lt.y-c:v+c+t.lt.y)):t.O.i(t.O.x+(e>135?(l?-x:-t.ut.width)+t.lt.x-c:y+c+t.lt.x),t.O.y+t.lt.y-T)}i?(x=this.oC(t,x,L),L<0&&(L=0),e>135&&(T+=b+c),b=Math.max(Math.max(b,v),b+v+c)):(e>135&&(L+=x+c),x=Math.max(Math.max(x,y),x+y+c),b=this.rC(t,b,T),T<0&&(T=0)),t.lt.i(L,T),t.ut.i(x,b)}customAlignment(t,e,i,s,n){return[e,i,s,n]}XD(t,e,i,s,n,o){const r=e.length;if(0===r)return new x(i,0,n,o);if(1===r){const t=e[0];return n=t.ut.width,o=t.ut.height,new x(i,0,n,o)}const a=t.nodeSpacing,h=t.rowSpacing,l=90===this.orthoAngle(t);let u=0,c=0,d=0;for(let p=0;p<r;p++){if(p%2!==0||r>1&&p===r-1)continue;const t=e[p],s=t.ut,f=0===u?0:h;if(l){const e=this.computeBusNodeSpacing(t)-a;t.O.i(i-(s.width+e),d+f),n=Math.max(n,s.width+e),o=Math.max(o,d+f+s.height),d+=f+s.height}else{const e=this.computeBusNodeSpacing(t)-a;t.O.i(c+f,i-(s.height+e)),o=Math.max(o,s.height+e),n=Math.max(n,c+f+s.width),c+=f+s.width}u++}u=0;const f=c,g=d;l?(c=i+a,d=0):(c=0,d=i+a);for(let p=0;p<r;p++){if(p%2===0)continue;const t=e[p],i=t.ut,s=0===u?0:h;if(l){const e=this.computeBusNodeSpacing(t)-a;t.O.i(c+e,d+s),n=Math.max(n,c+i.width+e),o=Math.max(o,d+s+i.height),d+=s+i.height}else{const e=this.computeBusNodeSpacing(t)-a;t.O.i(c+s,d+e),n=Math.max(n,c+s+i.width),o=Math.max(o,d+i.height+e),c+=s+i.width}u++}if(r>1&&r%2===1){const s=e[r-1],h=s.ut,u=this.computeBusLastRowSpacing(s,l?Math.max(Math.abs(g),Math.abs(d)):Math.max(Math.abs(f),Math.abs(c)));if(l){s.O.i(i+a/2-s.focus.x-s.lt.x,o+u);const e=i+a/2-s.focus.x-s.lt.x;n=Math.max(n,e+h.width),e<0&&(n-=e),o=Math.max(o,Math.max(g,d)+u+h.height),s.O.x<0&&(i=this.wk(t,s.O.x,!1,i,a))}else{s.O.i(n+u,i+a/2-s.focus.y-s.lt.y),n=Math.max(n,Math.max(f,c)+u+h.width);const e=i+a/2-s.focus.y-s.lt.y;o=Math.max(o,e+h.height),e<0&&(o-=e),s.O.y<0&&(i=this.wk(t,s.O.y,!0,i,a))}}return new x(i,0,n,o)}YD(t,e,i,s,n,o){const r=e.length;if(0===r)return new x(i,0,n,o);if(1===r){const t=e[0];return n=t.ut.width,o=t.ut.height,new x(i,0,n,o)}const a=t.nodeSpacing,h=t.rowSpacing,l=270===this.orthoAngle(t);let u=0,c=0,d=0;for(let p=0;p<r;p++){if(p%2!==0||r>1&&p===r-1)continue;const t=e[p],s=t.ut,f=0===u?0:h;if(l){const e=this.computeBusNodeSpacing(t)-a;d-=f+s.height,t.O.i(i-(s.width+e),d),n=Math.max(n,s.width+e),o=Math.max(o,Math.abs(d))}else{const e=this.computeBusNodeSpacing(t)-a;c-=f+s.width,t.O.i(c,i-(s.height+e)),o=Math.max(o,s.height+e),n=Math.max(n,Math.abs(c))}u++}u=0;const f=c,g=d;l?(c=i+a,d=0):(c=0,d=i+a);for(let p=0;p<r;p++){if(p%2===0)continue;const t=e[p],i=t.ut,s=0===u?0:h;if(l){const e=this.computeBusNodeSpacing(t)-a;d-=s+i.height,t.O.i(c+e,d),n=Math.max(n,c+i.width+e),o=Math.max(o,Math.abs(d))}else{const e=this.computeBusNodeSpacing(t)-a;c-=s+i.width,t.O.i(c,d+e),o=Math.max(o,d+i.height+e),n=Math.max(n,Math.abs(c))}u++}if(r>1&&r%2===1){const s=e[r-1],h=s.ut,u=this.computeBusLastRowSpacing(s,l?Math.max(Math.abs(g),Math.abs(d)):Math.max(Math.abs(f),Math.abs(c)));if(l){s.O.i(i+a/2-s.focus.x-s.lt.x,-o-h.height-u);const e=i+a/2-s.focus.x-s.lt.x;n=Math.max(n,e+h.width),e<0&&(n-=e),o=Math.max(o,Math.abs(Math.min(g,d))+u+h.height),s.O.x<0&&(i=this.wk(t,s.O.x,!1,i,a))}else{s.O.i(-n-h.width-u,i+a/2-s.focus.y-s.lt.y),n=Math.max(n,Math.abs(Math.min(f,c))+u+h.width);const e=i+a/2-s.focus.y-s.lt.y;o=Math.max(o,e+h.height),e<0&&(o-=e),s.O.y<0&&(i=this.wk(t,s.O.y,!0,i,a))}}for(let p=0;p<r;p++){const t=e[p];l?t.O.i(t.O.x,t.O.y+o):t.O.i(t.O.x+n,t.O.y)}return new x(i,0,n,o)}computeBusNodeSpacing(t){return null===t.parent?0:t.parent.nodeSpacing}computeBusLastRowSpacing(t,e){return null===t.parent?0:t.parent.rowSpacing}wk(t,e,i,s,n){const o=t.children,r=o.length;for(let h=0;h<r;h++)i?o[h].O.i(o[h].O.x,o[h].O.y-e):o[h].O.i(o[h].O.x-e,o[h].O.y);const a=o[r-1];return Math.max(s,i?a.lt.y+a.focus.y-n/2:a.lt.x+a.focus.x-n/2)}oC(t,e,i){switch(t.alignment){case 21:case 20:let s=e;return i+t.width>s&&(s=i+t.width),i<0&&(s-=i),s;case 22:return t.width>e?t.width:e;case 23:return 2*t.focus.x>e?t.width:e+t.width-2*t.focus.x;case 24:case 25:const n=Math.min(0,i),o=Math.max(e,i+t.width);return Math.max(t.width,o-n);case 26:return t.width-t.focus.x+t.nodeSpacing/2+e;case 27:return Math.max(t.width,t.focus.x+t.nodeSpacing/2+e);default:return e}}rC(t,e,i){switch(t.alignment){case 21:case 20:let s=e;return i+t.height>s&&(s=i+t.height),i<0&&(s-=i),s;case 22:return t.height>e?t.height:e;case 23:return 2*t.focus.y>e?t.height:e+t.height-2*t.focus.y;case 24:case 25:const n=Math.min(0,i),o=Math.max(e,i+t.height);return Math.max(t.height,o-n);case 26:return t.height-t.focus.y+t.nodeSpacing/2+e;case 27:return Math.max(t.height,t.focus.y+t.nodeSpacing/2+e);default:return e}}lC(t,i,s){switch(t){case 20:i/=2,s/=2;break;case 21:i/=2,s/=2;break;case 22:i=0,s=0;break;case 23:break;default:e.o("Unhandled alignment value "+t.toString())}return new y(i,s)}ic(t,e,i,s,n,o){const r=this.lC(e,i,s);this.tu(t,r.x,r.y,n,o)}tu(t,e,i,s,n){if(0===e&&0===i)return;const o=t.children;for(let r=s;r<=n;r++){const t=o[r].O;t.x+=e,t.y+=i}}yk(t,i,s){const n=t.parent;switch(this.ls){case 1:{const e=t.sourceEdges;for(;e.next();){const t=e.value;t.fromVertex===n&&t.relativePoint.i(i,s)}break}case 2:{const e=t.destinationEdges;for(;e.next();){const t=e.value;t.toVertex===n&&t.relativePoint.i(i,s)}break}default:e.o("Unhandled path value "+this.ls.toString())}}tE(t){if(0===t.childrenCount){const e=t.parent;let i=!1,s=0,n=21;null!==e&&(s=e.angle,n=e.alignment,i=this.isBusAlignment(n));const o=this.nC(t);return t.O.i(0,0),t.ut.i(t.width,t.height),null===t.parent||null===t.comments||(180!==s&&270!==s||i)&&!o?t.lt.i(0,0):180===s&&!i||(90===s||270===s)&&o?t.lt.i(t.width-2*t.focus.x,0):t.lt.i(0,t.height-2*t.focus.y),t.Cg=null,void(t.Lg=null)}const i=this.orthoAngle(t),s=90===i||270===i;let n=0;const o=t.children,r=o.length;for(let e=0;e<r;e++){const t=o[e];n=Math.max(n,s?t.ut.width:t.ut.height)}const a=t.alignment,h=22===a,l=23===a,u=this.isBusAlignment(a),c=Math.max(0,t.breadthLimit),d=this.computeLayerSpacing(t),f=t.nodeSpacing,g=this.computeNodeIndent(t),p=t.rowSpacing;let m=0;(h||l)&&(m=Math.max(0,t.rowIndent));const y=t.width,v=t.height;let x=0,b=0,w=0,k=null,S=null,P=0,M=0,C=0,A=0,N=0,L=0,T=0,D=0,O=0;if(u&&!this.Wy(a)&&i>135&&o.reverse(),this.Wy(a))if(r>1)for(let e=0;e<r;e++)e%2===0&&e!==r-1?D=Math.max(D,s?o[e].ut.width:o[e].ut.height):e%2!==0&&(O=Math.max(O,s?o[e].ut.width:o[e].ut.height));else 1===r&&(D=s?o[0].ut.width:o[0].ut.height);if(u){switch(a){case 24:let e;e=i<135?this.XD(t,o,D,O,x,b):this.YD(t,o,D,O,x,b),D=e.x,x=e.width,b=e.height;break;case 26:for(let t=0;t<r;t++){const e=o[t],i=e.ut,r=0===L?0:p;s?(e.O.i(n-i.width,A+r),x=Math.max(x,i.width),b=Math.max(b,A+r+i.height),A+=r+i.height):(e.O.i(C+r,n-i.height),x=Math.max(x,C+r+i.width),b=Math.max(b,i.height),C+=r+i.width),L++}break;case 27:for(let i=0;i<r;i++){const e=o[i],n=e.ut,r=0===L?0:p;s?(e.O.i(f/2+t.focus.x,A+r),x=Math.max(x,n.width),b=Math.max(b,A+r+n.height),A+=r+n.height):(e.O.i(C+r,f/2+t.focus.y),x=Math.max(x,C+r+n.width),b=Math.max(b,n.height),C+=r+n.width),L++}break}k=this.ae(2),S=this.ae(2),s?(k[0].i(0,0),k[1].i(0,b),S[0].i(x,0),S[1].i(x,b)):(k[0].i(0,0),k[1].i(x,0),S[0].i(0,b),S[1].i(x,b))}else for(let V=0;V<r;V++){const r=o[V],h=r.ut;if(s){c>0&&L>0&&C+f+h.width>c&&(C<n&&this.ic(t,a,n-C,0,T,V-1),N++,L=0,T=V,w=b,C=0,A=i>135?-b-p:b+p),this.yk(r,0,A);let s=0;if(0===L)k=r.Cg,S=r.Lg,P=h.width,M=h.height,(null===k||null===S||i!==this.orthoAngle(r))&&(k=this.ae(2),S=this.ae(2),k[0].i(0,0),k[1].i(0,M),S[0].i(P,0),S[1].i(P,M));else{const i=e.et(),n=this.KD(t,r,k,S,P,M,i);s=n.x,k=i[0],S=i[1],P=n.width,M=n.height,e.J(i),C<h.width&&s<0&&(this.tu(t,-s,0,T,V-1),this.xk(k,-s,0),this.xk(S,-s,0),s=0)}r.O.i(s,A),x=Math.max(x,P),b=Math.max(b,w+(0===N?0:p)+h.height),C=P}else{c>0&&L>0&&A+f+h.height>c&&(A<n&&this.ic(t,a,0,n-A,T,V-1),N++,L=0,T=V,w=x,A=0,C=i>135?-x-p:x+p),this.yk(r,C,0);let s=0;if(0===L)k=r.Cg,S=r.Lg,P=h.width,M=h.height,(null===k||null===S||i!==this.orthoAngle(r))&&(k=this.ae(2),S=this.ae(2),k[0].i(0,0),k[1].i(P,0),S[0].i(0,M),S[1].i(P,M));else{const i=e.et(),n=this.KD(t,r,k,S,P,M,i);s=n.x,k=i[0],S=i[1],P=n.width,M=n.height,e.J(i),A<h.height&&s<0&&(this.tu(t,0,-s,T,V-1),this.xk(k,0,-s),this.xk(S,0,-s),s=0)}r.O.i(C,s),b=Math.max(b,M),x=Math.max(x,w+(0===N?0:p)+h.width),A=M}L++}N>0&&(s?(b+=Math.max(0,d),C<x&&this.ic(t,a,x-C,0,T,r-1),m>0&&(l||this.tu(t,m,0,0,r-1),x+=m)):(x+=Math.max(0,d),A<b&&this.ic(t,a,0,b-A,T,r-1),m>0&&(l||this.tu(t,0,m,0,r-1),b+=m)));let F=0,R=0;switch(a){case 20:s?F+=x/2-t.focus.x-g/2:R+=b/2-t.focus.y-g/2;break;default:case 21:if(N>0)s?F+=x/2-t.focus.x-g/2:R+=b/2-t.focus.y-g/2;else{const e=r;if(s){const i=o[0].O.x+o[0].lt.x,s=o[e-1].O.x+o[e-1].lt.x+2*o[e-1].focus.x;F+=i+(s-i)/2-t.focus.x-g/2}else{const i=o[0].O.y+o[0].lt.y,s=o[e-1].O.y+o[e-1].lt.y+2*o[e-1].focus.y;R+=i+(s-i)/2-t.focus.y-g/2}}break;case 22:s?(F-=g,x+=g):(R-=g,b+=g);break;case 23:s?(F+=x-t.width+g,x+=g):(R+=b-t.height+g,b+=g);break;case 24:s?F+=r>1?D+f/2-t.focus.x:o[0].focus.x-t.focus.x+o[0].lt.x:R+=r>1?D+f/2-t.focus.y:o[0].focus.y-t.focus.y+o[0].lt.y;break;case 26:s?F+=x+f/2-t.focus.x:R+=b+f/2-t.focus.y;break;case 27:break;case 28:const e=this.customAlignment(t,F,R,x,b);F=e[0],R=e[1],x=e[2],b=e[3];break}for(let e=0;e<r;e++){const t=o[e];s?t.O.i(t.O.x+t.lt.x-F,t.O.y+(i>135?(u?-b:-t.ut.height)+t.lt.y-d:v+d+t.lt.y)):t.O.i(t.O.x+(i>135?(u?-x:-t.ut.width)+t.lt.x-d:y+d+t.lt.x),t.O.y+t.lt.y-R)}let E,B,I=0,_=0;if(u)s?(x=this.oC(t,x,F),F<0&&(F=0),i>135&&(R+=b+d),b+=v+d,27===a&&(I+=f/2+t.focus.x),_+=v+d):(i>135&&(F+=x+d),x+=y+d,b=this.rC(t,b,R),R<0&&(R=0),27===a&&(_+=f/2+t.focus.y),I+=y+d);else if(s){if(null===t.comments){if(y>x){const t=this.lC(a,y-x,0);I=t.x,_=t.y,x=y,F=0}}else x=this.oC(t,x,F);F<0&&(I-=F,F=0),i>135&&(R+=b+d),b=Math.max(Math.max(b,v),b+v+d),_+=v+d}else{if(i>135&&(F+=x+d),x=Math.max(Math.max(x,y),x+y+d),null===t.comments){if(v>b){const t=this.lC(a,0,v-b);I=t.x,_=t.y,b=v,R=0}}else b=this.rC(t,b,R);R<0&&(_-=R,R=0),I+=y+d}if(N>0)E=this.ae(4),B=this.ae(4),s?(E[2].i(0,v+d),E[3].i(E[2].x,b),B[2].i(x,E[2].y),B[3].i(B[2].x,E[3].y)):(E[2].i(y+d,0),E[3].i(x,E[2].y),B[2].i(E[2].x,b),B[3].i(E[3].x,B[2].y));else{E=this.ae(k.length+2),B=this.ae(S.length+2);for(let t=0;t<k.length;t++){const e=k[t];E[t+2].i(e.x+I,e.y+_)}for(let t=0;t<S.length;t++){const e=S[t];B[t+2].i(e.x+I,e.y+_)}}s?(E[0].i(F,0),E[1].i(E[0].x,v),E[2].y<E[1].y&&(E[2].x>E[0].x?E[2].a(E[1]):E[1].a(E[2])),E[3].y<E[2].y&&(E[3].x>E[0].x?E[3].a(E[2]):E[2].a(E[3])),B[0].i(F+y,0),B[1].i(B[0].x,v),B[2].y<B[1].y&&(B[2].x<B[0].x?B[2].a(B[1]):B[1].a(B[2])),B[3].y<B[2].y&&(B[3].x<B[0].x?B[3].a(B[2]):B[2].a(B[3])),E[2].y-=d/2,B[2].y-=d/2):(E[0].i(0,R),E[1].i(y,E[0].y),E[2].x<E[1].x&&(E[2].y>E[0].y?E[2].a(E[1]):E[1].a(E[2])),E[3].x<E[2].x&&(E[3].y>E[0].y?E[3].a(E[2]):E[2].a(E[3])),B[0].i(0,R+v),B[1].i(y,B[0].y),B[2].x<B[1].x&&(B[2].y<B[0].y?B[2].a(B[1]):B[1].a(B[2])),B[3].x<B[2].x&&(B[3].y<B[0].y?B[3].a(B[2]):B[2].a(B[3])),E[2].x-=d/2,B[2].x-=d/2),this._s(k),this._s(S),t.Cg=E,t.Lg=B,t.lt.i(F,R),t.ut.i(x,b)}xk(t,e,i){for(let s=0;s<t.length;s++){const n=t[s];n.x+=e,n.y+=i}}KD(t,e,i,s,n,o,r){const a=this.orthoAngle(t),h=90===a||270===a,l=t.nodeSpacing,u=i,c=s,d=n,f=o;let g=e.Cg,p=e.Lg;const m=e.ut,y=h?Math.max(f,m.height):Math.max(d,m.width);if((null===g||a!==this.orthoAngle(e))&&(g=this.ae(2),p=this.ae(2),h?(g[0].i(0,0),g[1].i(0,m.height),p[0].i(m.width,0),p[1].i(p[0].x,g[1].y)):(g[0].i(0,0),g[1].i(m.width,0),p[0].i(0,m.height),p[1].i(g[1].x,p[0].y))),h){const t=d;let e=t-this.iE(c,g,t);return e+=l,i=this.eE(u,g,e),s=this.sE(c,p,e),n=Math.max(0,e)+m.width,o=y,this._s(u),this._s(g),this._s(c),this._s(p),r[0]=i,r[1]=s,new x(e,0,n,o)}{const t=f;let e=t-this.nE(c,g,t);return e+=l,i=this.oE(u,g,e),s=this.rE(c,p,e),n=y,o=Math.max(0,e)+m.height,this._s(u),this._s(g),this._s(c),this._s(p),r[0]=i,r[1]=s,new x(e,0,n,o)}}oE(t,e,i){if(null===t||t.length<2||null===e||e.length<2)return null;const s=this.ae(t.length+e.length);let n=0,o=0,r=0;for(;o<e.length&&e[o].x<t[0].x;){const t=e[o++];s[r++].i(t.x,t.y+i)}for(;n<t.length;){const e=t[n++];s[r++].i(e.x,e.y)}const a=t[t.length-1].x;for(;o<e.length&&e[o].x<=a;)o++;for(;o<e.length&&e[o].x>a;){const t=e[o++];s[r++].i(t.x,t.y+i)}const h=this.ae(r);for(n=0;n<r;n++)h[n].a(s[n]);return this._s(s),h}eE(t,e,i){if(null===t||t.length<2||null===e||e.length<2)return null;const s=this.ae(t.length+e.length);let n=0,o=0,r=0;for(;o<e.length&&e[o].y<t[0].y;){const t=e[o++];s[r++].i(t.x+i,t.y)}for(;n<t.length;){const e=t[n++];s[r++].i(e.x,e.y)}const a=t[t.length-1].y;for(;o<e.length&&e[o].y<=a;)o++;for(;o<e.length&&e[o].y>a;){const t=e[o++];s[r++].i(t.x+i,t.y)}const h=this.ae(r);for(n=0;n<r;n++)h[n].a(s[n]);return this._s(s),h}rE(t,e,i){if(null===t||t.length<2||null===e||e.length<2)return null;const s=this.ae(t.length+e.length);let n=0,o=0,r=0;for(;n<t.length&&t[n].x<e[0].x;){const e=t[n++];s[r++].i(e.x,e.y)}for(;o<e.length;){const t=e[o++];s[r++].i(t.x,t.y+i)}const a=e[e.length-1].x;for(;n<t.length&&t[n].x<=a;)n++;for(;n<t.length&&t[n].x>a;){const e=t[n++];s[r++].i(e.x,e.y)}const h=this.ae(r);for(n=0;n<r;n++)h[n].a(s[n]);return this._s(s),h}sE(t,e,i){if(null===t||t.length<2||null===e||e.length<2)return null;const s=this.ae(t.length+e.length);let n=0,o=0,r=0;for(;n<t.length&&t[n].y<e[0].y;){const e=t[n++];s[r++].i(e.x,e.y)}for(;o<e.length;){const t=e[o++];s[r++].i(t.x+i,t.y)}const a=e[e.length-1].y;for(;n<t.length&&t[n].y<=a;)n++;for(;n<t.length&&t[n].y>a;){const e=t[n++];s[r++].i(e.x,e.y)}const h=this.ae(r);for(n=0;n<r;n++)h[n].a(s[n]);return this._s(s),h}nE(t,e,i){let s=9999999;if(null===t||t.length<2||null===e||e.length<2)return s;let n=0,o=0;for(;n<t.length&&o<e.length;){const r=t[n],a=e[o],h=a.x;let l=a.y;l+=i;let u=r;n+1<t.length&&(u=t[n+1]);let c=a,d=c.x,f=c.y;o+1<e.length&&(c=e[o+1],d=c.x,f=c.y,f+=i);let g=s;r.x===h?g=l-r.y:r.x>h&&r.x<d?g=l+(r.x-h)/(d-h)*(f-l)-r.y:h>r.x&&h<u.x&&(g=l-(r.y+(h-r.x)/(u.x-r.x)*(u.y-r.y))),g<s&&(s=g),u.x<=r.x?n++:d<=h?o++:(u.x<=d&&n++,d<=u.x&&o++)}return s}iE(t,e,i){let s=9999999;if(null===t||t.length<2||null===e||e.length<2)return s;let n=0,o=0;for(;n<t.length&&o<e.length;){const r=t[n],a=e[o];let h=a.x;const l=a.y;h+=i;let u=r;n+1<t.length&&(u=t[n+1]);let c=a,d=c.x,f=c.y;o+1<e.length&&(c=e[o+1],d=c.x,f=c.y,d+=i);let g=s;r.y===l?g=h-r.x:r.y>l&&r.y<f?g=h+(r.y-l)/(f-l)*(d-h)-r.x:l>r.y&&l<u.y&&(g=h-(r.x+(l-r.y)/(u.y-r.y)*(u.x-r.x))),g<s&&(s=g),u.y<=r.y?n++:f<=l?o++:(u.y<=f&&n++,f<=u.y&&o++)}return s}ae(t){const e=this.pk[t];if(void 0!==e){const t=e.pop();if(void 0!==t)return t}const i=[];for(let s=0;s<t;s++)i[s]=new y;return i}_s(t){if(!t)return;const e=t.length;let i=this.pk[e];void 0===i&&(i=[],this.pk[e]=i),i.push(t)}arrangeTrees(){if(52===this.Xi){const t=this.Fi.iterator;for(;t.next();){const e=t.value;if(!(e instanceof Bi))continue;const i=e.node;if(null===i)continue;const s=i.position;let n=s.x,o=s.y;isFinite(n)||(n=0),isFinite(o)||(o=0),this.hC(e,n,o)}}else{const t=[],e=this.Fi.iterator;for(;e.next();){const i=e.value;i instanceof Bi&&t.push(i)}switch(this.sorting){default:case 10:break;case 11:t.reverse();break;case 12:t.sort(this.comparer);break;case 13:t.sort(this.comparer),t.reverse();break}const i=this.arrangementOrigin;let s=i.x,n=i.y;for(let o=0;o<t.length;o++){const e=t[o];switch(this.hC(e,s+e.lt.x,n+e.lt.y),this.Xi){case 50:n+=e.ut.height+this.Ms.height;break;default:case 51:s+=e.ut.width+this.Ms.width;break}}}}hC(t,e,i){if(null===t)return;t.x=e,t.y=i;const s=t.children,n=s.length;for(let o=0;o<n;o++){const t=s[o];this.hC(t,e+t.O.x,i+t.O.y)}}commitLayout(){this.Vy(),this.commitNodes(),this.iC(),this.isRouting&&this.commitLinks()}commitNodes(){const t=this.network.vertexes.iterator;for(;t.next();)t.value.commit();for(t.reset();t.next();){const e=t.value;this.layoutComments(e)}}iC(){if(62!==this.layerStyle)return;const t=this.eC,e=[];let i=null;const s=this.network.vertexes.iterator;for(;s.next();){const t=s.value;null===i?i=t.bounds.copy():i.unionRect(t.bounds);let n=e[t.level];n=void 0===n?this.computeLayerSpacing(t):Math.max(n,this.computeLayerSpacing(t)),e[t.level]=n}for(let h=0;h<e.length;h++)void 0===e[h]&&(e[h]=0);let n;90===this.angle||270===this.angle?(i.inflate(this.nodeSpacing/2,this.layerSpacing),n=new y(-this.nodeSpacing/2,-this.layerSpacing/2)):(i.inflate(this.layerSpacing,this.nodeSpacing/2),n=new y(-this.layerSpacing/2,-this.nodeSpacing/2));const o=[],r=90===this.angle||270===this.angle?i.width:i.height;let a=0;if(180===this.angle||270===this.angle)for(let h=0;h<t.length;h++)a+=t[h]+e[h];for(let h=0;h<t.length;h++){const i=t[h]+e[h];270===this.angle?(a-=i,o.push(new x(0,a,r,i))):90===this.angle?(o.push(new x(0,a,r,i)),a+=i):180===this.angle?(a-=i,o.push(new x(a,0,i,r))):(o.push(new x(a,0,i,r)),a+=i)}this.commitLayers(o,n)}commitLayers(t,e){}commitLinks(){const t=this.network.edges.iterator;for(;t.next();)t.value.commit()}Vy(){const t=this.Fi.iterator;for(;t.next();){const e=t.value;e instanceof Bi&&this.GD(e)}}GD(t){if(null===t)return;this.setPortSpots(t);const e=t.children,i=e.length;for(let s=0;s<i;s++){const t=e[s];this.GD(t)}}setPortSpots(t){const e=t.alignment;if(this.isBusAlignment(e))this.lE(t,e);else{const e=this.orthoAngle(t);if(1===this.ls){const i=t.destinationEdges;for(;i.next();){const s=i.value.link;if(null!==s){if(t.setsPortSpot)if(t.portSpot.isDefault())switch(e){case 0:s.fromSpot=w.MiddleRight;break;case 90:s.fromSpot=w.MiddleBottom;break;case 180:s.fromSpot=w.MiddleLeft;break;default:s.fromSpot=w.MiddleTop;break}else s.fromSpot=t.portSpot;if(t.setsChildPortSpot)if(t.childPortSpot.isDefault())switch(e){case 0:s.toSpot=w.MiddleLeft;break;case 90:s.toSpot=w.MiddleTop;break;case 180:s.toSpot=w.MiddleRight;break;default:s.toSpot=w.MiddleBottom;break}else s.toSpot=t.childPortSpot}}}else{const i=t.sourceEdges;for(;i.next();){const s=i.value.link;if(null!==s){if(t.setsPortSpot)if(t.portSpot.isDefault())switch(e){case 0:s.toSpot=w.MiddleRight;break;case 90:s.toSpot=w.MiddleBottom;break;case 180:s.toSpot=w.MiddleLeft;break;default:s.toSpot=w.MiddleTop;break}else s.toSpot=t.portSpot;if(t.setsChildPortSpot)if(t.childPortSpot.isDefault())switch(e){case 0:s.fromSpot=w.MiddleLeft;break;case 90:s.fromSpot=w.MiddleTop;break;case 180:s.fromSpot=w.MiddleRight;break;default:s.fromSpot=w.MiddleBottom;break}else s.fromSpot=t.childPortSpot}}}}}lE(t,e){const i=1===this.ls,s=this.orthoAngle(t);let n;switch(s){case 0:n=w.MiddleRight;break;case 90:n=w.MiddleBottom;break;case 180:n=w.MiddleLeft;break;default:n=w.MiddleTop;break}const o=t.children,r=o.length;switch(e){case 24:case 25:for(let e=0;e<r;e++){const a=o[e],h=(i?a.sourceEdges:a.destinationEdges).first();if(null===h)continue;const l=h.link;if(null!==l){let o=90===s||270===s?w.MiddleLeft:w.MiddleTop;if(1===r||e===r-1&&r%2===1)switch(s){case 0:o=w.MiddleLeft;break;case 90:o=w.MiddleTop;break;case 180:o=w.MiddleRight;break;default:o=w.MiddleBottom;break}else e%2===0&&(o=90===s||270===s?w.MiddleRight:w.MiddleBottom);i?(t.setsPortSpot&&(l.fromSpot=n),t.setsChildPortSpot&&(l.toSpot=o)):(t.setsPortSpot&&(l.fromSpot=o),t.setsChildPortSpot&&(l.toSpot=n))}}break;case 26:{const e=90===s||270===s?w.MiddleRight:w.MiddleBottom,o=i?t.destinationEdges:t.sourceEdges;for(;o.next();){const s=o.value.link;null!==s&&(i?(t.setsPortSpot&&(s.fromSpot=n),t.setsChildPortSpot&&(s.toSpot=e)):(t.setsPortSpot&&(s.fromSpot=e),t.setsChildPortSpot&&(s.toSpot=n)))}break}case 27:{const e=90===s||270===s?w.MiddleLeft:w.MiddleTop,o=i?t.destinationEdges:t.sourceEdges;for(;o.next();){const s=o.value.link;null!==s&&(i?(t.setsPortSpot&&(s.fromSpot=n),t.setsChildPortSpot&&(s.toSpot=e)):(t.setsPortSpot&&(s.fromSpot=e),t.setsChildPortSpot&&(s.toSpot=n)))}break}}}orthoAngle(t){const e=t.angle;return e<=45?0:e<=135?90:e<=225?180:e<=315?270:0}computeLayerSpacing(t){const e=this.orthoAngle(t),i=90===e||270===e;let s=t.layerSpacing;if(t.layerSpacingParentOverlap>0){const e=Math.min(1,t.layerSpacingParentOverlap);s-=i?t.height*e:t.width*e}return s<(i?-t.height:-t.width)&&(s=i?-t.height:-t.width),s}computeNodeIndent(t){const e=this.orthoAngle(t),i=90===e||270===e;let s=t.nodeIndent;if(t.nodeIndentPastParent>0){const e=Math.min(1,t.nodeIndentPastParent);s+=i?t.width*e:t.height*e}return s=Math.max(0,s),s}get roots(){return this.Fi}set roots(t){this.Fi!==t&&(this.Fi=t,this.invalidateLayout())}get path(){return this.Li}set path(t){this.Li!==t&&(this.Li=t,this.invalidateLayout())}get treeStyle(){return this._f}set treeStyle(t){this._f!==t&&(40===t||42===t||41===t||43===t)&&(this._f=t,this.invalidateLayout())}get layerStyle(){return this.Ng}set layerStyle(t){this.Ng!==t&&(60===t||61===t||62===t)&&(this.Ng=t,this.invalidateLayout())}get comments(){return this.Fe}set comments(t){this.Fe!==t&&(e.s(t,"boolean",Ri,"comments"),this.Fe=t,this.invalidateLayout())}get arrangement(){return this.Xi}set arrangement(t){this.Xi!==t&&(50===t||51===t||52===t)&&(this.Xi=t,this.invalidateLayout())}get arrangementSpacing(){return this.Ms}set arrangementSpacing(t){this.Ms.equals(t)||(this.Ms.a(t),this.invalidateLayout())}get rootDefaults(){return this.B}set rootDefaults(t){this.B!==t&&(this.B=t,this.invalidateLayout())}get alternateDefaults(){return this.U}set alternateDefaults(t){this.U!==t&&(this.U=t,this.invalidateLayout())}get sorting(){return this.B.sorting}set sorting(t){this.B.sorting!==t&&(this.B.sorting=t,this.invalidateLayout())}get comparer(){return this.B.comparer}set comparer(t){this.B.comparer!==t&&(e.k(t,Ri,"comparer"),this.B.comparer=t,this.invalidateLayout())}get angle(){return this.B.angle}set angle(t){this.B.angle!==t&&(e.s(t,"number",Ri,"angle"),0===t||90===t||180===t||270===t?(this.B.angle=t,this.invalidateLayout()):e.o("TreeLayout.angle must be 0, 90, 180, or 270"))}get alignment(){return this.B.alignment}set alignment(t){this.B.alignment!==t&&(this.B.alignment=t,this.invalidateLayout())}get nodeIndent(){return this.B.nodeIndent}set nodeIndent(t){this.B.nodeIndent!==t&&(e.s(t,"number",Ri,"nodeIndent"),t>=0&&(this.B.nodeIndent=t,this.invalidateLayout()))}get nodeIndentPastParent(){return this.B.nodeIndentPastParent}set nodeIndentPastParent(t){this.B.nodeIndentPastParent!==t&&(e.s(t,"number",Ri,"nodeIndentPastParent"),t>=0&&t<=1&&(this.B.nodeIndentPastParent=t,this.invalidateLayout()))}get nodeSpacing(){return this.B.nodeSpacing}set nodeSpacing(t){this.B.nodeSpacing!==t&&(e.s(t,"number",Ri,"nodeSpacing"),this.B.nodeSpacing=t,this.invalidateLayout())}get layerSpacing(){return this.B.layerSpacing}set layerSpacing(t){this.B.layerSpacing!==t&&(e.s(t,"number",Ri,"layerSpacing"),this.B.layerSpacing=t,this.invalidateLayout())}get layerSpacingParentOverlap(){return this.B.layerSpacingParentOverlap}set layerSpacingParentOverlap(t){this.B.layerSpacingParentOverlap!==t&&(e.s(t,"number",Ri,"layerSpacingParentOverlap"),t>=0&&t<=1&&(this.B.layerSpacingParentOverlap=t,this.invalidateLayout()))}get compaction(){return this.B.compaction}set compaction(t){this.B.compaction!==t&&(30===t||31===t)&&(this.B.compaction=t,this.invalidateLayout())}get breadthLimit(){return this.B.breadthLimit}set breadthLimit(t){this.B.breadthLimit!==t&&(e.s(t,"number",Ri,"breadthLimit"),t>=0&&(this.B.breadthLimit=t,this.invalidateLayout()))}get rowSpacing(){return this.B.rowSpacing}set rowSpacing(t){this.B.rowSpacing!==t&&(e.s(t,"number",Ri,"rowSpacing"),this.B.rowSpacing=t,this.invalidateLayout())}get rowIndent(){return this.B.rowIndent}set rowIndent(t){this.B.rowIndent!==t&&(e.s(t,"number",Ri,"rowIndent"),t>=0&&(this.B.rowIndent=t,this.invalidateLayout()))}get commentSpacing(){return this.B.commentSpacing}set commentSpacing(t){this.B.commentSpacing!==t&&(e.s(t,"number",Ri,"commentSpacing"),this.B.commentSpacing=t,this.invalidateLayout())}get commentMargin(){return this.B.commentMargin}set commentMargin(t){this.B.commentMargin!==t&&(e.s(t,"number",Ri,"commentMargin"),this.B.commentMargin=t,this.invalidateLayout())}get setsPortSpot(){return this.B.setsPortSpot}set setsPortSpot(t){this.B.setsPortSpot!==t&&(e.s(t,"boolean",Ri,"setsPortSpot"),this.B.setsPortSpot=t,this.invalidateLayout())}get portSpot(){return this.B.portSpot}set portSpot(t){this.B.portSpot.equals(t)||(this.B.portSpot=t,this.invalidateLayout())}get setsChildPortSpot(){return this.B.setsChildPortSpot}set setsChildPortSpot(t){this.B.setsChildPortSpot!==t&&(e.s(t,"boolean",Ri,"setsChildPortSpot"),this.B.setsChildPortSpot=t,this.invalidateLayout())}get childPortSpot(){return this.B.childPortSpot}set childPortSpot(t){this.B.childPortSpot.equals(t)||(this.B.childPortSpot=t,this.invalidateLayout())}get alternateSorting(){return this.U.sorting}set alternateSorting(t){this.U.sorting!==t&&(this.U.sorting=t,this.invalidateLayout())}get alternateComparer(){return this.U.comparer}set alternateComparer(t){this.U.comparer!==t&&(e.k(t,Ri,"alternateComparer"),this.U.comparer=t,this.invalidateLayout())}get alternateAngle(){return this.U.angle}set alternateAngle(t){this.U.angle!==t&&(e.s(t,"number",Ri,"alternateAngle"),(0===t||90===t||180===t||270===t)&&(this.U.angle=t,this.invalidateLayout()))}get alternateAlignment(){return this.U.alignment}set alternateAlignment(t){this.U.alignment!==t&&(this.U.alignment=t,this.invalidateLayout())}get alternateNodeIndent(){return this.U.nodeIndent}set alternateNodeIndent(t){this.U.nodeIndent!==t&&(e.s(t,"number",Ri,"alternateNodeIndent"),t>=0&&(this.U.nodeIndent=t,this.invalidateLayout()))}get alternateNodeIndentPastParent(){return this.U.nodeIndentPastParent}set alternateNodeIndentPastParent(t){this.U.nodeIndentPastParent!==t&&(e.s(t,"number",Ri,"alternateNodeIndentPastParent"),t>=0&&t<=1&&(this.U.nodeIndentPastParent=t,this.invalidateLayout()))}get alternateNodeSpacing(){return this.U.nodeSpacing}set alternateNodeSpacing(t){this.U.nodeSpacing!==t&&(e.s(t,"number",Ri,"alternateNodeSpacing"),this.U.nodeSpacing=t,this.invalidateLayout())}get alternateLayerSpacing(){return this.U.layerSpacing}set alternateLayerSpacing(t){this.U.layerSpacing!==t&&(e.s(t,"number",Ri,"alternateLayerSpacing"),this.U.layerSpacing=t,this.invalidateLayout())}get alternateLayerSpacingParentOverlap(){return this.U.layerSpacingParentOverlap}set alternateLayerSpacingParentOverlap(t){this.U.layerSpacingParentOverlap!==t&&(e.s(t,"number",Ri,"alternateLayerSpacingParentOverlap"),t>=0&&t<=1&&(this.U.layerSpacingParentOverlap=t,this.invalidateLayout()))}get alternateCompaction(){return this.U.compaction}set alternateCompaction(t){this.U.compaction!==t&&(30===t||31===t)&&(this.U.compaction=t,this.invalidateLayout())}get alternateBreadthLimit(){return this.U.breadthLimit}set alternateBreadthLimit(t){this.U.breadthLimit!==t&&(e.s(t,"number",Ri,"alternateBreadthLimit"),t>=0&&(this.U.breadthLimit=t,this.invalidateLayout()))}get alternateRowSpacing(){return this.U.rowSpacing}set alternateRowSpacing(t){this.U.rowSpacing!==t&&(e.s(t,"number",Ri,"alternateRowSpacing"),this.U.rowSpacing=t,this.invalidateLayout())}get alternateRowIndent(){return this.U.rowIndent}set alternateRowIndent(t){this.U.rowIndent!==t&&(e.s(t,"number",Ri,"alternateRowIndent"),t>=0&&(this.U.rowIndent=t,this.invalidateLayout()))}get alternateCommentSpacing(){return this.U.commentSpacing}set alternateCommentSpacing(t){this.U.commentSpacing!==t&&(e.s(t,"number",Ri,"alternateCommentSpacing"),this.U.commentSpacing=t,this.invalidateLayout())}get alternateCommentMargin(){return this.U.commentMargin}set alternateCommentMargin(t){this.U.commentMargin!==t&&(e.s(t,"number",Ri,"alternateCommentMargin"),this.U.commentMargin=t,this.invalidateLayout())}get alternateSetsPortSpot(){return this.U.setsPortSpot}set alternateSetsPortSpot(t){this.U.setsPortSpot!==t&&(e.s(t,"boolean",Ri,"alternateSetsPortSpot"),this.U.setsPortSpot=t,this.invalidateLayout())}get alternatePortSpot(){return this.U.portSpot}set alternatePortSpot(t){this.U.portSpot.equals(t)||(this.U.portSpot=t,this.invalidateLayout())}get alternateSetsChildPortSpot(){return this.U.setsChildPortSpot}set alternateSetsChildPortSpot(t){this.U.setsChildPortSpot!==t&&(e.s(t,"boolean",Ri,"alternateSetsChildPortSpot"),this.U.setsChildPortSpot=t,this.invalidateLayout())}get alternateChildPortSpot(){return this.U.childPortSpot}set alternateChildPortSpot(t){this.U.childPortSpot.equals(t)||(this.U.childPortSpot=t,this.invalidateLayout())}static PathDefault=0;static PathDestination=1;static PathSource=2;static SortingForwards=10;static SortingReverse=11;static SortingAscending=12;static SortingDescending=13;static AlignmentCenterSubtrees=20;static AlignmentCenterChildren=21;static AlignmentStart=22;static AlignmentEnd=23;static AlignmentBus=24;static AlignmentBusBranching=25;static AlignmentTopLeftBus=26;static AlignmentBottomRightBus=27;static CompactionNone=30;static CompactionBlock=31;static StyleLayered=40;static StyleLastParents=41;static StyleAlternating=42;static StyleRootOnly=43;static ArrangementVertical=50;static ArrangementHorizontal=51;static ArrangementFixedRoots=52;static LayerIndividual=60;static LayerSiblings=61;static LayerUniform=62}class Ei extends je{constructor(t){super(t)}createVertex(){return new Bi(this)}createEdge(){return new Ii(this)}}class Bi extends $e{O;ut;lt;bk;kk;Pk;Sk;Mk;Nk;Ck;Fe;Cg;Lg;pe;ye;Yt;hi;Jy;$y;Zy;Ns;Qy;_y;tw;iw;ew;nw;ow;lw;hw;aw;cw;constructor(t){super(t),this.bk=!1,this.kk=null,this.Pk=[],this.Sk=0,this.Mk=0,this.Nk=0,this.Ck=0,this.Fe=null,this.O=new y(0,0),this.ut=new v(0,0),this.lt=new y(0,0),this.Cg=null,this.Lg=null,this.pe=10,this.ye=$e.standardComparer,this.Yt=0,this.hi=21,this.Jy=0,this.$y=0,this.Zy=20,this.Ns=50,this.Qy=0,this._y=31,this.tw=0,this.iw=25,this.ew=10,this.nw=10,this.ow=20,this.lw=!0,this.hw=w.Default,this.aw=!0,this.cw=w.Default}copyInheritedPropertiesFrom(t){null!==t&&(this.pe=t.sorting,this.ye=t.comparer,this.Yt=t.angle,this.hi=t.alignment,this.Jy=t.nodeIndent,this.$y=t.nodeIndentPastParent,this.Zy=t.nodeSpacing,this.Ns=t.layerSpacing,this.Qy=t.layerSpacingParentOverlap,this._y=t.compaction,this.tw=t.breadthLimit,this.iw=t.rowSpacing,this.ew=t.rowIndent,this.nw=t.commentSpacing,this.ow=t.commentMargin,this.lw=t.setsPortSpot,this.hw=t.portSpot,this.aw=t.setsChildPortSpot,this.cw=t.childPortSpot)}get initialized(){return this.bk}set initialized(t){this.bk!==t&&(e.s(t,"boolean",Bi,"initialized"),this.bk=t)}get parent(){return this.kk}set parent(t){this.kk!==t&&(this.kk=t)}get children(){return this.Pk}set children(t){if(this.Pk!==t){if(null!==t&&!Array.isArray(t)&&e.Zi(t,"Array",Bi,"children:value"),null!==t){const e=t.length;for(let i=0;i<e;i++){t[i]}}this.Pk=t}}get level(){return this.Sk}set level(t){this.Sk!==t&&(e.s(t,"number",Bi,"level"),this.Sk=t)}get descendantCount(){return this.Mk}set descendantCount(t){this.Mk!==t&&(e.s(t,"number",Bi,"descendantCount"),this.Mk=t)}get maxChildrenCount(){return this.Nk}set maxChildrenCount(t){this.Nk!==t&&(e.s(t,"number",Bi,"maxChildrenCount"),this.Nk=t)}get maxGenerationCount(){return this.Ck}set maxGenerationCount(t){this.Ck!==t&&(e.s(t,"number",Bi,"maxGenerationCount"),this.Ck=t)}get comments(){return this.Fe}set comments(t){if(this.Fe!==t){if(null!==t&&!Array.isArray(t)&&e.Zi(t,"Array",Bi,"comments:value"),null!==t){const e=t.length;for(let i=0;i<e;i++){t[i]}}this.Fe=t}}get sorting(){return this.pe}set sorting(t){this.pe!==t&&(this.pe=t)}get comparer(){return this.ye}set comparer(t){this.ye!==t&&(e.k(t,Bi,"comparer"),this.ye=t)}get angle(){return this.Yt}set angle(t){this.Yt!==t&&(e.s(t,"number",Bi,"angle"),this.Yt=t)}get alignment(){return this.hi}set alignment(t){this.hi!==t&&(this.hi=t)}get nodeIndent(){return this.Jy}set nodeIndent(t){this.Jy!==t&&(e.s(t,"number",Bi,"nodeIndent"),this.Jy=t)}get nodeIndentPastParent(){return this.$y}set nodeIndentPastParent(t){this.$y!==t&&(e.s(t,"number",Bi,"nodeIndentPastParent"),this.$y=t)}get nodeSpacing(){return this.Zy}set nodeSpacing(t){this.Zy!==t&&(e.s(t,"number",Bi,"nodeSpacing"),this.Zy=t)}get layerSpacing(){return this.Ns}set layerSpacing(t){this.Ns!==t&&(e.s(t,"number",Bi,"layerSpacing"),this.Ns=t)}get layerSpacingParentOverlap(){return this.Qy}set layerSpacingParentOverlap(t){this.Qy!==t&&(e.s(t,"number",Bi,"layerSpacingParentOverlap"),this.Qy=t)}get compaction(){return this._y}set compaction(t){this._y!==t&&(this._y=t)}get breadthLimit(){return this.tw}set breadthLimit(t){this.tw!==t&&(e.s(t,"number",Bi,"breadthLimit"),this.tw=t)}get rowSpacing(){return this.iw}set rowSpacing(t){this.iw!==t&&(e.s(t,"number",Bi,"rowSpacing"),this.iw=t)}get rowIndent(){return this.ew}set rowIndent(t){this.ew!==t&&(e.s(t,"number",Bi,"rowIndent"),this.ew=t)}get commentSpacing(){return this.nw}set commentSpacing(t){this.nw!==t&&(e.s(t,"number",Bi,"commentSpacing"),this.nw=t)}get commentMargin(){return this.ow}set commentMargin(t){this.ow!==t&&(e.s(t,"number",Bi,"commentMargin"),this.ow=t)}get setsPortSpot(){return this.lw}set setsPortSpot(t){this.lw!==t&&(e.s(t,"boolean",Bi,"setsPortSpot"),this.lw=t)}get portSpot(){return this.hw}set portSpot(t){this.hw.equals(t)||(this.hw=t)}get setsChildPortSpot(){return this.aw}set setsChildPortSpot(t){this.aw!==t&&(e.s(t,"boolean",Bi,"setsChildPortSpot"),this.aw=t)}get childPortSpot(){return this.cw}set childPortSpot(t){this.cw.equals(t)||(this.cw=t)}get childrenCount(){return this.children.length}get relativePosition(){return this.O}set relativePosition(t){this.O.set(t)}get subtreeSize(){return this.ut}set subtreeSize(t){this.ut.set(t)}get subtreeOffset(){return this.lt}set subtreeOffset(t){this.lt.set(t)}}class Ii extends Xe{Lk;constructor(t){super(t),this.Lk=new y(0,0)}commit(){const t=this.link;if(null===t||t.isAvoiding)return;const i=this.network.layout;let s=null,n=null;switch(i.ls){case 1:s=this.fromVertex,n=this.toVertex;break;case 2:s=this.toVertex,n=this.fromVertex;break;default:e.o("Unhandled path value "+i.ls.toString())}if(null===s||null===n)return;const o=this.Lk;if(0===o.x&&0===o.y)return void this.hE(s,n);const r=s.bounds,a=i.orthoAngle(s),h=i.computeLayerSpacing(s),l=s.rowSpacing;t.updateRoute();const u=9===t.curve,c=t.isOrthogonal;let d,f,g=0;if(t.startRoute(),c||u){for(g=2;t.pointsCount>4;)t.removePoint(2);d=t.getPoint(1),f=t.getPoint(2)}else{for(g=1;t.pointsCount>3;)t.removePoint(1);d=t.getPoint(0),f=t.getPoint(t.pointsCount-1)}const p=t.getPoint(t.pointsCount-1);let m=0;0===a?(23===s.alignment?(m=r.bottom+o.y,0===o.y&&d.y>p.y+s.rowIndent&&(m=Math.min(m,Math.max(d.y,m-i.computeNodeIndent(s))))):22===s.alignment?(m=r.top+o.y,0===o.y&&d.y<p.y-s.rowIndent&&(m=Math.max(m,Math.min(d.y,m+i.computeNodeIndent(s))))):m=r.y+r.height/2+o.y,u?(t.insertPointAt(g,d.x,m),g++,t.insertPointAt(g,r.right+h,m),g++,t.insertPointAt(g,r.right+h+(o.x-l)/3,m),g++,t.insertPointAt(g,r.right+h+2*(o.x-l)/3,m),g++,t.insertPointAt(g,r.right+h+(o.x-l),m),g++,t.insertPointAt(g,f.x,m),g++):(c&&(t.insertPointAt(g,r.right+h/2,d.y),g++),t.insertPointAt(g,r.right+h/2,m),g++,t.insertPointAt(g,r.right+h+o.x-(c?l/2:l),m),g++,c&&(t.insertPointAt(g,t.getPoint(g-1).x,f.y),g++))):90===a?(23===s.alignment?(m=r.right+o.x,0===o.x&&d.x>p.x+s.rowIndent&&(m=Math.min(m,Math.max(d.x,m-i.computeNodeIndent(s))))):22===s.alignment?(m=r.left+o.x,0===o.x&&d.x<p.x-s.rowIndent&&(m=Math.max(m,Math.min(d.x,m+i.computeNodeIndent(s))))):m=r.x+r.width/2+o.x,u?(t.insertPointAt(g,m,d.y),g++,t.insertPointAt(g,m,r.bottom+h),g++,t.insertPointAt(g,m,r.bottom+h+(o.y-l)/3),g++,t.insertPointAt(g,m,r.bottom+h+2*(o.y-l)/3),g++,t.insertPointAt(g,m,r.bottom+h+(o.y-l)),g++,t.insertPointAt(g,m,f.y),g++):(c&&(t.insertPointAt(g,d.x,r.bottom+h/2),g++),t.insertPointAt(g,m,r.bottom+h/2),g++,t.insertPointAt(g,m,r.bottom+h+o.y-(c?l/2:l)),g++,c&&(t.insertPointAt(g,f.x,t.getPoint(g-1).y),g++))):180===a?(23===s.alignment?(m=r.bottom+o.y,0===o.y&&d.y>p.y+s.rowIndent&&(m=Math.min(m,Math.max(d.y,m-i.computeNodeIndent(s))))):22===s.alignment?(m=r.top+o.y,0===o.y&&d.y<p.y-s.rowIndent&&(m=Math.max(m,Math.min(d.y,m+i.computeNodeIndent(s))))):m=r.y+r.height/2+o.y,u?(t.insertPointAt(g,d.x,m),g++,t.insertPointAt(g,r.left-h,m),g++,t.insertPointAt(g,r.left-h+(o.x+l)/3,m),g++,t.insertPointAt(g,r.left-h+2*(o.x+l)/3,m),g++,t.insertPointAt(g,r.left-h+(o.x+l),m),g++,t.insertPointAt(g,f.x,m),g++):(c&&(t.insertPointAt(g,r.left-h/2,d.y),g++),t.insertPointAt(g,r.left-h/2,m),g++,t.insertPointAt(g,r.left-h+o.x+(c?l/2:l),m),g++,c&&(t.insertPointAt(g,t.getPoint(g-1).x,f.y),g++))):270===a?(23===s.alignment?(m=r.right+o.x,0===o.x&&d.x>p.x+s.rowIndent&&(m=Math.min(m,Math.max(d.x,m-i.computeNodeIndent(s))))):22===s.alignment?(m=r.left+o.x,0===o.x&&d.x<p.x-s.rowIndent&&(m=Math.max(m,Math.min(d.x,m+i.computeNodeIndent(s))))):m=r.x+r.width/2+o.x,u?(t.insertPointAt(g,m,d.y),g++,t.insertPointAt(g,m,r.top-h),g++,t.insertPointAt(g,m,r.top-h+(o.y+l)/3),g++,t.insertPointAt(g,m,r.top-h+2*(o.y+l)/3),g++,t.insertPointAt(g,m,r.top-h+(o.y+l)),g++,t.insertPointAt(g,m,f.y),g++):(c&&(t.insertPointAt(g,d.x,r.top-h/2),g++),t.insertPointAt(g,m,r.top-h/2),g++,t.insertPointAt(g,m,r.top-h+o.y+(c?l/2:l)),g++,c&&(t.insertPointAt(g,f.x,t.getPoint(g-1).y),g++))):e.o("Invalid angle "+a),t.commitRoute()}hE(t,e){const i=this.link;if(null===i)return;const s=this.network.layout,n=s.orthoAngle(t),o=s.orthoAngle(e);if(n===o)return;const r=s.computeLayerSpacing(t),a=t.bounds,h=e.bounds;if(0===n&&h.left-a.right<r+1||90===n&&h.top-a.bottom<r+1||180===n&&a.left-h.right<r+1||270===n&&a.top-h.bottom<r+1)return;i.updateRoute();const l=9===i.curve,u=i.isOrthogonal,c=this.fromVertex,d=s.isBusAlignment(c.alignment);if(i.startRoute(),0===n){const t=a.right+r/2;if(l){if(4===i.pointsCount){const e=i.getPoint(3).y;i.setPointAt(1,t-20,i.getPoint(1).y),i.insertPointAt(2,t-20,e),i.insertPointAt(3,t,e),i.insertPointAt(4,t+20,e),i.setPointAt(5,i.getPoint(5).x,e)}}else u?d?i.setPointAt(3,i.getPoint(2).x,i.getPoint(4).y):6===i.pointsCount&&(i.setPointAt(2,t,i.getPoint(2).y),i.setPointAt(3,t,i.getPoint(3).y)):4===i.pointsCount?i.insertPointAt(2,t,i.getPoint(2).y):3===i.pointsCount?i.setPointAt(1,t,i.getPoint(2).y):2===i.pointsCount&&i.insertPointAt(1,t,i.getPoint(1).y)}else if(90===n){const t=a.bottom+r/2;if(l){if(4===i.pointsCount){const e=i.getPoint(3).x;i.setPointAt(1,i.getPoint(1).x,t-20),i.insertPointAt(2,e,t-20),i.insertPointAt(3,e,t),i.insertPointAt(4,e,t+20),i.setPointAt(5,e,i.getPoint(5).y)}}else u?d?i.setPointAt(3,i.getPoint(2).x,i.getPoint(4).y):6===i.pointsCount&&(i.setPointAt(2,i.getPoint(2).x,t),i.setPointAt(3,i.getPoint(3).x,t)):4===i.pointsCount?i.insertPointAt(2,i.getPoint(2).x,t):3===i.pointsCount?i.setPointAt(1,i.getPoint(2).x,t):2===i.pointsCount&&i.insertPointAt(1,i.getPoint(1).x,t)}else if(180===n){const t=a.left-r/2;if(l){if(4===i.pointsCount){const e=i.getPoint(3).y;i.setPointAt(1,t+20,i.getPoint(1).y),i.insertPointAt(2,t+20,e),i.insertPointAt(3,t,e),i.insertPointAt(4,t-20,e),i.setPointAt(5,i.getPoint(5).x,e)}}else u?d?i.setPointAt(3,i.getPoint(2).x,i.getPoint(4).y):6===i.pointsCount&&(i.setPointAt(2,t,i.getPoint(2).y),i.setPointAt(3,t,i.getPoint(3).y)):4===i.pointsCount?i.insertPointAt(2,t,i.getPoint(2).y):3===i.pointsCount?i.setPointAt(1,t,i.getPoint(2).y):2===i.pointsCount&&i.insertPointAt(1,t,i.getPoint(1).y)}else if(270===n){const t=a.top-r/2;if(l){if(4===i.pointsCount){const e=i.getPoint(3).x;i.setPointAt(1,i.getPoint(1).x,t+20),i.insertPointAt(2,e,t+20),i.insertPointAt(3,e,t),i.insertPointAt(4,e,t-20),i.setPointAt(5,e,i.getPoint(5).y)}}else u?d?i.setPointAt(3,i.getPoint(2).x,i.getPoint(4).y):6===i.pointsCount&&(i.setPointAt(2,i.getPoint(2).x,t),i.setPointAt(3,i.getPoint(3).x,t)):4===i.pointsCount?i.insertPointAt(2,i.getPoint(2).x,t):3===i.pointsCount?i.setPointAt(1,i.getPoint(2).x,t):2===i.pointsCount&&i.insertPointAt(1,i.getPoint(1).x,t)}i.commitRoute()}get fromVertex(){return this.je}set fromVertex(t){this.je!==t&&(this.je=t)}get toVertex(){return this.qe}set toVertex(t){this.qe!==t&&(this.qe=t)}get relativePoint(){return this.Lk}set relativePoint(t){this.Lk.set(t)}}class _i{constructor(){}static Light={colors:{text:"#0a0a0a",comment:"#ca8a04",link:"#0a0a0a",group:"#a3a3a344",outline:"#a3a3a3",selection:"#0ea5e9",div:"#fff",gridMinor:"#e5e5e5",gridMajor:"#a3a3a3",overviewBox:"#c026d3",tempLink:"#2563eb",tempPort:"#c026d3",adornmentFill:"#0ea5e9",adornmentStroke:"#1e40af",dragSelect:"#c026d3"},fonts:{normal:"10pt sans-serif",bold:"bold 12pt sans-serif"},numbers:{group:1,selection:3},margins:{group:new b(5)},arrowheads:{toArrow:"Standard"}};static Dark={colors:{text:"#f5f5f5",comment:"#facc15",link:"#f5f5f5",group:"#a3a3a388",outline:"#a3a3a3",selection:"#38bdf8",div:"#171717",gridMinor:"#262626",gridMajor:"#404040",overviewBox:"#e879f9",tempLink:"#60a5fa",tempPort:"#e879f9",adornmentFill:"#38bdf8",adornmentStroke:"#2563eb",dragSelect:"#e879f9"},fonts:{normal:"10pt sans-serif",bold:"bold 12pt sans-serif"},numbers:{group:1,selection:3},margins:{group:new b(5)},arrowheads:{toArrow:"Standard"}}}class Vi{ts=new Set;iu=new m;Ak="light";Tk="light";Dk=!1;Ag="light";HD=t=>{const e=t.matches?"dark":"light";e!==this.Ag&&(this.Ag=e,"system"===this.Tk&&this.fw())};constructor(e){e&&Object.assign(this,e),e?.themeMap||(this.iu.set("light",{colors:{..._i.Light.colors},fonts:{..._i.Light.fonts},numbers:{..._i.Light.numbers},margins:{..._i.Light.margins},arrowheads:{..._i.Light.arrowheads}}),this.iu.set("dark",{colors:{..._i.Dark.colors},fonts:{..._i.Dark.fonts},numbers:{..._i.Dark.numbers},margins:{..._i.Dark.margins},arrowheads:{..._i.Dark.arrowheads}})),t.matchMedia&&(this.Ag=t.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}get themeMap(){return this.iu}set themeMap(t){this.iu!==t&&(this.iu=t,this.fw())}get defaultTheme(){return this.Ak}set defaultTheme(t){this.Ak!==t&&(e.s(t,"string",Vi,"defaultTheme"),this.Ak=t,this.fw())}get currentTheme(){return this.Tk}set currentTheme(t){this.Tk!==t&&(e.s(t,"string",Vi,"currentTheme"),this.Tk=t,this.fw())}get changesDivBackground(){return this.Dk}set changesDivBackground(t){if(this.Dk!==t&&(this.Dk=t,t))for(const e of this.ts)e.setDivBackground(this.findValue("div","","fill")),e.D("ThemeChanged",this)}get preferredColorScheme(){return this.Ag}addDiagram(t){return this.ts.add(t),this.aC(t),this}removeDiagram(t){return this.ts.delete(t),this.aC(t),this}lR(){0===this.ts.size&&t.matchMedia&&t.matchMedia("(prefers-color-scheme: dark)")?.addEventListener("change",this.HD)}hR(){0===this.ts.size&&t.matchMedia&&t.matchMedia("(prefers-color-scheme: dark)")?.removeEventListener("change",this.HD)}set(t,e){""===t&&(t=this.Ak),"system"===t&&(t=this.Ag);let i=this.iu.get(t);return i=i?this.jD(i,e):e,this.iu.set(t,i),this.fw(),this}findValue(t,e,i){return this.getValue(this.findTheme(this.currentTheme),t,e,i)||this.getValue(this.findTheme(this.defaultTheme),t,e,i)}getValue(t,e,i,s){if(!t)return;null==i&&(i="");let n=t;const o=t=>{if(void 0===n||""===t)return;if("number"==typeof t||!Array.isArray(t)&&!t.includes("."))return n[t];const e=Array.isArray(t)?t:t.split(".");for(let i=0;i<e.length;i++){const t=e[i];if(""!==t&&(n=n[t],void 0===n))return}return n},r=()=>{if(""===i||(n=o(i),void 0!==n))return n=Array.isArray(n)&&"number"==typeof e?n[e%n.length]:o(e),n};if(n=r(),void 0===n&&"string"==typeof s&&s.length>0){let e=t.targetPropertyMap?.get(s);if(e?n=t[e]:(e=Vi.aE.get(s),n=e?t[e]:t.colors),n=r(),void 0!==n)return n}return n}findTheme(t){return this.themeMap.get("system"===t?this.Ag:t)}aC(t){const e=t.skipsUndoManager;t.skipsUndoManager=!0,t.updateAllThemeBindings(),this.Dk&&t.setDivBackground(this.findValue("div","","fill")),t.skipsUndoManager=e,t.D("ThemeChanged",this)}fw(){for(const t of this.ts)this.aC(t)}jD(t,i){for(const s in i)if(e.uw(i,s))try{i[s].constructor===Object?t[s]=this.jD(t[s]??{},i[s]):t[s]=i[s]}catch{delete t[s]}return t}static aE=new Map([["background","colors"],["defaultColumnSeparatorStroke","colors"],["defaultRowSeparatorStroke","colors"],["shadowColor","colors"],["fill","colors"],["stroke","colors"],["font","fonts"],["angle","numbers"],["fromEndSegmentLength","numbers"],["fromShortLength","numbers"],["height","numbers"],["opacity","numbers"],["scale","numbers"],["toEndSegmentLength","numbers"],["toShortLength","numbers"],["width","numbers"],["defaultColumnSeparatorStrokeWidth","numbers"],["defaultRowSeparatorStrokeWidth","numbers"],["shadowBlur","numbers"],["corner","numbers"],["curviness","numbers"],["smoothness","numbers"],["parameter1","numbers"],["parameter2","numbers"],["strokeWidth","numbers"],["strokeDashOffset","numbers"],["maxLines","numbers"],["spacingAbove","numbers"],["spacingBelow","numbers"],["position","points"],["shadowOffset","points"],["desiredSize","sizes"],["maxSize","sizes"],["minSize","sizes"],["margin","margins"],["defaultSeparatorPadding","margins"],["padding","margins"],["alignment","spots"],["alignmentFocus","spots"],["fromSpot","spots"],["toSpot","spots"],["defaultAlignment","spots"],["spot1","spots"],["spot2","spots"],["verticalAlignment","spots"],["imageAlignment","spots"],["fromArrow","arrowheads"],["toArrow","arrowheads"]])}class zi{Pt;N;Oi;al;constructor(){this.N=vt.um(),this.Pt="",this.Oi=!0,this.al=!0}get name(){return this.Pt}set name(t){this.Pt=t}get isEnabled(){return this.Oi}set isEnabled(t){this.Oi=t}get isRealtime(){return this.al}set isRealtime(t){this.al=t}get diagram(){return this.N}set diagram(t){this.N!==t&&(this.N=t,t.xl=!0,t.requestUpdate())}invalidateRouter(){null!==this.N&&(this.N.xl=!0,this.N.requestUpdate())}canRoute(t){if(!this.isEnabled)return!1;const e=this.diagram;return!(e&&(!this.isRealtime&&e.gu||e.animationManager.isTicking))}routeLinks(t,e){}toString(){return""!==this.name?this.name+" Router":e.Dn(this.constructor)}}class ji extends zi{constructor(t){super(),this.name="AvoidsNodes",t&&Object.assign(this,t)}canRoute(t){return!!(t instanceof vt?t.Vm:t.diagram.Vm)&&super.canRoute(t)}routeLinks(t,e){const i=e instanceof vt?null:e,s=t.iterator,n=this.diagram.getPositions(!0,i,null);for(;s.next();){const t=s.value;if(!t.isAvoiding||t.containingGroup!==i||null===t.toNode||null===t.fromNode||t.pointsCount<4)continue;t.startRoute();const e=t.pointsCount,o=t.getPoint(1),r=t.getPoint(e-2),a=t.fromNode.actualBounds.copy();a.inflate(De.Ba,De.Ba),a.unionPoint(t.getPoint(0));const h=t.toNode.actualBounds.copy();h.inflate(De.Ba,De.Ba),h.unionPoint(t.getPoint(e-1)),this.cE(t,a,h,n)&&this.fE(t,o,t.uN,r,t.dN,a,h,n),t.commitRoute()}}cE(t,e,i,s){const n=t.diagram,o=t.pointsCount;if(null===n||t.fromNode===t.toNode||t.layer.isTemporary||e.containsPoint(t.getPoint(o-1))&&!t.toNode.isMemberOf(t.fromNode)||i.containsPoint(t.getPoint(0))&&!t.fromNode.isMemberOf(t.toNode)||!t.isOrthogonal)return!1;if(17===t.segmentIndex)return!0;const r=t.getPoint(1),a=t.getPoint(o-2),h=t.getPoint(2);if(!s.isUnoccupied(Math.min(r.x,h.x),Math.min(r.y,h.y),Math.abs(r.x-h.x),Math.abs(r.y-h.y)))return!0;for(let u=2;u<o-3;u++){const e=t.getPoint(u),i=t.getPoint(u+1);if(!s.isUnoccupied(Math.min(e.x,i.x),Math.min(e.y,i.y),Math.abs(e.x-i.x),Math.abs(e.y-i.y)))return!0}const l=t.getPoint(o-3);return!s.isUnoccupied(Math.min(l.x,a.x),Math.min(l.y,a.y),Math.abs(l.x-a.x),Math.abs(l.y-a.y))}fE(t,e,i,s,n,o,r,a){const h=t.diagram,l=e,u=s;let c=null,d=null;if(h.isVirtualized){const o=a.bounds.copy(),r=t.getPoint(2),h=t.getPoint(t.pointsCount-3);o.inflate(-a.cellWidth,-a.cellHeight);const l=y.l();a.vd(e.x,e.y)||(S.dl(o.x,o.y,o.x+o.width,o.y+o.height,e.x,e.y,r.x,r.y,l)?(c=e=l.copy(),i=l.directionPoint(r)):S.dl(o.x,o.y,o.x+o.width,o.y+o.height,r.x,r.y,h.x,h.y,l)?(c=e=l.copy(),i=l.directionPoint(h)):S.dl(o.x,o.y,o.x+o.width,o.y+o.height,h.x,h.y,s.x,s.y,l)&&(c=e=l.copy(),i=l.directionPoint(s))),a.vd(s.x,s.y)||(S.dl(o.x,o.y,o.x+o.width,o.y+o.height,s.x,s.y,h.x,h.y,l)?(d=s=l.copy(),n=h.directionPoint(l)):S.dl(o.x,o.y,o.x+o.width,o.y+o.height,h.x,h.y,r.x,r.y,l)?(d=s=l.copy(),n=r.directionPoint(l)):S.dl(o.x,o.y,o.x+o.width,o.y+o.height,r.x,r.y,e.x,e.y,l)&&(d=s=l.copy(),n=e.directionPoint(l))),y.e(l)}const f=o.copy().unionRect(r);f.inflate(a.cellWidth*a.Kc,a.cellHeight*a.Kc),a.NT(e,i,s,n,f,!0);let g=a.ro(s.x,s.y);if(!a.xy&&g>=Fe.Rd&&(a.rA(),f.inflate(a.cellWidth*a.HM,a.cellHeight*a.jM),a.NT(e,i,s,n,f,!1),g=a.ro(s.x,s.y)),!a.xy&&g<Fe.Rd&&!a.TO(s.x,s.y)){t.points.removeRange(2,t.pointsCount-3),this.cC(t,a,s.x,s.y,n,!0);const o=0,r=90,h=180,f=270,g=t.getPoint(2);if(t.pointsCount<4)i===o||i===h?(g.x=e.x,g.y=s.y):(g.x=s.x,g.y=e.y),t.setPointAt(2,g.x,g.y),t.insertPointAt(3,g.x,g.y);else{const s=t.getPoint(3);if(i===o||i===h)if(S.f(g.x,s.x)){const n=i===o?Math.max(g.x,e.x):Math.min(g.x,e.x);t.setPointAt(2,n,e.y),t.setPointAt(3,n,s.y)}else S.f(g.y,s.y)?(Math.abs(e.y-g.y)<=a.cellHeight/2&&(t.setPointAt(2,g.x,e.y),t.setPointAt(3,s.x,e.y)),t.insertPointAt(2,g.x,e.y)):t.setPointAt(2,e.x,g.y);else if(i===r||i===f)if(S.f(g.y,s.y)){const n=i===r?Math.max(g.y,e.y):Math.min(g.y,e.y);t.setPointAt(2,e.x,n),t.setPointAt(3,s.x,n)}else S.f(g.x,s.x)?(Math.abs(e.x-g.x)<=a.cellWidth/2&&(t.setPointAt(2,e.x,g.y),t.setPointAt(3,e.x,s.y)),t.insertPointAt(2,e.x,g.y)):t.setPointAt(2,g.x,e.y)}if(null!==c){const e=t.getPoint(1),s=t.getPoint(2);e.x!==s.x&&e.y!==s.y?i===o||i===h?t.insertPointAt(2,e.x,s.y):t.insertPointAt(2,s.x,e.y):i===o||i===h?t.insertPointAt(2,l.x,c.y):t.insertPointAt(2,c.x,l.y)}null!==d&&(n===o||n===h?t.insertPointAt(t.pointsCount-2,u.x,d.y):t.insertPointAt(t.pointsCount-2,d.x,u.y))}}cC(t,e,i,s,n,o){const r=e.cellWidth,a=e.cellHeight;let h=e.ro(i,s),l=i,u=s,c=l,d=u;for(0===n?c+=r:90===n?d+=a:180===n?c-=r:d-=a,t.pN&&h>Fe.Xa&&e.ro(c,d)!==h-1&&(e.ro(l-r,u)===h-1?(n=180,c=l-r,d=u):e.ro(l+r,u)===h-1?(n=0,c=l+r,d=u):e.ro(l,u-a)===h-1?(n=270,c=l,d=u-a):e.ro(l,u+a)===h-1&&(n=90,c=l,d=u+a));h>Fe.Xa&&e.ro(c,d)===h-1;)l=c,u=d,0===n?c+=r:90===n?d+=a:180===n?c-=r:d-=a,h-=1;if(o?h>Fe.Xa&&(180===n||0===n?l=Math.floor(l/r)*r+r/2:(90===n||270===n)&&(u=Math.floor(u/a)*a+a/2)):(l=Math.floor(l/r)*r+r/2,u=Math.floor(u/a)*a+a/2),h>Fe.Xa){let i=n,s=l,o=u;if(0===n?(i=90,o+=a):90===n?(i=180,s-=r):180===n?(i=270,o-=a):270===n&&(i=0,s+=r),e.ro(s,o)===h-1)this.cC(t,e,s,o,i,!1);else{let s=l,o=u;0===n?(i=270,o-=a):90===n?(i=0,s+=r):180===n?(i=90,o+=a):270===n&&(i=180,s-=r),e.ro(s,o)===h-1&&this.cC(t,e,s,o,i,!1)}}t.insertPointAt(t.pointsCount-2,l,u)}}V.prototype.initializeStandardTools=function(){this.Jt("Action",new W,this.mouseDownTools),this.Jt("Relinking",new G,this.mouseDownTools),this.Jt("LinkReshaping",new K,this.mouseDownTools),this.Jt("Rotating",new H,this.mouseDownTools),this.Jt("Resizing",new U,this.mouseDownTools),this.Jt("Linking",new X,this.mouseMoveTools),this.Jt("Dragging",new z,this.mouseMoveTools),this.Jt("DragSelecting",new J,this.mouseMoveTools),this.Jt("Panning",new Q,this.mouseMoveTools),this.Jt("ContextMenu",new it,this.mouseUpTools),this.Jt("TextEditing",new rt,this.mouseUpTools),this.Jt("ClickCreating",new Z,this.mouseUpTools),this.Jt("ClickSelecting",new q,this.mouseUpTools)},vt.NM("GraphLinksModel",qe),vt.NM("TreeModel",We);const $i=t.go,Xi={get version(){return vt.version},Group:_e,List:h,Set:u,Map:m,Point:y,Size:v,Rect:x,Margin:b,Spot:w,Geometry:C,PathFigure:A,PathSegment:L,InputEvent:T,DiagramEvent:D,ChangedEvent:F,Model:ti,GraphLinksModel:ei,TreeModel:ii,Binding:Je,ThemeBinding:Qe,Transaction:R,UndoManager:E,CommandHandler:Ct,Tool:B,DraggingTool:z,DraggingInfo:bt,DraggingOptions:kt,LinkingBaseTool:j,LinkingTool:X,RelinkingTool:G,LinkReshapingTool:K,ResizingTool:U,RotatingTool:H,ClickSelectingTool:q,ActionTool:W,ClickCreatingTool:Z,HTMLInfo:tt,ContextMenuTool:it,DragSelectingTool:J,PanningTool:Q,TextEditingTool:rt,ToolManager:V,Animation:lt,AnimationManager:ht,AnimationTrigger:dt,Layer:ft,Diagram:vt,Palette:St,Overview:Pt,Brush:jt,GraphObject:Tt,Panel:ie,RowColumnDefinition:ae,Shape:he,TextBlock:fe,Picture:ye,Part:ke,Adornment:Pe,Node:Ce,Link:De,Placeholder:Ve,Layout:ze,LayoutNetwork:je,LayoutVertex:$e,LayoutEdge:Xe,GridLayout:Ue,PanelLayout:$t,CircularLayout:ai,CircularNetwork:li,CircularVertex:ui,CircularEdge:ci,ForceDirectedLayout:di,ForceDirectedNetwork:fi,ForceDirectedVertex:gi,ForceDirectedEdge:pi,LayeredDigraphLayout:Si,LayeredDigraphNetwork:Pi,LayeredDigraphVertex:Mi,LayeredDigraphEdge:Ci,TreeLayout:Ri,TreeNetwork:Ei,TreeVertex:Bi,TreeEdge:Ii,Themes:_i,ThemeManager:Vi,Router:zi,AnimationStyle:at,AutoScale:gt,CycleMode:pt,Flip:Lt,TextFormat:de,ImageStretch:me,LayoutConditions:we,LinkAdjusting:Ne,Curve:Te,Routing:Le,Orientation:Nt,TextOverflow:ce,PortSpreading:Me,ScrollMode:mt,CollapsePolicy:yt,Sizing:re,TriggerStart:ct,Stretch:At,ViewboxStretch:ee,Wrap:ue,BrushType:_t,ColorSpace:Vt,GeometryStretch:M,GeometryType:P,SegmentType:N,BindingMode:Ze,ChangeType:O,CircularArrangement:si,CircularDirection:ni,CircularNodeDiameterFormula:ri,CircularSorting:oi,GridAlignment:Ge,GridArrangement:Ye,GridSorting:Ke,LayeredDigraphAggressive:bi,LayeredDigraphAlign:ki,LayeredDigraphCycleRemove:yi,LayeredDigraphInit:xi,LayeredDigraphLayering:vi,LayeredDigraphPack:wi,TreeAlignment:Li,TreeArrangement:Oi,TreeCompaction:Ti,TreeLayerStyle:Fi,TreePath:Ai,TreeSorting:Ni,TreeStyle:Di,GestureMode:_,LinkingDirection:$,ReshapingBehavior:Y,TextEditingAccept:st,TextEditingStarting:nt,TextEditingState:ot,WheelMode:I};for(const Gi in Xi){const t=Xi[Gi];e.it(t)&&t!==de&&(t.className=Gi)}e.K($i)&&$i.version&&e.ni("WARNING: a `go` object on the root object is already defined.  "+("Debug"in $i?"debug ":"")+"version: "+$i.version+", replaced with version: "+Xi.version),vt.prototype.go=Xi,t.go=Xi})(),e.Ay="undefined"!==typeof global?global.go:self.go;const s="undefined"!==typeof global?global.go:self.go;s.Group,s.List,s.Set,s.Map,s.Point,s.Size,s.Rect,s.Margin,s.Spot,s.Geometry,s.PathFigure,s.PathSegment,s.InputEvent,s.DiagramEvent,s.ChangedEvent,s.Model,s.GraphLinksModel,s.TreeModel,s.Binding,s.ThemeBinding,s.Transaction,s.UndoManager,s.CommandHandler,s.Tool,s.DraggingTool,s.DraggingInfo,s.DraggingOptions,s.LinkingBaseTool,s.LinkingTool,s.RelinkingTool,s.LinkReshapingTool,s.ResizingTool,s.RotatingTool,s.ClickSelectingTool,s.ActionTool,s.ClickCreatingTool,s.HTMLInfo,s.ContextMenuTool,s.DragSelectingTool,s.PanningTool,s.TextEditingTool,s.ToolManager,s.Animation,s.AnimationManager,s.AnimationTrigger,s.Layer,s.Diagram,s.Palette,s.Overview,s.Brush,s.GraphObject,s.Panel,s.RowColumnDefinition,s.Shape,s.TextBlock,s.Picture,s.Part,s.Adornment,s.Node,s.Link,s.Placeholder,s.Layout,s.LayoutNetwork,s.LayoutVertex,s.LayoutEdge,s.GridLayout,s.PanelLayout,s.CircularLayout,s.CircularNetwork,s.CircularVertex,s.CircularEdge,s.ForceDirectedLayout,s.ForceDirectedNetwork,s.ForceDirectedVertex,s.ForceDirectedEdge,s.LayeredDigraphLayout,s.LayeredDigraphNetwork,s.LayeredDigraphVertex,s.LayeredDigraphEdge,s.TreeLayout,s.TreeNetwork,s.TreeVertex,s.TreeEdge,s.Themes,s.ThemeManager,s.Router,s.version,s.AnimationStyle,s.AutoScale,s.Curve,s.CycleMode,s.Flip,s.ImageStretch,s.LayoutConditions,s.LinkAdjusting,s.Orientation,s.PortSpreading,s.Routing,s.ScrollMode,s.CollapsePolicy,s.Sizing,s.TriggerStart,s.Stretch,s.TextFormat,s.TextOverflow,s.ViewboxStretch,s.Wrap,s.BrushType,s.ColorSpace,s.GeometryStretch,s.GeometryType,s.SegmentType,s.BindingMode,s.ChangeType,s.CircularArrangement,s.CircularDirection,s.CircularNodeDiameterFormula,s.CircularSorting,s.GridAlignment,s.GridArrangement,s.GridSorting,s.LayeredDigraphAggressive,s.LayeredDigraphAlign,s.LayeredDigraphCycleRemove,s.LayeredDigraphInit,s.LayeredDigraphLayering,s.LayeredDigraphPack,s.TreeAlignment,s.TreeArrangement,s.TreeCompaction,s.TreeLayerStyle,s.TreePath,s.TreeSorting,s.TreeStyle,s.GestureMode,s.LinkingDirection,s.ReshapingBehavior,s.TextEditingAccept,s.TextEditingStarting,s.TextEditingState,s.WheelMode},7889:function(t,e,i){var s=i(9456);e.A=s.A},7954:function(t,e,i){i.d(e,{A:function(){return n}});var s=i(6543),n=s.A.extend({name:"v-main",props:{tag:{type:String,default:"main"}},computed:{styles(){const{bar:t,top:e,right:i,footer:s,insetFooter:n,bottom:o,left:r}=this.$vuetify.application;return{paddingTop:`${e+t}px`,paddingRight:`${i}px`,paddingBottom:`${s+n+o}px`,paddingLeft:`${r}px`}}},render(t){const e={staticClass:"v-main",style:this.styles,ref:"main"};return t(this.tag,e,[t("div",{staticClass:"v-main__wrap"},this.$slots.default)])}})},8010:function(t,e,i){var s=i(5471),n=i(1723),o=i(6960);e.A=s.Ay.extend({name:"routable",directives:{Ripple:n.A},props:{activeClass:String,append:Boolean,disabled:Boolean,exact:{type:Boolean,default:void 0},exactPath:Boolean,exactActiveClass:String,link:Boolean,href:[String,Object],to:[String,Object],nuxt:Boolean,replace:Boolean,ripple:{type:[Boolean,Object],default:null},tag:String,target:String},data:()=>({isActive:!1,proxyClass:""}),computed:{classes(){const t={};return this.to||(this.activeClass&&(t[this.activeClass]=this.isActive),this.proxyClass&&(t[this.proxyClass]=this.isActive)),t},computedRipple(){var t;return null!==(t=this.ripple)&&void 0!==t?t:!this.disabled&&this.isClickable},isClickable(){return!this.disabled&&Boolean(this.isLink||this.$listeners.click||this.$listeners["!click"]||this.$attrs.tabindex)},isLink(){return this.to||this.href||this.link},styles:()=>({})},watch:{$route:"onRouteChange"},mounted(){this.onRouteChange()},methods:{generateRouteLink(){let t,e=this.exact;const i={attrs:{tabindex:"tabindex"in this.$attrs?this.$attrs.tabindex:void 0},class:this.classes,style:this.styles,props:{},directives:[{name:"ripple",value:this.computedRipple}],[this.to?"nativeOn":"on"]:{...this.$listeners,..."click"in this?{click:this.click}:void 0},ref:"link"};if("undefined"===typeof this.exact&&(e="/"===this.to||this.to===Object(this.to)&&"/"===this.to.path),this.to){let s=this.activeClass,n=this.exactActiveClass||s;this.proxyClass&&(s=`${s} ${this.proxyClass}`.trim(),n=`${n} ${this.proxyClass}`.trim()),t=this.nuxt?"nuxt-link":"router-link",Object.assign(i.props,{to:this.to,exact:e,exactPath:this.exactPath,activeClass:s,exactActiveClass:n,append:this.append,replace:this.replace})}else t=(this.href?"a":this.tag)||"div","a"===t&&this.href&&(i.attrs.href=this.href);return this.target&&(i.attrs.target=this.target),{tag:t,data:i}},onRouteChange(){if(!this.to||!this.$refs.link||!this.$route)return;const t=`${this.activeClass||""} ${this.proxyClass||""}`.trim(),e=`${this.exactActiveClass||""} ${this.proxyClass||""}`.trim()||t,i="_vnode.data.class."+(this.exact?e:t);this.$nextTick((()=>{!(0,o.no)(this.$refs.link,i)===this.isActive&&this.toggle()}))},toggle(){this.isActive=!this.isActive}}})},8014:function(t,e,i){var s=i(1291),n=Math.min;t.exports=function(t){var e=s(t);return e>0?n(e,9007199254740991):0}},8111:function(t,e,i){var s=i(6518),n=i(4576),o=i(679),r=i(8551),a=i(4901),h=i(2787),l=i(2106),u=i(4659),c=i(9039),d=i(9297),f=i(8227),g=i(7657).IteratorPrototype,p=i(3724),m=i(6395),y="constructor",v="Iterator",x=f("toStringTag"),b=TypeError,w=n[v],k=m||!a(w)||w.prototype!==g||!c((function(){w({})})),S=function(){if(o(this,g),h(this)===g)throw new b("Abstract class Iterator not directly constructable")},P=function(t,e){p?l(g,t,{configurable:!0,get:function(){return e},set:function(e){if(r(this),this===g)throw new b("You can't redefine this property");d(this,t)?this[t]=e:u(this,t,e)}}):g[t]=e};d(g,x)||P(x,v),!k&&d(g,y)&&g[y]!==Object||P(y,S),S.prototype=g,s({global:!0,constructor:!0,forced:k},{Iterator:S})},8227:function(t,e,i){var s=i(4576),n=i(5745),o=i(9297),r=i(3392),a=i(4495),h=i(7040),l=s.Symbol,u=n("wks"),c=h?l["for"]||l:l&&l.withoutSetter||r;t.exports=function(t){return o(u,t)||(u[t]=a&&o(l,t)?l[t]:c("Symbol."+t)),u[t]}},8237:function(t,e,i){var s=i(6518),n=i(2652),o=i(9306),r=i(8551),a=i(1767),h=TypeError;s({target:"Iterator",proto:!0,real:!0},{reduce:function(t){r(this),o(t);var e=a(this),i=arguments.length<2,s=i?void 0:arguments[1],l=0;if(n(e,(function(e){i?(i=!1,s=e):s=t(s,e,l),l++}),{IS_RECORD:!0}),i)throw new h("Reduce of empty iterator with no initial value");return s}})},8400:function(t,e,i){var s=i(7889),n=i(6521),o=i(5471);e.A=o.Ay.extend({name:"v-app-bar-nav-icon",functional:!0,render(t,{slots:e,listeners:i,props:o,data:r}){const a=Object.assign(r,{staticClass:`v-app-bar__nav-icon ${r.staticClass||""}`.trim(),props:{...o,icon:!0},on:i}),h=e().default;return t(n.A,a,h||[t(s.A,"$menu")])}})},8412:function(t,e,i){i(4114),i(8111),i(7588),i(125);var s=i(5471),n=i(4961),o=i(6960);const r=["sm","md","lg","xl"],a=["start","end","center"];function h(t,e){return r.reduce(((i,s)=>(i[t+(0,o.Zb)(s)]=e(),i)),{})}const l=t=>[...a,"baseline","stretch"].includes(t),u=h("align",(()=>({type:String,default:null,validator:l}))),c=t=>[...a,"space-between","space-around"].includes(t),d=h("justify",(()=>({type:String,default:null,validator:c}))),f=t=>[...a,"space-between","space-around","stretch"].includes(t),g=h("alignContent",(()=>({type:String,default:null,validator:f}))),p={align:Object.keys(u),justify:Object.keys(d),alignContent:Object.keys(g)},m={align:"align",justify:"justify",alignContent:"align-content"};function y(t,e,i){let s=m[t];if(null!=i){if(e){const i=e.replace(t,"");s+=`-${i}`}return s+=`-${i}`,s.toLowerCase()}}const v=new Map;e.A=s.Ay.extend({name:"v-row",functional:!0,props:{tag:{type:String,default:"div"},dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:l},...u,justify:{type:String,default:null,validator:c},...d,alignContent:{type:String,default:null,validator:f},...g},render(t,{props:e,data:i,children:s}){let o="";for(const n in e)o+=String(e[n]);let r=v.get(o);if(!r){let t;for(t in r=[],p)p[t].forEach((i=>{const s=e[i],n=y(t,i,s);n&&r.push(n)}));r.push({"no-gutters":e.noGutters,"row--dense":e.dense,[`align-${e.align}`]:e.align,[`justify-${e.justify}`]:e.justify,[`align-content-${e.alignContent}`]:e.alignContent}),v.set(o,r)}return t(e.tag,(0,n.Ay)(i,{staticClass:"row",class:r}),s)}})},8480:function(t,e,i){var s=i(1828),n=i(8727),o=n.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return s(t,o)}},8505:function(t,e,i){i.d(e,{A:function(){return o}});var s=i(3661),n=i(3507),o=(0,n.A)(s.A).extend({name:"v-app",props:{dark:{type:Boolean,default:void 0},id:{type:String,default:"app"},light:{type:Boolean,default:void 0}},computed:{isDark(){return this.$vuetify.theme.dark}},beforeCreate(){if(!this.$vuetify||this.$vuetify===this.$root)throw new Error("Vuetify is not properly initialized, see https://vuetifyjs.com/getting-started/quick-start#bootstrapping-the-vuetify-object")},render(t){const e=t("div",{staticClass:"v-application--wrap"},this.$slots.default);return t("div",{staticClass:"v-application",class:{"v-application--is-rtl":this.$vuetify.rtl,"v-application--is-ltr":!this.$vuetify.rtl,...this.themeClasses},attrs:{"data-app":!0},domProps:{id:this.id}},[e])}})},8551:function(t,e,i){var s=i(34),n=String,o=TypeError;t.exports=function(t){if(s(t))return t;throw new o(n(t)+" is not an object")}},8622:function(t,e,i){var s=i(4576),n=i(4901),o=s.WeakMap;t.exports=n(o)&&/native code/.test(String(o))},8652:function(t,e,i){i.d(e,{W:function(){return r}});var s=i(5471),n=i(5604);function o(t,e){return()=>(0,n.OP)(`The ${t} component must be used inside a ${e}`)}function r(t,e,i){const n=e&&i?{register:o(e,i),unregister:o(e,i)}:null;return s.Ay.extend({name:"registrable-inject",inject:{[t]:{default:n}}})}},8686:function(t,e,i){var s=i(3724),n=i(9039);t.exports=s&&n((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},8727:function(t){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},8767:function(t,e,i){var s=i(5471),n=i(5604),o=i(3805);e.A=s.Ay.extend({name:"colorable",props:{color:String},methods:{setBackgroundColor(t,e={}){return"string"===typeof e.style?((0,n.yA)("style must be an object",this),e):"string"===typeof e.class?((0,n.yA)("class must be an object",this),e):((0,o.VP)(t)?e.style={...e.style,"background-color":`${t}`,"border-color":`${t}`}:t&&(e.class={...e.class,[t]:!0}),e)},setTextColor(t,e={}){if("string"===typeof e.style)return(0,n.yA)("style must be an object",this),e;if("string"===typeof e.class)return(0,n.yA)("class must be an object",this),e;if((0,o.VP)(t))e.style={...e.style,color:`${t}`,"caret-color":`${t}`};else if(t){const[i,s]=t.toString().trim().split(" ",2);e.class={...e.class,[i+"--text"]:!0},s&&(e.class["text--"+s]=!0)}return e}}})},8773:function(t,e){var i={}.propertyIsEnumerable,s=Object.getOwnPropertyDescriptor,n=s&&!i.call({1:2},1);e.f=n?function(t){var e=s(this,t);return!!e&&e.enumerable}:i},8981:function(t,e,i){var s=i(7750),n=Object;t.exports=function(t){return n(s(t))}},9039:function(t){t.exports=function(t){try{return!!t()}catch(e){return!0}}},9297:function(t,e,i){var s=i(9504),n=i(8981),o=s({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return o(n(t),e)}},9306:function(t,e,i){var s=i(4901),n=i(6823),o=TypeError;t.exports=function(t){if(s(t))return t;throw new o(n(t)+" is not a function")}},9433:function(t,e,i){var s=i(4576),n=Object.defineProperty;t.exports=function(t,e){try{n(s,t,{value:e,configurable:!0,writable:!0})}catch(i){s[t]=e}return e}},9456:function(t,e,i){i.d(e,{A:function(){return g}});i(4114),i(8111),i(116);var s,n=i(4765),o=i(8767),r=i(1713),a=i(3661),h=i(6960),l=i(5471),u=i(3507);function c(t){return["fas","far","fal","fab","fad","fak"].some((e=>t.includes(e)))}function d(t){return/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(t)&&/[\dz]$/i.test(t)&&t.length>4}(function(t){t["xSmall"]="12px",t["small"]="16px",t["default"]="24px",t["medium"]="28px",t["large"]="36px",t["xLarge"]="40px"})(s||(s={}));const f=(0,u.A)(n.A,o.A,r.A,a.A).extend({name:"v-icon",props:{dense:Boolean,disabled:Boolean,left:Boolean,right:Boolean,size:[Number,String],tag:{type:String,required:!1,default:"i"}},computed:{medium(){return!1},hasClickListener(){return Boolean(this.listeners$.click||this.listeners$["!click"])}},methods:{getIcon(){let t="";return this.$slots.default&&(t=this.$slots.default[0].text.trim()),(0,h.g8)(this,t)},getSize(){const t={xSmall:this.xSmall,small:this.small,medium:this.medium,large:this.large,xLarge:this.xLarge},e=(0,h.HP)(t).find((e=>t[e]));return e&&s[e]||(0,h.Dg)(this.size)},getDefaultData(){return{staticClass:"v-icon notranslate",class:{"v-icon--disabled":this.disabled,"v-icon--left":this.left,"v-icon--link":this.hasClickListener,"v-icon--right":this.right,"v-icon--dense":this.dense},attrs:{"aria-hidden":!this.hasClickListener,disabled:this.hasClickListener&&this.disabled,type:this.hasClickListener?"button":void 0,...this.attrs$},on:this.listeners$}},getSvgWrapperData(){const t=this.getSize(),e={...this.getDefaultData(),style:t?{fontSize:t,height:t,width:t}:void 0};return this.applyColors(e),e},applyColors(t){t.class={...t.class,...this.themeClasses},this.setTextColor(this.color,t)},renderFontIcon(t,e){const i=[],s=this.getDefaultData();let n="material-icons";const o=t.indexOf("-"),r=o<=-1;r?i.push(t):(n=t.slice(0,o),c(n)&&(n="")),s.class[n]=!0,s.class[t]=!r;const a=this.getSize();return a&&(s.style={fontSize:a}),this.applyColors(s),e(this.hasClickListener?"button":this.tag,s,i)},renderSvgIcon(t,e){const i={class:"v-icon__svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",role:"img","aria-hidden":!0}},s=this.getSize();return s&&(i.style={fontSize:s,height:s,width:s}),e(this.hasClickListener?"button":"span",this.getSvgWrapperData(),[e("svg",i,[e("path",{attrs:{d:t}})])])},renderSvgIconComponent(t,e){const i={class:{"v-icon__component":!0}},s=this.getSize();s&&(i.style={fontSize:s,height:s,width:s}),this.applyColors(i);const n=t.component;return i.props=t.props,i.nativeOn=i.on,e(this.hasClickListener?"button":"span",this.getSvgWrapperData(),[e(n,i)])}},render(t){const e=this.getIcon();return"string"===typeof e?d(e)?this.renderSvgIcon(e,t):this.renderFontIcon(e,t):this.renderSvgIconComponent(e,t)}});var g=l.Ay.extend({name:"v-icon",$_wrapperFor:f,functional:!0,render(t,{data:e,children:i}){let s="";return e.domProps&&(s=e.domProps.textContent||e.domProps.innerHTML||s,delete e.domProps.textContent,delete e.domProps.innerHTML),t(f,e,s?[s]:i)}})},9462:function(t,e,i){var s=i(9565),n=i(2360),o=i(6699),r=i(6279),a=i(8227),h=i(1181),l=i(5966),u=i(7657).IteratorPrototype,c=i(2529),d=i(9539),f=a("toStringTag"),g="IteratorHelper",p="WrapForValidIterator",m=h.set,y=function(t){var e=h.getterFor(t?p:g);return r(n(u),{next:function(){var i=e(this);if(t)return i.nextHandler();if(i.done)return c(void 0,!0);try{var s=i.nextHandler();return i.returnHandlerResult?s:c(s,i.done)}catch(n){throw i.done=!0,n}},return:function(){var i=e(this),n=i.iterator;if(i.done=!0,t){var o=l(n,"return");return o?s(o,n):c(void 0,!0)}if(i.inner)try{d(i.inner.iterator,"normal")}catch(r){return d(n,"throw",r)}return n&&d(n,"normal"),c(void 0,!0)}})},v=y(!0),x=y(!1);o(x,f,"Iterator Helper"),t.exports=function(t,e,i){var s=function(s,n){n?(n.iterator=s.iterator,n.next=s.next):n=s,n.type=e?p:g,n.returnHandlerResult=!!i,n.nextHandler=t,n.counter=0,n.done=!1,m(this,n)};return s.prototype=e?v:x,s}},9504:function(t,e,i){var s=i(616),n=Function.prototype,o=n.call,r=s&&n.bind.bind(o,o);t.exports=s?r:function(t){return function(){return o.apply(t,arguments)}}},9519:function(t,e,i){var s,n,o=i(4576),r=i(2839),a=o.process,h=o.Deno,l=a&&a.versions||h&&h.version,u=l&&l.v8;u&&(s=u.split("."),n=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!n&&r&&(s=r.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=r.match(/Chrome\/(\d+)/),s&&(n=+s[1]))),t.exports=n},9539:function(t,e,i){var s=i(9565),n=i(8551),o=i(5966);t.exports=function(t,e,i){var r,a;n(t);try{if(r=o(t,"return"),!r){if("throw"===e)throw i;return i}r=s(r,t)}catch(h){a=!0,r=h}if("throw"===e)throw i;if(a)throw r;return n(r),i}},9565:function(t,e,i){var s=i(616),n=Function.prototype.call;t.exports=s?n.bind(n):function(){return n.apply(n,arguments)}},9617:function(t,e,i){var s=i(5397),n=i(5610),o=i(6198),r=function(t){return function(e,i,r){var a=s(e),h=o(a);if(0===h)return!t&&-1;var l,u=n(r,h);if(t&&i!==i){while(h>u)if(l=a[u++],l!==l)return!0}else for(;h>u;u++)if((t||u in a)&&a[u]===i)return t||u||0;return!t&&-1}};t.exports={includes:r(!0),indexOf:r(!1)}},9623:function(t,e,i){i(4114);var s=i(3507);function n(t){const e=[];for(let i=0;i<t.length;i++){const s=t[i];s.isActive&&s.isDependent?e.push(s):e.push(...n(s.$children))}return e}e.A=(0,s.A)().extend({name:"dependent",data(){return{closeDependents:!0,isActive:!1,isDependent:!0}},watch:{isActive(t){if(t)return;const e=this.getOpenDependents();for(let i=0;i<e.length;i++)e[i].isActive=!1}},methods:{getOpenDependents(){return this.closeDependents?n(this.$children):[]},getOpenDependentElements(){const t=[],e=this.getOpenDependents();for(let i=0;i<e.length;i++)t.push(...e[i].getClickableDependentElements());return t},getClickableDependentElements(){const t=[this.$el];return this.$refs.content&&t.push(this.$refs.content),this.overlay&&t.push(this.overlay.$el),t.push(...this.getOpenDependentElements()),t}}})},9683:function(t,e,i){i.d(e,{I:function(){return S},A:function(){return k}});var s={};i.r(s),i.d(s,{easeInCubic:function(){return l},easeInOutCubic:function(){return c},easeInOutQuad:function(){return h},easeInOutQuart:function(){return g},easeInOutQuint:function(){return y},easeInQuad:function(){return r},easeInQuart:function(){return d},easeInQuint:function(){return p},easeOutCubic:function(){return u},easeOutQuad:function(){return a},easeOutQuart:function(){return f},easeOutQuint:function(){return m},linear:function(){return o}});var n=i(1609);const o=t=>t,r=t=>t**2,a=t=>t*(2-t),h=t=>t<.5?2*t**2:(4-2*t)*t-1,l=t=>t**3,u=t=>--t**3+1,c=t=>t<.5?4*t**3:(t-1)*(2*t-2)*(2*t-2)+1,d=t=>t**4,f=t=>1- --t**4,g=t=>t<.5?8*t*t*t*t:1-8*--t*t*t*t,p=t=>t**5,m=t=>1+--t**5,y=t=>t<.5?16*t**5:1+16*--t**5;function v(t){if("number"===typeof t)return t;let e=w(t);if(!e)throw"string"===typeof t?new Error(`Target element "${t}" not found.`):new TypeError(`Target must be a Number/Selector/HTMLElement/VueComponent, received ${b(t)} instead.`);let i=0;while(e)i+=e.offsetTop,e=e.offsetParent;return i}function x(t){const e=w(t);if(e)return e;throw"string"===typeof t?new Error(`Container element "${t}" not found.`):new TypeError(`Container must be a Selector/HTMLElement/VueComponent, received ${b(t)} instead.`)}function b(t){return null==t?t:t.constructor.name}function w(t){return"string"===typeof t?document.querySelector(t):t&&t._isVue?t.$el:t instanceof HTMLElement?t:null}function k(t,e={}){const i={container:document.scrollingElement||document.body||document.documentElement,duration:500,offset:0,easing:"easeInOutCubic",appOffset:!0,...e},n=x(i.container);if(i.appOffset&&k.framework.application){const t=n.classList.contains("v-navigation-drawer"),e=n.classList.contains("v-navigation-drawer--clipped"),{bar:s,top:o}=k.framework.application;i.offset+=s,t&&!e||(i.offset+=o)}const o=performance.now();let r;r="number"===typeof t?v(t)-i.offset:v(t)-v(n)-i.offset;const a=n.scrollTop;if(r===a)return Promise.resolve(r);const h="function"===typeof i.easing?i.easing:s[i.easing];if(!h)throw new TypeError(`Easing function "${i.easing}" not found.`);return new Promise((t=>requestAnimationFrame((function e(s){const l=s-o,u=Math.abs(i.duration?Math.min(l/i.duration,1):1);n.scrollTop=Math.floor(a+(r-a)*h(u));const c=n===document.body?document.documentElement.clientHeight:n.clientHeight,d=c+n.scrollTop>=n.scrollHeight;if(1===u||r>n.scrollTop&&d)return t(r);requestAnimationFrame(e)}))))}k.framework={},k.init=()=>{};class S extends n.k{constructor(){return super(),k}}S.property="goTo"},9748:function(t,e,i){i.d(e,{P:function(){return n}});var s=i(5471);function n(t="value",e="input"){return s.Ay.extend({name:"toggleable",model:{prop:t,event:e},props:{[t]:{required:!1}},data(){return{isActive:!!this[t]}},watch:{[t](t){this.isActive=!!t},isActive(i){!!i!==this[t]&&this.$emit(e,i)}}})}const o=n();e.A=o},9923:function(t,e,i){i.d(e,{P:function(){return r}});var s=i(5471),n=i(6960);const o={absolute:Boolean,bottom:Boolean,fixed:Boolean,left:Boolean,right:Boolean,top:Boolean};function r(t=[]){return s.Ay.extend({name:"positionable",props:t.length?(0,n.fF)(o,t):o})}e.A=r()}}]);
//# sourceMappingURL=chunk-vendors.d5e1df02.js.map